<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<script src="head.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../js/Input.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../js/NumberValidator.js"></script>
	
	<style type="text/css" media="screen">
		input
		{
			font-size: 20px;
		}
		.hui_invalid
		{
			background: #faa;
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		hui.test.run([
			function() {
				var result,validator = new hui.ui.NumberValidator({min:0,max:10});
				
				result = validator.validate(10);
				hui.test.assertTrue(result.valid,'10 is valid');
				
				result = validator.validate('abc');
				hui.test.assertTrue(!result.valid,'abc is invalid');
				
				result = validator.validate(0);
				hui.test.assertTrue(result.valid,'0 is valid');
				
				result = validator.validate('0.5');
				hui.test.assertTrue(result.valid,'"0.5" is valid');
				hui.test.assertEquals(result.value,0.5,'new value = 0.5');
				
				result = validator.validate(' 5.5abc');
				hui.test.assertTrue(result.valid,'" 5.5abc" is valid');
				hui.test.assertEquals(result.value,5.5,'new value = 5.5');
				
				result = validator.validate(11);
				hui.test.assertTrue(!result.valid,'It is not valid');
				hui.test.assertEquals(result.value,10,'new value = 10');
				
				result = validator.validate(-1);
				hui.test.assertTrue(!result.valid,'It is not valid');
				hui.test.assertEquals(result.value,0,'new value = 0');
			},
			function() {
				var validator = new hui.ui.NumberValidator({min:0,max:10,allowNull:true});
				
				result = validator.validate(10);
				hui.test.assertTrue(result.valid,'10 is valid');
				
				result = validator.validate('');
				hui.test.assertTrue(result.valid,'"" is valid');

				result = validator.validate('  ');
				hui.test.assertTrue(result.valid,'"  " is valid');
			},
			function() {
				var validator = new hui.ui.NumberValidator({min:-10,max:10});
				var input = hui.build('input',{value:'abc'});
				document.body.appendChild(input);
				var field = new hui.ui.Input({
					element:input,
					validator:validator
				});
				hui.test.assertNotEquals(field.getValue(),input.value,'field value = input value');
				hui.test.assertEquals('abc',input.value,'field value = input value');
				hui.test.assertEquals(field.getValue(),0,'field value = 0');
				
				field.setValue('hfsajfh akjfhakjfhad kj');
				hui.test.assertEquals(field.getValue(),0,'field value = 0');
				
				field.setValue(10000);
				hui.test.assertEquals(field.getValue(),10,'field value = 10');
				
				field.setValue(-10000);
				hui.test.assertEquals(field.getValue(),-10,'field value = -10');
				
				field.setValue();
				hui.test.assertEquals(field.getValue(),0,'field value = 0');
				
				hui.test.type( input, "ab", function() {
					hui.test.assertEquals(field.getValue(),0,'field value = 0');
					field.setValue();
					hui.test.assertEquals(field.getValue(),0,'field value = 0');
					hui.test.type( input, "2",function() {
						hui.test.assertEquals(input.value,'2','input value = "2"');
						hui.test.assertEquals(field.getValue(),2,'field value = 2');
						hui.test.type( input, "0", function() {
							hui.test.assertEquals(input.value,'20','input value = "20"');
							hui.test.assertEquals(field.getValue(),10,'field value = 10');
						} );
					} );
				});
			},
			function() {
				var validator = new hui.ui.NumberValidator({min:-10,max:10,allowNull:true});
				var input = hui.build('input',{value:'    ',parent:document.body});
				var field = new hui.ui.Input({
					element:input,
					validator:validator
				});
				hui.test.assertNotEquals(field.getValue(),input.value,'field value = input value');
				hui.test.assertEquals('    ',input.value,'field value = input value');
				hui.test.assertEquals(field.getValue(),null,'field value = null');
			}
		]);
	</script>
</body>
</html>