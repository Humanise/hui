<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<link charset="utf-8" title="front" media="screen" type="text/css" href="../../css/message.css" rel="stylesheet" />
	<link charset="utf-8" title="front" media="screen" type="text/css" href="../../css/dev.css" rel="stylesheet" />
	<!--[if lt IE 7]>
		<link rel="stylesheet" type="text/css" href="../../css/msie6.css"> </link>
	<![endif]-->
	<!--[if IE 7]>
		<link rel="stylesheet" type="text/css" href="../../css/msie7.css"> </link>
	<![endif]-->
	<script charset="utf-8" type="text/javascript" src="../../js/hui.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../lib/date.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../js/ui.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../js/TextField.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../ext/Test.js"></script>
	<script charset="utf-8" type="text/javascript" src="../../tools/funcunit/funcunit/funcunit.js"></script>
	<script type="text/javascript" charset="utf-8">
		hui.ui.context='../../..';
	</script>
	<style type="text/css" media="screen">
		input
		{
			font-size: 20px;
		}
		.in2igui_invalid
		{
			background: #faa;
		}
	</style>
</head>
<body>
	<script type="text/javascript">
		hui.ui.test.run([
			function() {
				var result,validator = new hui.ui.NumberValidator({min:0,max:10});
				
				result = validator.validate(10);
				hui.ui.test.assertTrue(result.valid,'10 is valid');
				
				result = validator.validate('abc');
				hui.ui.test.assertTrue(!result.valid,'abc is invalid');
				
				result = validator.validate(0);
				hui.ui.test.assertTrue(result.valid,'0 is valid');
				
				result = validator.validate('0.5');
				hui.ui.test.assertTrue(result.valid,'"0.5" is valid');
				hui.ui.test.assertEquals(result.value,0.5,'new value = 0.5');
				
				result = validator.validate(' 5.5abc');
				hui.ui.test.assertTrue(result.valid,'" 5.5abc" is valid');
				hui.ui.test.assertEquals(result.value,5.5,'new value = 5.5');
				
				result = validator.validate(11);
				hui.ui.test.assertTrue(!result.valid,'It is not valid');
				hui.ui.test.assertEquals(result.value,10,'new value = 10');
				
				result = validator.validate(-1);
				hui.ui.test.assertTrue(!result.valid,'It is not valid');
				hui.ui.test.assertEquals(result.value,0,'new value = 0');
			},
			function() {
				var validator = new hui.ui.NumberValidator({min:0,max:10,allowNull:true});
				
				result = validator.validate(10);
				hui.ui.test.assertTrue(result.valid,'10 is valid');
				
				result = validator.validate('');
				hui.ui.test.assertTrue(result.valid,'"" is valid');

				result = validator.validate('  ');
				hui.ui.test.assertTrue(result.valid,'"  " is valid');
			},
			function() {
				var validator = new hui.ui.NumberValidator({min:-10,max:10});
				var input = n2i.build('input',{value:'abc'});
				document.body.appendChild(input);
				var field = new hui.ui.TextField({
					element:input,
					validator:validator
				});
				hui.ui.test.assertNotEquals(field.getValue(),input.value,'field value = input value');
				hui.ui.test.assertEquals('abc',input.value,'field value = input value');
				hui.ui.test.assertEquals(field.getValue(),0,'field value = 0');
				
				field.setValue('hfsajfh akjfhakjfhad kj');
				hui.ui.test.assertEquals(field.getValue(),0,'field value = 0');
				
				field.setValue(10000);
				hui.ui.test.assertEquals(field.getValue(),10,'field value = 10');
				
				field.setValue(-10000);
				hui.ui.test.assertEquals(field.getValue(),-10,'field value = -10');
				
				field.setValue();
				hui.ui.test.assertEquals(field.getValue(),0,'field value = 0');
				
				hui.ui.test.type( input, "ab", function() {
					hui.ui.test.assertEquals(field.getValue(),0,'field value = 0');
					field.setValue();
					hui.ui.test.assertEquals(field.getValue(),0,'field value = 0');
					hui.ui.test.type( input, "2",function() {
						hui.ui.test.assertEquals(input.value,'2','input value = "2"');
						hui.ui.test.assertEquals(field.getValue(),2,'field value = 2');
						hui.ui.test.type( input, "0", function() {
							hui.ui.test.assertEquals(input.value,'20','input value = "20"');
							hui.ui.test.assertEquals(field.getValue(),10,'field value = 10');
						} );
					} );
				});
			},
			function() {
				var validator = new hui.ui.NumberValidator({min:-10,max:10,allowNull:true});
				var input = n2i.build('input',{value:'    ',parent:document.body});
				var field = new hui.ui.TextField({
					element:input,
					validator:validator
				});
				hui.ui.test.assertNotEquals(field.getValue(),input.value,'field value = input value');
				hui.ui.test.assertEquals('    ',input.value,'field value = input value');
				hui.ui.test.assertEquals(field.getValue(),null,'field value = null');
			}
		]);
	</script>
</body>
</html>