<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:o="http://www.onlineobjects.com/jsf" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:gui="http://www.in2isoft.dk/in2igui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
>
	<ui:composition template="templates/plain.xhtml">
		
		<ui:define name="scripts">
			<o:script src="/style/js/word_view.js"/>
			<o:script src="/hui/js/Drawing.js" core="true"/>
			<o:script src="/hui/ext/Diagram.js" core="true"/>
		</ui:define>
		
		<ui:define name="title">#{wordsWordView.text} - </ui:define>
		
		<ui:define name="body">
			<div class="words">
				<o:script>
					wordView.text = "#{wordsWordView.text}";
				</o:script>
				<div id="word" class="words_word">
					<h1>#{wordsWordView.text}</h1>
					<ui:fragment rendered="#{empty wordsWordView.words}">
						<p style="color: #cc0000;">#{msg.word_not_registered}</p>
					</ui:fragment>
					<ui:fragment rendered="#{not empty wordsWordView.words}">
						<ul class="words_word_variants">
							<c:forEach items="#{wordsWordView.words}" var="word">
								<li class="words_word_variant">
									<p class="words_word_info">
										<strong class="words_word_info">#{word.word.text}</strong>
										<c:if test="#{word.lexicalCategory!=null}">
											<span class="words_word_info">
												<span>—</span>
												<a href="javascript://" onclick="wordView.changeWord({id:#{word.word.id},element:this,event:event}); return false;">
													<o:out value=" #{msg[word.lexicalCategory.code]}" lower="true"/>
												</a>
											</span>
										</c:if>
										<c:if test="#{word.language!=null}">
											<span class="words_word_info"><span>—</span> 
												<a href="javascript://" onclick="wordView.changeLanguage({id:#{word.word.id},element:this,event:event}); return false;">
													<o:out value=" #{msg[word.language.code]}" lower="true"/>
												</a>
											</span>
										</c:if>
										<c:if test="#{word.lexicalCategory==null}">
											<span class="words_word_info">
												<span>—</span>
												<a href="javascript://" onclick="wordView.categorizeWord({id:#{word.word.id},element:this,event:event}); return false;">
													<o:out value="#{msg.not_categorised}"/>
												</a>
											 </span>
										</c:if>
									</p>
									<ul class="words_word_relations">
									<c:forEach items="#{word.relations}" var="group">
										<li>
											<strong>#{msg[group.kind]}:</strong>
											<c:forEach items="#{group.relations}" var="relation" varStatus="status">
												<c:if test="#{not status.first}">, </c:if>
												<span class="words_word_relation">
													<o:link href="/#{wordsLayoutView.language}/word/#{relation.word.text}.html">#{relation.word.name}</o:link>
													
												</span>
												<c:if test="#{wordsLayoutView.loggedIn}">
													<a href="javascript://" class="words_word_action"
														onclick="wordView.deleteRelation({id:#{relation.id},element:this,event:event}); return false;"
													><o:out value="#{msg.remove}" lower="true"/></a>
												</c:if>
											</c:forEach>
										</li>
									</c:forEach>
									</ul>
									<p class="words_word_by">
										#{msg.created}: <o:date value="#{word.word.created}"/>
										<c:if test="#{not empty word.originator}">
										#{msg.by} #{word.originator.name}
										</c:if>
										<gui:button variant="paper" name="delete#{word.word.id}" tiny="true" text="#{msg.remove}" left="10" 
											click="wordView.deleteWord({id:#{word.word.id}})"
											rendered="#{wordsLayoutView.loggedIn}"
										/>
										<gui:button variant="paper" name="relate#{word.word.id}" tiny="true" text="#{msg.add_relation}" left="10" 
											click="wordView.addRelation({id:#{word.word.id}})"
											rendered="#{wordsLayoutView.loggedIn}"
										/>
									</p>
								</li>
							</c:forEach>
						</ul>
					</ui:fragment>
					<p>
						<gui:button variant="paper" name="addVariant" small="true" text="#{msg.add_variant}" rendered="#{wordsLayoutView.loggedIn}"/>
					</p>
					<gui:diagram name="diagram"/>
					
					<gui:boundPanel name="wordEditor" hideOnClick="true" width="400" rendered="#{wordsLayoutView.loggedIn}">
						<div class="panel_body">
							<h2>#{msg.lexical_categories}</h2>
							<ul class="selection">
								<c:forEach items="#{wordsWordView.categories}" var="cat">
									<c:if test="#{not empty cat.value}">
										<li><a rel="#{cat.value}"><strong>#{cat.label} :</strong> #{cat.description}</a></li>
									</c:if>
								</c:forEach>
							</ul>
						</div>
					</gui:boundPanel>
					
					<gui:boundPanel name="languagePanel" hideOnClick="true" width="200" rendered="#{wordsLayoutView.loggedIn}">
						<div class="panel_body">
							<h2>#{msg.languages}</h2>
							<ul class="selection">
								<c:forEach items="#{wordsWordView.languages}" var="cat">
									<li><a rel="#{cat.value}"><strong>#{cat.label}</strong></a></li>
								</c:forEach>
							</ul>
						</div>
					</gui:boundPanel>
					
					<gui:boundPanel name="relationKindPanel" hideOnClick="true" width="200" rendered="#{wordsLayoutView.loggedIn}">
						<div class="panel_body">
							<h2>#{msg.relation_kind}</h2>
							<ul class="selection">
								<c:forEach items="#{wordsWordView.relations}" var="cat">
									<li><a rel="#{cat.value}"><strong>#{cat.label}</strong></a></li>
								</c:forEach>
							</ul>
						</div>
					</gui:boundPanel>

			
					<gui:boundPanel name="addVariantPanel" hideOnClick="true" width="200">
						<gui:formula name="addVariantForm">
							<gui:fields>
								<gui:field label="#{msg.language}">
									<gui:dropDown key="language" items="#{wordsWordView.languages}"/>
								</gui:field>
								<gui:field label="#{msg.category}">
									<gui:dropDown key="category" items="#{wordsWordView.categories}"/>
								</gui:field>
							</gui:fields>
							<gui:button text="#{msg.add}" name="addVariantButton" highlighted="true"/>
						</gui:formula>
					</gui:boundPanel>
					
				</div>
			</div>
		</ui:define>
	</ui:composition>
</html>