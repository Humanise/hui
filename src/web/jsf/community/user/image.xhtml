<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:oo="http://www.onlineobjects.com/jsf" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:gui="http://www.in2isoft.dk/in2igui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
>
	<ui:composition template="template.xhtml">
		<ui:param name="tab" value="images"/>
		
		<ui:define name="breadcrumb">
			<li><a href="#{base.baseContext}/#{userProfile.user.username}/images.html">Billeder</a></li>
			<li><a href="#{base.baseContext}/#{userProfile.user.username}/images/#{imageView.imageId}.html">#{imageView.image.name}</a></li>
		</ui:define>
		
		<ui:define name="content">
			<div class="content_body image_view">
				<div class="image_preview">
					<img src="#{base.baseContext}/service/image/id#{imageView.image.id}width300height1000.jpg" onclick="oo.community.showImage({id:#{imageView.image.id},width:#{imageView.image.width},height:#{imageView.image.height}})"/>
					
					<h:panelGroup rendered="#{not empty imageView.location}">
						<div id="map_canvas" style="width:100%; height:300px; margin-top: 20px;"></div>
					</h:panelGroup>
				</div>
				<div id="imageContainer" class="container">
					<div class="rendering" id="imageProperties">
						<h1>#{imageView.image.name}</h1>
						<p class="minor fileinfo">#{imageView.image.width} &#215; #{imageView.image.height} (#{imageView.megaPixels} Megapixel), #{imageView.image.contentType}</p>
						<c:if test="#{not empty imageView.description}">
							<p class="resume">&#34;#{imageView.description}&#34;</p>
						</c:if>
						<c:if test="#{not empty imageView.imageInfo.tags}">
							<p class="tags">
								<ui:repeat value="#{imageView.imageInfo.tags}" var="tag" varStatus="status">
									<a class="tag" href="#"><span>#{tag}</span></a><h:panelGroup rendered="#{!status.last}">,</h:panelGroup>
								</ui:repeat>
							</p>
						</c:if>
						<h:panelGroup rendered="#{not empty imageView.imageInfo.taken}">
							<p><span class="label">Dato: </span> <h:outputText value="#{imageView.imageInfo.taken}"><f:convertDateTime pattern="EEEE 'd'. d.  MMMM yyyy 'kl.' HH:mm:ss" locale="da_DK"/></h:outputText></p>
						</h:panelGroup>
						<h:panelGroup rendered="#{not empty imageView.imageInfo.cameraMake}">
							<p><span class="label">Kameraproducent:</span> #{imageView.imageInfo.cameraMake}</p>
						</h:panelGroup>
						<h:panelGroup rendered="#{not empty imageView.imageInfo.cameraModel}">
							<p><span class="label">Kameramodel:</span> #{imageView.imageInfo.cameraModel}</p>
						</h:panelGroup>
						<h:panelGroup rendered="#{not empty imageView.location}">
							<p><span class="label">Latitude:</span> #{imageView.location.latitude}</p>
							<p><span class="label">Longitude:</span> #{imageView.location.longitude}</p>
						</h:panelGroup>
						<h:panelGroup rendered="#{imageView.canEdit}">
							<script type="text/javascript" src="#{base.localContext}/js/imageview.js"></script>
							<script type="text/javascript" charset="utf-8">
								oo.community.ImgeView.id=#{imageView.image.id};
							</script>
							<div class="editbutton">
								<gui:button text="Rediger egenskaber..." name="editImage" small="true"/>
							</div>
						</h:panelGroup>
					</div>
					<div id="imageEditor" style="display: none;"></div>
				</div>
			</div>
		</ui:define>
		
		<ui:define name="last">
			<h:panelGroup rendered="#{not empty imageView.location}">
				<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
				<script type="text/javascript">
				  ui.onDomReady(function() {
				    var myLatlng = new google.maps.LatLng(#{imageView.location.latitude}, #{imageView.location.longitude});
				    var myOptions = {
				      zoom: 15,
				      center: myLatlng,
				      mapTypeId: google.maps.MapTypeId.SATELLITE
				    }
				    var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
				    var marker = new google.maps.Marker({
				        position: myLatlng, 
				        map: map,
				        title:"Hello World!"
				    });   
				  });
				</script>
			</h:panelGroup>
		</ui:define>

	</ui:composition>
</html>
