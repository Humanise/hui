<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:o="http://www.onlineobjects.com/jsf" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:gui="http://www.in2isoft.dk/in2igui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
>
	<ui:composition template="templates/plain.xhtml">
		
		<ui:define name="title">#{photosPhotoView.image.name} - </ui:define>
		
		<ui:define name="scripts">
			<c:if test="#{not empty photosPhotoView.image}">
				<o:script src="/style/js/photo_view.js"/>
				<o:script>
					photoView.editable = #{photosPhotoView.canModify};
					photoView.imageId = #{photosPhotoView.image.id};
				</o:script>
			</c:if>
		</ui:define>
		
		<ui:define name="body">
			<c:if test="#{empty photosPhotoView.image}">
				<h2 class="message">Billedet blev ikke fundet</h2>
			</c:if>
			<c:if test="#{not empty photosPhotoView.image}">
				<div class="photos_photo">
					<ui:fragment id="title">
					<h1 id="editableTitle">#{photosPhotoView.image.name}</h1>
					</ui:fragment>
					<p class="photos_photo_by"><span>Tilføjet </span><strong>
						<h:outputText value="#{photosPhotoView.image.created}">
							<f:convertDateTime pattern="EEEE 'd'. d.  MMMM yyyy" locale="da_DK"/>
						</h:outputText></strong> af <o:link href="/users/#{photosPhotoView.user.username}/">#{photosPhotoView.person.fullName}</o:link>
					</p>
					<div class="photos_photo_image">
						<o:thumbnail image="#{photosPhotoView.image}" width="778" zoom="true" frame="false"/>
						<div class="photos_controller oo_faded">
							<o:link href="/service/image/id#{photosPhotoView.image.id}.jpg?download=true" core="true" plain="true"><i class="icon-download-alt"></i></o:link>
							<o:link href="/service/image/id#{photosPhotoView.image.id}.jpg" core="true" plain="true"><i class="icon-resize-full"></i></o:link>
						</div>
						<div class="photos_controller photos_controller_top oo_faded">
							<o:link href="/#{wordsLayoutView.language}/photo/#{photosPhotoView.previousId}.html" plain="true"><i class="icon-chevron-left"></i></o:link>
							<o:link href="/#{wordsLayoutView.language}/photo/#{photosPhotoView.nextId}.html" plain="true"><i class="icon-chevron-right"></i></o:link>
						</div> 
					</div>
					<div id="photos_photo_description">
						<c:if test="#{not photosPhotoView.canModify and not empty photosPhotoView.description}">
							<p class="photos_photo_description" style="margin-top: 10px;">
								<span class="photos_photo_description_start">&#8220;</span><o:out value="#{photosPhotoView.description}" escape="false"/><span class="photos_photo_description_end">&#8221;</span>
							</p>
						</c:if>
						<c:if test="#{photosPhotoView.canModify}">
							<div style="margin-top: 10px;">
							<gui:pages name="descriptionPages">
								<gui:page>
									<c:if test="#{not empty photosPhotoView.description}">
										<p class="photos_photo_description">
											<span class="photos_photo_description_start">&#8220;</span><o:out value="#{photosPhotoView.description}" escape="false"/><span class="photos_photo_description_end">&#8221;</span>
										</p>
									</c:if>
									<div style="padding: 0 10px 10px;">
										<gui:button variant="paper" text="Edit description" small="true" name="addDescription"/>
									</div>
								</gui:page>
								<gui:page>
									<div style="padding: 0 10px 10px;">
									<gui:textInput name="description" multiline="true" value="#{photosPhotoView.description}"/>
									<div style="padding: 5px 0 0;">
									<gui:buttons>
										<gui:button text="Save" variant="paper" name="saveDescription" small="true"/>
										<gui:button text="Cancel" variant="paper" name="cancelDescription" small="true"/>
									</gui:buttons>
									</div>
									</div>
								</gui:page>
							</gui:pages>
							</div>
						</c:if>
					</div>
				</div>
				<gui:boundPanel name="locationPanel" modal="true">
					<gui:formula name="locationForm">
						<gui:locationInput key="location"/>
					</gui:formula>
					<div style="margin-top: 3px;">
						<gui:button text="Save" name="saveLocation" small="true"/>
					</div>
				</gui:boundPanel>
			</c:if>
		</ui:define>
		
		<ui:define name="sidebar">
			<div class="photos_profile">
				<div class="photos_profile_photo">
					<o:thumbnail image="#{photosPhotoView.personImage}" width="50" height="60" zoom="true" frame="false"/>
				</div>
				<div class="photos_profile_body">
					<p>#{photosPhotoView.person.fullName}</p>
					<p>@#{photosPhotoView.user.username}</p>
					<p style="margin-top: 5px"><o:link>Photos »</o:link></p>
					<p style="margin-top: 5px"><o:link>Profile »</o:link></p>
				</div>
			</div>
			<div class="photos_photo_properties oo_faded">
				<o:block id="properties">
					<c:forEach items="#{photosPhotoView.properties}" var="prop">
						<p class="photos_photo_property"><strong>#{prop.label}:</strong> #{prop.value}</p>
					</c:forEach>
				</o:block>
				<div style="margin: 10px 0">
					<o:map name="map" location="#{photosPhotoView.mapPoint}" dynamic="false" editable="#{photosPhotoView.canModify}"/>
				</div>
				<o:words words="#{photosPhotoView.words}" editable="#{photosPhotoView.canModify}" name="words"/>
				<c:if test="#{photosPhotoView.canModify}">
					<h2 style="font-weight: 200; font-size: 12pt; border-bottom: 1px solid #ddd; color: #999; margin: 10px 0 0;">Access control</h2>
					<p style="margin: 5px 0;">
						<gui:checkbox label="Public access" name="publicAccess" value="#{not photosPhotoView.secret}"/>
					</p>
				</c:if>
			</div>
		</ui:define>
		
	</ui:composition>
</html>