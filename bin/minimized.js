var hui={browser:{},ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45};hui.browser.opera=/opera/i.test(navigator.userAgent);hui.browser.msie=!hui.browser.opera&&/MSIE/.test(navigator.userAgent);hui.browser.msie6=navigator.userAgent.indexOf("MSIE 6")!==-1;hui.browser.msie7=navigator.userAgent.indexOf("MSIE 7")!==-1;hui.browser.msie8=navigator.userAgent.indexOf("MSIE 8")!==-1;hui.browser.msie9=navigator.userAgent.indexOf("MSIE 9")!==-1;hui.browser.msie9compat=hui.browser.msie7&&navigator.userAgent.indexOf("Trident/5.0")!==-1;hui.browser.msie9=navigator.userAgent.indexOf("MSIE 10")!==-1;hui.browser.webkit=navigator.userAgent.indexOf("WebKit")!==-1;hui.browser.safari=navigator.userAgent.indexOf("Safari")!==-1;hui.browser.chrome=navigator.userAgent.indexOf("Chrome")!==-1;hui.browser.webkitVersion=null;hui.browser.gecko=!hui.browser.webkit&&navigator.userAgent.indexOf("Gecko")!==-1;hui.browser.chrome=navigator.userAgent.indexOf("Chrome")!==-1;hui.browser.ipad=hui.browser.webkit&&navigator.userAgent.indexOf("iPad")!==-1;hui.browser.windows=navigator.userAgent.indexOf("Windows")!==-1;hui.browser.opacity=!hui.browser.msie6&&!hui.browser.msie7&&!hui.browser.msie8;(function(){var A=/Safari\/([\d.]+)/.exec(navigator.userAgent);if(A){hui.browser.webkitVersion=parseFloat(A[1])}})();hui.log=function(A){try{if(arguments.length==1){console.log(A)}else{if(arguments.length==2){console.log(arguments[0],arguments[1])}else{console.log(arguments)}}}catch(B){}};hui.defer=function(A,B){if(B){A=A.bind(B)}window.setTimeout(A)};hui.override=function(B,A){if(A){for(prop in A){B[prop]=A[prop]}}return B};hui.each=function(A,D){if(hui.isArray(A)){for(var C=0;C<A.length;C++){D(A[C],C)}}else{for(var B in A){D(B,A[B])}}};hui.when=function(B,A){return B?A:""};hui.intOrString=function(B){if(hui.isDefined(B)){var A=/[0-9]+/.exec(B);if(A!==null&&A[0]==B){if(parseInt(B,10)==B){return parseInt(B,10)}}}return B};hui.isBlank=function(A){if(A===null||typeof (A)==="undefined"||A===""){return true}return typeof (A)=="string"&&hui.string.trim(A).length==0};hui.isDefined=function(A){return A!==null&&typeof (A)!=="undefined"};hui.isString=function(A){return typeof (A)==="string"};hui.isArray=function(A){if(A==null||A==undefined){return false}if(A.constructor==Array){return true}else{return Object.prototype.toString.call(A)==="[object Array]"}};hui.string={startsWith:function(A,B){if(!typeof (A)=="string"||!typeof (B)=="string"){return false}return(A.match("^"+B)==B)},endsWith:function(B,A){if(!typeof (B)=="string"||!typeof (A)=="string"){return false}return(B.match(A+"$")==A)},camelize:function(F){if(F.indexOf("-")==-1){return F}var D=F.split("-");var B=F.indexOf("-")==0?D[0].charAt(0).toUpperCase()+D[0].substring(1):D[0];for(var C=1,A=D.length;C<A;C++){var E=D[C];B+=E.charAt(0).toUpperCase()+E.substring(1)}return B},trim:function(A){if(A===null||A===undefined){return""}if(typeof (A)!="string"){A=new String(A)}return A.replace(/^[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+|[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+$/g,"")},wrap:function(A){if(A===null||A===undefined){return""}return A.split("").join("\u200B")},shorten:function(B,A){if(!hui.isDefined(B)){return""}if(B.length>A){return B.substring(0,A-3)+"..."}return B},escapeHTML:function(A){if(A===null||A===undefined){return""}return hui.build("div",{text:A}).innerHTML},escape:function(A){if(!hui.isDefined(A)){return""}return A.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},fromJSON:function(A){try{return JSON.parse(A)}catch(B){hui.log(B);return null}},toJSON:function(A){return JSON.stringify(A)}};hui.array={add:function(A,C){if(C.constructor==Array){for(var B=0;B<C.length;B++){if(!hui.array.contains(A,C[B])){A.push(C)}}}else{if(!hui.array.contains(A,C)){A.push(C)}}},contains:function(A,C){for(var B=0;B<A.length;B++){if(A[B]===C){return true}}return false},flip:function(A,B){if(hui.array.contains(A,B)){hui.array.remove(A,B)}else{A.push(B)}},remove:function(A,C){for(var B=A.length-1;B>=0;B--){if(A[B]==C){A.splice(B,1)}}},indexOf:function(A,C){for(var B=0;B<A.length;B++){if(A[B]===C){return B}}return -1},toIntegers:function(B){var C=B.split(",");for(var A=C.length-1;A>=0;A--){C[A]=parseInt(C[A])}return C}};hui.dom={isElement:function(B,A){return B.nodeType==hui.ELEMENT_NODE&&(A===undefined?true:B.nodeName.toLowerCase()==A)},isDefinedText:function(A){return A.nodeType==hui.TEXT_NODE&&A.nodeValue.length>0},addText:function(A,B){A.appendChild(document.createTextNode(B))},firstChild:function(C){var B=C.childNodes;for(var A=0;A<B.length;A++){if(B[A].nodeType==hui.ELEMENT_NODE){return B[A]}}return null},parseToNode:function(A){var B=hui.build("div",{html:A});return hui.get.firstChild(B,"table")},clear:function(C){var B=C.childNodes;for(var A=B.length-1;A>=0;A--){B[A].parentNode.removeChild(B[A])}},remove:function(A){if(A.parentNode){A.parentNode.removeChild(A)}},replaceNode:function(B,A){if(A.parentNode){A.parentNode.removeChild(A)}B.parentNode.insertBefore(A,B);B.parentNode.removeChild(B)},insertBefore:function(B,A){B.parentNode.insertBefore(A,B)},insertAfter:function(C,A){var B=C.nextSibling;if(B){B.parentNode.insertBefore(A,B)}else{C.parentNode.appendChild(A)}},replaceHTML:function(B,A){B=hui.get(B);B.innerHTML=A},runScripts:function(node){var scripts=node.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){eval(scripts[i].innerHTML)}},setText:function(C,D){if(D==undefined||D==null){D=""}var E=C.childNodes;var A=false;for(var B=E.length-1;B>=0;B--){if(!A&&E[B].nodeType==hui.TEXT_NODE){E[B].nodeValue=D;A=true}else{C.removeChild(E[B])}}if(!A){hui.dom.addText(C,D)}},getText:function(C){var A="";var D=C.childNodes;for(var B=0;B<D.length;B++){if(D[B].nodeType==hui.TEXT_NODE&&D[B].nodeValue!=null){A+=D[B].nodeValue}else{if(D[B].nodeType==hui.ELEMENT_NODE){A+=hui.dom.getText(D[B])}}}return A},isVisible:function(A){while(A){if(A.style&&(hui.style.get(A,"display")==="none"||hui.style.get(A,"visibility")==="hidden")){return false}A=A.parentNode}return true},isDescendantOrSelf:function(A,B){while(A){if(A==B){return true}A=A.parentNode}return false}};hui.form={getValues:function(C){var D={};var A=C.getElementsByTagName("input");for(var B=0;B<A.length;B++){if(hui.isDefined(A[B].name)){D[A[B].name]=A[B].value}}return D}};hui.get=function(A){if(typeof (A)=="string"){return document.getElementById(A)}return A};hui.get.children=function(D){var C=[];var A=D.childNodes;for(var B=0;B<A.length;B++){if(hui.dom.isElement(A[B])){C.push(A[B])}}return C};hui.get.ancestors=function(A){var C=[];var B=A.parentNode;while(B){C[C.length]=B;B=B.parentNode}return C};hui.get.firstAncestorByClass=function(A,B){while(A){if(hui.cls.has(A,B)){return A}A=A.parentNode}return null};hui.get.next=function(A){if(!A){return null}if(A.nextElementSibling){return A.nextElementSibling}if(!A.nextSibling){return null}var B=A.nextSibling;while(B&&B.nodeType!=1){B=B.nextSibling}if(B&&B.nodeType==1){return B}return null};hui.get.previous=function(A){if(!A){return null}if(A.previousElementSibling){return A.previousElementSibling}if(!A.previousSibling){return null}var B=A.previousSibling;while(B&&B.nodeType!=1){B=B.previousSibling}if(B&&B.nodeType==1){return B}return null};hui.get.before=function(C){var D=[];if(C){var A=C.parentNode.childNodes;for(var B=0;B<A.length;B++){if(A[B]==C){break}else{if(A[B].nodeType===1){D.push(A[B])}}}}return D};hui.get.after=function(A){var C=[];var B=hui.get.next(A);while(B){C.push(B);B=hui.get.next(B)}return C};hui.get.firstByClass=function(B,E,A){B=hui.get(B)||document.body;if(document.querySelector){return B.querySelector((A?A+".":".")+E)}else{var D=B.getElementsByTagName(A||"*");for(var C=0;C<D.length;C++){if(hui.cls.has(D[C],E)){return D[C]}}}return null};hui.get.byClass=function(H,F,I){H=hui.get(H)||document.body;if(document.querySelectorAll){var A=H.querySelectorAll((I?I+".":".")+F);var C=[];for(var E=0,G=A.length;E!=G;C.push(A[E++])){}return C}else{var B=H.getElementsByTagName(I||"*"),D=[];for(var E=0;E<B.length;E++){if(hui.cls.has(B[E],F)){D[D.length]=B[E]}}return D}};hui.get.byTag=function(E,C){var B=E.getElementsByTagName(C),A=[];for(var D=0,F=B.length;D!=F;A.push(B[D++])){}return A};hui.get.byId=function(D,E){var B=D.childNodes;for(var A=B.length-1;A>=0;A--){if(B[A].nodeType===hui.ELEMENT_NODE&&B[A].getAttribute("id")===E){return B[A]}else{var C=hui.get.byId(B[A],E);if(C){return C}}}return null};hui.get.firstParentByTag=function(C,A){var B=C;while(B){if(B.tagName&&B.tagName.toLowerCase()==A){return B}B=B.parentNode}return null};hui.get.firstParentByClass=function(C,A){var B=C;while(B){if(hui.cls.has(B)){return B}B=B.parentNode}return null};hui.get.firstByTag=function(C,A){C=hui.get(C)||document.body;if(document.querySelector&&A!=="*"){return C.querySelector(A)}var B=C.getElementsByTagName(A);return B[0]};hui.get.firstChild=hui.dom.firstChild;hui.build=function(B,A,D){var D=D||document,C=D.createElement(B);if(A){for(prop in A){if(prop=="text"){C.appendChild(D.createTextNode(A.text))}else{if(prop=="html"){C.innerHTML=A.html}else{if(prop=="parent"){A.parent.appendChild(C)}else{if(prop=="parentFirst"){if(A.parentFirst.childNodes.length==0){A.parentFirst.appendChild(C)}else{A.parentFirst.insertBefore(C,A.parentFirst.childNodes[0])}}else{if(prop=="before"){A.before.parentNode.insertBefore(C,A.before)}else{if(prop=="className"){C.className=A.className}else{if(prop=="class"){C.className=A["class"]}else{if(prop=="style"&&typeof (A[prop])=="object"){hui.style.set(C,A[prop])}else{if(prop=="style"&&(hui.browser.msie7||hui.browser.msie6)){C.style.setAttribute("cssText",A[prop])}else{if(hui.isDefined(A[prop])){C.setAttribute(prop,A[prop])}}}}}}}}}}}}return C};hui.position={getTop:function(A){A=hui.get(A);if(A){var B=A.offsetTop,C=A.offsetParent;while(C!=null){B+=C.offsetTop;C=C.offsetParent}return B}else{return 0}},getLeft:function(A){A=hui.get(A);if(A){var B=A.offsetLeft,C=A.offsetParent;while(C!=null){B+=C.offsetLeft;C=C.offsetParent}return B}else{return 0}},get:function(A){return{left:hui.position.getLeft(A),top:hui.position.getTop(A)}},getScrollOffset:function(A){A=hui.get(A);var C=0,B=0;do{C+=A.scrollTop||0;B+=A.scrollLeft||0;A=A.parentNode}while(A);return{top:C,left:B}},place:function(J){var B=0,G=0,A=hui.get(J.source.element),E=hui.get(J.target.element),D={left:hui.position.getLeft(E),top:hui.position.getTop(E)};B=D.left+E.clientWidth*(J.target.horizontal||0);G=D.top+E.clientHeight*(J.target.vertical||0);B-=A.clientWidth*(J.source.horizontal||0);G-=A.clientHeight*(J.source.vertical||0);if(J.top){G+=J.top}if(J.left){B+=J.left}if(J.insideViewPort){var H=hui.window.getViewWidth();if(B+A.clientWidth>H){B=H-A.clientWidth-(J.viewPartMargin||0);hui.log(J.viewPartMargin)}if(B<0){B=0}if(G<0){G=0}var I=hui.window.getViewHeight();var F=hui.window.getScrollTop()+hui.window.getViewHeight()-A.clientHeight,C=hui.window.getScrollTop();G=Math.max(Math.min(G,F),C)}A.style.top=Math.round(G)+"px";A.style.left=Math.round(B)+"px"},getRemainingHeight:function(D){var A=D.parentNode.clientHeight;var E=D.parentNode.childNodes;for(var C=0;C<E.length;C++){var B=E[C];if(B!==D&&hui.dom.isElement(E[C])){if(hui.style.get(B,"position")!="absolute"){A-=B.offsetHeight}}}return A}};hui.window={getScrollTop:function(){if(window.pageYOffset){return window.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}return 0},getScrollLeft:function(){if(window.pageYOffset){return window.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}}}return 0},scrollTo:function(D){var E=D.element;var G=hui.position.get(E);var A=hui.window.getScrollTop();var B=hui.window.getViewHeight();var C=A+B;if(A<G.top+E.clientHeight||(G.top)<C){var F=G.top-Math.round((B-E.clientHeight)/2);F=Math.max(0,F);window.scrollTo(0,F)}},getViewHeight:function(){if(window.innerHeight){return window.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight}else{if(document.body){return document.body.clientHeight}}}},getViewWidth:function(){if(window.innerWidth){return window.innerWidth}else{if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth}else{if(document.body){return document.body.clientWidth}}}}};hui.cls={has:function(C,D){C=hui.get(C);if(!C||!C.className){return false}if(C.hasClassName){return C.hasClassName(D)}if(C.className==D){return true}var A=C.className.split(/\s+/);for(var B=0;B<A.length;B++){if(A[B]==D){return true}}return false},add:function(A,B){A=hui.get(A);if(!A){return }if(A.addClassName){A.addClassName(B)}hui.cls.remove(A,B);A.className+=" "+B},remove:function(D,E){D=hui.get(D);if(!D||!D.className){return }if(D.removeClassName){D.removeClassName(E)}if(D.className=="className"){D.className="";return }var B="";var A=D.className.split(/\s+/);for(var C=0;C<A.length;C++){if(A[C]!=E){if(C>0){B+=" "}B+=A[C]}}D.className=B},toggle:function(A,B){if(hui.cls.has(A,B)){hui.cls.remove(A,B)}else{hui.cls.add(A,B)}},set:function(A,B,C){if(C){hui.cls.add(A,B)}else{hui.cls.remove(A,B)}}};hui.listen=function(B,C,D,A){B=hui.get(B);if(!B){return }if(document.addEventListener){B.addEventListener(C,D,A?true:false)}else{B.attachEvent("on"+C,D)}};hui.listenOnce=function(A,B,D){var C=null;C=function(E){hui.unListen(A,B,C);D(E)};hui.listen(A,B,C)};hui.unListen=function(C,B,D,A){C=hui.get(C);if(document.removeEventListener){C.removeEventListener(B,D,A?true:false)}else{C.detachEvent("on"+B,D)}};hui.event=function(A){if(A!==undefined&&A.huiEvent===true){return A}return new hui.Event(A)};hui.Event=function(A){this.huiEvent=true;this.event=A=A||window.event;if(!A){hui.log("No event")}this.element=A.target?A.target:A.srcElement;this.shiftKey=A.shiftKey;this.altKey=A.altKey;this.metaKey=A.metaKey;this.returnKey=A.keyCode==13;this.escapeKey=A.keyCode==27;this.spaceKey=A.keyCode==32;this.backspaceKey=A.keyCode==8;this.upKey=A.keyCode==38;this.downKey=A.keyCode==40;this.leftKey=A.keyCode==37;this.rightKey=A.keyCode==39;this.keyCode=A.keyCode};hui.Event.prototype={getLeft:function(){var A=0;if(this.event){if(this.event.pageX){A=this.event.pageX}else{if(this.event.clientX){A=this.event.clientX+hui.window.getScrollLeft()}}}return A},getTop:function(){var A=0;if(this.event){if(this.event.pageY){A=this.event.pageY}else{if(this.event.clientY){A=this.event.clientY+hui.window.getScrollTop()}}}return A},getElement:function(){return this.element},findByClass:function(A){return hui.get.firstAncestorByClass(this.element,A)},findByTag:function(A){var B=this.element;while(B){if(B.tagName&&B.tagName.toLowerCase()==A){return B}B=B.parentNode}return null},find:function(B){var A=this.element;while(A){if(A.tagName&&A.tagName.toLowerCase()==tag){if(B(A)){return A}}A=A.parentNode}return null},stop:function(){hui.stop(this.event)}};hui.stop=function(A){if(!A){A=window.event}if(A.stopPropagation){A.stopPropagation()}if(A.preventDefault){A.preventDefault()}A.cancelBubble=true;A.stopped=true};hui.onReady=function(A){if(window.addEventListener){window.addEventListener("DOMContentLoaded",A,false)}else{if(typeof document.addEventListener!="undefined"){document.addEventListener("load",A,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",A)}else{if(typeof window.onload=="function"){var B=window.onload;window.onload=function(){B();A()}}else{window.onload=A}}}}};hui.request=function(B){B=hui.override({method:"POST",async:true,headers:{Ajax:true}},B);var E=hui.request.createTransport();E.onreadystatechange=function(){try{if(E.readyState==4){if(E.status==200&&B.onSuccess){B.onSuccess(E)}else{if(E.status==403&&B.onForbidden){B.onForbidden(E)}else{if(E.status!==0&&B.onFailure){B.onFailure(E)}else{if(E.status==0&&B.onAbort){B.onAbort(E)}}}}}}catch(F){if(B.onException){B.onException(F,E)}else{throw F}}};var D=B.method.toUpperCase();E.open(D,B.url,B.async);var A=null;if(D=="POST"&&B.file){if(false){A=B.file;E.setRequestHeader("Content-type",B.file.type);E.setRequestHeader("X_FILE_NAME",B.file.name)}else{A=new FormData();A.append("file",B.file);if(B.parameters){for(param in B.parameters){A.append(param,B.parameters[param])}}}if(B.onProgress){E.upload.addEventListener("progress",function(F){B.onProgress(F.loaded,F.total)},false)}if(B.onLoad){E.upload.addEventListener("load",function(F){B.onLoad()},false)}}else{if(D=="POST"&&B.files){A=new FormData();for(var C=0;C<B.files.length;C++){A.append("file"+C,B.files[C])}}else{if(D=="POST"&&B.parameters){A=hui.request._buildPostBody(B.parameters);E.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8")}else{A=""}}}if(B.headers){for(name in B.headers){E.setRequestHeader(name,B.headers[name])}}E.send(A);return E};hui.request.isXMLResponse=function(A){return A.responseXML&&A.responseXML.documentElement&&A.responseXML.documentElement.nodeName!="parsererror"};hui.request._buildPostBody=function(B){if(!B){return null}var A="";for(param in B){if(A.length>0){A+="&"}A+=encodeURIComponent(param)+"=";if(B[param]!==undefined&&B[param]!==null){A+=encodeURIComponent(B[param])}}return A};hui.request.createTransport=function(){try{if(window.XMLHttpRequest){var B=new XMLHttpRequest();if(B.readyState==null){B.readyState=1;B.addEventListener("load",function(){B.readyState=4;if(typeof B.onreadystatechange=="function"){B.onreadystatechange()}},false)}return B}else{if(window.ActiveXObject){return hui.request._getActiveX()}else{this.delegate.onError(this)}}}catch(A){if(this.delegate.onError){this.delegate.onError(this,A)}}};hui.request._getActiveX=function(){var C=["MSXML2","Microsoft","MSXML","MSXML3"];var D;for(var B=0;B<C.length;B++){try{D=new ActiveXObject(C[B]+".XmlHttp");return D}catch(A){}}throw new Error("Could not find an installed XML parser")};hui.style={copy:function(E,F,D){for(var A=0;A<D.length;A++){var B=D[A];var C=hui.style.get(E,B);if(C){F.style[B]=C}}},set:function(A,B){for(style in B){if(style==="transform"){A.style["webkitTransform"]=B[style]}else{if(style==="opacity"){hui.style.setOpacity(A,B[style])}else{A.style[style]=B[style]}}}},get:function(B,C){B=hui.get(B);var E=hui.string.camelize(C);var D=B.style[E];if(!D){if(document.defaultView&&document.defaultView.getComputedStyle){var A=document.defaultView.getComputedStyle(B,null);D=A?A.getPropertyValue(C):null}else{if(B.currentStyle){D=B.currentStyle[E]}}}if(window.opera&&hui.array.contains(["left","top","right","bottom"],C)){if(hui.style.get(B,"position")=="static"){D="auto"}}return D=="auto"?"":D},setOpacity:function(B,A){if(!hui.browser.opacity){if(A==1){B.style["filter"]=null}else{B.style["filter"]="alpha(opacity="+(A*100)+")"}}else{B.style["opacity"]=A}}};hui.frame={getDocument:function(A){if(A.contentDocument){return A.contentDocument}else{if(A.contentWindow){return A.contentWindow.document}else{if(A.document){return A.document}}}},getWindow:function(A){if(A.defaultView){return A.defaultView}else{if(A.contentWindow){return A.contentWindow}}}};hui.selection={clear:function(){var A;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){A=window.getSelection();if(A&&A.removeAllRanges){A.removeAllRanges()}}}},getText:function(A){A=A||document;if(A.getSelection){return A.getSelection()+""}else{if(A.selection){return A.selection.createRange().text}}return""},getNode:function(B){B=B||document;if(B.getSelection){var A=B.getSelection().getRangeAt(0);return A.commonAncestorContainer()}return null},get:function(A){return{node:hui.selection.getNode(A),text:hui.selection.getText(A)}},enable:function(A){document.onselectstart=A?null:function(){return false};document.body.style.webkitUserSelect=A?null:"none"}};hui.effect={makeFlippable:function(A){if(hui.browser.webkit){hui.cls.add(A.container,"hui_flip_container");hui.cls.add(A.front,"hui_flip_front");hui.cls.add(A.back,"hui_flip_back")}else{hui.cls.add(A.front,"hui_flip_front_legacy");hui.cls.add(A.back,"hui_flip_back_legacy")}},flip:function(B){if(!hui.browser.webkit){hui.cls.toggle(B.element,"hui_flip_flipped_legacy")}else{var C=hui.get(B.element);var E=B.duration||"1s";var D=hui.get.firstByClass(C,"hui_flip_front");var A=hui.get.firstByClass(C,"hui_flip_back");D.style.webkitTransitionDuration=E;A.style.webkitTransitionDuration=E;hui.cls.toggle(B.element,"hui_flip_flipped")}},bounceIn:function(A){var B=A.element;if(hui.browser.msie){hui.style.set(B,{"display":"block",visibility:"visible"})}else{hui.style.set(B,{"display":"block","opacity":0,visibility:"visible"});hui.animate(B,"transform","scale(0.1)",0);window.setTimeout(function(){hui.animate(B,"opacity",1,300);hui.animate(B,"transform","scale(1)",400,{ease:hui.ease.backOut})})}},fadeIn:function(A){var B=A.element;if(hui.style.get(B,"display")=="none"){hui.style.set(B,{opacity:0,display:"inherit"})}hui.animate({node:B,css:{opacity:1},delay:A.delay||null,duration:A.duration||500,onComplete:A.onComplete})},fadeOut:function(A){hui.animate({node:A.element,css:{opacity:0},delay:A.delay||null,duration:A.duration||500,hideOnComplete:true,onComplete:A.onComplete})},wiggle:function(A){var B=hui.ui.getElement(A.element);hui.cls.add(A.element,"hui_effect_wiggle");window.setTimeout(function(){hui.cls.remove(A.element,"hui_effect_wiggle")},A.duration||1000)},shake:function(A){var B=hui.ui.getElement(A.element);hui.cls.add(A.element,"hui_effect_shake");window.setTimeout(function(){hui.cls.remove(A.element,"hui_effect_shake")},A.duration||1000)}};hui.document={getWidth:function(){return Math.max(document.body.clientWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth)},getHeight:function(){if(hui.browser.msie6){var A=Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight);var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(hui.dom.isElement(C[B])){A=Math.max(A,C[B].clientHeight)}}return A}if(window.scrollMaxY&&window.innerHeight){return window.scrollMaxY+window.innerHeight}else{return Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight)}}};hui.drag={register:function(A){hui.listen(A.element,"mousedown",function(B){if(A.$check&&A.$check(B)===false){return }hui.stop(B);hui.drag.start(A)})},start:function(B){var E=hui.browser.msie?document:window;if(B.onStart){B.onStart()}var A,D,C=false;A=function(F){F=hui.event(F);F.stop(F);if(!C&&B.onBeforeMove){B.onBeforeMove(F)}C=true;B.onMove(F)}.bind(this);hui.listen(E,"mousemove",A);D=function(){hui.unListen(E,"mousemove",A);hui.unListen(E,"mouseup",D);if(B.onEnd){B.onEnd()}if(C&&B.onAfterMove){B.onAfterMove()}hui.selection.enable(true)}.bind(this);hui.listen(E,"mouseup",D);hui.selection.enable(false)},_nativeListeners:[],_activeDrop:null,listen:function(A){if(hui.browser.msie){return }hui.drag._nativeListeners.push(A);if(hui.drag._nativeListeners.length>1){return }hui.listen(document.body,"dragenter",function(F){var B=hui.drag._nativeListeners;var E=null;for(var D=0;D<B.length;D++){var C=B[D].element;if(hui.dom.isDescendantOrSelf(F.target,C)){E=B[D];if(hui.drag._activeDrop==null||hui.drag._activeDrop!=E){hui.cls.add(C,E.hoverClass)}break}}if(hui.drag._activeDrop){if(hui.drag._activeDrop!=E){hui.cls.remove(hui.drag._activeDrop.element,hui.drag._activeDrop.hoverClass);if(hui.drag._activeDrop.$leave){hui.drag._activeDrop.$leave(F)}}else{if(hui.drag._activeDrop.$hover){hui.drag._activeDrop.$hover(F)}}}hui.drag._activeDrop=E});hui.listen(document.body,"dragover",function(B){hui.stop(B);if(hui.drag._activeDrop){if(hui.drag._activeDrop.$hover){hui.drag._activeDrop.$hover(B)}}});hui.listen(document.body,"dragend",function(B){hui.log("drag end")});hui.listen(document.body,"dragstart",function(B){hui.log("drag start")});hui.listen(document.body,"drop",function(F){var E=hui.event(F);E.stop();var C=hui.drag._activeDrop;hui.drag._activeDrop=null;if(C){hui.cls.remove(C.element,C.hoverClass);if(C.$drop){C.$drop(F,{event:E})}if(F.dataTransfer){hui.log(F.dataTransfer.types);if(C.$dropFiles&&F.dataTransfer.files&&F.dataTransfer.files.length>0){C.$dropFiles(F.dataTransfer.files,{event:E})}else{if(C.$dropURL&&F.dataTransfer.types!=null&&(hui.array.contains(F.dataTransfer.types,"public.url")||hui.array.contains(F.dataTransfer.types,"text/uri-list"))){var B=F.dataTransfer.getData("public.url");var D=F.dataTransfer.getData("text/uri-list");if(B&&!hui.string.startsWith(B,"data:")){C.$dropURL(B,{event:E})}else{if(D&&!hui.string.startsWith(B,"data:")){C.$dropURL(D,{event:E})}}}else{if(C.$dropText&&F.dataTransfer.types!=null&&hui.array.contains(F.dataTransfer.types,"text/plain")){C.$dropText(F.dataTransfer.getData("text/plain"),{event:E})}}}}}})}};hui.Preloader=function(A){this.options=A||{};this.delegate={};this.images=[];this.loaded=0};hui.Preloader.prototype={addImages:function(A){if(typeof (A)=="object"){for(var B=0;B<A.length;B++){this.images.push(A[B])}}else{this.images.push(A)}},setDelegate:function(A){this.delegate=A},load:function(E){E=E||0;var B=this;this.obs=[];for(var D=E;D<this.images.length+E;D++){var C=D;if(C>=this.images.length){C=C-this.images.length}var A=new Image();A.huiPreloaderIndex=C;A.onload=function(){B._imageChanged(this.huiPreloaderIndex,"imageDidLoad")};A.onerror=function(){B._imageChanged(this.huiPreloaderIndex,"imageDidGiveError")};A.onabort=function(){B._imageChanged(this.huiPreloaderIndex,"imageDidAbort")};A.src=(this.options.context?this.options.context:"")+this.images[C];this.obs.push(A)}},_imageChanged:function(A,B){this.loaded++;if(this.delegate[B]){this.delegate[B](this.loaded,this.images.length,A)}if(this.loaded==this.images.length&&this.delegate.allImagesDidLoad){this.delegate.allImagesDidLoad()}}};hui.cookie={set:function(C,D,E){var A;if(E){var B=new Date();B.setTime(B.getTime()+(E*24*60*60*1000));A="; expires="+B.toGMTString()}else{A=""}document.cookie=C+"="+D+A+"; path=/"},get:function(B){var D=B+"=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)==0){return E.substring(D.length,E.length)}}return null},clear:function(A){this.set(A,"",-1)}};hui.location={getParameter:function(A){var C=hui.location.getParameters();for(var B=0;B<C.length;B++){if(C[B].name==A){return C[B].value}}return null},setParameter:function(A,E){var C=hui.location.getParameters();var D=false;for(var B=0;B<C.length;B++){if(C[B].name==A){C[B].value=E;D=true;break}}if(!D){C.push({name:A,value:E})}hui.location.setParameters(C)},hasHash:function(A){var B=document.location.hash;if(B!==""){return B=="#"+A}return false},getHashParameter:function(A){var D=document.location.hash;if(D!==""){var B=D.indexOf(A+"=");if(B!==-1){var C=D.substring(B+A.length+1);if(C.indexOf("&")!==-1){return C.substring(0,C.indexOf("&"))}return C}}return null},clearHash:function(){document.location.hash="#"},setParameters:function(B){var C="";for(var A=0;A<B.length;A++){C+=A==0?"?":"&";C+=B[A].name+"="+B[A].value}document.location.search=C},getBoolean:function(A){var B=hui.location.getParameter(A);return(B=="true"||B=="1")},getInt:function(A){var B=parseInt(hui.location.getParameter(A));if(B!==NaN){return B}return null},getParameters:function(){var B=document.location.search.substring(1).split("&");var A=[];for(var D=0;D<B.length;D++){var E=B[D].split("=");var C=unescape(E[0]).replace(/^\s*|\s*$/g,"");var F=unescape(E[1]).replace(/^\s*|\s*$/g,"");if(C){A.push({name:C,value:F})}}return A}};hui.xml={transform:function(B,C){if(window.ActiveXObject){return B.transformNode(C)}else{if(document.implementation&&document.implementation.createDocument){try{var E=new XSLTProcessor();E.importStylesheet(C);var A=document;return E.transformToFragment(B,A)}catch(D){hui.log(D);throw D}}else{hui.log("No XSLT!")}}},parse:function(A){var B;if(window.DOMParser){var D=new DOMParser();B=D.parseFromString(A,"text/xml");var C=B.getElementsByTagName("parsererror");if(C.length>0&&C[0].textContent){hui.log(C[0].textContent);return null}}else{B=new ActiveXObject("Microsoft.XMLDOM");B.async=false;B.loadXML(A)}return B},serialize:function(A){try{return(new XMLSerializer()).serializeToString(A)}catch(B){try{return A.xml}catch(B){}}return null}};if(!Function.prototype.bind){Function.prototype.bind=function(){if(arguments.length<2&&arguments[0]===undefined){return this}var C=this,A=Array.prototype.slice.call(arguments),B=A.shift();return function(){return C.apply(B,A.concat(Array.prototype.slice.call(arguments)))}};Function.bind=function(){var A=Array.prototype.slice.call(arguments);return Function.prototype.bind.apply(A.shift(),A)}}if(!Function.prototype.argumentNames){Function.prototype.argumentNames=function(){var A=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return A.length==1&&!A[0]?[]:A}}hui.animate=function(A,E,D,F,B){if(typeof (A)=="string"||hui.dom.isElement(A)){hui.animation.get(A).animate(null,D,E,F,B)}else{var C=hui.animation.get(A.node);if(!A.css){C.animate(null,"","",A.duration,A)}else{for(prop in A.css){C.animate(null,A.css[prop],prop,A.duration,A)}}}};hui.animation={objects:{},running:false,latestId:0,get:function(A){A=hui.get(A);if(!A.huiAnimationId){A.huiAnimationId=this.latestId++}if(!this.objects[A.huiAnimationId]){this.objects[A.huiAnimationId]=new hui.animation.Item(A)}return this.objects[A.huiAnimationId]},start:function(){if(!this.running){hui.animation._render()}}};hui.animation._lengthUpater=function(C,B,A){C.style[A.property]=(A.from+(A.to-A.from)*B)+(A.unit!=null?A.unit:"")};hui.animation._transformUpater=function(D,B,A){var C=A.transform;var E="";if(C.rotate){E+=" rotate("+(C.rotate.from+(C.rotate.to-C.rotate.from)*B)+C.rotate.unit+")"}if(C.scale){E+=" scale("+(C.scale.from+(C.scale.to-C.scale.from)*B)+")"}D.style[hui.animation.TRANSFORM]=E};hui.animation._colorUpater=function(D,C,B){var F=Math.round(B.from.red+(B.to.red-B.from.red)*C);var E=Math.round(B.from.green+(B.to.green-B.from.green)*C);var A=Math.round(B.from.blue+(B.to.blue-B.from.blue)*C);value="rgb("+F+","+E+","+A+")";D.style[B.property]=value};hui.animation._propertyUpater=function(C,B,A){C[A.property]=Math.round(A.from+(A.to-A.from)*B)};hui.animation._ieOpacityUpdater=function(D,B,A){var C=(A.from+(A.to-A.from)*B);if(C==1){D.style.removeAttribute("filter")}else{D.style["filter"]="alpha(opacity="+(C*100)+")"}};hui.animation._render=function(){hui.animation.running=true;var G=false,A=new Date().getTime();for(var B in hui.animation.objects){var D=hui.animation.objects[B];if(D.work){var E=D.element;for(var F=0;F<D.work.length;F++){var H=D.work[F];if(H.finished){continue}var C=(A-H.start)/(H.end-H.start);if(C<0){G=true;continue}else{if(isNaN(C)||C>1){C=1}else{if(C<1){G=true}}}var J=C,I=null;if(H.delegate&&H.delegate.ease){J=H.delegate.ease(J)}if(H.delegate&&H.delegate.callback){H.delegate.callback(E,J)}else{if(H.updater){H.updater(E,J,H)}}if(C==1){H.finished=true;if(H.delegate&&H.delegate.onComplete){window.setTimeout(H.delegate.onComplete)}else{if(H.delegate&&H.delegate.hideOnComplete){E.style.display="none"}}}}}}if(G){window.setTimeout(hui.animation._render,0)}else{hui.animation.running=false}};hui.animation._parseStyle=function(D){var B={type:null,value:null,unit:null};var C;if(!hui.isDefined(D)){return B}else{if(!isNaN(D)){B.value=parseFloat(D)}else{if(C=D.match(/([\-]?[0-9\.]+)(px|pt|%)/)){B.type="length";B.value=parseFloat(C[1]);B.unit=C[2]}else{if(C=D.match(/rgb\(([0-9]+),[ ]?([0-9]+),[ ]?([0-9]+)\)/)){B.type="color";B.value={red:parseInt(C[1]),green:parseInt(C[2]),blue:parseInt(C[3])}}else{var A=new hui.Color(D);if(A.ok){B.value={red:A.r,green:A.g,blue:A.b}}}}}}return B};hui.animation.Item=function(A){this.element=A;this.work=[]};hui.animation.Item.prototype.animate=function(H,I,J,B,F){var G=this.getWork(hui.string.camelize(J));G.delegate=F;G.finished=false;var D=!(J=="scrollLeft"||J=="scrollTop");if(H!==null){G.from=H}else{if(J=="transform"){G.transform=hui.animation.Item.parseTransform(I,this.element)}else{if(!hui.browser.opacity&&J=="opacity"){G.from=this._getIEOpacity(this.element)}else{if(D){var A=hui.style.get(this.element,J);var C=hui.animation._parseStyle(A);G.from=C.value}else{G.from=this.element[J]}}}}if(D){var E=hui.animation._parseStyle(I);G.to=E.value;G.unit=E.unit;if(!hui.browser.opacity&&J=="opacity"){G.updater=hui.animation._ieOpacityUpdater}else{if(J=="transform"){G.updater=hui.browser.msie?function(){}:hui.animation._transformUpater}else{if(E.value.red===undefined){G.updater=hui.animation._lengthUpater}else{G.updater=hui.animation._colorUpater}}}}else{G.to=I;G.unit=null;G.updater=hui.animation._propertyUpater}G.start=new Date().getTime();if(F&&F.delay){G.start+=F.delay}G.end=G.start+B;hui.animation.start()};hui.animation.TRANSFORM=hui.browser.gecko?"MozTransform":"WebkitTransform";hui.animation.Item.parseTransform=function(G,D){var I={};var F,E;var H=/rotate\(([0-9\.]+)([a-z]+)\)/i;var C=G.match(H);if(C){F=0;if(D.style[hui.animation.TRANSFORM]){E=D.style[hui.animation.TRANSFORM].match(H);if(E){F=parseFloat(E[1])}}I.rotate={from:F,to:parseFloat(C[1]),unit:C[2]}}var A=/scale\(([0-9\.]+)\)/i;var B=G.match(A);if(B){F=1;if(D.style[hui.animation.TRANSFORM]){E=D.style[hui.animation.TRANSFORM].match(A);if(E){F=parseFloat(E[1])}}I.scale={from:F,to:parseFloat(B[1])}}return I};hui.animation.Item.prototype._getIEOpacity=function(B){var C=hui.style.get(B,"filter").toLowerCase();var A;if(A=C.match(/opacity=([0-9]+)/)){return parseFloat(A[1])/100}else{return 1}};hui.animation.Item.prototype.getWork=function(C){for(var B=this.work.length-1;B>=0;B--){if(this.work[B].property===C){return this.work[B]}}var A={property:C};this.work[this.work.length]=A;return A};hui.animation.Loop=function(A){this.recipe=A;this.position=-1;this.running=false};hui.animation.Loop.prototype.next=function(){this.position++;if(this.position>=this.recipe.length){this.position=0}var B=this.recipe[this.position];if(typeof (B)=="function"){B()}else{if(B.element){hui.animate(B.element,B.property,B.value,B.duration,{ease:B.ease})}}var A=this;var C=B.duration||0;if(B.wait!==undefined){C=B.wait}window.setTimeout(function(){A.next()},C)};hui.animation.Loop.prototype.start=function(){this.running=true;this.next()};hui.ease={slowFastSlow:function(C){var B=1.6;var A=1.4;return -1*Math.pow(Math.cos((Math.PI/2)*Math.pow(C,B)),Math.pow(Math.PI,A))+1},fastSlow:function(C){var B=0.5;var A=0.7;return -1*Math.pow(Math.cos((Math.PI/2)*Math.pow(C,B)),Math.pow(Math.PI,A))+1},elastic:function(A){return 1-hui.ease.elastic2(1-A)},elastic2:function(B,A,D){if(B<=0||B>=1){return B}if(!D){D=0.45}var C;if(!A||A<1){A=1;C=D/4}else{C=D/(2*Math.PI)*Math.asin(1/A)}return -(A*Math.pow(2,10*(B-=1))*Math.sin((B-C)*(2*Math.PI)/D))},bounce:function(A){if(A<(1/2.75)){return 7.5625*A*A}else{if(A<(2/2.75)){return(7.5625*(A-=(1.5/2.75))*A+0.75)}else{if(A<(2.5/2.75)){return(7.5625*(A-=(2.25/2.75))*A+0.9375)}else{return(7.5625*(A-=(2.625/2.75))*A+0.984375)}}}},flicker:function(A){if(A==1){return 1}return Math.random()*A},linear:function(A){return A},quadIn:function(A){return Math.pow(A,2)},quadOut:function(A){return A*(A-2)*-1},quadInOut:function(A){A=A*2;if(A<1){return Math.pow(A,2)/2}return -1*((--A)*(A-2)-1)/2},cubicIn:function(A){return Math.pow(A,3)},cubicOut:function(A){return Math.pow(A-1,3)+1},cubicInOut:function(A){A=A*2;if(A<1){return Math.pow(A,3)/2}A-=2;return(Math.pow(A,3)+2)/2},quartIn:function(A){return Math.pow(A,4)},quartOut:function(A){return -1*(Math.pow(A-1,4)-1)},quartInOut:function(A){A=A*2;if(A<1){return Math.pow(A,4)/2}A-=2;return -1/2*(Math.pow(A,4)-2)},quintIn:function(A){return Math.pow(A,5)},quintOut:function(A){return Math.pow(A-1,5)+1},quintInOut:function(A){A=A*2;if(A<1){return Math.pow(A,5)/2}A-=2;return(Math.pow(A,5)+2)/2},sineIn:function(A){return -1*Math.cos(A*(Math.PI/2))+1},sineOut:function(A){return Math.sin(A*(Math.PI/2))},sineInOut:function(A){return -1*(Math.cos(Math.PI*A)-1)/2},expoIn:function(A){return(A==0)?0:Math.pow(2,10*(A-1))},expoOut:function(A){return(A==1)?1:(-1*Math.pow(2,-10*A)+1)},expoInOut:function(A){if(A==0){return 0}if(A==1){return 1}A=A*2;if(A<1){return Math.pow(2,10*(A-1))/2}--A;return(-1*Math.pow(2,-10*A)+2)/2},circIn:function(A){return -1*(Math.sqrt(1-Math.pow(A,2))-1)},circOut:function(A){A=A-1;return Math.sqrt(1-Math.pow(A,2))},circInOut:function(A){A=A*2;if(A<1){return -1/2*(Math.sqrt(1-Math.pow(A,2))-1)}A-=2;return 1/2*(Math.sqrt(1-Math.pow(A,2))+1)},backIn:function(B){var A=1.70158;return Math.pow(B,2)*((A+1)*B-A)},backOut:function(B){B=B-1;var A=1.70158;return Math.pow(B,2)*((A+1)*B+A)+1},backInOut:function(B){var A=1.70158*1.525;B=B*2;if(B<1){return(Math.pow(B,2)*((A+1)*B-A))/2}B-=2;return(Math.pow(B,2)*((A+1)*B+A)+2)/2},elasticIn:function(C){if(C==0){return 0}if(C==1){return 1}var B=0.3;var A=B/4;C=C-1;return -1*Math.pow(2,10*C)*Math.sin((C-A)*(2*Math.PI)/B)},elasticOut:function(C){if(C==0){return 0}if(C==1){return 1}var B=0.3;var A=B/4;return Math.pow(2,-10*C)*Math.sin((C-A)*(2*Math.PI)/B)+1},elasticInOut:function(C){if(C==0){return 0}C=C*2;if(C==2){return 1}var B=0.3*1.5;var A=B/4;if(C<1){C-=1;return -0.5*(Math.pow(2,10*C)*Math.sin((C-A)*(2*Math.PI)/B))}C-=1;return 0.5*(Math.pow(2,-10*C)*Math.sin((C-A)*(2*Math.PI)/B))+1},bounceIn:function(A){return(1-hui.ease.bounceOut(1-A))},bounceOut:function(D){var B=7.5625;var C=2.75;var A;if(D<(1/C)){A=B*Math.pow(D,2)}else{if(D<(2/C)){D-=(1.5/C);A=B*Math.pow(D,2)+0.75}else{if(D<(2.5/C)){D-=(2.25/C);A=B*Math.pow(D,2)+0.9375}else{D-=(2.625/C);A=B*Math.pow(D,2)+0.984375}}}return A},bounceInOut:function(A){if(A<0.5){return hui.ease.bounceIn(A*2)/2}return(hui.ease.bounceOut(A*2-1)/2)+0.5}};hui.Color=function(F){this.ok=false;if(hui.isBlank(F)){return }if(F.charAt(0)=="#"){F=F.substr(1,6)}F=F.replace(/ /g,"");F=F.toLowerCase();for(var B in hui.Color.table){if(F==B){F=hui.Color.table[B]}}var G=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(H){return[parseInt(H[1]),parseInt(H[2]),parseInt(H[3])]}},{re:/^rgb\((\d{1,3})%,\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,process:function(H){return[Math.round(parseInt(H[1])/100*255),Math.round(parseInt(H[2])/100*255),Math.round(parseInt(H[3])/100*255)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(H){return[parseInt(H[1],16),parseInt(H[2],16),parseInt(H[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(H){return[parseInt(H[1]+H[1],16),parseInt(H[2]+H[2],16),parseInt(H[3]+H[3],16)]}}];for(var A=0;A<G.length;A++){var D=G[A].re,C=G[A].process,E=D.exec(F);if(E){channels=C(E);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true;break}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b)};hui.Color.prototype={toRGB:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},isDefined:function(){return !(this.r===undefined||this.g===undefined||this.b===undefined)},toHex:function(){if(!this.isDefined()){return null}var C=this.r.toString(16);var B=this.g.toString(16);var A=this.b.toString(16);if(C.length==1){C="0"+C}if(B.length==1){B="0"+B}if(A.length==1){A="0"+A}return"#"+C+B+A}};hui.Color.table={white:"ffffff",black:"000000",red:"ff0000",green:"00ff00",blue:"0000ff"};hui.Color.hex2rgb=function(D){if(hui.isBlank(D)){return null}if(D[0]=="#"){D=D.substr(1)}if(D.length==3){var A=D;D="";A=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(A).slice(1);for(var C=0;C<3;C++){D+=A[C]+A[C]}}var B=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(D).slice(1);return{r:parseInt(B[0],16),g:parseInt(B[1],16),b:parseInt(B[2],16)}};hui.Color.hsv2rgb=function(F,I,E){var N=F/360,K,P,C;if(I==0){K=E*255;P=E*255;C=E*255}else{var L=N*6,D,M,O;var J=Math.floor(L);var A=E*(1-I);var T=E*(1-I*(L-J));var Q=E*(1-I*(1-(L-J)));if(J==0){D=E;M=Q;O=A}else{if(J==1){D=T;M=E;O=A}else{if(J==2){D=A;M=E;O=Q}else{if(J==3){D=A;M=T;O=E}else{if(J==4){D=Q;M=A;O=E}else{D=E;M=A;O=T}}}}}K=Math.round(D*255);P=Math.round(M*255);C=Math.round(O*255)}return new Array(K,P,C)};hui.Color.rgb2hsv=function(G,F,B){G=(G/255);F=(F/255);B=(B/255);var D=Math.min(Math.min(G,F),B),A=Math.max(Math.max(G,F),B),H=A,E,C;if(A==D){C=0}else{if(A==G){C=(60*((F-B)/(A-D)))%360}else{if(A==F){C=60*((B-G)/(A-D))+120}else{if(A==B){C=60*((G-F)/(A-D))+240}}}}if(C<0){C+=360}if(A==0){E=0}else{E=1-(D/A)}return[Math.round(C),Math.round(E*100),Math.round(H*100)]};hui.Color.rgb2hex=function(B){var D="#";for(var A=0;A<3;A++){var C=parseInt(B[A]).toString(16);if(C.length<2){C="0"+C}D+=C}return D};!function(F,T,J){var G=T.getElementsByTagName("head")[0],R={},P={},S={},D={},M="string",Q=false,H="push",K="DOMContentLoaded",B="readyState",O="addEventListener",N="onreadystatechange",U=function(V,Y){for(var X=0,W=V.length;X<W;++X){if(!Y(V[X])){return Q}}return 1};function E(V,W){U(V,function(X){return !W(X)})}if(!T[B]&&T[O]){T[O](K,function I(){T.removeEventListener(K,I,Q);T[B]="complete"},Q);T[B]="loading"}var C=function(d,Z,X){d=d[H]?d:[d];var W=Z&&Z.call,Y=W?Z:X,V=W?d.join(""):Z,a=d.length;function b(e){return e.call?e():R[e]}function c(){if(!--a){R[V]=1;Y&&Y();for(var e in S){U(e.split("|"),b)&&!E(S[e],b)&&(S[e]=[])}}}J(function(){E(d,function(e){if(D[e]){V&&(P[V]=1);c();return }D[e]=1;V&&(P[V]=1);L(C.path?C.path+e+".js":e,c)})},0);return C};function L(Y,X){var W=T.createElement("script"),V=Q;W.onload=W.onerror=W[N]=function(){if((W[B]&&!(/^c|loade/.test(W[B])))||V){return }W.onload=W[N]=null;V=1;X()};W.async=1;W.src=Y;G.insertBefore(W,G.firstChild)}C.get=L;C.ready=function(Y,W,X){Y=Y[H]?Y:[Y];var V=[];!E(Y,function(Z){R[Z]||V[H](Z)})&&U(Y,function(Z){return R[Z]})?W():!function(Z){S[Z]=S[Z]||[];S[Z][H](W);X&&X(V)}(Y.join("|"));return C};var A=F.$script;C.noConflict=function(){F.$script=A;return this};(typeof module!=="undefined"&&module.exports)?(module.exports=C):(F.hui.require=C)}(this,document,setTimeout);var SWFUpload=function(A){this.initSWFUpload(A)};SWFUpload.prototype.initSWFUpload=function(B){try{this.customSettings={};this.settings=B;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(A){delete SWFUpload.instances[this.movieName];throw A}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 Alpha";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(B,A){this.settings[B]=(this.settings[B]==undefined)?A:this.settings[B]};this.ensureDefault("upload_url","");this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id",null);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",function(A){hui.log(A)});this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+"?swfuploadrnd="+Math.floor(Math.random()*999999999)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){if(this.settings.button_placeholder_id!==""){this.replaceWithFlash()}else{this.appendFlash()}};SWFUpload.prototype.appendFlash=function(){var B,A;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}B=document.getElementsByTagName("body")[0];if(B==undefined){throw"Could not find the 'body' element."}A=document.createElement("div");A.style.width="1px";A.style.height="1px";A.style.overflow="hidden";B.appendChild(A);A.innerHTML=this.getFlashHTML()};SWFUpload.prototype.replaceWithFlash=function(){var A,B;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}A=this.settings.button_placeholder||document.getElementById(this.settings.button_placeholder_id);if(A==undefined){throw"Could not find the placeholder element."}B=document.createElement("div");B.innerHTML=this.getFlashHTML();A.parentNode.replaceChild(B.firstChild,A)};SWFUpload.prototype.getFlashHTML=function(){var A=this.settings.button_image_url===""?true:false;return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',A?"transparent":"window",'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var A=this.buildParamString();return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;params=",encodeURIComponent(A),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var C=this.settings.post_params;var B=[];if(typeof (C)==="object"){for(var A in C){if(C.hasOwnProperty(A)){B.push(encodeURIComponent(A.toString())+"="+encodeURIComponent(C[A].toString()))}}}return B.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.stopUpload();var B=null;try{B=this.getMovieElement()}catch(C){}if(B!=undefined&&B.parentNode!=undefined&&typeof B.parentNode.removeChild==="function"){var A=B.parentNode;if(A!=undefined){A.removeChild(B);if(A.parentNode!=undefined&&typeof A.parentNode.removeChild==="function"){A.parentNode.removeChild(A)}}}SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];delete this.movieElement;delete this.settings;delete this.customSettings;delete this.eventQueue;delete this.movieName;delete window[this.movieName];return true}catch(D){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(B,C,A){if(C==undefined){return(this.settings[B]=A)}else{return(this.settings[B]=C)}};SWFUpload.prototype.getSetting=function(A){if(this.settings[A]!=undefined){return this.settings[A]}return""};SWFUpload.prototype.callFlash=function(C,D){D=D||[];var A=this.getMovieElement();var B;if(typeof A[C]==="function"){if(D.length===0){B=A[C]()}else{if(D.length===1){B=A[C](D[0])}else{if(D.length===2){B=A[C](D[0],D[1])}else{if(D.length===3){B=A[C](D[0],D[1],D[2])}else{throw"Too many arguments"}}}}if(B!=undefined&&typeof B.post==="object"){B=this.unescapeFilePostParams(B)}return B}else{throw"Invalid function name: "+C}};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(A){this.callFlash("StartUpload",[A])};SWFUpload.prototype.cancelUpload=function(A){this.callFlash("CancelUpload",[A])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(A){this.callFlash("SetStats",[A])};SWFUpload.prototype.getFile=function(A){if(typeof (A)==="number"){return this.callFlash("GetFileByIndex",[A])}else{return this.callFlash("GetFile",[A])}};SWFUpload.prototype.addFileParam=function(A,B,C){return this.callFlash("AddFileParam",[A,B,C])};SWFUpload.prototype.removeFileParam=function(A,B){this.callFlash("RemoveFileParam",[A,B])};SWFUpload.prototype.setUploadURL=function(A){this.settings.upload_url=A.toString();this.callFlash("SetUploadURL",[A])};SWFUpload.prototype.setPostParams=function(A){this.settings.post_params=A;this.callFlash("SetPostParams",[A])};SWFUpload.prototype.addPostParam=function(A,B){this.settings.post_params[A]=B;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(A){delete this.settings.post_params[A];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(A,B){this.settings.file_types=A;this.settings.file_types_description=B;this.callFlash("SetFileTypes",[A,B])};SWFUpload.prototype.setFileSizeLimit=function(A){this.settings.file_size_limit=A;this.callFlash("SetFileSizeLimit",[A])};SWFUpload.prototype.setFileUploadLimit=function(A){this.settings.file_upload_limit=A;this.callFlash("SetFileUploadLimit",[A])};SWFUpload.prototype.setFileQueueLimit=function(A){this.settings.file_queue_limit=A;this.callFlash("SetFileQueueLimit",[A])};SWFUpload.prototype.setFilePostName=function(A){this.settings.file_post_name=A;this.callFlash("SetFilePostName",[A])};SWFUpload.prototype.setUseQueryString=function(A){this.settings.use_query_string=A;this.callFlash("SetUseQueryString",[A])};SWFUpload.prototype.setRequeueOnError=function(A){this.settings.requeue_on_error=A;this.callFlash("SetRequeueOnError",[A])};SWFUpload.prototype.setDebugEnabled=function(A){this.settings.debug_enabled=A;this.callFlash("SetDebugEnabled",[A])};SWFUpload.prototype.setButtonImageURL=function(A){if(A==undefined){A=""}this.settings.button_image_url=A;this.callFlash("SetButtonImageURL",[A])};SWFUpload.prototype.setButtonDimensions=function(C,A){this.settings.button_width=C;this.settings.button_height=A;var B=this.getMovieElement();if(B!=undefined){B.style.width=C+"px";B.style.height=A+"px"}this.callFlash("SetButtonDimensions",[C,A])};SWFUpload.prototype.setButtonText=function(A){this.settings.button_text=A;this.callFlash("SetButtonText",[A])};SWFUpload.prototype.setButtonTextPadding=function(B,A){this.settings.button_text_top_padding=A;this.settings.button_text_left_padding=B;this.callFlash("SetButtonTextPadding",[B,A])};SWFUpload.prototype.setButtonTextStyle=function(A){this.settings.button_text_style=A;this.callFlash("SetButtonTextStyle",[A])};SWFUpload.prototype.setButtonDisabled=function(A){this.settings.button_disabled=A;this.callFlash("SetButtonDisabled",[A])};SWFUpload.prototype.setButtonAction=function(A){this.settings.button_action=A;this.callFlash("SetButtonAction",[A])};SWFUpload.prototype.queueEvent=function(B,C){if(C==undefined){C=[]}else{if(!(C instanceof Array)){C=[C]}}var A=this;if(typeof this.settings[B]==="function"){this.eventQueue.push(function(){this.settings[B].apply(this,C)});setTimeout(function(){A.executeNextEvent()},0)}else{if(this.settings[B]!==null){throw"Event handler "+B+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var A=this.eventQueue?this.eventQueue.shift():null;if(typeof (A)==="function"){A.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(C){var E=/[$]([0-9a-f]{4})/i;var F={};var D;if(C!=undefined){for(var A in C.post){if(C.post.hasOwnProperty(A)){D=A;var B;while((B=E.exec(D))!==null){D=D.replace(B[0],String.fromCharCode(parseInt("0x"+B[1],16)))}F[D]=C.post[A]}}C.post=F}return C};SWFUpload.prototype.flashReady=function(){var A=this.getMovieElement();if(typeof A.StartUpload!=="function"){throw"ExternalInterface methods failed to initialize."}if(window[this.movieName]==undefined){window[this.movieName]=A}this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("file_queued_handler",A)};SWFUpload.prototype.fileQueueError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("file_queue_error_handler",[A,C,B])};SWFUpload.prototype.fileDialogComplete=function(A,B){this.queueEvent("file_dialog_complete_handler",[A,B])};SWFUpload.prototype.uploadStart=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("return_upload_start_handler",A)};SWFUpload.prototype.returnUploadStart=function(A){var B;if(typeof this.settings.upload_start_handler==="function"){A=this.unescapeFilePostParams(A);B=this.settings.upload_start_handler.call(this,A)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(B===undefined){B=true}B=!!B;this.callFlash("ReturnUploadStart",[B])};SWFUpload.prototype.uploadProgress=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_progress_handler",[A,C,B])};SWFUpload.prototype.uploadError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_error_handler",[A,C,B])};SWFUpload.prototype.uploadSuccess=function(B,A){B=this.unescapeFilePostParams(B);this.queueEvent("upload_success_handler",[B,A])};SWFUpload.prototype.uploadComplete=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("upload_complete_handler",A)};SWFUpload.prototype.debug=function(A){hui.log(A)};if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}}()}Date.parseFunctions={count:0};Date.parseRegexes=[];Date.formatFunctions={count:0};Date.prototype.dateFormat=function(B){if(Date.formatFunctions[B]==null){Date.createNewFormat(B)}var A=Date.formatFunctions[B];return this[A]()};Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;var code="Date.prototype."+funcName+" = function(){return ";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;code+="'"+Date.escape(ch)+"' + "}else{code+=Date.getFormatCode(ch)}}}eval(code.substring(0,code.length-3)+";}")};Date.getFormatCode=function(A){switch(A){case"d":return"Date.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"Date.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"Date.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"Date.leftPad(this.getHours(), 2, '0') + ";case"i":return"Date.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"Date.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+Date.escape(A)+"' + "}};Date.parseDate=function(A,C){if(Date.parseFunctions[C]==null){Date.createParser(C)}var B=Date.parseFunctions[C];return Date[B](A)};Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++;var regexNum=Date.parseRegexes.length;var currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input){\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {";var regex="";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;regex+=Date.escape(ch)}else{var obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g;regex+=obj.s;if(obj.g&&obj.c){code+=obj.c}}}}code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}";Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$");eval(code)};Date.formatCodeToRegex=function(B,A){switch(B){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+A+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:0,c:null,s:"(?:\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+A+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+A+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+A+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+A+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+A+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+A+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+A+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+A+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+A+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+A+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:Date.escape(B)}}};Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")};Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+Date.leftPad(Math.floor(this.getTimezoneOffset()/60),2,"0")+Date.leftPad(this.getTimezoneOffset()%60,2,"0")};Date.prototype.getDayOfYear=function(){var A=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var B=0;B<this.getMonth();++B){A+=Date.daysInMonth[B]}return A+this.getDate()-1};Date.prototype.getWeekOfYear=function(){var B=this.getDayOfYear()+(5-this.getDay());var A=new Date(this.getFullYear(),0,1);var C=(5-A.getDay());return parseInt(Date.leftPad(((B-C)/7)+1,2,"0"))};Date.prototype.isLeapYear=function(){var A=this.getFullYear();return((A&3)==0&&(A%100||(A%400==0&&A)))};Date.prototype.getFirstDayOfMonth=function(){var A=(this.getDay()-(this.getDate()-1))%7;return(A<0)?(A+7):A};Date.prototype.getLastDayOfMonth=function(){var A=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return(A<0)?(A+7):A};Date.prototype.getDaysInMonth=function(){Date.daysInMonth[1]=this.isLeapYear()?29:28;return Date.daysInMonth[this.getMonth()]};Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};Date.escape=function(A){return A.replace(/('|\\)/g,"\\$1")};Date.leftPad=function(D,B,C){var A=new String(D);if(C==null){C=" "}while(A.length<B){A=C+A}return A};Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.y2kYear=50;Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"};hui.ui={domReady:false,context:"",language:"en",objects:[],delegates:[],state:"default",latestObjectIndex:0,latestIndex:500,latestPanelIndex:1000,latestAlertIndex:1500,latestTopIndex:2000,toolTips:{},confirmOverlays:{},delayedUntilReady:[],texts:{request_error:{en:"An error occurred on the server",da:"Der skete en fejl på serveren"},"continue":{en:"Continue",da:"Fortsæt"},reload_page:{en:"Reload page",da:"Indæs siden igen"},access_denied:{en:"Access denied, maybe you are nolonger logged in",da:"Adgang nægtet, du er måske ikke længere logget ind"}}};hui.onReady(function(){if(window.dwr&&window.dwr.engine&&window.dwr.engine.setErrorHandler){window.dwr.engine.setErrorHandler(function(C,B){hui.log(C);hui.log(B)})}hui.listen(window,"resize",hui.ui._resize);hui.ui.reLayout();hui.ui.domReady=true;if(window.parent&&window.parent.hui&&window.parent.hui.ui){window.parent.hui.ui._frameLoaded(window)}for(var A=0;A<hui.ui.delayedUntilReady.length;A++){hui.ui.delayedUntilReady[A]()}hui.ui.callSuperDelegates(this,"ready")});hui.ui.get=function(A){if(A){if(A.element){return A}return hui.ui.objects[A]}return null};hui.ui.getText=function(B){var A=this.texts[B];if(!A){return B}if(A[this.language]){return A[this.language]}else{return A["en"]}};hui.ui.onReady=function(A){if(hui.ui.domReady){return A()}if(hui.browser.gecko&&hui.string.endsWith(document.baseURI,"xml")){window.setTimeout(A,1000);return }hui.ui.delayedUntilReady.push(A)};hui.ui._frameLoaded=function(A){hui.ui.callSuperDelegates(this,"frameLoaded",A)};hui.ui._resize=function(){hui.ui.reLayout();window.clearTimeout(this._delayedResize);if(!hui.ui._resizeFirst){this._delayedResize=window.setTimeout(hui.ui._afterResize,1000)}};hui.ui._afterResize=function(){hui.log("afterResize");hui.ui.callSuperDelegates(hui.ui,"$afterResize")};hui.ui.confirmOverlay=function(B){var E=B.element,A;if(!E){E=document.body}if(B.widget){E=B.widget.getElement()}if(hui.ui.confirmOverlays[E]){A=hui.ui.confirmOverlays[E];A.clear()}else{A=hui.ui.Overlay.create({modal:true});hui.ui.confirmOverlays[E]=A}if(B.text){A.addText(hui.ui.getTranslated(B.text))}var C=hui.ui.Button.create({text:hui.ui.getTranslated(B.okText)||"OK",highlighted:"true"});C.click(function(){if(B.onOk){B.onOk()}if(B["$ok"]){B.$ok()}A.hide()});A.add(C);var D=hui.ui.Button.create({text:hui.ui.getTranslated(B.cancelText)||"Cancel"});D.onClick(function(){if(B.onCancel){B.onCancel()}if(B["$cancel"]){B.$cancel()}A.hide()});A.add(D);A.show({element:E})};hui.ui.destroy=function(B){var A=hui.ui.objects;delete (A[B.name])};hui.ui.destroyDescendants=function(B){var E=hui.ui.getDescendants(B);var C=hui.ui.objects;for(var A=0;A<E.length;A++){var D=delete (C[E[A].name]);if(!D){hui.log("not found: "+E[A].name)}}};hui.ui.getAncestors=function(E){var H=[];var F=E.element;if(F){var A=hui.get.ancestors(F);var G=[];for(var D in hui.ui.objects){G.push(hui.ui.objects[D])}for(var C=0;C<A.length;C++){for(var B=0;B<G.length;B++){if(G[B].element==A[C]){H.push(G[B])}}}}return H};hui.ui.getDescendants=function(H){var G=[],D=H.getElement?H.getElement():H;if(D){var F=D.getElementsByTagName("*");var E=[];for(var C in hui.ui.objects){E.push(hui.ui.objects[C])}for(var B=0;B<F.length;B++){for(var A=0;A<E.length;A++){if(F[B]==E[A].element){G.push(E[A])}}}}return G};hui.ui.getAncestor=function(D,B){var A=hui.ui.getAncestors(D);for(var C=0;C<A.length;C++){if(hui.cls.has(A[C].getElement(),B)){return A[C]}}return null};hui.ui.changeState=function(C){if(hui.ui.state===C){return }var B=hui.ui.objects,A,D;for(A in B){D=B[A];if(D.options&&D.options.state){if(D.options.state==C){D.show()}else{D.hide()}}}hui.ui.state=C;this.reLayout()};hui.ui.reLayout=function(){var C=hui.ui.getDescendants(document.body);for(var A=0;A<C.length;A++){var D=C[A];if(D["$$layout"]){D["$$layout"]()}}return ;var B=hui.ui.objects,D;for(key in B){D=B[key];if(D["$$layout"]){D["$$layout"]()}}};hui.ui.Widget=function(){};hui.ui.Widget.prototype={_init:function(A){this.options=A;this.name=A.name;this.element=hui.get(A.element)},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""}};hui.ui.nextIndex=function(){hui.ui.latestIndex++;return hui.ui.latestIndex};hui.ui.nextPanelIndex=function(){hui.ui.latestPanelIndex++;return hui.ui.latestPanelIndex};hui.ui.nextAlertIndex=function(){hui.ui.latestAlertIndex++;return hui.ui.latestAlertIndex};hui.ui.nextTopIndex=function(){hui.ui.latestTopIndex++;return hui.ui.latestTopIndex};hui.ui.showCurtain=function(D){var E=D.widget;if(!E.curtain){E.curtain=hui.build("div",{"class":"hui_curtain",style:"z-index:none"});var A=hui.get.firstByClass(document.body,"hui_body");if(!A){A=document.body}A.appendChild(E.curtain);hui.listen(E.curtain,"click",function(){if(E["$curtainWasClicked"]){E["$curtainWasClicked"]()}})}var C=E.curtain;if(D.transparent){C.style.background="none"}else{if(D.color){if(D.color=="auto"){var B=hui.style.get(document.body,"background-color");if(B=="transparent"||B=="rgba(0, 0, 0, 0)"){B="#fff"}C.style.backgroundColor=B}else{C.style.backgroundColor=D.color}}}if(hui.browser.msie){C.style.height=hui.document.getHeight()+"px"}else{C.style.position="fixed";C.style.top="0";C.style.left="0";C.style.bottom="0";C.style.right="0"}C.style.zIndex=D.zIndex;if(D.transparent){C.style.display="block"}else{hui.style.setOpacity(C,0);C.style.display="block";hui.animate(C,"opacity",0.7,1000,{ease:hui.ease.slowFastSlow})}};hui.ui.hideCurtain=function(A){if(A.curtain){hui.animate(A.curtain,"opacity",0,200,{hideOnComplete:true})}};hui.ui.confirm=function(A){if(!A.name){A.name="huiConfirm"}var D=hui.ui.get(A.name);var B;if(!D){D=hui.ui.Alert.create(A);var C=hui.ui.Button.create({name:name+"_cancel",text:A.cancel||"Cancel",highlighted:A.highlighted==="cancel"});C.listen({$click:function(){D.hide();if(A.onCancel){A.onCancel()}hui.ui.callDelegates(D,"cancel")}});D.addButton(C);B=hui.ui.Button.create({name:name+"_ok",text:A.ok||"OK",highlighted:A.highlighted==="ok"});D.addButton(B)}else{D.update(A);B=hui.ui.get(name+"_ok");B.setText(A.ok||"OK");B.setHighlighted(A.highlighted=="ok");B.clearListeners();hui.ui.get(name+"_cancel").setText(A.ok||"Cancel");hui.ui.get(name+"_cancel").setHighlighted(A.highlighted=="cancel");if(A.cancel){hui.ui.get(name+"_cancel").setText(A.cancel)}}B.listen({$click:function(){D.hide();if(A.onOK){A.onOK()}hui.ui.callDelegates(D,"ok")}});D.show()};hui.ui.alert=function(A){if(!this.alertBox){this.alertBox=hui.ui.Alert.create(A);this.alertBoxButton=hui.ui.Button.create({name:"huiAlertBoxButton",text:"OK"});this.alertBoxButton.listen({$click$huiAlertBoxButton:function(){hui.ui.alertBox.hide();if(hui.ui.alertBoxCallBack){hui.ui.alertBoxCallBack();hui.ui.alertBoxCallBack=null}}});this.alertBox.addButton(this.alertBoxButton)}else{this.alertBox.update(A)}this.alertBoxCallBack=A.onOK;this.alertBoxButton.setText(A.button?A.button:"OK");this.alertBox.show()};hui.ui.showMessage=function(B){if(typeof (B)=="string"){B={text:B}}if(B.delay){hui.ui.messageDelayTimer=window.setTimeout(function(){B.delay=null;hui.ui.showMessage(B)},B.delay);return }window.clearTimeout(hui.ui.messageDelayTimer);if(!hui.ui.message){hui.ui.message=hui.build("div",{"class":"hui_message",html:"<div><div></div></div>"});if(!hui.browser.msie){hui.style.setOpacity(hui.ui.message,0)}document.body.appendChild(hui.ui.message)}var C=hui.ui.getTranslated(B.text)||"";var A=hui.ui.message.getElementsByTagName("div")[1];if(B.icon){hui.dom.clear(A);A.appendChild(hui.ui.createIcon(B.icon,24));hui.dom.addText(A,C)}else{if(B.busy){A.innerHTML='<span class="hui_message_busy"></span>';hui.dom.addText(A,C)}else{hui.dom.setText(A,C)}}hui.ui.message.style.display="block";hui.ui.message.style.zIndex=hui.ui.nextTopIndex();hui.ui.message.style.marginLeft=(hui.ui.message.clientWidth/-2)+"px";hui.ui.message.style.marginTop=hui.window.getScrollTop()+"px";if(hui.browser.opacity){hui.animate(hui.ui.message,"opacity",1,300)}window.clearTimeout(hui.ui.messageTimer);if(B.duration){hui.ui.messageTimer=window.setTimeout(hui.ui.hideMessage,B.duration)}};hui.ui.getTranslated=function(A){if(!hui.isDefined(A)||hui.isString(A)){return A}if(A[hui.ui.language]){return A[hui.ui.language]}if(A[null]){return A[null]}for(key in A){return A[key]}};hui.ui.hideMessage=function(){window.clearTimeout(hui.ui.messageDelayTimer);if(hui.ui.message){if(hui.browser.opacity){hui.animate(hui.ui.message,"opacity",0,300,{hideOnComplete:true})}else{hui.ui.message.style.display="none"}}};hui.ui.showToolTip=function(A){var C=A.key||"common";var B=hui.ui.toolTips[C];if(!B){B=hui.build("div",{"class":"hui_tooltip",style:"display:none;",html:"<div><div></div></div>",parent:document.body});hui.ui.toolTips[C]=B}B.onclick=function(){hui.ui.hideToolTip(A)};var E=hui.get(A.element);var D=hui.position.get(E);hui.dom.setText(B.getElementsByTagName("div")[1],A.text);if(B.style.display=="none"&&hui.browser.opacity){hui.style.setOpacity(B,0)}hui.style.set(B,{"display":"block",zIndex:hui.ui.nextTopIndex()});hui.style.set(B,{left:(D.left-B.clientWidth+4)+"px",top:(D.top+2-(B.clientHeight/2)+(E.clientHeight/2))+"px"});if(hui.browser.opacity){hui.animate(B,"opacity",1,300)}};hui.ui.hideToolTip=function(A){var C=A?A.key||"common":"common";var B=hui.ui.toolTips[C];if(B){if(!hui.browser.msie){hui.animate(B,"opacity",0,300,{hideOnComplete:true})}else{B.style.display="none"}}};hui.ui.getElement=function(A){if(hui.dom.isElement(A)){return A}else{if(A.getElement){return A.getElement()}}return null};hui.ui.isWithin=function(D,A){D=hui.event(D);var F=hui.position.get(A),E={width:A.offsetWidth,height:A.offsetHeight},C=D.getLeft(),B=D.getTop();return C>F.left&&C<F.left+E.width&&B>F.top&&B<F.top+E.height};hui.ui.getIconUrl=function(B,A){return hui.ui.context+"/hui/icons/"+B+A+".png"};hui.ui.createIcon=function(C,B,A){return hui.build(A||"span",{"class":"hui_icon hui_icon_"+B,style:"background-image: url("+hui.ui.getIconUrl(C,B)+")"})};hui.ui.wrapInField=function(B){var A=hui.build("div",{"class":"hui_field",html:'<span class="hui_field_top"><span><span></span></span></span><span class="hui_field_middle"><span class="hui_field_middle"><span class="hui_field_content"></span></span></span><span class="hui_field_bottom"><span><span></span></span></span>'});hui.get.firstByClass(A,"hui_field_content").appendChild(B);return A};hui.ui.addFocusClass=function(A){var B=A.classElement||A.element,C=A["class"];hui.listen(A.element,"focus",function(){hui.cls.add(B,C);if(A.widget){hui.ui.setKeyboardTarget(A.widget)}});hui.listen(A.element,"blur",function(){hui.cls.remove(B,C);if(A.widget){hui.ui.setKeyboardTarget(null)}})};hui.ui.keyboardTarget=null;hui.ui.setKeyboardTarget=function(A){hui.ui.keyboardTarget=A};hui.ui.stress=function(A){var B=hui.ui.getElement(A);hui.effect.wiggle({element:B,duration:1000})};hui.ui.NumberValidator=function(A){hui.override({allowNull:false,min:0,max:10},A);this.min=A.min;this.max=A.max;this.allowNull=A.allowNull;this.middle=Math.max(Math.min(this.max,0),this.min)};hui.ui.NumberValidator.prototype={validate:function(B){if(hui.isBlank(B)&&this.allowNull){return{valid:true,value:null}}var A=parseFloat(B);if(isNaN(A)){return{valid:false,value:this.middle}}else{if(A<this.min){return{valid:false,value:this.min}}else{if(A>this.max){return{valid:false,value:this.max}}}}return{valid:true,value:A}}};hui.ui.positionAtElement=function(C,G,B){B=B||{};C=hui.get(C);G=hui.get(G);var D=hui.style.get(C,"display");if(D=="none"){hui.style.set(C,{"visibility":"hidden","display":"block"})}var F=hui.position.getLeft(G),E=hui.position.getTop(G);var A=B.vertical||null;if(B.horizontal&&B.horizontal=="right"){F=F+G.clientWidth-C.clientWidth}if(A=="topOutside"){E=E-C.clientHeight}else{if(A=="bottomOutside"){E=E+G.clientHeight}}F+=(B.left||0);E+=(B.top||0);hui.style.set(C,{"left":F+"px","top":E+"px"});if(D=="none"){hui.style.set(C,{"visibility":"visible","display":"none"})}};hui.ui.getTextAreaHeight=function(A){var C=this.textAreaDummy;if(!C){C=this.textAreaDummy=document.createElement("div");C.className="hui_textarea_dummy";document.body.appendChild(C)}var B=A.value;if(B[B.length-1]==="\n"){B+="x"}B=hui.string.escape(B).replace(/\n/g,"<br/>");C.innerHTML=B;C.style.width=(A.clientWidth)+"px";return C.clientHeight};hui.ui.extend=function(B,A){if(!B.name){hui.ui.latestObjectIndex++;B.name="unnamed"+hui.ui.latestObjectIndex}if(A!==undefined){if(B.options){B.options=hui.override(B.options,A)}B.element=hui.get(A.element);B.name=A.name}if(hui.ui.objects[B.name]){hui.log("Widget replaced: "+B.name)}hui.ui.objects[B.name]=B;B.delegates=[];B.listen=function(C){hui.array.add(this.delegates,C);return this};B.unListen=function(C){hui.array.remove(this.delegates,C)};B.clearListeners=function(){this.delegates=[]};B.fire=function(E,D,C){return hui.ui.callDelegates(this,E,D,C)};B.fireValueChange=function(){B.fire("valueChanged",B.value);hui.ui.firePropertyChange(B,"value",B.value);hui.ui.callAncestors(B,"childValueChanged",B.value)};B.fireProperty=function(C,D){hui.ui.firePropertyChange(this,C,D)};B.fireSizeChange=function(){hui.ui.callAncestors(B,"$$childSizeChanged")};if(!B.getElement){B.getElement=function(){return this.element}}if(!B.valueForProperty){B.valueForProperty=function(C){return this[C]}}};hui.ui.callDelegatesDrop=function(A,C){for(var B=0;B<hui.ui.delegates.length;B++){if(hui.ui.delegates[B]["$drop$"+A.kind+"$"+C.kind]){hui.ui.delegates[B]["$drop$"+A.kind+"$"+C.kind](A,C)}}};hui.ui.callAncestors=function(D,F,C,B){if(typeof (C)=="undefined"){C=D}var E=hui.ui.getAncestors(D);for(var A=0;A<E.length;A++){if(E[A][F]){E[A][F](C,B)}}};hui.ui.callDescendants=function(D,F,C,B){if(typeof (C)=="undefined"){C=D}if(!F[0]=="$"){F="$"+F}var E=hui.ui.getDescendants(D);for(var A=0;A<E.length;A++){if(E[A][F]){thisResult=E[A][F](C,B)}}};hui.ui.callVisible=function(A){hui.ui.callDescendants(A,"$visibilityChanged")};hui.ui.listen=function(A){if(hui.ui.domReady&&A.$ready){A.$ready()}hui.ui.delegates.push(A)};hui.ui.callDelegates=function(E,A,I,B){if(typeof (I)=="undefined"){I=E}var J=undefined;if(E.delegates){for(var F=0;F<E.delegates.length;F++){var G=E.delegates[F],C=undefined,H="$"+A+"$"+E.name;if(E.name&&G[H]){C=G[H](I,B)}else{if(G["$"+A]){C=G["$"+A](I,B)}}if(J===undefined&&C!==undefined&&typeof (C)!="undefined"){J=C}}}var D=hui.ui.callSuperDelegates(E,A,I,B);if(J===undefined&&D!==undefined){J=D}return J};hui.ui.tellContainers=function(A,B){if(window.parent!=window){try{window.parent.hui.ui._tellContainers(A,B)}catch(C){}}};hui.ui._tellContainers=function(A,B){hui.ui.callSuperDelegates({},A,B);if(window.parent!=window){try{window.parent.hui.ui._tellContainers(A,B)}catch(C){}}};hui.ui.callSuperDelegates=function(F,H,E,D){if(typeof (E)=="undefined"){E=F}var A=undefined;for(var B=0;B<hui.ui.delegates.length;B++){var C=hui.ui.delegates[B];var G=undefined;if(F.name&&C["$"+H+"$"+F.name]){G=C["$"+H+"$"+F.name](E,D)}else{if(C["$"+H]){G=C["$"+H](E,D)}}if(A===undefined&&G!==undefined&&typeof (G)!="undefined"){A=G}}return A};hui.ui.resolveImageUrl=function(G,B,F,A){for(var D=0;D<G.delegates.length;D++){if(G.delegates[D].$resolveImageUrl){return G.delegates[D].$resolveImageUrl(B,F,A)}}for(var C=0;C<hui.ui.delegates.length;C++){var E=hui.ui.delegates[C];if(E.$resolveImageUrl){return E.$resolveImageUrl(B,F,A)}}return null};hui.ui.firePropertyChange=function(C,A,B){hui.ui.callDelegates(C,"propertyChanged",{property:A,value:B})};hui.ui.bind=function(E,A){if(hui.isString(E)&&E.charAt(0)=="@"){var D=E.substring(1).split(".");var C=hui.ui.get(D[0]);if(!C){hui.log("Unable to bind to "+E);return }var B=D.slice(1).join(".");C.listen({$propertyChanged:function(F){if(F.property==B){A(F.value)}}});return C.valueForProperty(B)}return E};hui.ui.handleRequestError=function(B){hui.log("General request error received");var A=hui.ui.callSuperDelegates(B||this,"requestError");if(!A){hui.ui.confirmOverlay({element:document.body,text:hui.ui.getText("request_error"),okText:hui.ui.getText("reload_page"),cancelText:hui.ui.getText("continue"),onOk:function(){document.location.reload()}})}};hui.ui.handleForbidden=function(B){hui.log("General access denied received");var A=hui.ui.callSuperDelegates(B||this,"accessDenied");if(!A){hui.ui.confirmOverlay({element:document.body,text:hui.ui.getText("access_denied"),okText:hui.ui.getText("reload_page"),cancelText:hui.ui.getText("continue"),onOk:function(){document.location.reload()}})}};hui.ui.request=function(B){B=hui.override({method:"post",parameters:{}},B);if(B.json){for(var C in B.json){B.parameters[C]=hui.string.toJSON(B.json[C])}}var F=B.onSuccess||B.$success,G=B.onJSON||B.$object,E=B.message;B.onSuccess=function(I){if(E){if(E.success){hui.ui.showMessage({text:E.success,icon:"common/success",duration:E.duration||2000})}else{if(E.start){hui.ui.hideMessage()}}}var J,H;if(typeof (F)=="string"){if(!hui.request.isXMLResponse(I)){J=I.responseText.replace(/^\s+|\s+$/g,"");if(J.length>0){H=hui.string.fromJSON(I.responseText)}else{H=""}hui.ui.callDelegates(H,"success$"+F)}else{hui.ui.callDelegates(I,"success$"+F)}}else{if(hui.request.isXMLResponse(I)&&B.onXML){B.onXML(I.responseXML)}else{if(G){J=I.responseText.replace(/^\s+|\s+$/g,"");if(J.length>0){H=hui.string.fromJSON(I.responseText)}else{H=null}G(H)}else{if(typeof (F)=="function"){F(I)}else{if(B.onText){B.onText(I.responseText)}}}}}};var D=B.onFailure||B.$failure;B.onFailure=function(H){if(typeof (D)=="string"){hui.ui.callDelegates(H,"failure$"+D)}else{if(typeof (D)=="function"){D(H)}else{if(B.message&&B.message.start){hui.ui.hideMessage()}hui.ui.handleRequestError()}}};B.onException=B.$exception||function(I,H){hui.log(I);hui.log(H);throw I};var A=B.onForbidden;B.onForbidden=function(H){if(B.message&&B.message.start){hui.ui.hideMessage()}if(A){A(H)}else{B.onFailure(H);hui.ui.handleForbidden()}};if(B.message&&B.message.start){hui.ui.showMessage({text:B.message.start,busy:true,delay:B.message.delay})}hui.request(B)};hui.ui.parseItems=function(C){var A=C.documentElement;var B=[];hui.ui.parseSubItems(A,B);return B};hui.ui.parseSubItems=function(D,F){var B=D.childNodes;for(var A=0;A<B.length;A++){var E=B[A];if(E.nodeType==1&&E.nodeName=="title"){F.push({title:E.getAttribute("title"),type:"title"})}else{if(E.nodeType==1&&E.nodeName=="item"){var C=[];hui.ui.parseSubItems(E,C);F.push({text:E.getAttribute("text"),title:E.getAttribute("title"),value:E.getAttribute("value"),icon:E.getAttribute("icon"),kind:E.getAttribute("kind"),badge:E.getAttribute("badge"),children:C})}}}};hui.ui.Bundle=function(A){this.strings=A};hui.ui.Bundle.prototype={get:function(B){var A=this.strings[B];if(A){return A[hui.ui.language]}hui.log(B+" not found for language:"+hui.ui.language);return B}};hui.ui.require=function(C,B){for(var A=C.length-1;A>=0;A--){C[A]=hui.ui.context+"hui/js/"+C[A]+".js"}hui.require(C,B)};hui.ui.Source=function(A){this.options=hui.override({url:null,dwr:null,parameters:[],lazy:false},A);this.name=A.name;this.data=null;this.parameters=this.options.parameters;hui.ui.extend(this);if(A.delegate){this.listen(A.delegate)}this.initial=true;this.busy=false;hui.ui.onReady(this.init.bind(this))};hui.ui.Source.prototype={init:function(){var A=this;hui.each(this.parameters,function(C){var B=hui.ui.bind(C.value,function(D){A.changeParameter(C.key,D)});C.value=A.convertValue(B)});if(!this.options.lazy){this.refresh()}},convertValue:function(A){if(A&&A.getTime){return A.getTime()}return A},refreshFirst:function(){if(this.initial){this.refresh()}},refreshLater:function(){window.clearTimeout(this.paramDelay);this.paramDelay=window.setTimeout(function(){this.refresh()}.bind(this),100)},refresh:function(){if(this.delegates.length==0){return }var shouldRefresh=this.delegates.length==0;for(var i=0;i<this.delegates.length;i++){var d=this.delegates[i];if(d["$sourceShouldRefresh"]){shouldRefresh=shouldRefresh||d["$sourceShouldRefresh"]()}else{shouldRefresh=true}}if(!shouldRefresh){return }if(this.busy){this.pendingRefresh=true;return }this.initial=false;this.pendingRefresh=false;var self=this;if(this.options.url){var prms={};for(var j=0;j<this.parameters.length;j++){var p=this.parameters[j];prms[p.key]=p.value}this.busy=true;hui.ui.callDelegates(this,"sourceIsBusy");this.transport=hui.request({method:"post",url:this.options.url,parameters:prms,onSuccess:this.parse.bind(this),onException:function(e,t){hui.log("Exception while loading source...");hui.log(e);self.end()},onForbidden:function(){hui.ui.handleForbidden(self);hui.ui.callDelegates(self,"sourceFailed");self.end()},onFailure:function(t){hui.log("sourceFailed");hui.ui.callDelegates(self,"sourceFailed");self.end()}})}else{if(this.options.dwr){var pair=this.options.dwr.split(".");var facade=eval(pair[0]);var method=pair[1];var args=facade[method].argumentNames();for(var k=0;k<args.length;k++){if(this.parameters[k]){args[k]=this.parameters[k].value===undefined?null:this.parameters[k].value}}args[args.length-1]=function(r){self.parseDWR(r)};this.busy=true;hui.ui.callDelegates(this,"sourceIsBusy");hui.log(args);facade[method].apply(facade,args)}}},end:function(){this.busy=false;hui.ui.callDelegates(this,"sourceIsNotBusy");if(this.pendingRefresh){this.refresh()}},parse:function(B){if(hui.request.isXMLResponse(B)){this.parseXML(B.responseXML)}else{var C=B.responseText.replace(/^\s+|\s+$/g,""),A=null;if(C.length>0){A=hui.string.fromJSON(B.responseText)}this.fire("objectsLoaded",A)}this.end()},parseXML:function(A){if(A.documentElement.tagName=="items"){this.data=hui.ui.parseItems(A);this.fire("itemsLoaded",this.data)}else{if(A.documentElement.tagName=="list"){this.fire("listLoaded",A)}else{if(A.documentElement.tagName=="articles"){this.fire("articlesLoaded",A)}}}},parseDWR:function(A){this.data=A;this.fire("objectsLoaded",A);this.end()},addParameter:function(B){this.parameters.push(B);var A=hui.ui.bind(B.value,function(C){this.changeParameter(B.key,C)}.bind(this));B.value=this.convertValue(A)},setParameter:function(B,C){C=this.convertValue(C);for(var A=0;A<this.parameters.length;A++){var D=this.parameters[A];if(D.key==B){D.value=C;return }}this.parameters.push({key:B,value:C})},changeParameter:function(B,C){C=this.convertValue(C);for(var A=0;A<this.parameters.length;A++){var D=this.parameters[A];if(D.key==B){D.value=C}}this.refreshLater()}};hui.ui.getDragProxy=function(){if(!hui.ui.dragProxy){hui.ui.dragProxy=hui.build("div",{"class":"hui_dragproxy",style:"display:none"});document.body.appendChild(hui.ui.dragProxy)}return hui.ui.dragProxy};hui.ui.startDrag=function(E,C,A){E=new hui.Event(E);var D=C.dragDropInfo;hui.ui.dropTypes=hui.ui.findDropTypes(D);if(!hui.ui.dropTypes){return }var B=hui.ui.getDragProxy();hui.listen(document.body,"mousemove",hui.ui.dragListener);hui.listen(document.body,"mouseup",hui.ui.dragEndListener);hui.ui.dragInfo=D;if(D.icon){B.style.backgroundImage="url("+hui.ui.getIconUrl(D.icon,16)+")"}hui.ui.startDragPos={top:E.getTop(),left:E.getLeft()};B.innerHTML=D.title?"<span>"+hui.string.escape(D.title)+"</span>":"###";hui.ui.dragging=true;hui.selection.enable(false)};hui.ui.findDropTypes=function(D){var A=hui.ui;var F=null;for(var C=0;C<A.delegates.length;C++){if(A.delegates[C].dragDrop){for(var B=0;B<A.delegates[C].dragDrop.length;B++){var E=A.delegates[C].dragDrop[B];if(E.drag==D.kind){if(F==null){F={}}F[E.drop]={}}}}}return F};hui.ui.dragListener=function(B){B=new hui.Event(B);hui.ui.dragProxy.style.left=(B.getLeft()+10)+"px";hui.ui.dragProxy.style.top=B.getTop()+"px";hui.ui.dragProxy.style.display="block";var A=hui.ui.findDropTarget(B.getElement());if(A&&hui.ui.dropTypes[A.dragDropInfo["kind"]]){if(hui.ui.latestDropTarget){hui.cls.remove(hui.ui.latestDropTarget,"hui_drop")}hui.cls.add(A,"hui_drop");hui.ui.latestDropTarget=A}else{if(hui.ui.latestDropTarget){hui.cls.remove(hui.ui.latestDropTarget,"hui_drop");hui.ui.latestDropTarget=null}}return false};hui.ui.findDropTarget=function(A){while(A){if(A.dragDropInfo){return A}A=A.parentNode}return null};hui.ui.dragEndListener=function(A){hui.unListen(document.body,"mousemove",hui.ui.dragListener);hui.unListen(document.body,"mouseup",hui.ui.dragEndListener);hui.ui.dragging=false;if(hui.ui.latestDropTarget){hui.cls.remove(hui.ui.latestDropTarget,"hui_drop");hui.ui.callDelegatesDrop(hui.ui.dragInfo,hui.ui.latestDropTarget.dragDropInfo);hui.ui.dragProxy.style.display="none"}else{hui.animate(hui.ui.dragProxy,"left",(hui.ui.startDragPos.left+10)+"px",200,{ease:hui.ease.fastSlow});hui.animate(hui.ui.dragProxy,"top",(hui.ui.startDragPos.top-5)+"px",200,{ease:hui.ease.fastSlow,hideOnComplete:true})}hui.ui.latestDropTarget=null;hui.selection.enable(false)};hui.ui.dropOverListener=function(A){if(hui.ui.dragging){}};hui.ui.dropOutListener=function(A){if(hui.ui.dragging){}};hui.ui.Window=function(A){this.element=hui.get(A.element);this.name=A.name;this.close=hui.get.firstByClass(this.element,"hui_window_close");this.titlebar=hui.get.firstByClass(this.element,"hui_window_titlebar");this.title=hui.get.firstByClass(this.titlebar,"hui_window_title");this.content=hui.get.firstByClass(this.element,"hui_window_body");this.front=hui.get.firstByClass(this.element,"hui_window_front");this.back=hui.get.firstByClass(this.element,"hui_window_back");if(this.back){hui.effect.makeFlippable({container:this.element,front:this.front,back:this.back})}this.visible=false;hui.ui.extend(this);this._addBehavior()};hui.ui.Window.create=function(B){B=hui.override({title:"Window",close:true},B);var C='<div class="hui_window_front">'+(B.close?'<div class="hui_window_close"></div>':"")+'<div class="hui_window_titlebar"><div><div>';if(B.icon){C+='<span class="hui_window_icon" style="background-image: url('+hui.ui.getIconUrl(B.icon,16)+')"></span>'}C+='<span class="hui_window_title">'+hui.ui.getTranslated(B.title)+'</span></div></div></div><div class="hui_window_content"><div class="hui_window_content"><div class="hui_window_body" style="'+(B.width?"width:"+B.width+"px;":"")+(B.padding?"padding:"+B.padding+"px;":"")+(B.padding?"padding-bottom:"+Math.max(0,B.padding-2)+"px;":"")+'"></div></div></div><div class="hui_window_bottom"><div class="hui_window_bottom"><div class="hui_window_bottom"></div></div></div></div>';var A="hui_window"+(B.variant?" hui_window_"+B.variant:"");if(B.variant=="dark"){A+=" hui_context_dark"}B.element=hui.build("div",{"class":A,html:C,parent:document.body});if(B.variant=="dark"){hui.cls.add(B.element,"hui_context_dark")}return new hui.ui.Window(B)};hui.ui.Window.prototype={_addBehavior:function(){var A=this;if(this.close){hui.listen(this.close,"click",function(B){this.hide();this.fire("userClosedWindow")}.bind(this));hui.listen(this.close,"mousedown",function(B){hui.stop(B)})}hui.drag.register({element:this.titlebar,onStart:this._onDragStart.bind(this),onBeforeMove:this._onBeforeMove.bind(this),onMove:this._onMove.bind(this),onAfterMove:this._onAfterMove.bind(this)});hui.listen(this.element,"mousedown",function(){A.element.style.zIndex=hui.ui.nextPanelIndex()})},setTitle:function(A){hui.dom.setText(this.title,A)},_positionInView:function(){var B=hui.window.getScrollTop();var A=hui.position.getTop(this.element);if(A<B||A+this.element.clientHeight>hui.window.getViewHeight()+B){hui.animate({node:this.element,css:{top:(B+40)+"px"},duration:500,ease:hui.ease.slowFastSlow})}},show:function(A){if(this.visible){this._positionInView();this.element.style.zIndex=hui.ui.nextPanelIndex();return }A=A||{};hui.style.set(this.element,{zIndex:hui.ui.nextPanelIndex(),visibility:"hidden",display:"block"});var B=this.element.clientWidth;hui.style.set(this.element,{width:B+"px",visibility:"visible"});if(A.avoid){hui.position.place({insideViewPort:true,target:{element:A.avoid,vertical:0.5,horizontal:1},source:{element:this.element,vertical:0.5,horizontal:0}})}else{if(!this.element.style.top){this.element.style.top=(hui.window.getScrollTop()+40)+"px"}else{this._positionInView()}if(!this.element.style.left){this.element.style.left=Math.round((hui.window.getViewWidth()-B)/2)+"px"}}if(hui.browser.opacity){hui.animate(this.element,"opacity",1,0)}this.visible=true;hui.ui.callVisible(this)},toggle:function(){(this.visible?this.hide():this.show())},hide:function(){if(!this.visible){return }if(hui.browser.opacity){hui.animate(this.element,"opacity",0,200,{onComplete:function(){this.element.style.display="none";hui.ui.callVisible(this)}.bind(this)})}else{this.element.style.display="none";hui.ui.callVisible(this)}this.visible=false},add:function(A){if(A.getElement){this.content.appendChild(A.getElement())}else{this.content.appendChild(A)}},addToBack:function(A){if(!this.back){this.back=hui.build("div",{className:"hui_window_back"});this.element.insertBefore(this.back,this.front);hui.effect.makeFlippable({container:this.element,front:this.front,back:this.back})}this.back.appendChild(hui.ui.getElement(A))},setVariant:function(A){hui.cls.remove(this.element,"hui_window_dark");hui.cls.remove(this.element,"hui_window_light");hui.cls.remove(this.element,"hui_window_news");if(A=="dark"||A=="light"||A=="news"){hui.cls.add(this.element,"hui_window_"+A)}hui.cls.set(this.element,"hui_context_dark",A=="dark")},flip:function(){if(this.back){this.back.style.minHeight=this.element.clientHeight+"px";hui.effect.flip({element:this.element})}},setBusy:function(A){window.clearTimeout(this._busyTimer);if(A===false){if(this._busyCurtain){this._busyCurtain.style.display="none"}return }this._busyTimer=window.setTimeout(function(){var B=this._busyCurtain;if(!B){B=this._busyCurtain=hui.build("div",{"class":"hui_window_busy",parentFirst:hui.get.firstByClass(this.element,"hui_window_content")})}B.innerHTML=hui.isString(A)?"<span>"+A+"</span>":"<span></span>";B.style.display="";B.style.height=this.content.clientHeight+"px";B.style.width=this.content.clientWidth+"px"}.bind(this),300)},move:function(A){hui.style.set(this.element,{top:A.top+"px",left:A.left+"px"})},_onDragStart:function(A){this.element.style.zIndex=hui.ui.nextPanelIndex()},_onBeforeMove:function(A){A=hui.event(A);var B=hui.position.get(this.element);this.dragState={left:A.getLeft()-B.left,top:A.getTop()-B.top};this.element.style.right="auto";hui.cls.add(this.element,"hui_window_dragging")},_onMove:function(C){var B=(C.getTop()-this.dragState.top);var A=(C.getLeft()-this.dragState.left);this.element.style.top=Math.max(B,0)+"px";this.element.style.left=Math.max(A,0)+"px"},_onAfterMove:function(){hui.ui.callDescendants(this,"$$parentMoved");hui.cls.remove(this.element,"hui_window_dragging")}};hui.ui.Formula=function(A){this.options=A;hui.ui.extend(this,A);this.addBehavior()};hui.ui.Formula.create=function(A){A=A||{};var B={"class":"hui_formula hui_formula"};if(A.action){B.action=A.action}if(A.method){B.method=A.method}A.element=hui.build("form",B);return new hui.ui.Formula(A)};hui.ui.Formula.prototype={addBehavior:function(){this.element.onsubmit=function(){return false}},submit:function(){this.fire("submit")},getValues:function(){var C={};var D=hui.ui.getDescendants(this);for(var A=0;A<D.length;A++){var B=D[A];if(B.options&&B.options.key&&B.getValue){C[B.options.key]=B.getValue()}else{if(B.name&&B.getValue){C[B.name]=B.getValue()}}}return C},setValues:function(A){if(!hui.isDefined(A)){return }var D=hui.ui.getDescendants(this);for(var C=0;C<D.length;C++){if(D[C].options&&(D[C].options.key||D[C].options.name)){var B=D[C].options.key||D[C].options.name;if(B&&A[B]!==undefined){D[C].setValue(A[B])}}}},focus:function(){var B=hui.ui.getDescendants(this);for(var A=0;A<B.length;A++){if(B[A].focus){B[A].focus();return }}},reset:function(){var B=hui.ui.getDescendants(this);for(var A=0;A<B.length;A++){if(B[A].reset){B[A].reset()}}},add:function(A){this.element.appendChild(A.getElement())},createGroup:function(A){var B=hui.ui.Formula.Group.create(A);this.add(B);return B},buildGroup:function(A,C){var B=this.createGroup(A);hui.each(C,function(E){if(hui.ui.Formula[E.type]){var D=hui.ui.Formula[E.type].create(E.options);B.add(D,E.label)}else{if(hui.ui[E.type]){var D=hui.ui[E.type].create(E.options);B.add(D,E.label)}else{hui.log("buildGroup: Unable to find type: "+E.type)}}});return B},childValueChanged:function(A){this.fire("valuesChanged",this.getValues())},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};hui.ui.Formula.Group=function(A){this.name=A.name;this.element=hui.get(A.element);this.body=hui.get.firstByTag(this.element,"tbody");this.options=hui.override({above:true},A);hui.ui.extend(this)};hui.ui.Formula.Group.create=function(A){A=hui.override({above:true},A);var B=A.element=hui.build("table",{"class":"hui_formula_fields"});if(A.above){hui.cls.add(B,"hui_formula_fields_above")}B.appendChild(hui.build("tbody"));return new hui.ui.Formula.Group(A)};hui.ui.Formula.Group.prototype={add:function(E,A){var D=hui.build("tr");this.body.appendChild(D);var F=hui.build("td",{"class":"hui_formula_field"});if(!A&&E.getLabel){A=E.getLabel()}if(A){A=hui.ui.getTranslated(A);if(this.options.above){hui.build("label",{className:"hui_formula_field",text:A,parent:F})}else{var C=hui.build("th",{parent:D,className:"hui_formula_middle"});hui.build("label",{className:"hui_formula_field",text:A,parent:C})}}var B=hui.build("div",{"class":"hui_formula_field_body"});B.appendChild(E.getElement());F.appendChild(B);D.appendChild(F)},createButtons:function(B){var C=hui.build("tr",{parent:this.body});var D=hui.build("td",{colspan:this.options.above?1:2,parent:C});var A=hui.ui.Buttons.create(B);D.appendChild(A.getElement());return A}};hui.ui.List=function(A){this.options=hui.override({url:null,source:null,selectable:true,indent:null,selectMany:false,rememberSelection:false},A);this.element=hui.get(A.element);this.name=A.name;if(this.options.source){this.options.source.listen(this)}this.url=A.url;this.table=hui.get.firstByTag(this.element,"table");this.head=hui.get.firstByTag(this.element,"thead");this.body=hui.get.firstByTag(this.element,"tbody");this.columns=[];this.rows=[];this.selected=[];this.checked=[];this.navigation=hui.get.firstByClass(this.element,"hui_list_navigation");this.count=hui.get.firstByClass(this.navigation,"hui_list_count");this.windowPage=hui.get.firstByClass(this.navigation,"window_page");this.windowPageBody=hui.get.firstByClass(this.navigation,"window_page_body");this.parameters={};this.sortKey=null;this.sortDirection=null;this.window={size:null,page:0,total:0};if(A.windowSize!=""){this.window.size=parseInt(A.windowSize)}hui.ui.extend(this);if(A.dropFiles){this._addDrop()}if(this.url){this.refresh()}};hui.ui.List.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_list",html:'<div class="hui_list_progress"></div><div class="hui_list_navigation"><div class="hui_list_selection window_page"><div><div class="window_page_body"></div></div></div><span class="hui_list_count"></span></div><div class="hui_list_body"'+(A.maxHeight>0?' style="max-height: '+A.maxHeight+'px; overflow: auto;"':"")+'><table cellspacing="0" cellpadding="0"><thead><tr></tr></thead><tbody></tbody></table></div>'});return new hui.ui.List(A)};hui.ui.List.prototype={_addDrop:function(){hui.drag.listen({element:this.element,hoverClass:"hui_list_drop",$dropFiles:function(A){this.fire("filesDropped",A)}.bind(this),$dropURL:function(A){this.fire("urlDropped",A)}.bind(this)})},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block";this.refresh()},registerColumn:function(A){this.columns.push(A)},getSelection:function(){if(this.selected.length>0){return this._getRowsByIndexes(this.selected)}return this._getRowsByIndexes(this.checked)},getFirstSelection:function(){var A=this.getSelection();if(A.length>0){return A[0]}return null},getSelectionSize:function(){return this.selected.length+this.checked.length},getSelectionIds:function(){var C=this.getSelection(),B=[];for(var A=0;A<C.length;A++){B.push(C[A].id)}return B},_getRowsByIndexes:function(B){var A=[];for(var C=0;C<B.length;C++){A.push(this.rows[B[C]])}return A},getRows:function(){return this.rows},setParameter:function(A,B){this.parameters[A]=B},loadData:function(A){this.setUrl(A)},setSource:function(A){if(this.options.source!=A){if(this.options.source){this.options.source.unListen(this)}A.listen(this);this.options.source=A;A.refresh()}},setUrl:function(A){if(this.options.source){this.options.source.unListen(this);this.options.source=null}this.url=A;this.selected=[];this.checked=[];this.sortKey=null;this.sortDirection=null;this.resetState();this.refresh()},clear:function(){this._empty();if(this.options.source){this.options.source.unListen(this)}this.options.source=null;this.url=null},clearSelection:function(){this._changeSelection([])},_empty:function(){this.selected=[];this.checked=[];this.columns=[];this.rows=[];this.navigation.style.display="none";hui.dom.clear(this.body);hui.dom.clear(this.head)},resetState:function(){this.window={size:null,page:0,total:0};hui.ui.firePropertyChange(this,"window",this.window);hui.ui.firePropertyChange(this,"window.page",this.window.page)},valueForProperty:function(B){if(B=="window.page"){return this.window.page}else{if(B=="sort.key"){return this.sortKey}else{if(B=="sort.direction"){return(this.sortDirection||"ascending")}else{if(B=="selection.id"){var A=this.getFirstSelection();if(A){return A.id}return null}else{return this[B]}}}}},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){if(this.options.source&&hui.dom.isVisible(this.element)){this.options.source.refreshFirst()}},refresh:function(){if(this.options.source){this.options.source.refreshLater();return }if(!this.url){return }var A=this.url;if(typeof (this.window.page)=="number"){A+=A.indexOf("?")==-1?"?":"&";A+="windowPage="+this.window.page}if(this.window.size){A+=A.indexOf("?")==-1?"?":"&";A+="windowSize="+this.window.size}if(this.sortKey){A+=A.indexOf("?")==-1?"?":"&";A+="sort="+this.sortKey}if(this.sortDirection){A+=A.indexOf("?")==-1?"?":"&";A+="direction="+this.sortDirection}for(var B in this.parameters){A+=A.indexOf("?")==-1?"?":"&";A+=B+"="+this.parameters[B]}this._setBusy(true);hui.ui.request({url:A,onJSON:function(C){this._setBusy(false);this.$objectsLoaded(C)}.bind(this),onXML:function(C){this._setBusy(false);this.$listLoaded(C)}.bind(this)})},sort:function(A){var B=this.columns[A].key;if(B==this.sortKey){this.sortDirection=this.sortDirection=="ascending"?"descending":"ascending";hui.ui.firePropertyChange(this,"sort.direction",this.sortDirection)}else{hui.ui.firePropertyChange(this,"sort.key",B)}this.sortKey=B},_debug:function(A){},$listLoaded:function(Z){this._debug("List loaded");this._setError(false);var N=this.selected.length>0||this.checked.length>0;var J;if(this.options.rememberSelection){J=this.getSelectionIds()}this.selected=[];this.checked=[];this._parseWindow(Z);this._buildNavigation();hui.dom.clear(this.head);hui.dom.clear(this.body);this.rows=[];this.columns=[];this.checkboxMode=Z.documentElement.getAttribute("checkboxes")==="true";var W=document.createElement("tr");var U=Z.getElementsByTagName("sort");this.sortKey=null;this.sortDirection=null;if(U.length>0){this.sortKey=U[0].getAttribute("key");this.sortDirection=U[0].getAttribute("direction")}if(this.checkboxMode){var G=hui.build("th",{className:"list_check",parent:W});var V=hui.build("a",{className:"list_check_all",parent:G});hui.listen(G,"click",this._checkAll.bind(this))}var C=Z.getElementsByTagName("header");var R;for(R=0;R<C.length;R++){var D="";var G=document.createElement("th");var O=C[R].getAttribute("width");var Y=C[R].getAttribute("key");var E=C[R].getAttribute("sortable")=="true";if(O&&O!=""){G.style.width=O+"%"}if(C[R].getAttribute("align")){G.style.textAlign=C[R].getAttribute("align")}if(E){var M=this;G.huiIndex=R;G.onclick=function(){M.sort(this.huiIndex)};D+="sortable"}if(this.sortKey&&Y==this.sortKey){D+=" sort_"+this.sortDirection}G.className=D;var Q=document.createElement("span");G.appendChild(Q);Q.appendChild(document.createTextNode(C[R].getAttribute("title")||""));W.appendChild(G);this.columns.push({"key":Y,"sortable":E,"width":O})}this.head.appendChild(W);var B=document.createDocumentFragment();var K=Z.getElementsByTagName("row");for(R=0;R<K.length;R++){var F=K[R].getElementsByTagName("cell");var H=document.createElement("tr");H.setAttribute("data-index",R);if(this.checkboxMode){var I=hui.build("td",{parent:H,className:"hui_list_checkbox"});hui.build("a",{className:"hui_list_checkbox",parent:I})}var T=K[R].getAttribute("icon");var X=K[R].getAttribute("title");var A=K[R].getAttribute("level");for(var P=0;P<F.length;P++){var I=document.createElement("td");if(F[P].getAttribute("wrap")=="false"){I.style.whiteSpace="nowrap"}if(F[P].getAttribute("vertical-align")){I.style.verticalAlign=F[P].getAttribute("vertical-align")}if(F[P].getAttribute("width")){I.style.width=F[P].getAttribute("width")+"%"}if(F[P].getAttribute("align")){I.style.textAlign=F[P].getAttribute("align")}if(F[P].getAttribute("class")){hui.cls.add(I,F[P].getAttribute("class"))}if(F[P].getAttribute("dimmed")=="true"){I.className="hui_list_dimmed"}if(P==0&&A>1){I.style.paddingLeft=((parseInt(A)-1)*16+5)+"px"}else{if(P==0&&this.options.indent!=null){I.style.paddingLeft=this.options.indent+"px"}}this._parseCell(F[P],I);H.appendChild(I);if(!X){X=hui.dom.getText(F[P])}if(!T){T=F[P].getAttribute("icon")}}var S={id:K[R].getAttribute("id"),kind:K[R].getAttribute("kind"),icon:T,title:X,index:R,data:this._getData(K[R])};H.dragDropInfo=S;this._addRowBehavior(H,R);B.appendChild(H);this.rows.push(S)}this.body.appendChild(B);this._setEmpty(K.length==0);if(this.options.rememberSelection){hui.log("Previous:",J);var L=[];for(var R=0;R<J.length;R++){for(var P=0;P<this.rows.length;P++){if(this.rows[P].id===J[R]){L.push(P)}}}this._changeSelection(L)}else{this.fire("selectionReset");if(N){this.fire("select")}}this.fireSizeChange()},$objectsLoaded:function(B){var A=this.selected.length>0||this.checked.length>0;this._setError(false);if(B==null){}else{if(B.constructor==Array){this.setObjects(B)}else{this.setData(B)}}this.fire("selectionReset");if(A){this.fire("select")}this.fireSizeChange()},$sourceIsBusy:function(){this._debug("$sourceIsBusy");this._setBusy(true)},$sourceIsNotBusy:function(){this._debug("$sourceIsNotBusy");this._setBusy(false)},$sourceFailed:function(){hui.log("The source failed!");this._setError(true)},_setError:function(A){hui.cls.set(this.element,"hui_list_error",A)},_setBusy:function(A){this.busy=A;window.clearTimeout(this.busytimer);if(A){var B=this.element;this.busytimer=window.setTimeout(function(){hui.cls.add(B,"hui_list_busy");if(B.parentNode.className=="hui_overflow"){hui.cls.add(B,"hui_list_busy_large")}},300)}else{hui.cls.remove(this.element,"hui_list_busy");if(this.element.parentNode.className=="hui_overflow"){hui.cls.remove(this.element,"hui_list_busy_large")}}},_setEmpty:function(B){var A=hui.get.firstByClass(this.element,"hui_list_empty");if(A){A.style.display=B?"block":""}},_wrap:function(D){var A="";var C=0;for(var B=0;B<D.length;B++){if(D[B]===" "||D[B]==="-"){C=0}else{C++}A+=D[B];if(C>10){A+="\u200B";C=0}}return A},_parseCell:function(C,K){var D=C.getAttribute("variant");if(D!=null&&D!=""){K=hui.build("div",{parent:K,className:"hui_list_cell_"+D})}var J=C.getAttribute("icon");if(J!=null&&J!=""){K.appendChild(hui.ui.createIcon(J,16));K=hui.build("div",{parent:K,style:"margin-left: 21px; padding-top: 1px;"})}for(var G=0;G<C.childNodes.length;G++){var B=C.childNodes[G];if(hui.dom.isDefinedText(B)){hui.dom.addText(K,B.nodeValue)}else{if(hui.dom.isElement(B,"break")){K.appendChild(document.createElement("br"))}else{if(hui.dom.isElement(B,"icon")){var N=B.getAttribute("size")||16;var J=hui.ui.createIcon(B.getAttribute("icon"),N);if(B.getAttribute("hint")){J.setAttribute("title",B.getAttribute("hint"))}if(B.getAttribute("action")=="true"){hui.cls.add(J,"hui_list_icon_action")}var F=B.getAttribute("data");if(F){J.setAttribute("data",F)}if(B.getAttribute("revealing")==="true"){hui.cls.add(J,"hui_list_revealing")}K.appendChild(J)}else{if(hui.dom.isElement(B,"line")){var M=hui.build("p",{"class":"hui_list_line"});if(B.getAttribute("dimmed")=="true"){hui.cls.add(M,"hui_list_dimmed")}if(B.getAttribute("minor")=="true"){hui.cls.add(M,"hui_list_minor")}if(B.getAttribute("mini")=="true"){hui.cls.add(M,"hui_list_mini")}if(B.getAttribute("class")){hui.cls.add(M,B.getAttribute("class"))}if(B.getAttribute("top")){M.style.paddingTop=B.getAttribute("top")+"px"}K.appendChild(M);this._parseCell(B,M)}else{if(hui.dom.isElement(B,"object")){var E=hui.build("div",{"class":"hui_list_object"});if(B.getAttribute("icon")){E.appendChild(hui.ui.createIcon(B.getAttribute("icon"),16))}if(B.firstChild&&B.firstChild.nodeType==hui.TEXT_NODE&&B.firstChild.nodeValue.length>0){hui.dom.addText(E,B.firstChild.nodeValue)}K.appendChild(E)}else{if(hui.dom.isElement(B,"icons")){var L=hui.build("span",{"class":"hui_list_icons"});if(B.getAttribute("left")){L.style.marginLeft=B.getAttribute("left")+"px"}this._parseCell(B,L);K.appendChild(L)}else{if(hui.dom.isElement(B,"button")){var H=hui.ui.Button.create({text:B.getAttribute("text"),small:true,rounded:true,data:this._getData(B)});H.click(this._buttonClick.bind(this));K.appendChild(H.getElement())}else{if(hui.dom.isElement(B,"wrap")){hui.dom.addText(K,this._wrap(hui.dom.getText(B)))}else{if(hui.dom.isElement(B,"delete")){this._parseCell(B,hui.build("del",{parent:K}))}else{if(hui.dom.isElement(B,"strong")){this._parseCell(B,hui.build("strong",{parent:K}))}else{if(hui.dom.isElement(B,"badge")){this._parseCell(B,hui.build("span",{className:"hui_list_badge",parent:K}))}else{if(hui.dom.isElement(B,"progress")){var A=hui.build("span",{className:"hui_list_progress",parent:K});var I=Math.round(parseFloat(B.getAttribute("value"))*100);hui.build("span",{style:{width:I+"%"},parent:A});this._parseCell(B,A)}}}}}}}}}}}}}},_getData:function(A){var B=A.getAttribute("data");if(B){return hui.string.fromJSON(B)}return null},_buttonClick:function(A){var C=hui.get.firstParentByTag(A.getElement(),"tr");var B=this.rows[parseInt(C.getAttribute("data-index"),10)];this.fire("clickButton",{row:B,button:A})},_parseWindow:function(B){var C=B.getElementsByTagName("window");if(C.length>0){var A=C[0];this.window.total=parseInt(A.getAttribute("total"));this.window.size=parseInt(A.getAttribute("size"));this.window.page=parseInt(A.getAttribute("page"))}else{this.window.total=0;this.window.size=0;this.window.page=0}},_buildNavigation:function(){var C=this;var A=this.window.size>0?Math.ceil(this.window.total/this.window.size):0;if(A<2){this.navigation.style.display="none";return }this.navigation.style.display="block";var H=((this.window.page)*this.window.size+1);hui.dom.setText(this.count,(H+"-"+Math.min((this.window.page+1)*this.window.size,this.window.total)+" / "+this.window.total));var F=this.windowPageBody;F.innerHTML="";if(A<2){this.windowPage.style.display="none"}else{var G=this._buildPages(A,this.window.page);for(var E=0;E<G.length;E++){var D=G[E];if(D===""){F.appendChild(hui.build("span",{text:"·"}))}else{var B=document.createElement("a");B.appendChild(document.createTextNode(D+1));B.setAttribute("data-index",D);B.onmousedown=function(){C._onPageClick(this);return false};if(D==C.window.page){B.className="hui_list_selected"}F.appendChild(B)}}this.windowPage.style.display="block"}},_buildPages:function(E,D){var B=[];var A=false;for(var C=0;C<E;C++){if(C<1||C>E-2||Math.abs(D-C)<5){B.push(C);A=false}else{if(!A){B.push("")}A=true}}return B},setData:function(A){this.selected=[];this.checked=[];var B=A.window||{};this.window.total=B.total||0;this.window.size=B.size||0;this.window.page=B.page||0;this._buildNavigation();this._buildHeaders(A.headers);this._buildRows(A.rows);this._setEmpty(!A.rows||A.rows.length==0)},_buildHeaders:function(B){hui.dom.clear(this.head);this.columns=[];var A=hui.build("tr",{parent:this.head});hui.each(B,function(D,C){var E=hui.build("th");if(D.width){E.style.width=D.width+"%"}if(D.sortable){hui.listen(E,"click",function(){this.sort(C)}.bind(this));hui.cls.add(E,"sortable")}E.appendChild(hui.build("span",{text:D.title}));A.appendChild(E);this.columns.push(D)}.bind(this))},_buildRows:function(B){var A=this;hui.dom.clear(this.body);this.rows=[];if(!B){return }hui.each(B,function(E,C){var F=hui.build("tr");var D=E.icon;var H=E.title;hui.each(E.cells,function(J){var I=hui.build("td");if(J.icon){I.appendChild(hui.ui.createIcon(J.icon,16));D=D||J.icon}if(J.text){I.appendChild(document.createTextNode(J.text));H=H||J.text}F.appendChild(I)});A.body.appendChild(F);var G={id:E.id,kind:E.kind,icon:D,title:H,index:C};F.dragDropInfo=G;hui.log(this._getData(F));A.rows.push({id:E.id,kind:E.kind,icon:D,title:H,index:C,data:E.data});this._addRowBehavior(F,C)}.bind(this))},setObjects:function(I){I=I||[];this.selected=[];this.checked=[];hui.dom.clear(this.body);this.rows=[];for(var E=0;E<I.length;E++){var J=hui.build("tr");var D=I[E];var F=null;for(var C=0;C<this.columns.length;C++){var H=hui.build("td");if(this.builder){H.appendChild(this.builder.buildColumn(this.columns[C],D))}else{var G=D[this.columns[C].key]||"";if(hui.isArray(G)){for(var B=0;B<G.length;B++){if(G[B].constructor==Object){H.appendChild(this._createObject(G[B]))}else{H.appendChild(hui.build("div",{text:G}))}}}else{if(G.constructor==Object){H.appendChild(this._createObject(G[C]))}else{hui.dom.addText(H,G);F=F==null?G:F}}}J.appendChild(H)}var A={id:D.id,kind:D.kind,title:F};J.dragDropInfo=A;this.body.appendChild(J);this._addRowBehavior(J,E);this.rows.push(D)}},_createObject:function(A){var B=hui.build("div",{"class":"hui_list_object"});if(A.icon){B.appendChild(hui.ui.createIcon(A.icon,16))}hui.dom.addText(B,A.text||A.name||"");return B},_addRowBehavior:function(C,B){var A=this;C.onmousedown=function(G){if(A.busy){return }var E=hui.event(G);var F=E.findByClass("hui_list_icon_action");if(!F){var D=E.findByClass("hui_list_checkbox");if(D){A._toggleChecked(B)}else{A._onRowDown(B,E);hui.ui.startDrag(G,C);return false}}};C.ondblclick=function(D){if(A.busy){return }A._onRowDoubleClick(B,D);hui.selection.clear();return false};C.onclick=function(D){if(A.busy){return }A._onRowClick(B,D);return false}},_checkAll:function(){for(var A=0;A<this.rows.length;A++){hui.array.flip(this.checked,A)}this._drawChecks();this._changeSelection([])},_toggleChecked:function(A){hui.array.flip(this.checked,A);this._drawChecks();this._changeSelection([])},_drawChecks:function(){var B=this.body.getElementsByTagName("tr");for(var A=0;A<B.length;A++){hui.cls.set(B[A],"hui_list_checked",hui.array.contains(this.checked,A))}},_clearChecked:function(){this.checked=[];this._drawChecks();this.fire("checkedReset")},_changeSelection:function(A){var C=this.body.getElementsByTagName("tr"),B;for(B=0;B<this.selected.length;B++){hui.cls.remove(C[this.selected[B]],"hui_list_selected")}for(B=0;B<A.length;B++){hui.cls.add(C[A[B]],"hui_list_selected")}this.selected=A;if(A.length>0){this.fire("select",this.rows[A[0]]);hui.ui.firePropertyChange(this,"selection.id",this.rows[A[0]].id);this._clearChecked()}},_onRowClick:function(B,D){D=hui.event(D);var A=D.findByClass("hui_list_icon_action");if(A){var C=A.getAttribute("data");if(C){this.fire("clickIcon",{row:this.rows[B],data:hui.string.fromJSON(C),node:A})}}},_onRowDown:function(B,C){if(!this.options.selectable){return }this.checked=[];if(C.metaKey&&this.options.selectMany){var A=this.selected.slice(0);hui.array.flip(A,B);this._changeSelection(A)}else{this._changeSelection([B])}},_onRowDoubleClick:function(A,B){B=hui.event(B);if(!B.findByClass("hui_list_icon_action")){var C=this.getFirstSelection();if(C){this.fire("open",C)}}},_onPageClick:function(A){var C=parseInt(A.getAttribute("data-index"));this.window.page=C;hui.ui.firePropertyChange(this,"window",this.window);hui.ui.firePropertyChange(this,"window.page",this.window.page);var B=this.windowPageBody.getElementsByTagName("a");for(var D=B.length-1;D>=0;D--){B[D].className=B[D]==A?"hui_list_selected":""}}};hui.ui.Tabs=function(D){D=D||{};this.name=D.name;this.element=hui.get(D.element);this.activeTab=-1;var A=hui.get.firstByClass(this.element,"hui_tabs_bar");this.bar=hui.get.firstByTag(A,"ul");this.tabs=[];var B=this.bar.getElementsByTagName("li");for(var C=0;C<B.length;C++){if(!hui.browser.msie){hui.get.firstByTag(B[C],"a").removeAttribute("href")}this.tabs.push(B[C])}this.contents=hui.get.byClass(this.element,"hui_tabs_tab");this.addBehavior();hui.ui.extend(this)};hui.ui.Tabs.create=function(B){B=B||{};var D=B.element=hui.build("div",{"class":"hui_tabs"});var A="hui_tabs_bar";if(B.small){A+=" hui_tabs_bar_small"}if(B.centered){A+=" hui_tabs_bar_centered"}var C=hui.build("div",{"class":A,parent:D});hui.build("ul",{parent:C});return new hui.ui.Tabs(B)};hui.ui.Tabs.prototype={addBehavior:function(){for(var A=0;A<this.tabs.length;A++){this.addTabBehavior(this.tabs[A],A)}},addTabBehavior:function(B,A){hui.listen(B,"click",function(){this.tabWasClicked(A)}.bind(this))},registerTab:function(A){A.parent=this;this.tabs.push(A)},tabWasClicked:function(A){this.activeTab=A;this.updateGUI();hui.ui.callVisible(this)},updateGUI:function(){for(var A=0;A<this.tabs.length;A++){hui.cls.set(this.tabs[A],"hui_tabs_selected",A==this.activeTab);this.contents[A].style.display=A==this.activeTab?"block":"none"}},createTab:function(A){A=A||{};var B=hui.build("li",{html:"<a><span><span>"+hui.string.escape(A.title)+"</span></span></a>",parent:this.bar});this.addTabBehavior(B,this.tabs.length);this.tabs.push(B);var C=A.element=hui.build("div",{"class":"hui_tabs_tab"});if(A.padding>0){C.style.padding=A.padding+"px"}this.contents.push(C);this.element.appendChild(C);if(this.activeTab==-1){this.activeTab=0;hui.cls.add(B,"hui_tabs_selected")}else{C.style.display="none"}return new hui.ui.Tab(A)}};hui.ui.Tab=function(A){this.name=A.name;this.element=hui.get(A.element)};hui.ui.Tab.prototype={add:function(A){this.element.appendChild(A.element)}};hui.ui.ObjectList=function(A){this.options=hui.override({key:null},A);this.name=A.name;this.element=hui.get(A.element);this.body=hui.get.firstByTag(this.element,"tbody");this.template=[];this.objects=[];hui.ui.extend(this)};hui.ui.ObjectList.create=function(E){E=E||{};var D=E.element=hui.build("table",{"class":"hui_objectlist",cellpadding:"0",cellspacing:"0"});if(E.template){var B="<thead><tr>";for(var A=0;A<E.template.length;A++){B+="<th>"+(E.template[A].label||"")+"</th>"}B+="</tr></thead>";D.innerHTML=B}hui.build("tbody",{parent:D});var C=new hui.ui.ObjectList(E);if(E.template){hui.each(E.template,function(F){C.registerTemplateItem(new hui.ui.ObjectList.Text(F.key))})}return C};hui.ui.ObjectList.prototype={ignite:function(){this.addObject({})},addObject:function(B,D){var C;if(this.objects.length==0||D){C=new hui.ui.ObjectList.Object(this.objects.length,B,this);this.objects.push(C);this.body.appendChild(C.getElement())}else{var A=this.objects[this.objects.length-1];hui.array.remove(this.objects,A);C=new hui.ui.ObjectList.Object(A.index,B,this);A.index++;this.objects.push(C);this.objects.push(A);this.body.insertBefore(C.getElement(),A.getElement())}},reset:function(){for(var B=0;B<this.objects.length;B++){var A=this.objects[B].getElement();if(!A.parentNode){hui.log("no parent for...");hui.log(A)}else{A.parentNode.removeChild(A)}}this.objects=[];this.addObject({})},addObjects:function(B){for(var A=0;A<B.length;A++){this.addObject(B[A])}},setObjects:function(A){this.reset();this.addObjects(A)},getObjects:function(C){var B=[];for(var A=0;A<this.objects.length-1;A++){B.push(this.objects[A].getData())}return B},getValue:function(){return this.getObjects()},setValue:function(A){this.setObjects(A)},registerTemplateItem:function(A){this.template.push(A)},objectDidChange:function(A){if(A.index>=this.objects.length-1){this.addObject({},true)}},getLabel:function(){return this.options.label}};hui.ui.ObjectList.Object=function(A,C,B){this.data=C;this.index=A;this.list=B;this.fields=[]};hui.ui.ObjectList.Object.prototype={getElement:function(){if(!this.element){this.element=document.createElement("tr");for(var B=0;B<this.list.template.length;B++){var C=this.list.template[B];var D=C.clone();D.object=this;this.fields.push(D);var A=document.createElement("td");if(B==0){A.className="first"}A.appendChild(D.getElement());D.setValue(this.data[C.key]);this.element.appendChild(A)}}return this.element},valueDidChange:function(){this.list.objectDidChange(this)},getData:function(){var B=this.data;for(var A=0;A<this.fields.length;A++){B[this.fields[A].key]=this.fields[A].getValue()}return B}};hui.ui.ObjectList.Text=function(A){this.key=A;this.value=null};hui.ui.ObjectList.Text.prototype={clone:function(){return new hui.ui.ObjectList.Text(this.key)},getElement:function(){var A=hui.build("input",{"class":"hui_formula_text"});var B=hui.ui.wrapInField(A);this.wrapper=new hui.ui.Input({element:A});this.wrapper.listen(this);hui.ui.addFocusClass({element:A,classElement:B,"class":"hui_field_focused"});return B},$valueChanged:function(A){this.value=A;this.object.valueDidChange()},getValue:function(){return this.value},setValue:function(A){this.value=A;this.wrapper.setValue(A)}};hui.ui.ObjectList.Select=function(A){this.key=A;this.value=null;this.options=[]};hui.ui.ObjectList.Select.prototype={clone:function(){var A=new hui.ui.ObjectList.Select(this.key);A.options=this.options;return A},getElement:function(){this.select=hui.build("select");for(var B=0;B<this.options.length;B++){this.select.options[this.select.options.length]=new Option(this.options[B].label,this.options[B].value)}var A=this;this.select.onchange=function(){A.object.valueDidChange()};return this.select},getValue:function(){return this.select.value},setValue:function(A){this.select.value=A},addOption:function(B,A){this.options.push({value:B,label:A})}};hui.ui.DropDown=function(A){this.options=hui.override({label:null,placeholder:null,url:null,source:null},A);this.name=A.name;var B=this.element=hui.get(A.element);this.inner=B.getElementsByTagName("strong")[0];this.items=A.items||[];this.index=-1;this.value=this.options.value||null;this.dirty=true;this.busy=false;hui.ui.extend(this);if(A.listener){this.listen(A.listener)}this._addBehavior();this._updateIndex();this._updateUI();if(this.options.url){this.options.source=new hui.ui.Source({url:this.options.url,delegate:this})}else{if(this.options.source){this.options.source.listen(this)}}};hui.ui.DropDown.create=function(A){A=A||{};A.element=hui.build("a",{"class":"hui_dropdown",href:"javascript://",html:"<span><span><strong></strong></span></span>"});return new hui.ui.DropDown(A)};hui.ui.DropDown.prototype={_addBehavior:function(){hui.ui.addFocusClass({element:this.element,"class":"hui_dropdown_focused"});hui.listen(this.element,"click",this._click.bind(this));hui.listen(this.element,"blur",this._hideSelector.bind(this));hui.listen(this.element,"keydown",this._keyDown.bind(this))},_updateIndex:function(){this.index=-1;for(var A=0;A<this.items.length;A++){if(this.items[A].value==this.value){this.index=A}}},_updateUI:function(){var C=this.items[this.index];if(C){var D=C.label||C.title||C.text||"";this.inner.innerHTML="";hui.dom.addText(this.inner,hui.string.wrap(D))}else{if(this.options.placeholder){this.inner.innerHTML="";this.inner.appendChild(hui.build("em",{text:hui.string.escape(this.options.placeholder)}))}else{this.inner.innerHTML=""}}if(!this.selector){return }var A=this.selector.getElementsByTagName("a");for(var B=0;B<A.length;B++){if(this.index==B){hui.cls.add(A[B],"hui_selected")}else{A[B].className=""}}},_click:function(A){if(this.busy){return }hui.stop(A);if(this._selectorVisible){this._hideSelector()}else{this._showSelector()}},_showSelector:function(){this._buildSelector();var D=this.element,I=this.selector;D.focus();if(!this.items){return }var J=hui.document.getHeight();if(J<200){var E=hui.position.getLeft(this.element);hui.style.set(this.selector,{"left":E+"px",top:"5px"})}else{var G=hui.window.getScrollTop();var F=hui.position.getScrollOffset(this.element).top;var C=G-F;hui.position.place({target:{element:this.element,vertical:1,horizontal:0},source:{element:this.selector,vertical:0,horizontal:0},top:C})}hui.style.set(I,{visibility:"hidden",display:"block",width:""});var H=Math.min(J-hui.position.getTop(I)-5,200);var B=Math.max(D.clientWidth-5,100,I.clientWidth+20);var A=hui.window.getViewWidth()-hui.position.getLeft(D)-20;B=Math.min(B,A);hui.style.set(I,{visibility:"visible",width:B+"px",zIndex:hui.ui.nextTopIndex(),maxHeight:H+"px"});this._selectorVisible=true},_hideSelector:function(){if(!this.selector){return }this.selector.style.display="none";this._selectorVisible=false},_keyDown:function(A){if(this.busy){return }if(this.items.length==0){return }if(A.keyCode==40){hui.stop(A);if(this.index>=this.items.length-1){this.value=this.items[0].value}else{this.value=this.items[this.index+1].value}this._updateIndex();this._updateUI();this._fireChange()}else{if(A.keyCode==38){hui.stop(A);if(this.index>0){this.index--}else{this.index=this.items.length-1}this.value=this.items[this.index].value;this._updateUI();this._fireChange()}}},selectFirst:function(){if(this.items.length>0){this.setValue(this.items[0].value)}},getValue:function(){return this.value},setValue:function(A){this.value=A;this._updateIndex();this._updateUI()},reset:function(){this.setValue(null)},getLabel:function(){return this.options.label},refresh:function(){if(this.options.source){this.options.source.refresh()}},stress:function(){hui.ui.stress(this)},focus:function(){try{this.element.focus()}catch(A){}},getItem:function(){if(this.index>=0){return this.items[this.index]}return 0},addItem:function(A){this.items.push(A);this.dirty=true;this._updateIndex();this._updateUI()},setItems:function(A){this.items=A;this.dirty=true;this.index=-1;this._updateIndex();this._updateUI()},$itemsLoaded:function(A){this.setItems(A)},$sourceIsBusy:function(){this.busy=true;hui.style.setOpacity(this.element,0.5)},$sourceIsNotBusy:function(){this.busy=false;hui.style.setOpacity(this.element,1)},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){if(this.options.source){this.options.source.refreshFirst()}}else{this._hideSelector()}},_buildSelector:function(){if(!this.dirty||!this.items){return }if(!this.selector){this.selector=hui.build("div",{"class":"hui_dropdown_selector"});document.body.appendChild(this.selector);hui.listen(this.selector,"mousedown",function(B){hui.stop(B)})}else{this.selector.innerHTML=""}var A=this;hui.each(this.items,function(C,B){var D=hui.build("a",{href:"javascript://",text:C.label||C.title||C.text||""});hui.listen(D,"mousedown",function(E){hui.stop(E);A._itemClicked(C,B)});if(B==A.index){hui.cls.add(D,"hui_selected")}A.selector.appendChild(D)});this.dirty=false},_itemClicked:function(B,A){this.index=A;var C=this.value!=this.items[A].value;this.value=this.items[A].value;this._updateUI();this._hideSelector();if(C){this._fireChange()}},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value);hui.ui.firePropertyChange(this,"value",this.value)}};hui.ui.Alert=function(A){this.options=hui.override({modal:false},A);this.element=hui.get(A.element);this.name=A.name;this.body=hui.get.firstByClass(this.element,"hui_alert_body");this.content=hui.get.firstByClass(this.element,"hui_alert_content");this.emotion=this.options.emotion;this.title=hui.get.firstByTag(this.element,"h1");hui.ui.extend(this)};hui.ui.Alert.create=function(B){B=hui.override({title:"",text:"",emotion:null,title:null},B);var C=B.element=hui.build("div",{"class":"hui_alert"});var A=hui.build("div",{"class":"hui_alert_body",parent:C});hui.build("div",{"class":"hui_alert_content",parent:A});document.body.appendChild(C);var D=new hui.ui.Alert(B);if(B.emotion){D.setEmotion(B.emotion)}if(B.title){D.setTitle(B.title)}if(B.text){D.setText(B.text)}return D};hui.ui.Alert.prototype={show:function(){var A=hui.ui.nextAlertIndex();if(this.options.modal){hui.ui.showCurtain({widget:this,zIndex:A});A++}this.element.style.zIndex=A;this.element.style.display="block";this.element.style.top=(hui.window.getScrollTop()+100)+"px";hui.animate(this.element,"opacity",1,200);hui.animate(this.element,"margin-top","40px",600,{ease:hui.ease.elastic})},hide:function(){hui.animate(this.element,"opacity",0,200,{hideOnComplete:true});hui.animate(this.element,"margin-top","0px",200);hui.ui.hideCurtain(this)},setTitle:function(A){if(!this.title){this.title=hui.build("h1",{parent:this.content})}hui.dom.setText(this.title,hui.ui.getTranslated(A))},setText:function(A){if(!this.text){this.text=hui.build("p",{parent:this.content})}hui.dom.setText(this.text,hui.ui.getTranslated(A))},setEmotion:function(A){if(this.emotion){hui.cls.remove(this.body,this.emotion)}this.emotion=A;hui.cls.add(this.body,A)},update:function(A){A=A||{};this.setTitle(A.title||null);this.setText(A.text||null);this.setEmotion(A.emotion||null)},addButton:function(A){if(!this.buttons){this.buttons=hui.ui.Buttons.create({align:"right"});this.body.appendChild(this.buttons.element)}this.buttons.add(A)}};hui.ui.Button=function(A){this.options=A;this.name=A.name;this.element=hui.get(A.element);this.enabled=!hui.cls.has(this.element,"hui_button_disabled");hui.ui.extend(this);this.addBehavior();if(A.listener){this.listen(A.listener)}};hui.ui.Button.create=function(B){B=hui.override({text:"",highlighted:false,enabled:true},B);var E="hui_button"+(B.highlighted?" hui_button_highlighted":"");if(B.variant){E+=" hui_button_"+B.variant}if(B.small&&B.variant){E+=" hui_button_small_"+B.variant}if(B.small){E+=" hui_button_small"+(B.highlighted?" hui_button_small_highlighted":"")}if(!B.enabled){E+=" hui_button_disabled"}var F=B.text?hui.ui.getTranslated(B.text):null;if(B.title){F=hui.ui.getTranslated(B.title)}var C=B.element=hui.build("a",{"class":E,href:"javascript://"});var A=hui.build("span",{parent:hui.build("span",{parent:C})});if(B.icon){var D=hui.build("em",{parent:A,"class":"hui_button_icon",style:"background-image:url("+hui.ui.getIconUrl(B.icon,16)+")"});if(!F){hui.cls.add(D,"hui_button_icon_notext")}}if(F){hui.dom.addText(A,F)}return new hui.ui.Button(B)};hui.ui.Button.prototype={addBehavior:function(){var A=this;hui.listen(this.element,"mousedown",function(B){hui.stop(B)});hui.listen(this.element,"click",function(B){hui.stop(B);A._onClick()})},_onClick:function(){if(this.enabled){if(this.options.confirm){hui.ui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this._fireClick.bind(this)})}else{this._fireClick()}}else{this.element.blur()}},_fireClick:function(){this.fire("click");if(this.options.submit){var A=hui.ui.getAncestor(this,"hui_formula");if(A){A.submit()}else{hui.log("No form found to submit")}}},click:function(A){if(A){this.listen({$click:A});return this}else{this._onClick()}},focus:function(){this.element.focus()},onClick:function(A){this.listen({$click:A})},setEnabled:function(A){this.enabled=A;this._updateUI()},enable:function(){this.setEnabled(true)},disable:function(){this.setEnabled(false)},setHighlighted:function(A){hui.cls.set(this.element,"hui_button_highlighted",A)},_updateUI:function(){hui.cls.set(this.element,"hui_button_disabled",!this.enabled)},setText:function(A){hui.dom.setText(this.element.getElementsByTagName("span")[1],hui.ui.getTranslated(A))},getData:function(){return this.options.data}};hui.ui.Buttons=function(A){this.name=A.name;this.element=hui.get(A.element);this.body=hui.get.firstByClass(this.element,"hui_buttons_body");hui.ui.extend(this)};hui.ui.Buttons.create=function(A){A=hui.override({top:0},A);var B=A.element=hui.build("div",{"class":"hui_buttons"});if(A.align=="right"){hui.cls.add(B,"hui_buttons_right")}if(A.align=="center"){hui.cls.add(B,"hui_buttons_center")}if(A.top>0){B.style.paddingTop=A.top+"px"}hui.build("div",{"class":"hui_buttons_body",parent:B});return new hui.ui.Buttons(A)};hui.ui.Buttons.prototype={add:function(A){this.body.appendChild(A.element);return this}};hui.ui.Selection=function(A){this.options=hui.override({value:null},A);this.element=hui.get(A.element);this.name=A.name;this.items=[];this.subItems=[];this.busy=0;this.selection=null;if(A.items&&A.items.length>0){for(var C=0;C<A.items.length;C++){var D=A.items[C];this.items.push(D);var B=hui.get(D.id);D.element=B;this.addItemBehavior(B,D)}this.selection=this._getSelectionWithValue(this.options.value);this._updateUI()}else{if(this.options.value!=null){this.selection={value:this.options.value}}}hui.ui.extend(this)};hui.ui.Selection.create=function(A){A=hui.override({width:0},A);var B=A.element=hui.build("div",{"class":"hui_selection"});if(A.width>0){B.style.width=A.width+"px"}return new hui.ui.Selection(A)};hui.ui.Selection.prototype={getValue:function(){return this.selection},valueForProperty:function(A){if(A==="value"){return this.selection?this.selection.value:null}else{if(A==="kind"){return this.selection?this.selection.kind:null}}return undefined},setValue:function(B){var A=this._getSelectionWithValue(B);if(A===null){this.selection=null}else{this.selection=A;this.kind=A.kind}this._updateUI();this.fireChange()},_getSelectionWithValue:function(D){var C;for(C=0;C<this.items.length;C++){if(this.items[C].value==D){return this.items[C]}}for(C=0;C<this.subItems.length;C++){var A=this.subItems[C].items;for(var B=0;B<A.length;B++){if(A[B].value==D){return A[B]}}}return null},selectFirst:function(){var C;for(C=0;C<this.items.length;C++){this.changeSelection(this.items[C]);return }for(C=0;C<this.subItems.length;C++){var A=this.subItems[C].items;for(var B=0;B<A.length;B++){this.changeSelection(A[B]);return }}},reset:function(){this.setValue(null)},addItems:function(B){B.element=hui.build("div",{parent:this.element});var A=new hui.ui.Selection.Items(B);A.parent=this;this.subItems.push(A)},_updateUI:function(){var A;for(A=0;A<this.items.length;A++){hui.cls.set(this.items[A].element,"hui_selected",this.isSelection(this.items[A]))}for(A=0;A<this.subItems.length;A++){this.subItems[A]._updateUI()}},changeSelection:function(B){for(var A=0;A<this.subItems.length;A++){this.subItems[A].selectionChanged(this.selection,B)}this.selection=B;this._updateUI();this.fireChange()},fireChange:function(){this.fire("select",this.selection);this.fireProperty("value",this.selection?this.selection.value:null);this.fireProperty("kind",this.selection?this.selection.kind:null);for(var A=0;A<this.subItems.length;A++){this.subItems[A].parentValueChanged()}},registerItems:function(A){A.parent=this;this.subItems.push(A)},addItemBehavior:function(B,A){hui.listen(B,"click",function(){this.itemWasClicked(A)}.bind(this));hui.listen(B,"dblclick",function(C){hui.stop(C);hui.selection.clear();this._onDoubleClick(A)}.bind(this));B.dragDropInfo=A},setObjects:function(A){this.items=[];hui.each(A,function(D){this.items.push(D);var C=hui.build("div",{"class":"hui_selection_item"});D.element=C;this.element.appendChild(C);var B=hui.build("span",{"class":"hui_selection_label",text:D.title});if(D.icon){C.appendChild(hui.ui.createIcon(D.icon,16))}C.appendChild(B);hui.listen(C,"click",function(){this.itemWasClicked(D)}.bind(this));hui.listen(C,"dblclick",function(E){hui.stop(E);this._onDoubleClick(D)}.bind(this))}.bind(this));this.fireSizeChange()},isSelection:function(B){if(this.selection===null){return false}var A=B.value==this.selection.value;if(this.selection.kind){A=A&&B.kind==this.selection.kind}return A},itemWasClicked:function(A){if(this.busy>0){return }this.changeSelection(A)},_onDoubleClick:function(A){if(this.busy>0){return }this.fire("open",A)},_setBusy:function(A){this.busy+=A?1:-1;window.clearTimeout(this.busytimer);if(this.busy>0){var B=this.element;this.busytimer=window.setTimeout(function(){hui.cls.add(B,"hui_selection_busy")},300)}else{hui.cls.remove(this.element,"hui_selection_busy");this.fire("loaded")}},_checkValue:function(){if(!this.selection){return }var A=this._getSelectionWithValue(this.selection.value);if(!A){hui.log("Value not found: "+this.selection.value);if(!this.busy){this.selectFirst()}else{hui.log("Will not select first since im still busy")}}},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};hui.ui.Selection.Items=function(A){this.options=hui.override({source:null},A);this.element=hui.get(A.element);this.title=hui.get(this.element.id+"_title");this.name=A.name;this.disclosed={};this.parent=null;this.items=[];hui.ui.extend(this);if(this.options.source){this.options.source.listen(this)}};hui.ui.Selection.Items.prototype={refresh:function(){if(this.options.source){this.options.source.refresh()}},$objectsLoaded:function(A){this.$itemsLoaded(A)},$itemsLoaded:function(A){this.items=[];this.element.innerHTML="";this.buildLevel(this.element,A,0,true);if(this.title){this.title.style.display=this.items.length>0?"block":"none"}this.parent._updateUI();this.parent._checkValue();this.fireSizeChange()},$sourceIsBusy:function(){this.parent._setBusy(true)},$sourceIsNotBusy:function(){this.parent._setBusy(false)},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){if(this.options.source){this.options.source.refreshFirst()}}},buildLevel:function(D,B,E,C){if(!B){return }var A=this.isHierarchy(B);var F=hui.build("div",{"class":"hui_selection_level",style:(C?"display:block":"display:none"),parent:D});hui.each(B,function(M){if(M.type=="title"){hui.build("div",{"class":"hui_selection_title",html:"<span>"+M.title+"</span>",parent:F});return }var K=M.children&&M.children.length>0;var H=E*16+6;if(!A&&E>0||A&&!K){H+=13}var I=hui.build("div",{"class":"hui_selection_item"});I.style.paddingLeft=H+"px";if(M.badge){I.appendChild(hui.build("strong",{"class":"hui_selection_badge",text:M.badge}))}var L=false;if(A&&K){var N=this;L=this.disclosed[M.value];var O=this.disclosed[M.value]?"hui_disclosure hui_disclosure_open":"hui_disclosure";var J=hui.build("span",{"class":O,parent:I});hui.listen(J,"click",function(Q){hui.stop(Q);N.toggle(J,M)})}var P=hui.build("span",{"class":"hui_selection_label",text:M.title});if(M.icon){I.appendChild(hui.build("span",{"class":"hui_icon_1",style:"background-image: url("+hui.ui.getIconUrl(M.icon,16)+")"}))}I.appendChild(P);hui.listen(I,"click",function(Q){this.parent.itemWasClicked(M)}.bind(this));hui.listen(I,"dblclick",function(Q){hui.stop(Q);hui.selection.clear();this.parent._onDoubleClick(M)}.bind(this));F.appendChild(I);var G={title:M.title,icon:M.icon,badge:M.badge,kind:M.kind,element:I,value:M.value};I.dragDropInfo=G;this.items.push(G);this.buildLevel(F,M.children,E+1,L)}.bind(this))},toggle:function(B,A){if(hui.cls.has(B,"hui_disclosure_open")){this.disclosed[A.value]=false;hui.get.next(B.parentNode).style.display="none";hui.cls.remove(B,"hui_disclosure_open")}else{this.disclosed[A.value]=true;hui.get.next(B.parentNode).style.display="block";hui.cls.add(B,"hui_disclosure_open")}this.parent.fireSizeChange()},isHierarchy:function(A){if(!A){return false}for(var B=0;B<A.length;B++){if(A[B]!==null&&A[B].children&&A[B].children.length>0){return true}}return false},getValue:function(){if(this.parent.selection==null){return null}for(var A=0;A<this.items.length;A++){if(this.items[A].value==this.parent.selection.value){return this.items[A]}}return null},_updateUI:function(){for(var A=0;A<this.items.length;A++){hui.cls.set(this.items[A].element,"hui_selected",this.parent.isSelection(this.items[A]))}},selectionChanged:function(B,A){for(var C=0;C<this.items.length;C++){var D=this.items[C].value;if(D==A.value){this.fireProperty("value",A.value);return }}this.fireProperty("value",null)},parentValueChanged:function(){for(var A=0;A<this.items.length;A++){if(this.parent.isSelection(this.items[A])){this.fireProperty("value",this.items[A].value);return }}this.fireProperty("value",null)}};hui.ui.Toolbar=function(A){this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Toolbar.create=function(A){A=A||{};A.element=hui.build("div",{"class":A.labels?"hui_toolbar hui_toolbar_nolabels":"hui_toolbar"});return new hui.ui.Toolbar(A)};hui.ui.Toolbar.prototype={add:function(A){this.element.appendChild(A.getElement())},addDivider:function(){this.element.appendChild(hui.build("span",{"class":"hui_divider"}))},setSelection:function(B){var D=hui.ui.getDescendants(this);for(var A=0;A<D.length;A++){var C=D[A];if(C.setSelected){C.setSelected(C.key==B)}}},getByKey:function(B){var D=hui.ui.getDescendants(this);for(var A=0;A<D.length;A++){var C=D[A];if(C.key==B){return C}}}};hui.ui.RevealingToolbar=function(A){this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.RevealingToolbar.create=function(A){A=A||{};A.element=hui.build("div",{className:"hui_revealing_toolbar",style:"display:none",parent:document.body});var B=new hui.ui.RevealingToolbar(A);B.setToolbar(hui.ui.Toolbar.create());return B};hui.ui.RevealingToolbar.prototype={setToolbar:function(A){this.toolbar=A;this.element.appendChild(A.getElement())},getToolbar:function(){return this.toolbar},show:function(A){this.element.style.display="";hui.animate(this.element,"height","58px",A?0:600,{ease:hui.ease.slowFastSlow})},hide:function(){hui.animate(this.element,"height","0px",500,{ease:hui.ease.slowFastSlow,hideOnComplete:true})}};hui.ui.Toolbar.Icon=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.key=A.key;this.enabled=!hui.cls.has(this.element,"hui_toolbar_icon_disabled");this.element.tabIndex=this.enabled?0:-1;this.icon=hui.get.firstByClass(this.element,"hui_icon");hui.ui.extend(this);this.addBehavior()};hui.ui.Toolbar.Icon.create=function(B){var C=B.element=hui.build("a",{"class":"hui_toolbar_icon"});var E=hui.build("span",{"class":"hui_icon",style:"background-image: url("+hui.ui.getIconUrl(B.icon,32)+")"});var A=hui.build("span",{"class":"hui_toolbar_inner_icon",parent:C});var D=hui.build("span",{"class":"hui_toolbar_inner_icon",parent:A});var F=hui.build("strong",{text:B.title});if(B.overlay){hui.build("span",{"class":"hui_icon_overlay",parent:E,style:"background-image: url("+hui.ui.getIconUrl("overlay/"+B.overlay,32)+")"})}D.appendChild(E);D.appendChild(F);return new hui.ui.Toolbar.Icon(B)};hui.ui.Toolbar.Icon.prototype={addBehavior:function(){var A=this;this.element.onclick=function(){A.wasClicked()}},setEnabled:function(A){this.enabled=A;this.element.tabIndex=A?0:-1;hui.cls.set(this.element,"hui_toolbar_icon_disabled",!this.enabled)},disable:function(){this.setEnabled(false)},enable:function(){this.setEnabled(true)},setOverlay:function(A){var C=hui.get.firstByClass(this.element,"hui_icon_overlay");if(C&&!A){C.style.backgroundImage=""}else{if(C&&A){C.style.backgroundImage="url('"+hui.ui.getIconUrl("overlay/"+A,32)+"')"}else{if(A){var B=hui.get.firstByClass(this.element,"hui_icon");hui.build("span",{"class":"hui_icon_overlay",parent:B,style:"background-image: url("+hui.ui.getIconUrl("overlay/"+A,32)+")"})}}}},setBadge:function(B){var A=hui.get.firstByClass(this.element,"hui_icon_badge");if(!A&&!hui.isBlank(B)){A=hui.build("span",{"class":"hui_icon_badge",parent:hui.get.firstByClass(this.element,"hui_icon"),text:B})}else{if(hui.isBlank(B)&&A){hui.dom.remove(A)}else{if(A){hui.dom.setText(A,B)}}}},setLabel:function(A){var B=hui.get.firstByTag(this.element,"strong");hui.dom.setText(B,A)},setIcon:function(A){var B=hui.get.firstByClass(this.element,"hui_icon");B.style.backgroundImage="url("+hui.ui.getIconUrl(A,32)+")"},setSelected:function(A){if(A){this.element.blur()}hui.cls.set(this.element,"hui_toolbar_icon_selected",A)},wasClicked:function(){if(this.enabled){if(this.options.confirm){hui.ui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this.fireClick.bind(this)})}else{this.fireClick()}}},fireClick:function(){hui.ui.callDelegates(this,"toolbarIconWasClicked");hui.ui.callDelegates(this,"click")}};hui.ui.Toolbar.Badge=function(A){this.element=hui.get(A.element);this.name=A.name;this.label=hui.get.firstByTag(this.element,"strong");this.text=hui.get.firstByTag(this.element,"span");hui.ui.extend(this)};hui.ui.Toolbar.Badge.prototype={setLabel:function(A){hui.dom.setText(this.label,A)},setText:function(A){hui.dom.setText(this.text,A)}};hui.ui.Toolbar.More=function(A){this.element=hui.get(A.element);this.name=A.name;this.button=hui.get.firstByClass(this.element,"hui_toolbar_more");hui.listen(this.button,"click",this.toggle.bind(this));hui.ui.extend(this)};hui.ui.Toolbar.More.prototype={toggle:function(){hui.cls.toggle(this.element,"hui_toolbar_more_expanded")}};hui.ui.ImageInput=function(A){this.name=A.name;this.options=hui.override({width:48,height:48},A);this.element=hui.get(A.element);this.images=[];this.value=null;this.thumbnailsLoaded=false;hui.ui.extend(this);this._addBehavior()};hui.ui.ImageInput.prototype={_addBehavior:function(){hui.listen(this.element,"click",this._showPicker.bind(this))},setObject:function(A){this.value=A;this._updateUI()},getObject:function(){return this.value},getValue:function(){return this.value},setValue:function(A){this.setObject(A)},reset:function(){this.value=null;this._updateUI()},_updateUI:function(){if(this.value==null){this.element.style.backgroundImage=""}else{var A=hui.ui.resolveImageUrl(this,this.value,this.options.width,this.options.height);this.element.style.backgroundImage="url("+A+")"}},_showFinder:function(){if(!this.finder){this.finder=hui.ui.Finder.create(this.options.finder);this.finder.listen({$select:function(A){this.setObject(A);this._fireChange();this.finder.hide()}.bind(this)})}this.finder.show()},_showPicker:function(){if(this.options.finder){this._showFinder();return }if(!this.picker){var B=this;this.picker=hui.ui.BoundPanel.create({modal:true});this.content=hui.build("div",{"class":"hui_imageinput_thumbs"});var C=hui.ui.Buttons.create({align:"right"});var D=hui.ui.Button.create({text:"Luk",highlighted:true,small:true});D.listen({$click:function(){B._hidePicker()}});var A=hui.ui.Button.create({text:"Fjern",small:true});A.listen({$click:function(){B.setObject(null);B._hidePicker();B._fireChange()}});C.add(A).add(D);this.picker.add(this.content);this.picker.add(C)}this.picker.position(this.element);this.picker.show();if(!this.thumbnailsLoaded){this._updateImages();this.thumbnailsLoaded=true}},_hidePicker:function(){this.picker.hide()},$visibilityChanged:function(){if(this.picker&&!hui.dom.isVisible(this.element)){this.picker.hide()}if(this.finder&&!hui.dom.isVisible(this.element)){this.finder.hide()}},_fireChange:function(){this.fireValueChange()},_updateImages:function(){var A=this;hui.request({onSuccess:function(B){A._parse(B.responseXML)},url:this.options.source})},_parse:function(G){this.content.innerHTML="";var A=G.getElementsByTagName("image");var D=this;for(var F=0;F<A.length;F++){var H=parseInt(A[F].getAttribute("id"));var C={id:H};var E=hui.ui.resolveImageUrl(this,C,48,48);var B=hui.build("div",{"class":"hui_imageinput_thumbnail",style:"background-image:url("+E+")"});B.huiObject={"id":H};B.onclick=function(){D.setObject(this.huiObject);D._hidePicker();D._fireChange()};this.content.appendChild(B)}}};hui.ui.BoundPanel=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.visible=false;this.content=hui.get.firstByClass(this.element,"hui_boundpanel_content");this.arrow=hui.get.firstByClass(this.element,"hui_boundpanel_arrow");this.arrowWide=37;this.arrowNarrow=18;if(A.variant=="light"){this.arrowWide=23;this.arrowNarrow=12}hui.ui.extend(this)};hui.ui.BoundPanel.create=function(A){A=hui.override({name:null,top:0,left:0,width:null,padding:null,modal:false,hideOnClick:false},A);var B='<div class="hui_boundpanel_arrow"></div><div class="hui_boundpanel_top"><div><div></div></div></div><div class="hui_boundpanel_body"><div class="hui_boundpanel_body"><div class="hui_boundpanel_body"><div class="hui_boundpanel_content" style="';if(A.width){B+="width:"+A.width+"px;"}if(A.padding){B+="padding:"+A.padding+"px;"}B+='"></div></div></div></div><div class="hui_boundpanel_bottom"><div><div></div></div></div>';A.element=hui.build("div",{"class":A.variant?"hui_boundpanel hui_boundpanel_"+A.variant:"hui_boundpanel",style:"display:none;zIndex:"+hui.ui.nextPanelIndex()+";top:"+A.top+"px;left:"+A.left+"px",html:B,parent:document.body});return new hui.ui.BoundPanel(A)};hui.ui.BoundPanel.prototype={toggle:function(){if(!this.visible){this.show()}else{this.hide()}},show:function(C){C=C||{};var D=C.target||this.options.target;if(this.visible){this.element.style.zIndex=hui.ui.nextPanelIndex();return }if(D){if(D.nodeName){this.position(D)}else{this.position(hui.ui.get(this.options.target))}}if(hui.browser.opacity){hui.style.setOpacity(this.element,0)}var A;if(this.relativePosition=="left"){A=false;this.element.style.marginLeft="30px"}else{if(this.relativePosition=="right"){A=false;this.element.style.marginLeft="-30px"}else{if(this.relativePosition=="top"){A=true;this.element.style.marginTop="30px"}else{if(this.relativePosition=="bottom"){A=true;this.element.style.marginTop="-30px"}}}}hui.style.set(this.element,{visibility:"hidden",display:"block"});this.element.style.visibility="visible";this.element.style.display="block";var B=hui.ui.nextPanelIndex();this.element.style.zIndex=B;hui.ui.callVisible(this);if(hui.browser.opacity){hui.animate(this.element,"opacity",1,400,{ease:hui.ease.fastSlow})}hui.animate(this.element,A?"margin-top":"margin-left","0px",800,{ease:hui.ease.bounce});this.visible=true;if(this.options.modal){hui.ui.showCurtain({widget:this,zIndex:B-1,transparent:this.options.modal=="transparent",color:"auto"})}if(this.options.hideOnClick){this.hideListener=hui.listen(document.body,"click",function(E){if(!hui.ui.isWithin(E,this.element)){this.hide()}}.bind(this))}},$curtainWasClicked:function(){hui.ui.hideCurtain(this);this.hide()},hide:function(){if(!this.visible){return }if(!hui.browser.opacity){this.element.style.display="none";hui.ui.callVisible(this)}else{hui.animate(this.element,"opacity",0,300,{ease:hui.ease.slowFast,onComplete:function(){this.element.style.display="none";hui.ui.callVisible(this)}.bind(this)})}if(this.options.modal){hui.ui.hideCurtain(this)}this.visible=false;hui.unListen(document.body,"click",this.hideListener)},isVisible:function(){return this.visible},add:function(A){if(A.getElement){this.content.appendChild(A.getElement())}else{this.content.appendChild(A)}},clear:function(){hui.ui.destroyDescendants(this.content);this.content.innerHTML=""},addSpace:function(A){this.add(hui.build("div",{style:"font-size:0px;height:"+A+"px"}))},getDimensions:function(){var B,A;if(this.element.style.display=="none"){this.element.style.visibility="hidden";this.element.style.display="block";B=this.element.clientWidth;A=this.element.clientHeight;this.element.style.display="none";this.element.style.visibility=""}else{B=this.element.clientWidth;A=this.element.clientHeight}return{width:B,height:A}},position:function(F){var M,T;if(F.getElement){M=F.getElement()}if(F.element){M=F.element;T=F.position}else{M=hui.get(F)}var A={left:hui.position.getLeft(M),top:hui.position.getTop(M)};var R=hui.position.getScrollOffset(M);var O={left:hui.window.getScrollLeft(),top:hui.window.getScrollTop()};var C=this.getDimensions();var P=hui.window.getViewWidth();var E=hui.window.getViewHeight();var I=A.left-O.left+hui.window.getScrollLeft();var D=M.clientWidth||M.offsetWidth;var J=M.clientHeight||M.offsetHeight;var G,L,H,K;var S={top:A.top-O.top-(R.top-O.top)};var B=(A.top-O.top+R.top)/E;B=S.top/E;if(T=="vertical"){B=B>0.5?0.9:0.1}if(B<=0.1){this.relativePosition="top";this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_top";if(this.options.variant=="light"){L=this.arrowNarrow*-1+1}else{L=this.arrowNarrow*-1+2}H=Math.min(P-C.width-2,Math.max(3,I+(D/2)-((C.width)/2)));G=(I+D/2)-H-this.arrowNarrow;K=A.top+J+8-(R.top-O.top)}else{if(B>=0.9){this.relativePosition="bottom";this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_bottom";if(this.options.variant=="light"){L=C.height-2}else{L=C.height-6}H=Math.min(P-C.width-3,Math.max(3,I+(D/2)-((C.width)/2)));G=(I+D/2)-H-this.arrowNarrow;K=A.top-C.height-5-(R.top-O.top)}else{if((I+D/2)/P<0.5){this.relativePosition="left";H=I+D+10;this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_left";K=A.top+(J-C.height)/2;K-=(R.top-O.top);var N=O.top+3;var Q=O.top+(E-C.height)-3;K=Math.min(Math.max(K,N),Q);L=A.top-K;L-=(R.top-O.top);L-=this.arrowWide/2;L+=J/2;if(this.options.variant=="light"){G=-11;L+=2}else{G=-14}}else{this.relativePosition="right";H=I-C.width-10;this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_right";K=A.top+(J-C.height)/2;K-=(R.top-O.top);var N=O.top+3;var Q=O.top+(E-C.height)-3;K=Math.min(Math.max(K,N),Q);L=A.top-K;L-=(R.top-O.top);L-=this.arrowWide/2;L+=J/2;if(this.options.variant=="light"){G=C.width-1;L+=2}else{G=C.width-4}}}}this.arrow.style.marginTop=L+"px";this.arrow.style.marginLeft=G+"px";if(this.visible){hui.animate(this.element,"top",K+"px",500,{ease:hui.ease.fastSlow});hui.animate(this.element,"left",H+"px",500,{ease:hui.ease.fastSlow})}else{this.element.style.top=K+"px";this.element.style.left=H+"px"}}};hui.ui.ImageViewer=function(A){this.options=hui.override({maxWidth:800,maxHeight:600,perimeter:100,sizeSnap:100,margin:0,ease:hui.ease.slowFastSlow,easeEnd:hui.ease.bounce,easeAuto:hui.ease.slowFastSlow,easeReturn:hui.ease.cubicInOut,transition:400,transitionEnd:1000,transitionReturn:300},A);this.element=hui.get(A.element);this.box=this.options.box;this.viewer=hui.get.firstByClass(this.element,"hui_imageviewer_viewer");this.innerViewer=hui.get.firstByClass(this.element,"hui_imageviewer_inner_viewer");this.status=hui.get.firstByClass(this.element,"hui_imageviewer_status");this.previousControl=hui.get.firstByClass(this.element,"hui_imageviewer_previous");this.controller=hui.get.firstByClass(this.element,"hui_imageviewer_controller");this.nextControl=hui.get.firstByClass(this.element,"hui_imageviewer_next");this.playControl=hui.get.firstByClass(this.element,"hui_imageviewer_play");this.closeControl=hui.get.firstByClass(this.element,"hui_imageviewer_close");this.text=hui.get.firstByClass(this.element,"hui_imageviewer_text");this.dirty=false;this.width=600;this.height=460;this.index=0;this.playing=false;this.name=A.name;this.images=[];this.box.listen(this);this._addBehavior();hui.ui.extend(this)};hui.ui.ImageViewer.create=function(A){A=A||{};var B=A.element=hui.build("div",{"class":"hui_imageviewer",html:'<div class="hui_imageviewer_viewer"><div class="hui_imageviewer_inner_viewer"></div></div><div class="hui_imageviewer_text"></div><div class="hui_imageviewer_status"></div><div class="hui_imageviewer_controller"><div><div><a class="hui_imageviewer_previous"></a><a class="hui_imageviewer_play"></a><a class="hui_imageviewer_next"></a><a class="hui_imageviewer_close"></a></div></div></div>'});var C=A.box=hui.ui.Box.create({absolute:true,modal:true,closable:true});C.add(B);C.addToDocument();return new hui.ui.ImageViewer(A)};hui.ui.ImageViewer.prototype={_addBehavior:function(){var A=this;this.nextControl.onclick=function(){A.next(true)};this.previousControl.onclick=function(){A.previous(true)};this.playControl.onclick=function(){A.playOrPause()};this.closeControl.onclick=this.hide.bind(this);hui.listen(this.viewer,"click",this._zoom.bind(this));this._timer=function(){A.next(false)};this._keyListener=function(B){B=hui.event(B);if(B.rightKey){A.next(true)}else{if(B.leftKey){A.previous(true)}else{if(B.escapeKey){A.hide()}else{if(B.returnKey){A.playOrPause()}}}}},hui.listen(this.viewer,"mousemove",this._onMouseMove.bind(this));hui.listen(this.controller,"mouseover",function(){A.overController=true});hui.listen(this.controller,"mouseout",function(){A.overController=false});hui.listen(this.viewer,"mouseout",function(B){if(!hui.ui.isWithin(B,this.viewer)){A._hideController()}}.bind(this))},_onMouseMove:function(){window.clearTimeout(this.ctrlHider);if(this._shouldShowController()){this.ctrlHider=window.setTimeout(this._hideController.bind(this),2000);if(hui.browser.msie){this.controller.style.display="block"}else{hui.effect.fadeIn({element:this.controller,duration:200})}}},_hideController:function(){if(!this.overController){if(hui.browser.msie){this.controller.style.display="none"}else{hui.effect.fadeOut({element:this.controller,duration:500})}}},_getLargestSize:function(A,B){if(B.width<=A.width&&B.height<=A.height){return{width:B.width,height:B.height}}else{if(A.width/A.height>B.width/B.height){return{width:Math.round(A.height/B.height*B.width),height:A.height}}else{if(A.width/A.height<B.width/B.height){return{width:A.width,height:Math.round(A.width/B.width*B.height)}}else{return{width:A.width,height:A.height}}}}},_calculateSize:function(){var A=this.options.sizeSnap;var F=hui.window.getViewWidth()-this.options.perimeter;F=Math.floor(F/A)*A;F=Math.min(F,this.options.maxWidth);var B=hui.window.getViewHeight()-this.options.perimeter;B=Math.floor(B/A)*A;B=Math.min(B,this.options.maxHeight);var E=0;var D=0;for(var C=0;C<this.images.length;C++){var G=this._getLargestSize({width:F,height:B},this.images[C]);E=Math.max(E,G.width);D=Math.max(D,G.height)}B=Math.floor(Math.min(B,D));F=Math.floor(Math.min(F,E));if(F!=this.width||B!=this.height){this.width=F;this.height=B;this.dirty=true}},_updateUI:function(){if(this.dirty){this.innerViewer.innerHTML="";for(var B=0;B<this.images.length;B++){var A=hui.build("div",{"class":"hui_imageviewer_image"});hui.style.set(A,{width:(this.width+this.options.margin)+"px",height:(this.height-1)+"px"});this.innerViewer.appendChild(A)}if(this._shouldShowController()){this.controller.style.display="block"}else{this.controller.style.display="none"}this.dirty=false;this._preload()}},_shouldShowController:function(){return this.images.length>1},_goToImage:function(C,D,B){if(C){if(D>1){hui.animate(this.viewer,"scrollLeft",this.index*(this.width+this.options.margin),Math.min(D*this.options.transitionReturn,2000),{ease:this.options.easeReturn})}else{var A=this.index==0||this.index==this.images.length-1;var F=(A?this.options.easeEnd:this.options.ease);if(!B){F=this.options.easeAuto}hui.animate(this.viewer,"scrollLeft",this.index*(this.width+this.options.margin),(A?this.options.transitionEnd:this.options.transition),{ease:F})}}else{this.viewer.scrollLeft=this.index*(this.width+this.options.margin)}var E=this.images[this.index].text;if(E){this.text.innerHTML=E;this.text.style.display="block"}else{this.text.innerHTML="";this.text.style.display="none"}},showById:function(B){for(var A=0;A<this.images.length;A++){if(this.images[A].id==B){this.show(A);break}}},show:function(A){this.index=A||0;this._calculateSize();this._updateUI();var B=this.options.margin;hui.style.set(this.element,{width:(this.width+B)+"px",height:(this.height+B*2-1)+"px"});hui.style.set(this.viewer,{width:(this.width+B)+"px",height:(this.height-1)+"px"});hui.style.set(this.innerViewer,{width:((this.width+B)*this.images.length)+"px",height:(this.height-1)+"px"});hui.style.set(this.controller,{marginLeft:((this.width-180)/2+B*0.5)+"px",display:"none"});this.box.show();this._goToImage(false,0,false);hui.listen(document,"keydown",this._keyListener);this.visible=true;this._setHash(true)},_setHash:function(A){if(!this._listening){this._listening=true;if(!hui.browser.msie6&&!hui.browser.msie7){hui.listen(window,"hashchange",this._onHashChange.bind(this))}}if(A){document.location="#imageviewer"}else{hui.location.clearHash()}},_onHashChange:function(){if(this._changing){return }this._changing=true;if(hui.location.hasHash("imageviewer")&&!this.visible){this.show()}else{if(!hui.location.hasHash("imageviewer")&&this.visible){this.hide()}}this._changing=false},hide:function(){this._hide()},_hide:function(){this.pause();this.box.hide();hui.unListen(document,"keydown",this._keyListener);this.visible=false;this._setHash(false)},$boxCurtainWasClicked:function(){this.hide()},$boxWasClosed:function(){this.hide()},clearImages:function(){this.images=[];this.dirty=true},addImages:function(A){for(var B=0;B<A.length;B++){this.addImage(A[B])}},addImage:function(A){this.images.push(A);this.dirty=true},play:function(){if(!this.interval){this.interval=window.setInterval(this._timer,6000)}this.next(false);this.playing=true;this.playControl.className="hui_imageviewer_pause"},pause:function(){window.clearInterval(this.interval);this.interval=null;this.playControl.className="hui_imageviewer_play";this.playing=false},playOrPause:function(){if(this.playing){this.pause()}else{this.play()}},_resetPlay:function(){if(this.playing){window.clearInterval(this.interval);this.interval=window.setInterval(this._timer,6000)}},previous:function(A){var B=1;this.index--;if(this.index<0){this.index=this.images.length-1;B=this.images.length-1}this._goToImage(true,B,A);this._resetPlay()},next:function(A){var B=1;this.index++;if(this.index==this.images.length){this.index=0;B=this.images.length-1}this._goToImage(true,B,A);this._resetPlay()},_preload:function(){var B=new hui.Preloader();B.addImages(hui.ui.context+"/hui/gfx/imageviewer_controls.png");var A=this;B.setDelegate({allImagesDidLoad:function(){A._preloadImages()}});B.load()},_preloadImages:function(){var A=new hui.Preloader();A.setDelegate(this);for(var C=0;C<this.images.length;C++){var B=hui.ui.resolveImageUrl(this,this.images[C],this.width,this.height);if(B!==null){A.addImages(B)}}this.status.innerHTML="0%";this.status.style.display="";A.load(this.index)},allImagesDidLoad:function(){this.status.style.display="none"},imageDidLoad:function(C,D,B){this.status.innerHTML=Math.round(C/D*100)+"%";var A=hui.ui.resolveImageUrl(this,this.images[B],this.width,this.height);A=A.replace(/&amp;/g,"&");this.innerViewer.childNodes[B].style.backgroundImage="url('"+A+"')";hui.cls.set(this.innerViewer.childNodes[B],"hui_imageviewer_image_abort",false);hui.cls.set(this.innerViewer.childNodes[B],"hui_imageviewer_image_error",false)},imageDidGiveError:function(B,C,A){hui.cls.set(this.innerViewer.childNodes[A],"hui_imageviewer_image_error",true)},imageDidAbort:function(B,C,A){hui.cls.set(this.innerViewer.childNodes[A],"hui_imageviewer_image_abort",true)},_zoom:function(D){var A=this.images[this.index];if(A.width<=this.width&&A.height<=this.height){return }if(!this.zoomer){this.zoomer=hui.build("div",{"class":"hui_imageviewer_zoomer",style:"width:"+this.viewer.clientWidth+"px;height:"+this.viewer.clientHeight+"px"});this.element.insertBefore(this.zoomer,hui.dom.firstChild(this.element));hui.listen(this.zoomer,"mousemove",this._onZoomMove.bind(this));hui.listen(this.zoomer,"click",function(){this.zoomer.style.display="none"}.bind(this))}this.pause();var C=this._getLargestSize({width:2000,height:2000},A);var B=hui.ui.resolveImageUrl(this,A,C.width,C.height);this.zoomer.innerHTML='<div style="width:'+C.width+"px;height:"+C.height+'px; margin: 0 auto;"><img src="'+B+'"/></div>';this.zoomer.style.display="block";this.zoomInfo={width:C.width,height:C.height};this._onZoomMove(D)},_onZoomMove:function(B){B=new hui.Event(B);if(!this.zoomInfo){return }var C={left:hui.position.getLeft(this.zoomer),top:hui.position.getTop(this.zoomer)};var A=(B.getLeft()-C.left)/this.zoomer.clientWidth*(this.zoomInfo.width-this.zoomer.clientWidth);var D=(B.getTop()-C.top)/this.zoomer.clientHeight*(this.zoomInfo.height-this.zoomer.clientHeight);this.zoomer.scrollLeft=A;this.zoomer.scrollTop=D}};hui.ui.Picker=function(A){A=this.options=hui.override({itemWidth:100,itemHeight:150,itemsVisible:null,shadow:true,valueProperty:"value"},A);this.element=hui.get(A.element);this.name=A.name;this.container=hui.get.firstByClass(this.element,"hui_picker_container");this.content=hui.get.firstByClass(this.element,"hui_picker_content");this.title=hui.get.firstByClass(this.element,"hui_picker_title");this.pages=[];this.objects=[];this.selected=null;this.value=null;this._addBehavior();hui.ui.extend(this)};hui.ui.Picker.create=function(A){A=hui.override({shadow:true},A);A.element=hui.build("div",{"class":"hui_picker",html:hui.when(A.title,'<div class="hui_picker_title">'+A.title+"</div>")+'<div class="hui_picker_container"><div class="hui_picker_content"></div></div><div class="hui_picker_pages"></div>'});if(A.shadow==true){hui.cls.add(A.element,"hui_picker_shadow")}return new hui.ui.Picker(A)};hui.ui.Picker.prototype={_addBehavior:function(){hui.drag.register({element:this.element,onBeforeMove:this._onBeforeMove.bind(this),onMove:this._onMove.bind(this),onAfterMove:this._onAfterMove.bind(this)});hui.listen(this.element,"click",this._onClick.bind(this))},_onClick:function(B){if(this.dragging){return }B=hui.event(B);var A=B.findByClass("hui_picker_page");if(A){this.goToPage(parseInt(A.getAttribute("data-index")))}},goToPage:function(A){var B=Math.round(this.container.clientWidth*A);B=Math.min(B,this.content.clientWidth-this.container.clientWidth);this._scrollTo(B,hui.ease.fastSlow)},setObjects:function(A){this.selected=null;this.objects=A||[];this._updateUI()},setValue:function(A){this.value=A;this._updateSelection()},getValue:function(){return this.value},reset:function(){this.value=null;this._updateSelection()},_updateUI:function(){var A=this,B;this.content.innerHTML="";this.container.scrollLeft=0;if(this.options.itemsVisible){B=this.options.itemsVisible*(this.options.itemWidth+14)}else{B=this.container.clientWidth}hui.style.set(this.container,{width:B+"px",height:(this.options.itemHeight+14)+"px"});hui.style.set(this.content,{width:(this.objects.length*(this.options.itemWidth+14))+"px",height:(this.options.itemHeight+14)+"px"});hui.each(this.objects,function(C,D){var E=hui.build("div",{"class":"hui_picker_item",title:C.title,html:'<div style="width:'+A.options.itemWidth+"px;height:"+A.options.itemHeight+"px; overflow: hidden; background-image:url('"+C.image+"')\"><strong>"+hui.string.escape(C.title)+"</strong></div>",parent:A.content});if(A.value!=null&&C[A.options.valueProperty]==A.value){hui.cls.add(E,"hui_picker_item_selected")}hui.listen(E,"mouseup",function(){A._onItemClick(C[A.options.valueProperty])})});this._updatePages()},_updatePages:function(){var B=this.container.clientWidth;if(!B){return }var C=Math.ceil(this.content.clientWidth/B);var A=hui.get.firstByClass(this.element,"hui_picker_pages");hui.dom.clear(A);if(C<2){return }for(var D=1;D<=C;D++){hui.build("a",{parent:A,text:D,className:"hui_picker_page"+hui.when(D==1," hui_picker_page_selected"),"data-index":D-1})}},_updateSelection:function(){var B=this.content.childNodes;for(var A=0;A<B.length;A++){hui.cls.set(B[A],"hui_picker_item_selected",this.value!=null&&this.objects[A][this.options.valueProperty]==this.value)}},_onItemClick:function(A){if(this.dragging){return }if(this.value==A){return }this.value=A;this._updateSelection();this.fire("select",A)},_onBeforeMove:function(A){this.dragX=A.getLeft();this.dragScroll=this.container.scrollLeft;this.dragging=true},_onMove:function(A){this.container.scrollLeft=this.dragX-A.getLeft()+this.dragScroll},_onAfterMove:function(B){var A=this.options.itemWidth+14;var C=Math.round(this.container.scrollLeft/A)*A;this._scrollTo(C);this.dragging=false},_scrollTo:function(B,A){A=A||hui.ease.bounceOut;hui.animate(this.container,"scrollLeft",B,500,{ease:A,onComplete:this._updatePager.bind(this)})},_updatePager:function(){var C=Math.ceil(this.container.scrollLeft/this.container.clientWidth);hui.log(C);var A=hui.get.byClass(this.element,"hui_picker_page");for(var B=0;B<A.length;B++){hui.cls.set(A[B],"hui_picker_page_selected",C==B)}},$visibilityChanged:function(){if(!hui.dom.isVisible(this.element)){return }this.container.style.display="none";var A;if(this.options.itemsVisible){A=this.options.itemsVisible*(this.options.itemWidth+14)}else{A=this.container.parentNode.clientWidth}A=Math.max(A,0);hui.style.set(this.container,{width:A+"px",display:"block"});this._updatePages()}};hui.ui.Editor=function(){this.name="huiEditor";this.options={rowClass:"row",columnClass:"column",partClass:"part"};this.parts=[];this.rows=[];this.partControllers=[];this.activePart=null;this.active=false;this.live=true;hui.ui.extend(this)};hui.ui.Editor.get=function(){if(!hui.ui.Editor.instance){hui.ui.Editor.instance=new hui.ui.Editor()}return hui.ui.Editor.instance};hui.ui.Editor.prototype={ignite:function(){hui.listen(window,"keydown",this._onKeyDown.bind(this));hui.listen(window,"keyup",this._onKeyUp.bind(this));this.reload()},_onKeyDown:function(A){A=hui.event(A)},_onKeyUp:function(A){},addPartController:function(B,C,A){this.partControllers.push({key:B,"title":C,"controller":A})},setOptions:function(A){hui.override(this.options,A)},_getPartController:function(A){var B=null;hui.each(this.partControllers,function(C){if(C.key==A){B=C}});return B},reload:function(){if(this.partControls){this.partControls.hide()}var A=this;this.parts=[];var B=hui.get.byClass(document.body,this.options.rowClass);hui.each(B,function(E,D){var C=hui.get.byClass(E,A.options.columnClass);A._reloadColumns(C,D);hui.each(C,function(G,F){var H=hui.get.byClass(G,A.options.partClass);A._reloadParts(H,D,F)})})},_reloadColumns:function(B,C){var A=this;hui.each(B,function(E,D){hui.listen(E,"mouseover",function(){A._onHoverColumn(E)});hui.listen(E,"mouseout",function(F){A._onBlurColumn(F)})})},_reloadParts:function(D,E,C){var A=this;var B=new RegExp(this.options.partClass+"_([\\w]+)","i");hui.each(D,function(H,J){if(!H){return }var G=H.className.match(B);if(G&&G[1]){var I=A._getPartController(G[1]);if(I){var F=new I.controller({element:H});F.type=G[1];hui.listen(H,"click",function(K){K=hui.event(K);if(!K.findByTag("a")&&K.altKey){A._editPart(F)}});hui.listen(H,"mouseover",function(K){A.hoverPart(F)});hui.listen(H,"mouseout",function(K){A.blurPart(K)});A.parts.push(F)}hui.listen(H,"mousedown",function(K){A._startPartDrag({element:H,event:K})})}})},activate:function(){this.active=true},deactivate:function(){this.active=false;if(this.activePart){this.activePart.deactivate()}if(this.partControls){this.partControls.hide()}},_onHoverColumn:function(A){if(this.hoveredColumn){hui.cls.remove(this.hoveredColumn,"hui_editor_column_hover")}this.hoveredColumn=A;if(!this.active||this.activePart){return }hui.cls.add(A,"hui_editor_column_hover")},_onBlurColumn:function(A){if(!this.active||!this.hoveredColumn||hui.ui.isWithin(A,this.hoveredColumn)){return }hui.cls.remove(this.hoveredColumn,"hui_editor_column_hover")},contextColumn:function(C,G,B,E){if(!this.active||this.activePart){return }if(!this.columnMenu){var F=hui.ui.Menu.create({name:"huiEditorColumnMenu"});F.addItem({title:"Rediger kolonne",value:"editColumn"});F.addItem({title:"Slet kolonne",value:"removeColumn"});F.addItem({title:"Tilføj kolonne",value:"addColumn"});F.addDivider();for(var A=0;A<this.partControllers.length;A++){var D=this.partControllers[A];F.addItem({title:D.title,value:D.key})}this.columnMenu=F;F.listen(this)}this.hoveredRow=G;this.hoveredColumnIndex=B;this.columnMenu.showAtPointer(E)},$itemWasClicked$huiEditorColumnMenu:function(A){if(A=="removeColumn"){this.fire("removeColumn",{"row":this.hoveredRow,"column":this.hoveredColumnIndex})}else{if(A=="editColumn"){this.editColumn(this.hoveredRow,this.hoveredColumnIndex)}else{if(A=="addColumn"){this.fire("addColumn",{"row":this.hoveredRow,"position":this.hoveredColumnIndex+1})}else{this.fire("addPart",{"row":this.hoveredRow,"column":this.hoveredColumnIndex,"position":0,type:A})}}}},editColumn:function(D,A){this.closeColumn();var B=hui.get.byClass(document.body,"row")[D];var C=this.activeColumn=hui.get.byClass(B,"column")[A];hui.cls.add(C,"hui_editor_column_edit");this.showColumnWindow();this.columnEditorForm.setValues({width:hui.style.get(C,"width"),paddingLeft:hui.style.get(C,"padding-left")})},closeColumn:function(){if(this.activeColumn){hui.cls.remove(this.activeColumn,"hui_editor_column_edit")}},showColumnWindow:function(){if(!this.columnEditor){var A=this.columnEditor=hui.ui.Window.create({name:"columnEditor",title:"Rediger kolonne",width:200});var F=this.columnEditorForm=hui.ui.Formula.create();var C=F.createGroup();var B=hui.ui.TextField.create({label:"Bredde",key:"width"});B.listen({$valueChanged:function(G){this.changeColumnWidth(G)}.bind(this)});C.add(B);var E=hui.ui.TextField.create({label:"Venstremargen",key:"left"});E.listen({$valueChanged:function(G){this.changeColumnLeftMargin(G)}.bind(this)});C.add(E);var D=hui.ui.TextField.create({label:"Højremargen",key:"right"});D.listen({$valueChanged:this.changeColumnRightMargin.bind(this)});C.add(D);A.add(F);A.listen(this)}this.columnEditor.show()},$userClosedWindow$columnEditor:function(){this.closeColumn();var A=this.columnEditorForm.getValues();A.row=this.hoveredRow;A.column=this.hoveredColumnIndex;this.fire("updateColumn",A)},changeColumnWidth:function(A){this.activeColumn.style.width=A},changeColumnLeftMargin:function(A){this.activeColumn.setStyle({"paddingLeft":A})},changeColumnRightMargin:function(A){this.activeColumn.setStyle({"paddingRight":A})},hoverPart:function(B,C){if(!this.active||this.activePart||!this.live||this.dragging||this.busy){return }this.hoveredPart=B;hui.cls.add(B.element,"hui_editor_part_hover");var A=this;this.partControlTimer=window.setTimeout(function(){A.showPartControls()},200)},blurPart:function(A){window.clearTimeout(this.partControlTimer);if(hui.ui.isWithin(A,this.hoveredPart.element)){return }if(!this.active){return }if(this.partControls&&!hui.ui.isWithin(A,this.partControls.element)){this._hidePartControls();hui.cls.remove(this.hoveredPart.element,"hui_editor_part_hover")}if(!this.partControls&&this.hoveredPart){hui.cls.remove(this.hoveredPart.element,"hui_editor_part_hover")}},showPartEditControls:function(){if(!this.partEditControls){this.partEditControls=hui.ui.Overlay.create({name:"huiEditorPartEditActions"});this.partEditControls.addIcon("save","common/save");this.partEditControls.addIcon("cancel","common/close");this.partEditControls.listen(this)}this.partEditControls.showAtElement(this.activePart.element,{"horizontal":"right","vertical":"topOutside"})},showPartControls:function(){if(!this.partControls){this.partControls=hui.ui.Overlay.create({name:"huiEditorPartActions"});this.partControls.addIcon("edit","common/edit");this.partControls.addIcon("new","common/new");this.partControls.addIcon("delete","common/delete");var A=this;hui.listen(this.partControls.getElement(),"mouseout",this._blurControls.bind(this));hui.listen(this.partControls.getElement(),"mouseover",this._hoverControls.bind(this));this.partControls.listen(this)}if(this.hoveredPart.column==-1||true){this.partControls.hideIcons(["new","delete"])}else{this.partControls.showIcons(["new","delete"])}this.partControls.showAtElement(this.hoveredPart.element,{"horizontal":"right"})},_hoverControls:function(A){hui.cls.add(this.hoveredPart.element,"hui_editor_part_hover")},_blurControls:function(A){hui.cls.remove(this.hoveredPart.element,"hui_editor_part_hover");if(!hui.ui.isWithin(A,this.hoveredPart.element)){this._hidePartControls()}},$iconWasClicked$huiEditorPartActions:function(A,B){if(A=="delete"){this.deletePart(this.hoveredPart)}else{if(A=="new"){this.newPart(B)}else{if(A=="edit"){this._editPart(this.hoveredPart)}}}},$iconWasClicked$huiEditorPartEditActions:function(A,B){if(A=="cancel"){this.cancelPart(this.activePart)}else{if(A=="save"){this.savePart(this.activePart)}}},_hidePartControls:function(){if(this.partControls){this.partControls.hide()}},_hidePartEditControls:function(){if(this.partEditControls){this.partEditControls.hide()}},_editPart:function(A){if(!this.active||this.activePart){return }if(this.activePart){this.activePart.deactivate()}if(this.hoveredPart){hui.cls.remove(this.hoveredPart.element,"hui_editor_part_hover")}this.activePart=A;this.showPartEditControls();hui.cls.add(A.element,"hui_editor_part_active");A.activate(function(){});window.clearTimeout(this.partControlTimer);this._hidePartControls();if(this.hoveredColumn){hui.cls.remove(this.hoveredColumn,"hui_editor_column_hover")}this._showPartEditor()},_showPartEditor:function(){},updatePartProperties:function(A){hui.style.set(this.activePart.element,{marginTop:A.top,marginBottom:A.bottom,marginLeft:A.left,marginRight:A.right});this.activePart.properties=A},hidePartEditor:function(){if(this.partEditor){this.partEditor.hide()}},cancelPart:function(A){A.cancel();this.hidePartEditor();this.activePart=null},savePart:function(A){this.busy=true;A.save({callback:function(){this.hidePartEditor();this.activePart=null;this.busy=false}.bind(this)})},getEditorForElement:function(B){for(var A=0;A<this.parts.length;A++){if(this.parts[A].element==B){return this.parts[A]}}return null},partDidDeacivate:function(A){hui.cls.remove(A.element,"hui_editor_part_active");this.activePart=null;this._hidePartEditControls()},partChanged:function(A){hui.ui.callDelegates(A,"partChanged")},deletePart:function(A){hui.ui.callDelegates(A,"deletePart");this.partControls.hide()},newPart:function(A){if(!this.newPartMenu){var B=hui.ui.Menu.create({name:"huiEditorNewPartMenu"});hui.each(this.partControllers,function(C){B.addItem({title:C.title,value:C.key})});B.listen(this);this.newPartMenu=B}this.newPartMenu.showAtPointer(A)},$itemWasClicked$huiEditorNewPartMenu:function(A){var B={row:this.hoveredPart.row,column:this.hoveredPart.column,position:this.hoveredPart.position+1,type:A};hui.ui.callDelegates(this,"addPart",B)},_dragInfo:null,_dropInfo:null,dragProxy:null,_startPartDrag:function(D){if(!this.active||this.activePart||!this.live){return true}var C=hui.event(D.event),B=D.element;if(!C.altKey){return }C.stop();if(!this.dragProxy){this.dragProxy=hui.build("div",{"class":"hui_editor_dragproxy",parent:document.body,style:"display:none;"})}var A=this.dragProxy;A.innerHTML=B.innerHTML;var E=this._getPartPosition(B);if(!E){return }this._dragInfo={diffLeft:C.getLeft()-hui.position.getLeft(B),diffTop:C.getTop()-hui.position.getTop(B),draggedElement:B,partIndex:E.partIndex,rowIndex:E.rowIndex,columnIndex:E.columnIndex,initialHeight:B.clientHeight};hui.log("startDrag");hui.drag.start({element:A,onBeforeMove:this._onBeforeDrag.bind(this),onMove:this._onDrag.bind(this),onAfterMove:this._onAfterDrag.bind(this),onEnd:function(){}})},_onBeforeDrag:function(){var A=this._dragInfo.draggedElement,B=this.dragProxy;this._insertDropPlaceholders();hui.style.set(B,{display:"block",visibility:"visible",height:A.clientHeight+"px",width:A.clientWidth+"px",transform:"scale(1)",background:"rgba(255,255,255,.5)",padding:"1px",opacity:1});hui.style.setOpacity(A,0.5);this._dragging=true;if(!this._dropMarker){this._dropMarker=hui.build("div",{"class":"hui_editor_dropmarker",parent:document.body})}},_onDrag:function(F){var E=F.getLeft();var D=F.getTop();this.dragProxy.style.left=(E-this._dragInfo.diffLeft)+"px";this.dragProxy.style.top=(D-this._dragInfo.diffTop)+"px";for(var A=0;A<this.dropTargets.length;A++){var C=this.dropTargets[A];if(C.left<E&&C.right>E&&C.top<D&&C.bottom>D){var B=this._dragColumnHeights[C.rowIndex+"-"+C.columnIndex];if(this._latestProxyColumn!=C.columnIndex||this._latestProxyRow!=C.rowIndex){hui.animate({node:this.dragProxy,css:{width:(C.right-C.left)+"px"},duration:300,ease:hui.ease.fastSlow});this._latestProxyColumn=C.columnIndex;this._latestProxyrow=C.rowIndex}this._dropInfo=C;hui.style.set(this._dropMarker,{width:(C.right-C.left)+"px",left:C.left+"px",top:C.position+"px",display:"block"});break}}},_onAfterDrag:function(F){var G=this.dragProxy,B=this._dragInfo,J=this._dragInfo.draggedElement,H=this._dropInfo;if(H){var A=this._dragColumnHeights[H.rowIndex+"-"+H.columnIndex];var I=H.position,C=H.left;if((B.columnIndex==H.columnIndex&&B.partIndex<H.partIndex)||B.rowIndex<H.rowIndex){I=I-B.initialHeight}C++;hui.animate({node:G,css:{left:C+"px",top:I+"px",opacity:0.5},duration:500,ease:hui.ease.slowFastSlow});var D=this._getColumn(H.rowIndex,H.columnIndex);var E=hui.get.byClass(D,this.options.partClass);if(E[H.partIndex]!=J){this.fire("partWasMoved",{dragged:J,rowIndex:H.rowIndex,columnIndex:H.columnIndex,partIndex:H.partIndex,onSuccess:function(){J.style.webkitTransformOrigin="0 0";var K=hui.build("div");if(H.partIndex>=E.length){hui.animate({node:J,css:{height:"0px"},duration:500,ease:hui.ease.slowFastSlow,onComplete:function(){hui.dom.remove(J);D.appendChild(J);hui.animate({node:J,css:{transform:"scale(1)",height:A+"px"},duration:500,ease:hui.ease.slowFastSlow,onComplete:function(){J.style.height=""}})}})}else{hui.dom.insertBefore(E[H.partIndex],K);hui.animate({node:K,css:{height:A+"px"},duration:600,ease:hui.ease.slowFastSlow,onComplete:function(){hui.dom.remove(J);hui.dom.replaceNode(K,J);hui.style.set(J,{transform:"scale(1)",opacity:0,height:""});hui.animate({node:J,css:{opacity:1},duration:500,ease:hui.ease.slowFastSlow})}});hui.animate({node:J,css:{transform:"scale(0)",height:"0px"},duration:500,ease:hui.ease.slowFastSlow})}this._cleanDrag()}.bind(this),onFailure:function(){this._cleanDrag()}.bind(this)})}else{this._cleanDrag()}}},_cleanDrag:function(){var B=this.dragProxy;hui.animate({node:B,css:{opacity:0},duration:500,delay:500,ease:hui.ease.slowFastSlow,onComplete:function(){B.style.display="none"}});hui.style.setOpacity(this._dragInfo.draggedElement,1);var C=hui.get.byClass(document.body,"hui_editor_drop_placeholder");for(var A=0;A<C.length;A++){hui.dom.remove(C[A])}this.dropTargets=[];this._dragging=false;if(this._dropMarker){this._dropMarker.style.display="none"}},_getColumn:function(E,B){var C=hui.get.byClass(document.body,this.options.rowClass);var D=C[E];var A=hui.get.byClass(D,this.options.columnClass);return A[B]},_getPartPosition:function(E){var F=hui.get.byClass(document.body,this.options.rowClass);for(var D=0;D<F.length;D++){var C=hui.get.byClass(F[D],this.options.columnClass);for(var B=0;B<C.length;B++){var G=hui.get.byClass(C[B],this.options.partClass);for(var A=0;A<G.length;A++){if(E===G[A]){return{rowIndex:D,columnIndex:B,partIndex:A}}}}}return null},_activeDragPlaceholder:null,_dragInfo:null,_dragColumnHeights:null,_insertDropPlaceholders:function(){var Y=this.dropTargets=[];var E=this._dragColumnHeights={};var U=this.dragProxy;var G=this._dragInfo.draggedElement;var J=hui.get.byClass(document.body,this.options.rowClass);for(var V=0;V<J.length;V++){var F=J[V];var A=hui.get.byClass(F,this.options.columnClass);for(var S=0;S<A.length;S++){var C=A[S];hui.style.set(U,{width:C.clientWidth+"px",height:"",visibility:"hidden",display:"block"});var L=E[V+"-"+S]=U.clientHeight;var O=hui.get.byClass(C,this.options.partClass);var Q=hui.position.getTop(C);var T=Q+C.clientHeight;var N=Q;var R=0;var B=null;for(;R<O.length;R++){var P=O[R],M=O[R+1],B=O[R-1];var D=hui.position.getLeft(P);var X=D+P.clientWidth;var K=B?hui.position.getTop(B)+B.clientHeight/2:Q;var H=hui.position.getTop(P)+P.clientHeight/2;var W={rowIndex:V,columnIndex:S,partIndex:R,part:P,left:D,right:X,top:K,bottom:H,position:hui.position.getTop(P)};N+=P.clientHeight;Y.push(W);B=P}var I=O.length>0?O[O.length-1]:null;if(I){var K=hui.position.getTop(I)+I.clientHeight/2;var Z=hui.position.getTop(I)+I.clientHeight}else{var K=Q;var Z=Q;var D=hui.position.getLeft(C);var X=D+C.clientWidth}var W={rowIndex:V,columnIndex:S,partIndex:R+1,part:P,left:D,right:X,top:K,position:Z,bottom:T-K>20?T:K+20};if(P){N+=P.clientHeight}Y.push(W)}}for(var V=0;V<Y.length;V++){var W=Y[V]}}};hui.ui.Editor.getPartId=function(B){if(!B.id){return }var A=B.id.match(/part\-([\d]+)/i);if(A&&A.length>0){return A[1]}};hui.ui.Editor.Header=function(A){this.element=hui.get(A.element);this.id=hui.ui.Editor.getPartId(this.element);this.header=hui.get.firstByTag(this.element,"*");this.field=null};hui.ui.Editor.Header.prototype={activate:function(){this.value=this.header.innerHTML;this.field=hui.build("textarea",{className:"hui_editor_header"});this.field.value=this.value;this.header.style.visibility="hidden";this.updateFieldStyle();this.element.insertBefore(this.field,this.header);this.field.focus();this.field.select();hui.listen(this.field,"keydown",function(A){if(A.keyCode==Event.KEY_RETURN){this.save()}}.bind(this))},save:function(){var A=this.field.value;this.header.innerHTML=A;this.deactivate();if(A!=this.value){this.value=A;hui.ui.Editor.get().partChanged(this)}},cancel:function(){this.deactivate()},deactivate:function(){this.header.style.visibility="";this.element.removeChild(this.field);hui.ui.Editor.get().partDidDeacivate(this)},updateFieldStyle:function(){hui.style.set(this.field,{width:this.header.clientWidth+"px",height:this.header.clientHeight+"px"});hui.style.copy(this.header,this.field,["fontSize","lineHeight","marginTop","fontWeight","fontFamily","textAlign","color","fontStyle"])},getValue:function(){return this.value}};hui.ui.Editor.Html=function(A){this.element=hui.get(A.element);this.id=hui.ui.Editor.getPartId(this.element);this.field=null};hui.ui.Editor.Html.prototype={activate:function(){this.value=this.element.innerHTML;this.element.innerHTML="";var A=this.buildStyle();this.editor=hui.ui.MarkupEditor.create({autoHideToolbar:false,style:A});this.element.appendChild(this.editor.getElement());this.editor.listen(this);this.editor.setValue(this.value);this.editor.focus()},buildStyle:function(){return{"textAlign":hui.style.get(this.element,"text-align"),"fontFamily":hui.style.get(this.element,"font-family"),"fontSize":hui.style.get(this.element,"font-size"),"fontWeight":hui.style.get(this.element,"font-weight"),"color":hui.style.get(this.element,"color")}},cancel:function(){this.deactivate();this.element.innerHTML=this.value},save:function(){this.deactivate();var A=this.editor.getValue();if(A!=this.value){this.value=A;hui.ui.Editor.get().partChanged(this)}this.element.innerHTML=this.value},deactivate:function(){if(this.editor){this.editor.destroy();this.element.innerHTML=this.value}hui.ui.Editor.get().partDidDeacivate(this)},richTextDidChange:function(){},getValue:function(){return this.value}};hui.ui.Menu=function(A){this.options=hui.override({autoHide:false,parentElement:null},A);this.element=hui.get(A.element);this.name=A.name;this.value=null;this.subMenus=[];this.visible=false;hui.ui.extend(this);this._addBehavior()};hui.ui.Menu.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_menu"});var B=new hui.ui.Menu(A);document.body.appendChild(A.element);return B};hui.ui.Menu.prototype={_addBehavior:function(){this.hider=function(){this.hide();this.fire("cancel")}.bind(this);if(this.options.autoHide){var A=function(B){if(!hui.ui.isWithin(B,this.element)&&(!this.options.parentElement||!hui.ui.isWithin(B,this.options.parentElement))){if(!this._isSubMenuVisible()){this.hide()}}}.bind(this);hui.listen(this.element,"mouseout",A);if(this.options.parentElement){hui.listen(this.options.parentElement,"mouseout",A)}}},addDivider:function(){hui.build("div",{"class":"hui_menu_divider",parent:this.element})},addItem:function(D){var A=this;var B=hui.build("div",{"class":"hui_menu_item",text:D.title||D.text});hui.listen(B,"click",function(E){hui.stop(E);A._onItemClick(D.value)});if(D.children&&D.children.length>0){var C=hui.ui.Menu.create({autoHide:true,parentElement:B});C.addItems(D.children);hui.listen(B,"mouseover",function(E){C.showAtElement(B,E,"horizontal")});A.subMenus.push(C);hui.cls.add(B,"hui_menu_item_children");C.listen({$select:function(E){A.hide();A.fire("select",E)}})}this.element.appendChild(B)},addItems:function(A){for(var B=0;B<A.length;B++){if(A[B]==null){this.addDivider()}else{this.addItem(A[B])}}},getValue:function(){return this.value},_onItemClick:function(A){this.value=A;this.fire("itemWasClicked",A);this.fire("select",A);this.hide()},showAtPointer:function(A){A=hui.event(A);A.stop();this.showAtPoint({"top":A.getTop(),"left":A.getLeft()})},showAtElement:function(C,D,B){D=hui.event(D);D.stop();C=hui.get(C);var A=hui.position.get(C);if(B=="horizontal"){A.left+=C.clientWidth}else{if(B=="vertical"){A.top+=C.clientHeight}}this.showAtPoint(A)},showAtPoint:function(H){var F=hui.window.getViewWidth();var A=hui.window.getViewHeight();var C=hui.window.getScrollTop();var E=hui.window.getScrollLeft();if(!this.visible){hui.style.set(this.element,{"display":"block","visibility":"hidden",opacity:0})}var B=this.element.clientWidth;var I=this.element.clientHeight;var D=Math.min(H.left,F-B-26+E);var G=Math.max(0,Math.min(H.top,A-I-20+C));hui.style.set(this.element,{"top":G+"px","left":D+"px","visibility":"visible",zIndex:hui.ui.nextTopIndex()});if(!this.element.style.width){this.element.style.width=(B+6)+"px"}if(!this.visible){hui.style.set(this.element,{opacity:1});this._addHider();this.visible=true}},hide:function(A){if(!this.visible){return }if(true||A&&A.immediate){this.element.style.display="none"}else{hui.animate(this.element,"opacity",0,200,{onComplete:function(){this.element.style.display="none"}.bind(this)})}this._removeHider();for(var B=0;B<this.subMenus.length;B++){this.subMenus[B].hide()}this.visible=false;this.fire("hide")},isVisible:function(){return this.visible},_isSubMenuVisible:function(){for(var A=0;A<this.subMenus.length;A++){if(this.subMenus[A].visible){return true}}return false},_addHider:function(){hui.listen(document.body,"click",this.hider)},_removeHider:function(){hui.unListen(document.body,"click",this.hider)}};hui.ui.Overlay=function(A){this.options=A;this.element=hui.get(A.element);this.content=hui.get.byClass(this.element,"hui_inner_overlay")[1];this.name=A.name;this.icons={};this.visible=false;hui.ui.extend(this);this._addBehavior()};hui.ui.Overlay.create=function(A){A=A||{};var B=A.element=hui.build("div",{className:"hui_overlay"+(A.variant?" hui_overlay_"+A.variant:""),style:"display:none",html:'<div class="hui_inner_overlay"><div class="hui_inner_overlay"></div></div>'});document.body.appendChild(B);return new hui.ui.Overlay(A)};hui.ui.Overlay.prototype={_addBehavior:function(){var A=this},addIcon:function(C,D){var A=this;var B=hui.build("div",{className:"hui_overlay_icon"});B.style.backgroundImage="url("+hui.ui.getIconUrl(D,32)+")";hui.listen(B,"click",function(E){A._iconWasClicked(C,E)});this.icons[C]=B;this.content.appendChild(B)},addText:function(A){this.content.appendChild(hui.build("span",{"class":"hui_overlay_text",text:A}))},add:function(A){this.content.appendChild(A.getElement())},hideIcons:function(B){for(var A=0;A<B.length;A++){this.icons[B[A]].style.display="none"}},showIcons:function(B){for(var A=0;A<B.length;A++){this.icons[B[A]].style.display=""}},_iconWasClicked:function(A,B){hui.ui.callDelegates(this,"iconWasClicked",A,B)},showAtElement:function(B,A){A=A||{};hui.ui.positionAtElement(this.element,B,A);if(A.autoHide){this._autoHide(B)}if(this.visible){return }if(hui.browser.msie){this.element.style.display="block"}else{hui.style.set(this.element,{display:"block",opacity:0});hui.animate(this.element,"opacity",1,150)}var C=hui.ui.nextAlertIndex();if(this.options.modal){this.element.style.zIndex=hui.ui.nextAlertIndex();hui.ui.showCurtain({widget:this,zIndex:C})}else{this.element.style.zIndex=C}this.visible=true},_autoHide:function(A){hui.cls.add(A,"hui_overlay_bound");hui.unListen(document.body,"mousemove",this._hider);this._hider=function(B){if(!hui.ui.isWithin(B,A)&&!hui.ui.isWithin(B,this.element)){try{hui.unListen(document.body,"mousemove",this._hider);hui.cls.remove(A,"hui_overlay_bound");this.hide()}catch(B){hui.log("unable to stop listening: document="+document)}}}.bind(this);hui.listen(document.body,"mousemove",this._hider)},show:function(A){A=A||{};if(!this.visible){hui.style.set(this.element,{"display":"block",visibility:"hidden"})}if(A.element){hui.position.place({source:{element:this.element,vertical:0,horizontal:0.5},target:{element:A.element,vertical:0.5,horizontal:0.5},insideViewPort:true,viewPartMargin:9})}if(A.autoHide&&A.element){this._autoHide(A.element)}if(this.visible){return }hui.effect.bounceIn({element:this.element});this.visible=true;if(this.options.modal){var B=hui.ui.nextAlertIndex();this.element.style.zIndex=B+1;hui.ui.showCurtain({widget:this,zIndex:B,color:"auto"})}},$curtainWasClicked:function(){this.hide()},hide:function(){hui.ui.hideCurtain(this);this.element.style.display="none";this.visible=false},clear:function(){hui.ui.destroyDescendants(this.content);this.content.innerHTML=""}};hui.ui.Upload=function(A){this.options=hui.override({url:"",parameters:{},multiple:false,maxSize:"20480",types:"*.*",fieldName:"file",chooseButton:"Choose files..."},A);this.element=hui.get(A.element);this.itemContainer=hui.get.firstByClass(this.element,"hui_upload_items");this.status=hui.get.firstByClass(this.element,"hui_upload_status");this.placeholder=hui.get.firstByClass(this.element,"hui_upload_placeholder");this.name=A.name;this.items=[];this.busy=false;this._chooseImplementation();hui.ui.extend(this);this._addBehavior()};hui.ui.Upload.implementations=["Frame","HTML5","Flash"];hui.ui.Upload.nameIndex=0;hui.ui.Upload.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_upload",html:'<div class="hui_upload_items"></div><div class="hui_upload_status"></div>'+(A.placeholder?'<div class="hui_upload_placeholder"><span class="hui_upload_icon"></span>'+(A.placeholder.title?"<h2>"+hui.string.escape(A.placeholder.title)+"</h2>":"")+(A.placeholder.text?"<p>"+hui.string.escape(A.placeholder.text)+"</p>":"")+"</div>":"")});return new hui.ui.Upload(A)};hui.ui.Upload.prototype={setParameter:function(A,B){this.options.parameters[A]=B;this.impl.setParameter(A,B)},clear:function(){for(var A=0;A<this.items.length;A++){if(this.items[A]){this.items[A].destroy()}}this.items=[];this.itemContainer.style.display="none";this.status.style.display="none";if(this.placeholder){this.placeholder.style.display="block"}},addDropTarget:function(A){if(A.element){hui.drag.listen({element:A.element,hoverClass:A.hoverClass,$dropFiles:function(B){if(A.$drop){A.$drop()}this._transferFiles(B)}.bind(this)})}},uploadFiles:function(A){this._transferFiles(A)},_chooseImplementation:function(){var D=hui.ui.Upload.implementations;if(this.options.implementation){D.splice(0,0,this.options.implementation)}for(var B=0;B<D.length;B++){var A=hui.ui.Upload[D[B]];var C=A.support();if(C.supported){if(!this.options.multiple&&!C.multiple){this.impl=new A(this);hui.log("Selected impl (single): "+D[B]);break}else{if(this.options.multiple&&C.multiple){this.impl=new A(this);hui.log("Selected impl (multiple): "+D[B]);break}}}}if(!this.impl){hui.log("No implementation found, using frame");this.impl=new hui.ui.Upload.Frame(this)}},_addBehavior:function(){if(!this.impl.initialize){alert(this.impl);return }hui.ui.onReady(function(){this.impl.initialize();hui.drag.listen({element:this.element,hoverClass:"hui_upload_drop",$dropFiles:this._transferFiles.bind(this)})}.bind(this))},_transferFiles:function(C){if(C.length>0){if(!this.options.multiple){this._transferFile(C[0])}else{for(var B=0;B<C.length;B++){var A=C[B];this._transferFile(A)}}}},_transferFile:function(A){hui.log(A);var B=this.$_addItem({name:A.name,size:A.size});hui.request({method:"post",file:A,url:this.options.url,parameters:this.options.parameters,onProgress:function(D,C){B.updateProgress(D,C)},onLoad:function(){hui.log("transferFile: load")},onAbort:function(){this.$_itemFail(B);B.setError("Afbrudt")}.bind(this),onSuccess:function(C){hui.log("transferFile: success");B.data.request=C;this.$_itemSuccess(B)}.bind(this),onFailure:function(){hui.log("transferFile: fail");this.$_itemFail(B)}.bind(this)})},$_addItem:function(A){if(!this.busy){this.fire("uploadDidStartQueue");this.status.style.display="block";this._setWidgetEnabled(false);this.busy=true}return this._addItem(A)},$_itemSuccess:function(D){var E=hui.get.firstByClass(this.itemContainer,"hui_upload_item_success");D.setProgress(1);D.setSuccess();this.fire("uploadDidComplete",D.getInfo());this._checkQueue();var B=E!=null||this.items.length>1;B=B&&D.element.nextSibling!=null;if(B&&(E==null||E!=D.element.nextSibling)){var C=D.element.parentNode;var A=D.element.clientHeight;hui.animate({node:D.element,css:{height:"0px"},ease:hui.ease.slowFastSlow,duration:500,onComplete:function(){C.removeChild(D.element);if(E){C.insertBefore(D.element,E)}else{C.appendChild(D.element)}hui.animate({node:D.element,css:{height:A+"px"},ease:hui.ease.slowFastSlow,duration:200})}})}},$_itemFail:function(A){A.setError("Upload af filen fejlede!");this.fire("uploadDidFail",A.getInfo());this._checkQueue()},$_getButtonContainer:function(){var B=hui.build("span",{"class":"hui_upload_button"});if(this.options.widget){var A=hui.ui.get(this.options.widget);A.element.parentNode.insertBefore(B,A.element);A.element.parentNode.removeChild(A.element);B.appendChild(A.element)}else{B.innerHTML='<a href="javascript:void(0);" class="hui_button"><span><span>'+this.options.chooseButton+"</span></span></a>";this.element.appendChild(B)}return B},_setWidgetEnabled:function(B){if(this.options.widget){var A=hui.ui.get(this.options.widget);if(A&&A.setEnabled){A.setEnabled(B)}}},_checkQueue:function(){for(var A=0;A<this.items.length;A++){if(!this.items[A].isFinished()){return }}this.busy=false;this._setWidgetEnabled(true);this.fire("uploadDidCompleteQueue")},_addItem:function(C){var A=C.index;if(A===undefined){A=this.items.length;C.index=A}var B=A>4;var D=new hui.ui.Upload.Item(C,B);this.items[A]=D;var E=hui.get.firstByClass(this.itemContainer,"hui_upload_item_success");if(E){this.itemContainer.insertBefore(D.element,E)}else{this.itemContainer.appendChild(D.element)}this.itemContainer.style.display="block";if(this.placeholder){this.placeholder.style.display="none"}return D}};hui.ui.Upload.Item=function(B,A){this.data=B;this.rearrange=A;this.element=hui.build("div",{className:"hui_upload_item"});this.element.appendChild(hui.ui.createIcon("file/generic",32));this.content=hui.build("div",{className:"hui_upload_item_content",parent:this.element});this.progress=hui.ui.ProgressBar.create({small:true});this.content.appendChild(this.progress.getElement());var C=hui.build("p",{parent:this.content});this.info=hui.build("strong",{parent:C});this.status=hui.build("em",{parent:C});if(B.name){hui.dom.setText(this.info,B.name)}this.finished=false;this.error=false};hui.ui.Upload.Item.prototype={getInfo:function(){return this.data},isFinished:function(){return this.finished},setError:function(A){this._setStatus(A||hui.ui.getTranslated({en:"Error",da:"Fejl"}));hui.cls.add(this.element,"hui_upload_item_error");this.progress.hide();this.progress.setValue(0);this.finished=true},setSuccess:function(A){this._setStatus(hui.ui.getTranslated({en:"Complete",da:"Færdig"}));this.progress.setValue(1);this.finished=true;hui.cls.add(this.element,"hui_upload_item_success")},updateProgress:function(A,B){this.setProgress(A/B);return this},setProgress:function(A){this._setStatus(hui.ui.getTranslated({en:"Transfering",da:"Overfører"}));this.progress.setValue(Math.min(0.9999,A));return this},setWaiting:function(){this._setStatus("Venter");this.progress.setWaiting();return this},hide:function(){this.element.hide()},destroy:function(){hui.dom.remove(this.element)},_setStatus:function(A){if(this._status!==A){hui.dom.setText(this.status,A);this._status=A}}};hui.ui.Upload._nameIndex=0;hui.ui.Upload._buildForm=function(F){var B=F.options;hui.ui.Upload._nameIndex++;var A="hui_upload_"+hui.ui.Upload.Frame.nameIndex;var D=hui.build("form");D.setAttribute("action",B.url||"");D.setAttribute("method","post");D.setAttribute("enctype","multipart/form-data");D.setAttribute("encoding","multipart/form-data");D.setAttribute("target",A);if(B.parameters){for(var C in B.parameters){var E=hui.build("input",{"type":"hidden","name":C});E.value=B.parameters[C];D.appendChild(E)}}return D};hui.ui.Upload.Frame=function(A){this.parent=A};hui.ui.Upload.Frame.support=function(){return{supported:true,multiple:false}};hui.ui.Upload.Frame.prototype={initialize:function(){var B=this.parent.options;var E=this.form=hui.ui.Upload._buildForm(this.parent);var A=E.getAttribute("target");var D=this.iframe=hui.build("iframe",{name:A,id:A,src:hui.ui.context+"/hui/html/blank.html",style:"display:none"});this.parent.element.appendChild(D);hui.listen(this.iframe,"load",function(){this._uploadComplete()}.bind(this));this.fileInput=hui.build("input",{"type":"file","name":B.fieldName});hui.listen(this.fileInput,"change",this._onSubmit.bind(this));E.appendChild(this.fileInput);var C=hui.build("span",{"class":"hui_upload_button_input"});C.appendChild(E);var F=this.parent.$_getButtonContainer();F.insertBefore(C,F.firstChild)},setParameter:function(A,D){var C=this.form.getElementsByTagName("input");for(var B=0;B<C.length;B++){if(C[B].name==A){C[B].value=D;return }}hui.build("input",{"type":"hidden","name":A,"value":D,parent:this.form})},_rebuildParameters:function(){if(hui.browser.msie){hui.each(this.parent.options.parameters,function(A,B){this.form[A].value=B}.bind(this))}},_rebuildFileInput:function(){var B=this.parent.options;var A=this.fileInput;this.fileInput=hui.build("input",{"type":"file","name":B.fieldName});hui.listen(this.fileInput,"change",this._onSubmit.bind(this));hui.dom.replaceNode(A,this.fileInput);hui.log("Frame: input replaced")},_getFileName:function(){return this.fileInput.value.split("\\").pop()},_onSubmit:function(){this.form.style.display="none";this.uploading=true;this._rebuildParameters();this.form.submit();this.item=this.parent.$_addItem({name:this._getFileName()});this.item.setWaiting();this._rebuildFileInput();hui.log("Frame: Upload started")},_uploadComplete:function(){if(!this.uploading){return }this.uploading=false;var B=this._isSuccessResponse();hui.log("Frame: Upload complete: success="+B);var A=this.item;if(A){if(B){this.parent.$_itemSuccess(A);hui.log("Frame: Upload succeeded")}else{this.parent.$_itemFail(A);hui.log("Frame: Upload failed!")}}this.iframe.src=hui.ui.context+"/hui/html/blank.html";this.form.style.display="block";this.form.reset()},_isSuccessResponse:function(){var A=hui.frame.getDocument(this.iframe);return A.body.innerHTML.indexOf("SUCCESS")!==-1}};hui.ui.Upload.Flash=function(A){this.parent=A;this.items=[]};hui.ui.Upload.Flash.support=function(){if(hui.browser.chrome){}return{supported:hui.ui.Flash.getMajorVersion()>=10&&window.SWFUpload!==undefined,multiple:true}};hui.ui.Upload.Flash.prototype={initialize:function(){var E=this.parent.options;hui.log("Creating flash verison");var D=this._getAbsoluteUrl(E.url);var B=hui.cookie.get("JSESSIONID");if(B){D+=";jsessionid="+B}var F=hui.cookie.get("PHPSESSID");if(F){D+="?PHPSESSID="+F}var C=hui.build("span",{"class":"hui_upload_button"});var G=hui.build("span",{"class":"hui_upload_button_object",parent:C});if(E.widget){var A=hui.ui.get(E.widget);A.element.parentNode.insertBefore(C,A.element);A.element.parentNode.removeChild(A.element);C.appendChild(A.element)}else{C.innerHTL='<a href="javascript:void(0);" class="hui_button"><span><span>'+E.chooseButton+"</span></span></a>";this.parent.element.appendChild(C)}this.loader=new SWFUpload({upload_url:D,flash_url:hui.ui.context+"/hui/lib/swfupload/swfupload.swf",file_size_limit:E.maxSize,file_queue_limit:E.maxItems,file_post_name:E.fieldName,file_upload_limit:E.maxItems,file_types:E.types,debug:!true,post_params:E.parameters,button_placeholder_id:"x",button_placeholder:G,button_width:"100%",button_height:30,swfupload_loaded_handler:this._onFlashLoaded.bind(this),file_queued_handler:this._onFileQueued.bind(this),file_queue_error_handler:this._onFileQueueError.bind(this),file_dialog_complete_handler:this._onFileDialogComplete.bind(this),upload_start_handler:this._onUploadStart.bind(this),upload_progress_handler:this._onUploadProgress.bind(this),upload_error_handler:this._onUploadError.bind(this),upload_success_handler:this._onUploadSuccess.bind(this),upload_complete_handler:this._onUploadComplete.bind(this)})},setParameter:function(A,B){hui.log("Flash: Warning: cannot change parameters")},_getAbsoluteUrl:function(B){var C=new String(document.location);var A=C.slice(0,C.lastIndexOf("/"));while(B.indexOf("../")===0){B=B.substring(3);A=A.slice(0,A.lastIndexOf("/"))}A+="/"+B;return A},_onFlashLoaded:function(){hui.log("Flash loaded")},_onFileQueued:function(A){var B=this.parent.$_addItem({name:A.name,size:A.size});B.setWaiting();this.items.push(B)},_onFileQueueError:function(B,A,D){hui.log("Flash: fileQueueError file:"+hui.string.toJSON(B)+", error:"+A+", message:"+D);if(B!==null){var C=this.parent.$_addItem({name:B.name,size:B.size});this.items.push(C);this.parent.$_itemFail(C);C.setError(hui.ui.Upload.Flash.errors[A])}else{hui.ui.showMessage({text:hui.ui.Upload.Flash.errors[A],duration:4000})}},_onFileDialogComplete:function(){hui.log("Flash: fileDialogComplete");this.loader.startUpload()},_onUploadStart:function(){},_onUploadProgress:function(B,A,D){var C=this.items[B.index];C.updateProgress(A,D)},_onUploadError:function(B,A,D){hui.log("Flash: uploadError file:"+B+", error:"+A+", message:"+D);if(B){var C=this.items[B.index];this.parent.$_itemFail(C);C.setError(hui.ui.Upload.Flash.errors[A])}},_onUploadSuccess:function(A,C){var B=this.items[A.index];B.updateProgress(A.size,A.size);this.parent.$_itemSuccess(B)},_onUploadComplete:function(A){this.loader.startUpload()}};!(function(){var B=hui.ui.Upload.Flash.errors={};var A=hui.ui.Upload.Flash.status={};if(window.SWFUpload){B[SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED]="Der er valgt for mange filer";B[SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT]="Filen er for stor";B[SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE]="Filen er tom";B[SWFUpload.QUEUE_ERROR.INVALID_FILETYPE]="Filens type er ikke understøttet";B[SWFUpload.UPLOAD_ERROR.HTTP_ERROR]="Der skete en netværksfejl";B[SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL]="Upload-adressen findes ikke";B[SWFUpload.UPLOAD_ERROR.IO_ERROR]="Der skete en IO-fejl";B[SWFUpload.UPLOAD_ERROR.SECURITY_ERROR]="Der skete en sikkerhedsfejl";B[SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED]="Upload-størrelsen er overskredet";B[SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED]="Upload af filen fejlede";B[SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND]="Filens id kunne ikke findes";B[SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED]="Validering af filen fejlede";B[SWFUpload.UPLOAD_ERROR.FILE_CANCELLED]="Filen blev afbrudt";B[SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED]="Upload af filen blev stoppet";A[SWFUpload.FILE_STATUS.QUEUED]="I kø";A[SWFUpload.FILE_STATUS.IN_PROGRESS]="I gang";A[SWFUpload.FILE_STATUS.ERROR]="Filen gav fejl";A[SWFUpload.FILE_STATUS.COMPLETE]="Færdig";A[SWFUpload.FILE_STATUS.CANCELLED]="Afbrudt"}})();hui.ui.Upload.HTML5=function(A){this.parent=A};hui.ui.Upload.HTML5.support=function(){var A=window.File!==undefined&&(hui.browser.webkit||hui.browser.gecko);hui.log("HTML5: supported="+A);return{supported:A,multiple:true}};hui.ui.Upload.HTML5.prototype={initialize:function(){var A=this.parent.options;var B=hui.build("span",{"class":"hui_upload_button_input"});this.fileInput=hui.build("input",{"type":"file","name":A.fieldName,"multiple":"multiple",parent:B});var C=this.parent.$_getButtonContainer();C.insertBefore(B,C.firstChild);hui.listen(this.fileInput,"change",this._submit.bind(this))},_submit:function(B){var A=this.fileInput.files;this.parent._transferFiles(A)}};hui.ui.ProgressBar=function(A){this.element=hui.get(A.element);this.name=A.name;this.WAITING=A.small?"hui_progressbar_small_waiting":"hui_progressbar_waiting";this.COMPLETE=A.small?"hui_progressbar_small_complete":"hui_progressbar_complete";this.options=A||{};this.indicator=hui.get.firstByTag(this.element,"div");hui.ui.extend(this)};hui.ui.ProgressBar.create=function(B){B=B||{};var A=B.element=hui.build("div",{"class":B.small?"hui_progressbar hui_progressbar_small":"hui_progressbar"});A.appendChild(document.createElement("div"));return new hui.ui.ProgressBar(B)};hui.ui.ProgressBar.prototype={setValue:function(B){var A=this.element;if(this.waiting){hui.cls.remove(A,this.WAITING)}hui.cls.set(A,this.COMPLETE,B==1);hui.animate(this.indicator,"width",(B*100)+"%",200)},setWaiting:function(){this.waiting=true;this.indicator.style.width=0;hui.cls.add(this.element,this.WAITING)},reset:function(){var A=this.element;if(this.waiting){hui.cls.remove(A,this.WAITING)}hui.cls.remove(A,this.COMPLETE);this.indicator.style.width="0%"},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block"}};hui.ui.Gallery=function(A){this.options=A||{};this.name=A.name;this.element=hui.get(A.element);this.body=hui.get.firstByClass(this.element,"hui_gallery_body");this.objects=[];this.nodes=[];this.selected=[];this.width=100;this.height=100;this.revealing=false;hui.ui.extend(this);if(A.dropFiles){this._addDrop()}if(this.options.source){this.options.source.listen(this)}if(this.element.parentNode&&hui.cls.has(this.element.parentNode,"hui_overflow")){this.revealing=true;hui.listen(this.element.parentNode,"scroll",this._reveal.bind(this))}};hui.ui.Gallery.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_gallery",html:'<div class="hui_gallery_progress"></div><div class="hui_gallery_body"></div>'});return new hui.ui.Gallery(A)};hui.ui.Gallery.prototype={_addDrop:function(){hui.drag.listen({element:this.element,hoverClass:"hui_gallery_drop",$dropFiles:function(A){this.fire("filesDropped",A)}.bind(this),$dropURL:function(A){this.fire("urlDropped",A)}.bind(this)})},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="";if(this.options.source){this.options.source.refresh()}},setSize:function(C){this.width=C;this.height=C;for(var B=0;B<this.nodes.length;B++){var E=this.nodes[B];var F=this.objects[B];E.style.width=C+"px";E.style.height=C+"px";var A=hui.get.firstChild(E);if(A.height&&A.width){var D=this._findSize(F,C);hui.style.set(A,{width:D.width+"px",height:D.height+"px",marginTop:((C-D.height)/2)+"px"})}}},_findSize:function(C,A){var B={width:A,height:A};if(C.width>C.height){B.height=C.height/C.width*A}if(C.width<C.height){B.width=C.width/C.height*A}return B},reRender:function(){this._render()},setObjects:function(A){this.selected=[];this.objects=A;this._render();this.fire("selectionReset")},getObjects:function(){return this.objects},$sourceShouldRefresh:function(){return this.element.style.display!="none"},$objectsLoaded:function(A){this.setObjects(A)},$itemsLoaded:function(A){this.setObjects(A)},_render:function(){this.nodes=[];this.maxRevealed=0;this.body.innerHTML="";hui.each(this.objects,function(C,D){var B=this._resolveImageUrl(C),F=0;if(B!==null){B=B.replace(/&amp;/,"&")}if(!this.revealing&&C.height<C.width){F=(this.height-(this.height*C.height/C.width))/2}var A=hui.build("img",{style:"margin:"+F+"px auto 0px"});A.setAttribute(this.revealing?"data-src":"src",B);var E=hui.build("div",{"class":"hui_gallery_item",style:"width:"+this.width+"px; height:"+this.height+"px"});E.appendChild(A);hui.listen(E,"click",function(G){this._itemClicked(D,G)}.bind(this));E.dragDropInfo={kind:"image",icon:"common/image",id:C.id,title:C.name||C.title};E.onmousedown=function(G){hui.ui.startDrag(G,E);return false};hui.listen(E,"dblclick",function(){this._onItemDoubleClick(D)}.bind(this));this.body.appendChild(E);this.nodes.push(E)}.bind(this));this._reveal();this.fireSizeChange()},_reveal:function(){if(!this.revealing){return }var C=this.element.parentNode;var B=C.scrollTop+C.clientHeight;if(B<=this.maxRevealed){return }this.maxRevealed=B;for(var F=0,A=this.nodes.length;F<A;F++){var G=this.nodes[F];if(G.revealed){continue}if(G.offsetTop<B){var E=G.getElementsByTagName("img")[0];G.className="hui_gallery_item hui_gallery_item_busy";var D=this;E.onload=function(){hui.defer(function(){this.parentNode.className="hui_gallery_item";if(this.height<this.width){var H=(D.height-(D.height*this.height/this.width))/2;this.style.marginTop=H+"px"}},this)};E.onerror=function(){this.parentNode.className="hui_gallery_item hui_gallery_item_error"};E.src=E.getAttribute("data-src");G.revealed=true}}},_updateUI:function(){var B=this.selected;for(var A=0;A<this.nodes.length;A++){hui.cls.set(this.nodes[A],"hui_gallery_item_selected",hui.array.contains(B,A))}},_resolveImageUrl:function(A){return hui.ui.resolveImageUrl(this,A,this.width,this.height);for(var B=0;B<this.delegates.length;B++){if(this.delegates[B]["$resolveImageUrl"]){return this.delegates[B]["$resolveImageUrl"](A,this.width,this.height)}}return""},_itemClicked:function(A,B){if(this.busy){return }B=hui.event(B);if(B.metaKey){hui.array.flip(this.selected,A)}else{this.selected=[A]}this.fire("select",this.selected);this._updateUI()},isOneSelection:function(){return this.selected.length==1},getSelectionSize:function(){return this.selected.length},getSelection:function(){var B=[];for(var A=0;A<this.selected.length;A++){var C=this.objects[this.selected[A]];if(C){B.push(C)}}return B},getSelectionIds:function(){var B=[];for(var A=0;A<this.selected.length;A++){var C=this.objects[this.selected[A]];if(C){B.push(C.id)}}return B},getFirstSelection:function(){if(this.selected.length>0){return this.objects[this.selected[0]]}return null},_onItemDoubleClick:function(A){if(this.busy){return }this.fire("itemOpened",this.objects[A])},setSource:function(A){if(this.options.source!=A){if(this.options.source){this.options.source.unListen(this)}A.listen(this);this.options.source=A;A.refresh()}},$sourceIsBusy:function(){this._setBusy(true)},$sourceIsNotBusy:function(){this._setBusy(false)},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){this._reveal()}},$$layout:function(){if(this.nodes.length>0){this._reveal()}},_setBusy:function(A){this.busy=A;window.clearTimeout(this.busytimer);if(A){var B=this.element;this.busytimer=window.setTimeout(function(){hui.cls.add(B,"hui_gallery_busy")},300)}else{hui.cls.remove(this.element,"hui_gallery_busy")}}};hui.ui.Calendar=function(A){this.name=A.name;this.options=hui.override({startHour:7,endHour:24},A);this.element=hui.get(A.element);this.head=hui.get.firstByTag(this.element,"thead");this.body=hui.get.firstByTag(this.element,"tbody");this.date=new Date();hui.ui.extend(this);this.buildUI();this.updateUI();if(this.options.source){this.options.source.listen(this)}};hui.ui.Calendar.prototype={show:function(){this.element.style.display="block";if(this.options.source){this.options.source.refresh()}},hide:function(){this.element.style.display="none"},getFirstDay:function(){var A=new Date(this.date.getTime());A.setDate(A.getDate()-A.getDay()+1);A.setHours(0);A.setMinutes(0);A.setSeconds(0);return A},getLastDay:function(){var A=new Date(this.date.getTime());A.setDate(A.getDate()-A.getDay()+7);A.setHours(23);A.setMinutes(59);A.setSeconds(59);return A},clearEvents:function(){this.events=[];var A=hui.get.byClass(this.element,"hui_calendar_event");for(var B=0;B<A.length;B++){hui.dom.remove(A[B])}this.hideEventViewer()},$objectsLoaded:function(A){try{this.setEvents(A)}catch(B){hui.log(B)}},$sourceIsBusy:function(){this.setBusy(true)},$sourceShouldRefresh:function(){return this.element.style.display!="none"},setEvents:function(D){D=D||[];for(var C=0;C<D.length;C++){var F=D[C];if(typeof (F.startTime)!="object"){F.startTime=new Date(parseInt(F.startTime)*1000)}if(typeof (F.endTime)!="object"){F.endTime=new Date(parseInt(F.endTime)*1000)}}this.setBusy(false);this.clearEvents();this.events=D;var A=this;var G=(this.options.endHour-this.options.startHour)*40;var B=this.getFirstDay().getWeekOfYear();var E=this.getFirstDay().getYear();hui.each(this.events,function(L){var I=hui.get.byClass(A.body,"hui_calendar_day")[L.startTime.getDay()-1];if(!I){return }if(L.startTime.getWeekOfYear()!=B||L.startTime.getYear()!=E){return }var K=hui.build("div",{"class":"hui_calendar_event",parent:I});var M=((L.startTime.getHours()*60+L.startTime.getMinutes())/60-A.options.startHour)*40-1;var H=(L.endTime.getTime()-L.startTime.getTime())/1000/60/60*40+1;H=Math.min(G-M,H);hui.style.set(K,{"marginTop":M+"px","height":H+"px",visibility:"hidden"});var J=hui.build("div",{parent:K});hui.build("p",{"class":"hui_calendar_event_time",text:L.startTime.dateFormat("H:i"),parent:J});hui.build("p",{"class":"hui_calendar_event_text",text:L.text,parent:J});if(L.location){hui.build("p",{"class":"hui_calendar_event_location",text:L.location,parent:J})}window.setTimeout(function(){hui.effect.bounceIn({element:K})},Math.random()*200);hui.listen(K,"click",function(){A.eventWasClicked(K)})})},eventWasClicked:function(A){this.showEvent(A)},setBusy:function(A){hui.cls.set(this.element,"hui_calendar_busy",A)},updateUI:function(){var C=this.getFirstDay();var D=hui.get.byClass(this.head,"day");for(var B=0;B<D.length;B++){var A=new Date(C.getTime());A.setDate(A.getDate()+B);hui.dom.setText(D[B],A.dateFormat("l \\d. d M"))}},buildUI:function(){var F=hui.get.firstByClass(this.element,"hui_calendar_bar");this.toolbar=hui.ui.Toolbar.create({labels:false});F.appendChild(this.toolbar.getElement());var E=hui.ui.Button.create({name:"huiCalendarPrevious",text:"",icon:"monochrome/previous"});E.listen(this);this.toolbar.add(E);var A=hui.ui.Button.create({name:"huiCalendarToday",text:"Idag"});A.click(function(){this.setDate(new Date())}.bind(this));this.toolbar.add(A);var C=hui.ui.Button.create({name:"huiCalendarNext",text:"",icon:"monochrome/next"});C.listen(this);this.toolbar.add(C);this.datePickerButton=hui.ui.Button.create({name:"huiCalendarDatePicker",text:"Vælg dato..."});this.datePickerButton.listen(this);this.toolbar.add(this.datePickerButton);var G=hui.get.firstByClass(this.body,"hui_calendar_day");for(var B=this.options.startHour;B<=this.options.endHour;B++){var D=hui.build("div",{"class":"hui_calendar_time",html:"<span><em>"+B+":00</em></span>"});if(B==this.options.startHour){hui.cls.add(D,"hui_calendar_time_first")}if(B==this.options.endHour){hui.cls.add(D,"hui_calendar_time_last")}G.appendChild(D)}},$click$huiCalendarPrevious:function(){var A=new Date(this.date.getTime());A.setDate(this.date.getDate()-7);this.setDate(A)},$click$huiCalendarNext:function(){var A=new Date(this.date.getTime());A.setDate(this.date.getDate()+7);this.setDate(A)},setDate:function(A){this.date=new Date(A.getTime());this.updateUI();this.refresh();if(this.datePicker){this.datePicker.setValue(this.date)}},$click$huiCalendarDatePicker:function(){this.showDatePicker()},refresh:function(){this.clearEvents();this.setBusy(true);var A={"startTime":this.getFirstDay(),"endTime":this.getLastDay()};this.fire("calendarSpanChanged",A);hui.ui.firePropertyChange(this,"startTime",this.getFirstDay());hui.ui.firePropertyChange(this,"endTime",this.getLastDay())},valueForProperty:function(A){if(A=="startTime"){return this.getFirstDay()}if(A=="endTime"){return this.getLastDay()}return this[A]},showDatePicker:function(){if(!this.datePickerPanel){this.datePickerPanel=hui.ui.BoundPanel.create();this.datePicker=hui.ui.DatePicker.create({name:"huiCalendarDatePicker",value:this.date});this.datePicker.listen(this);this.datePickerPanel.add(this.datePicker);this.datePickerPanel.addSpace(3);var A=hui.ui.Button.create({name:"huiCalendarDatePickerClose",text:"Luk",small:true,rounded:true});A.listen(this);this.datePickerPanel.add(A)}this.datePickerPanel.position(this.datePickerButton.getElement());this.datePickerPanel.show()},$click$huiCalendarDatePickerClose:function(){this.datePickerPanel.hide()},$dateChanged$huiCalendarDatePicker:function(A){this.setDate(A)},showEvent:function(B){if(!this.eventViewerPanel){this.eventViewerPanel=hui.ui.BoundPanel.create({width:270,padding:3});this.eventInfo=hui.ui.InfoView.create(null,{height:240,clickObjects:true});this.eventViewerPanel.add(this.eventInfo);this.eventViewerPanel.addSpace(5);var A=hui.ui.Button.create({name:"huiCalendarEventClose",text:"Luk"});A.listen(this);this.eventViewerPanel.add(A)}this.eventInfo.clear();this.eventInfo.setBusy(true);this.eventViewerPanel.position(B);this.eventViewerPanel.show();hui.ui.callDelegates(this,"requestEventInfo");return },updateEventInfo:function(A,B){this.eventInfo.setBusy(false);this.eventInfo.update(B)},$click$huiCalendarEventClose:function(){this.hideEventViewer()},hideEventViewer:function(){if(this.eventViewerPanel){this.eventViewerPanel.hide()}}};hui.ui.DatePicker=function(A){this.name=A.name;this.element=hui.get(A.element);this.options={};hui.override(this.options,A);this.cells=[];this.title=hui.get.firstByTag(this.element,"strong");this.today=new Date();this.value=this.options.value?new Date(this.options.value.getTime()):new Date();this.viewDate=new Date(this.value.getTime());this.viewDate.setDate(1);hui.ui.extend(this);this._addBehavior();this._updateUI()};hui.ui.DatePicker.create=function(J){var C=J.element=hui.build("div",{"class":"hui_datepicker",html:'<div class="hui_datepicker_header"><a class="hui_datepicker_next"></a><a class="hui_datepicker_previous"></a><strong></strong></div>'}),H=hui.build("table",{parent:C}),F=hui.build("thead",{parent:H}),G=hui.build("tr",{parent:F});for(var D=0;D<7;D++){G.appendChild(hui.build("th",{text:Date.dayNames[D].substring(0,3)}))}var E=hui.build("tbody",{parent:H});for(var B=0;B<6;B++){var I=hui.build("tr",{parent:E});for(var A=0;A<7;A++){hui.build("td",{parent:I})}}return new hui.ui.DatePicker(J)};hui.ui.DatePicker.prototype={_addBehavior:function(){var A=this;this.cells=hui.get.byTag(this.element,"td");hui.each(this.cells,function(D,E){hui.listen(D,"mousedown",function(F){hui.stop(F);A._selectCell(E)})});var B=hui.get.firstByClass(this.element,"hui_datepicker_next");var C=hui.get.firstByClass(this.element,"hui_datepicker_previous");hui.listen(B,"mousedown",function(D){hui.stop(D);A.next()});hui.listen(C,"mousedown",function(D){hui.stop(D);A.previous()})},setValue:function(A){if(!A){A=new Date()}this.value=new Date(A.getTime());this.viewDate=new Date(A.getTime());this.viewDate.setDate(1);this._updateUI()},_updateUI:function(){hui.dom.setText(this.title,this.viewDate.dateFormat("F Y"));var C=this.value.getFullYear()==this.viewDate.getFullYear();var E=this.viewDate.getMonth();for(var D=0;D<this.cells.length;D++){var B=this._indexToDate(D);var A=this.cells[D];if(B.getMonth()<E){A.className="hui_datepicker_dimmed"}else{if(B.getMonth()>E){A.className="hui_datepicker_dimmed"}else{A.className=""}}if(B.getDate()==this.value.getDate()&&B.getMonth()==this.value.getMonth()&&C){hui.cls.add(A,"hui_datepicker_selected")}if(B.getDate()==this.today.getDate()&&B.getMonth()==this.today.getMonth()&&B.getFullYear()==this.today.getFullYear()){hui.cls.add(A,"hui_datepicker_today")}hui.dom.setText(A,B.getDate())}},_getPreviousMonth:function(){var A=new Date(this.viewDate.getTime());A.setMonth(A.getMonth()-1);return A},_getNextMonth:function(){var A=new Date(this.viewDate.getTime());A.setMonth(A.getMonth()+1);return A},previous:function(){this.viewDate=this._getPreviousMonth();this._updateUI()},next:function(){this.viewDate=this._getNextMonth();this._updateUI()},_selectCell:function(A){this.value=this._indexToDate(A);this.viewDate=new Date(this.value.getTime());this.viewDate.setDate(1);this._updateUI();hui.ui.callDelegates(this,"dateChanged",this.value)},_indexToDate:function(B){var D=this.viewDate.getDay(),E=this.viewDate.getDaysInMonth(),C=this._getPreviousMonth().getDaysInMonth(),A;if(B<D){A=this._getPreviousMonth();A.setDate(C-D+B+1)}else{if(B>D+E-1){A=this._getPreviousMonth();A.setDate(B-D-E+1)}else{A=new Date(this.viewDate.getTime());A.setDate(B+1-D)}}return A}};Date.monthNames=["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"];Date.dayNames=["Søndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lørdag"];hui.ui.Layout=function(A){this.name=A.name;this.options=A||{};this.element=hui.get(A.element);hui.ui.extend(this)};hui.ui.Layout.create=function(A){A=hui.override({text:"",highlighted:false,enabled:true},A);A.element=hui.dom.parseToNode('<table class="hui_layout"><tbody class="hui_layout"><tr class="hui_layout_middle"><td class="hui_layout_middle"><table class="hui_layout_middle"><tr><td class="hui_layout_left hui_context_sidebar"><div class="hui_layout_left"></div></td><td class="hui_layout_center"></td></tr></table></td></tr></tbody></table>');return new hui.ui.Layout(A)};hui.ui.Layout.prototype={addToLeft:function(B){var A=hui.get.firstByClass(this.element,"hui_layout_left");A.appendChild(B.element)},addToCenter:function(B){var A=hui.get.firstByClass(this.element,"hui_layout_center");A.appendChild(B.element)},$$layout:function(){if(hui.browser.gecko){var B=hui.get.firstByClass(this.element,"hui_layout_center");if(B){B.style.height="100%"}}if(!window.navigator.userAgent.indexOf("AppleWebKit/536")){if(!hui.browser.msie7&&!hui.browser.msie8&&!hui.browser.msie9){return }}if(!hui.dom.isVisible(this.element)){return }if(this.diff===undefined){var E=hui.get.firstByClass(this.element,"hui_layout_top");var D=hui.get.firstByTag(E,"*").clientHeight;var F=hui.get.firstByTag(hui.get.firstByTag(this.element,"tfoot"),"td");var A=0;if(F){var I=hui.get.firstByTag(F,"*");if(I){A=I.clientHeight}}D+=hui.position.getTop(this.element);this.diff=A+D;if(this.element.parentNode!==document.body){this.diff+=15}else{}}var C=hui.get.firstByTag(this.element,"tbody");var G=hui.get.firstByTag(C,"td");var H=(hui.window.getViewHeight()-this.diff+5);G.style.height=H+"px"}};hui.ui.Dock=function(A){this.options=A;this.element=hui.get(A.element);this.iframe=hui.get.firstByTag(this.element,"iframe");this.progress=hui.get.firstByClass(this.element,"hui_dock_progress");this.resizer=hui.get.firstByClass(this.element,"hui_dock_sidebar_line");this.bar=hui.get.firstByClass(this.element,"hui_dock_bar");hui.listen(this.iframe,"load",this._load.bind(this));this.name=A.name;hui.ui.extend(this);this.busy=true;hui.ui.listen(this);this._addBehavior()};hui.ui.Dock.prototype={_addBehavior:function(){if(this.resizer){this.sidebar=hui.get.firstByClass(this.element,"hui_dock_sidebar");this.main=hui.get.firstByClass(this.element,"hui_dock_sidebar_main");hui.drag.register({element:this.resizer,onStart:function(){this.hasDragged=false;hui.cls.add(this.element,"hui_dock_sidebar_resizing");this._setBusy(true)}.bind(this),onMove:function(B){var A=B.getLeft();if(A<10){A=10}this._updateSidebarWidth(A);if(!this.hasDragged){hui.cls.remove(this.element,"hui_dock_sidebar_collapsed")}this.hasDragged=true}.bind(this),onEnd:function(){this._setBusy(false);if(!this.hasDragged){this.toggle()}else{if(this.latestWidth==10){this.collapse()}else{this.latestExpandedWidth=this.latestWidth}}hui.cls.remove(this.element,"hui_dock_sidebar_resizing");hui.ui.callVisible(this);hui.ui.reLayout()}.bind(this)})}},_updateSidebarWidth:function(A){this.latestWidth=A;this.sidebar.style.width=(A-1)+"px";this.main.style.left=A+"px";this.resizer.style.left=(A-5)+"px"},setUrl:function(A){this._setBusy(true);hui.frame.getDocument(this.iframe).location.href=A},collapse:function(){hui.cls.add(this.element,"hui_dock_sidebar_collapsed");this._updateSidebarWidth(10);hui.ui.callVisible(this)},expand:function(){hui.cls.remove(this.element,"hui_dock_sidebar_collapsed");this._updateSidebarWidth(this.latestExpandedWidth||200);hui.ui.callVisible(this)},toggle:function(){if(hui.cls.has(this.element,"hui_dock_sidebar_collapsed")){this.expand()}else{this.collapse()}},_load:function(){this._setBusy(false)},_setBusy:function(A){if(A){hui.style.set(this.progress,{display:"block",height:this.iframe.clientHeight+"px",width:this.iframe.clientWidth+"px"})}else{this.progress.style.display="none"}},$frameLoaded:function(A){if(A==hui.frame.getWindow(this.iframe)){this._setBusy(false)}},$$layout:function(){return ;var A=hui.window.getViewHeight();hui.log(A,this.bar.clientHeight);this.iframe.style.height=(A-this.bar.clientHeight)+"px";this.progress.style.width=(this.iframe.clientWidth)+"px";this.progress.style.height=(A-this.bar.clientHeight)+"px"}};hui.ui.Box=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);this.body=hui.get.firstByClass(this.element,"hui_box_body");this.close=hui.get.firstByClass(this.element,"hui_box_close");this.visible=!this.options.absolute;if(this.close){hui.listen(this.close,"click",this._close.bind(this))}hui.ui.extend(this)};hui.ui.Box.create=function(A){A=A||{};A.element=hui.build("div",{"class":A.absolute?"hui_box hui_box_absolute":"hui_box",html:(A.closable?'<a class="hui_box_close" href="#"></a>':"")+'<div class="hui_box_top"><div><div></div></div></div><div class="hui_box_middle"><div class="hui_box_middle">'+(A.title?'<div class="hui_box_header"><strong class="hui_box_title">'+hui.string.escape(hui.ui.getTranslated(A.title))+"</strong></div>":"")+'<div class="hui_box_body" style="'+(A.padding?"padding: "+A.padding+"px;":"")+(A.width?"width: "+A.width+"px;":"")+'"></div></div></div><div class="hui_box_bottom"><div><div></div></div></div>',style:A.width?A.width+"px":null});return new hui.ui.Box(A)};hui.ui.Box.prototype={_close:function(A){hui.stop(A);this.hide();this.fire("boxWasClosed");this.fire("close")},shake:function(){hui.effect.shake({element:this.element})},addToDocument:function(){document.body.appendChild(this.element)},add:function(A){if(A.getElement){this.body.appendChild(A.getElement())}else{this.body.appendChild(A)}},show:function(){var D=this.element;if(this.options.modal){var B=hui.ui.nextPanelIndex();D.style.zIndex=B+1;hui.ui.showCurtain({widget:this,zIndex:B})}if(this.options.absolute){hui.style.set(D,{display:"block",visibility:"hidden"});var A=D.clientWidth;var C=(hui.window.getViewHeight()-D.clientHeight)/2+hui.window.getScrollTop();hui.style.set(D,{"marginLeft":(A/-2)+"px",top:C+"px"});hui.style.set(D,{display:"block",visibility:"visible"})}else{D.style.display="block"}this.visible=true;hui.ui.callVisible(this)},isVisible:function(){return this.visible},$$layout:function(){if(this.options.absolute&&this.visible){var C=this.element;var A=C.clientWidth;var B=(hui.window.getViewHeight()-C.clientHeight)/2+hui.window.getScrollTop();hui.style.set(C,{"marginLeft":(A/-2)+"px",top:B+"px"})}},hide:function(){hui.ui.hideCurtain(this);this.element.style.display="none";this.visible=false;hui.ui.callVisible(this)},$curtainWasClicked:function(){this.fire("boxCurtainWasClicked");if(this.options.curtainCloses){this._close()}}};hui.ui.Wizard=function(A){this.options=A||{};this.element=hui.get(A.element);this.name=A.name;this.container=hui.get.firstByClass(this.element,"hui_wizard_steps");this.steps=hui.get.byClass(this.element,"hui_wizard_step");this.anchors=hui.get.byClass(this.element,"hui_wizard_selection");this.selected=0;hui.ui.extend(this);this._addBehavior()};hui.ui.Wizard.prototype={_addBehavior:function(){var A=this;hui.each(this.anchors,function(C,B){hui.listen(C,"mousedown",function(D){hui.stop(D);A.goToStep(B)});hui.listen(C,"click",function(D){hui.stop(D)})})},getStep:function(){return this.selected},goToStep:function(A){var B=this.container;B.style.height=B.clientHeight+"px";hui.cls.remove(this.anchors[this.selected],"hui_selected");this.steps[this.selected].style.display="none";hui.cls.add(this.anchors[A],"hui_selected");this.steps[A].style.display="block";this.selected=A;hui.animate(B,"height",this.steps[A].clientHeight+"px",500,{ease:hui.ease.slowFastSlow,onComplete:function(){B.style.height=""}});hui.ui.callVisible(this);this.fire("stepChanged",this.selected)},isFirst:function(){return this.selected==0},isLast:function(){return this.selected==this.steps.length-1},next:function(){if(this.selected<this.steps.length-1){this.goToStep(this.selected+1)}},previous:function(){if(this.selected>0){this.goToStep(this.selected-1)}}};hui.ui.Input=function(A){this.options=hui.override({placeholderElement:null,validator:null},A);var B=this.element=hui.get(A.element);this.element.setAttribute("autocomplete","off");this.value=this._validate(this.element.value);this.isPassword=this.element.type=="password";this.name=A.name;hui.ui.extend(this);this._addBehavior();if(this.options.placeholderElement&&this.value!=""){hui.style.set(this.options.placeholderElement,{opacity:0,display:"none"})}this._checkPlaceholder();try{if(B==document.activeElement){this._onFocus()}}catch(B){}};hui.ui.Input.prototype={_addBehavior:function(){var B=this.element,A=this.options.placeholderElement;hui.listen(B,"keyup",this._onKeyUp.bind(this));hui.listen(B,"blur",this._onBlur.bind(this));if(A){hui.listen(B,"focus",this._onFocus.bind(this));hui.listen(B,"blur",this._checkPlaceholder.bind(this));if(A){A.style.cursor="text";hui.listen(A,"mousedown",this.focus.bind(this));hui.listen(A,"click",this.focus.bind(this))}}if(B.type=="submit"){hui.listen(B,"click",function(C){this.fire("click",C)}.bind(this))}},_onFocus:function(){var B=this.element,A=this.options.placeholderElement;if(A&&B.value==""){hui.style.set(A,{opacity:0,display:"none"})}},_validate:function(C){var B=this.options.validator;var A;if(B){A=B.validate(C);hui.cls.set(this.element,"hui_invalid",!A.valid);return A.value}return C},_checkPlaceholder:function(){if(this.options.placeholderElement&&this.value==""){hui.effect.fadeIn({element:this.options.placeholderElement,duration:200})}if(this.isPassword&&!hui.browser.msie){this.element.type="password"}},_onKeyUp:function(){if(this.value!==this.element.value){var A=this._validate(this.element.value);var B=A!==this.value;this.value=A;if(B){this.fire("valueChanged",this.value)}}},_onBlur:function(){hui.cls.remove(this.element,"hui_invalid");this.element.value=this.value||""},getValue:function(){return this.value},setValue:function(A){if(A===undefined||A===null){A=""}this.element.value=A;this.value=this._validate(A)},isEmpty:function(){return this.value==""},isBlank:function(){return hui.isBlank(this.value)},focus:function(){this.element.focus()},setError:function(A){var B=A?true:false;hui.cls.set(this.element,"hui_field_error",B);if(typeof (A)=="string"){hui.ui.showToolTip({text:A,element:this.element,key:this.name})}if(!B){hui.ui.hideToolTip({key:this.name})}}};hui.ui.InfoView=function(A){this.options=hui.override({clickObjects:false},A);this.element=hui.get(A.element);this.body=hui.get.firstByTag(this.element,"tbody");this.name=A.name;hui.ui.extend(this)};hui.ui.InfoView.create=function(A){A=A||{};var B=A.element=hui.build("div",{"class":"hui_infoview",html:"<table><tbody></tbody></table>"});if(A.height){hui.style.set(B,{height:A.height+"px","overflow":"auto","overflowX":"hidden"})}if(A.margin){B.style.margin=A.margin+"px"}return new hui.ui.InfoView(A)};hui.ui.InfoView.prototype={addHeader:function(B){var A=hui.build("tr",{parent:this.body});hui.build("th",{"class":"hui_infoview_header",colspan:"2",text:B,parent:A})},addProperty:function(A,C){var B=hui.build("tr",{parent:this.body});hui.build("th",{parent:B,text:A});hui.build("td",{parent:B,text:C})},addObjects:function(B,D){if(!D||D.length==0){return }var E=hui.build("tr",{parent:this.body});E.appendChild(hui.build("th",{text:B}));var A=hui.build("td",{parent:E});var C=this.options.clickObjects;hui.each(D,function(G){var F=hui.build("div",{text:G.title,parent:A});if(C){hui.cls.add(F,"hui_infoview_click");hui.listen(F,"click",function(){hui.ui.callDelegates(this,"objectWasClicked",G)})}})},setBusy:function(A){hui.cls.set(this,element,"hui_infoview_busy",A)},clear:function(){hui.dom.clear(this.body)},update:function(B){this.clear();for(var A=0;A<B.length;A++){switch(B[A].type){case"header":this.addHeader(B[A].value);break;case"property":this.addProperty(B[A].label,B[A].value);break;case"objects":this.addObjects(B[A].label,B[A].value);break}}}};hui.ui.Overflow=function(A){this.options=A;this.element=hui.get(A.element);this.topShadow=hui.get.firstByClass(this.element,"hui_overflow_top");this.bottomShadow=hui.get.firstByClass(this.element,"hui_overflow_bottom");hui.listen(this.element,"scroll",this._checkShadows.bind(this));this.name=A.name;hui.ui.extend(this)};hui.ui.Overflow.create=function(A){A=A||{};var B=A.element=hui.build("div",{"class":"hui_overflow",html:'<div class="hui_overflow_top"></div><div class="hui_overflow_bottom"></div>'});if(A.height){B.style.height=A.height+"px"}return new hui.ui.Overflow(A)};hui.ui.Overflow.prototype={_checkShadows:function(){if(hui.browser.msie){return }if(this.element.scrollTop>0){this.topShadow.style.display="block";this.topShadow.style.top=this.element.scrollTop+"px"}else{this.topShadow.style.display="none"}if(this.element.scrollHeight-this.element.scrollTop-this.element.clientHeight>0){this.bottomShadow.style.display="block";this.bottomShadow.style.top=(this.element.scrollTop+this.element.clientHeight-this.bottomShadow.clientHeight)+"px"}else{this.bottomShadow.style.display="none"}},show:function(){this.element.style.display="";hui.ui.callVisible(this)},hide:function(){this.element.style.display="none";hui.ui.callVisible(this)},add:function(A){if(A.getElement){this.element.appendChild(A.getElement())}else{this.element.appendChild(A)}return this},$$childSizeChanged:function(){this._checkShadows()},$$layout:function(){if(!this.options.dynamic){this._checkShadows();return }hui.log(this.element.parentNode.clientHeight);this.element.style.height=hui.position.getRemainingHeight(this.element)+"px";this._checkShadows()}};hui.ui.SearchField=function(A){this.options=hui.override({expandedWidth:null},A);this.element=hui.get(A.element);this.name=A.name;this.field=hui.get.firstByTag(this.element,"input");this.value=this.field.value;this.adaptive=hui.cls.has(this.element,"hui_searchfield_adaptive");this.initialWidth=null;hui.ui.extend(this);this._addBehavior();this._updateClass()};hui.ui.SearchField.create=function(A){A=A||{};A.element=hui.build("span",{"class":A.adaptive?"hui_searchfield hui_searchfield_adaptive":"hui_searchfield",html:'<em class="hui_searchfield_placeholder"></em><a href="javascript:void(0);" class="hui_searchfield_reset"></a><span><span><input type="text"/></span></span>'});return new hui.ui.SearchField(A)};hui.ui.SearchField.prototype={_addBehavior:function(){var B=this;hui.listen(this.field,"keyup",this._onKeyUp.bind(this));var C=hui.get.firstByTag(this.element,"a");C.tabIndex=-1;if(!hui.browser.ipad){var A=function(){B.field.focus();B.field.select()};hui.listen(this.element,"mousedown",A);hui.listen(this.element,"mouseup",A);hui.listen(hui.get.firstByTag(this.element,"em"),"mousedown",A)}else{var A=function(){B.field.focus()};hui.listen(hui.get.firstByTag(this.element,"em"),"click",A)}hui.listen(C,"mousedown",function(D){hui.stop(D);B.reset();A()});hui.listen(this.field,"focus",this._onFocus.bind(this));hui.listen(this.field,"blur",this._onBlur.bind(this))},_onFocus:function(){hui.ui.setKeyboardTarget(this);this.focused=true;this._updateClass();if(this.options.expandedWidth>0){if(this.initialWidth==null){this.initialWidth=parseInt(hui.style.get(this.element,"width"))}hui.animate(this.element,"width",this.options.expandedWidth+"px",500,{ease:hui.ease.slowFastSlow})}},_onBlur:function(){hui.ui.setKeyboardTarget(null);this.focused=false;this._updateClass();if(this.initialWidth!==null){hui.animate(this.element,"width",this.initialWidth+"px",500,{ease:hui.ease.slowFastSlow,delay:100})}},_onKeyUp:function(A){this._fieldChanged();if(A.keyCode===hui.KEY_RETURN){this.fire("submit")}},focus:function(){this.field.focus()},setValue:function(A){this.field.value=A===undefined||A===null?"":A;this._fieldChanged()},getValue:function(){return this.field.value},isEmpty:function(){return this.field.value==""},isBlank:function(){return hui.isBlank(this.field.value)},reset:function(){this.field.value="";this._fieldChanged()},_updateClass:function(){var A="hui_searchfield";if(this.adaptive){A+=" hui_searchfield_adaptive"}if(this.focused&&this.value!=""){A+=" hui_searchfield_focus_dirty"}else{if(this.focused){A+=" hui_searchfield_focus"}else{if(this.value!=""){A+=" hui_searchfield_dirty"}}}this.element.className=A},_fieldChanged:function(){if(this.field.value!=this.value){this.value=this.field.value;this._updateClass();this.fireValueChange()}}};hui.ui.Fragment=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Fragment.prototype={show:function(){this.element.style.display="block";hui.ui.callVisible(this)},hide:function(){this.element.style.display="none";hui.ui.callVisible(this)}};hui.ui.LocationPicker=function(A){A=A||{};this.name=A.name;this.options=A.options||{};this.element=hui.get(A.element);this.backendLoaded=window.google!==undefined&&window.google.maps!==undefined;this.defered=[];hui.ui.extend(this)};hui.ui.LocationPicker.prototype={show:function(B){if(!this.panel){var A=this.panel=hui.ui.BoundPanel.create({width:302,modal:true});var E=hui.build("div",{style:"width:300px;height:300px;border:1px solid #bbb;"});A.add(E);var D=hui.ui.Buttons.create({align:"right",top:5});var C=hui.ui.Button.create({text:{en:"Close",da:"Luk"},small:true});C.listen({$click:function(){A.hide()}});A.add(D.add(C));hui.style.set(A.element,{left:"-10000px",top:"-10000px",display:""});this._whenReady(function(){var F={zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN};this.defaultCenter=new google.maps.LatLng(57.0465,9.9185);this.map=new google.maps.Map(E,F);google.maps.event.addListener(this.map,"click",function(G){var H={latitude:G.latLng.lat(),longitude:G.latLng.lng()};this.setLocation(H);this.fire("locationChanged",H)}.bind(this));this.setLocation(B.location)}.bind(this))}if(B.node){this.panel.position(B.node)}this.panel.show()},_whenReady:function(A){if(this.backendLoaded){A();return }this.defered.push(A);if(this.loadingBackend){return }this.loadingBackend=true;window.huiLocationPickerReady=function(){this.loadingBackend=false;this.backendLoaded=true;hui.log("Google maps loaded!");for(var B=0;B<this.defered.length;B++){this.defered[B]()}window.huiLocationPickerReady=null}.bind(this);hui.log("Loading google maps...");hui.require("http://maps.google.com/maps/api/js?sensor=false&callback=huiLocationPickerReady")},setLocation:function(A){this._whenReady(function(){hui.log("Setting location...");if(!A&&this.marker){this.marker.setMap(null);this.map.setCenter(this.defaultCenter);return }A=this._buildLatLng(A);if(!this.marker){this.marker=new google.maps.Marker({position:A,map:this.map})}else{this.marker.setPosition(A);this.marker.setMap(this.map)}this.map.setCenter(A)}.bind(this))},_buildLatLng:function(A){if(!A){A={latitude:57.0465,longitude:9.9185}}return new google.maps.LatLng(A.latitude,A.longitude)}};hui.ui.Bar=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);this.visible=this.element.style.display=="none"?false:null;this.body=hui.get.firstByClass(this.element,"hui_bar_left");hui.ui.extend(this)};hui.ui.Bar.create=function(C){C=C||{};var B="hui_bar";if(C.variant){B+=" hui_bar_"+C.variant}if(C.absolute){B+=" hui_bar_absolute"}C.element=hui.build("div",{"class":B});var A=hui.build("div",{"class":"hui_bar_body",parent:C.element});hui.build("div",{"class":"hui_bar_left",parent:A});return new hui.ui.Bar(C)};hui.ui.Bar.prototype={addToDocument:function(){document.body.appendChild(this.element)},add:function(A){this.body.appendChild(A.getElement())},addDivider:function(){hui.build("span",{"class":"hui_bar_divider",parent:this.body})},addToRight:function(B){var A=this._getRight();A.appendChild(B.getElement())},placeAbove:function(A){if(A.getElement){A=A.getElement()}hui.position.place({source:{element:this.element,vertical:1,horizontal:0},target:{element:A,vertical:0,horizontal:0}});this.element.style.zIndex=hui.ui.nextTopIndex()},setVisible:function(A){if(this.visible===A){return }if(A){this.show()}else{this.hide()}},show:function(){if(this.visible){return }if(this.options.absolute){this.element.style.visibility="visible"}else{this.element.style.display="";hui.ui.reLayout()}this.visible=true;hui.ui.callVisible(this)},hide:function(){if(!this.visible){return }if(this.options.absolute){this.element.style.visibility="hidden"}else{this.element.style.display="none";hui.ui.reLayout()}this.visible=false;hui.ui.callVisible(this)},_getRight:function(){if(!this.right){this.right=hui.get.firstByClass(this.element,"hui_bar_right");if(!this.right){var A=hui.get.firstByClass(this.element,"hui_bar_body");this.right=hui.build("div",{"class":"hui_bar_right",parentFirst:A})}}return this.right}};hui.ui.Bar.Button=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);hui.listen(this.element,"click",this._click.bind(this));hui.listen(this.element,"mousedown",this._mousedown.bind(this));hui.listen(this.element,"mouseup",hui.stop);hui.ui.extend(this)};hui.ui.Bar.Button.create=function(A){A=A||{};var B=A.element=hui.build("a",{"class":"hui_bar_button"});if(A.icon){B.appendChild(hui.ui.createIcon(A.icon,16))}return new hui.ui.Bar.Button(A)};hui.ui.Bar.Button.prototype={_mousedown:function(A){this.fire("mousedown");if(this.options.stopEvents){hui.stop(A)}},_click:function(A){this.fire("click");if(this.options.stopEvents){hui.stop(A)}},setSelected:function(A){hui.cls.set(this.element,"hui_bar_button_selected",A)}};hui.ui.Bar.Text=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);hui.ui.extend(this)};hui.ui.Bar.Text.prototype={setText:function(A){hui.dom.setText(this.element,hui.ui.getTranslated(A))}};hui.ui.IFrame=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.IFrame.prototype={setUrl:function(A){this.element.setAttribute("src",A)},clear:function(){this.setUrl("about:blank")},getDocument:function(){return hui.frame.getDocument(this.element)},getWindow:function(){return hui.frame.getWindow(this.element)},reload:function(){this.getWindow().location.reload()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};hui.ui.VideoPlayer=function(A){this.options=A;this.element=hui.get(A.element);this.placeholder=hui.get.firstByTag(this.element,"div");this.name=A.name;this.state={duration:0,time:0,loaded:0};this.handlers=[hui.ui.VideoPlayer.HTML5,hui.ui.VideoPlayer.QuickTime,hui.ui.VideoPlayer.Embedded];this.handler=null;hui.ui.extend(this);if(this.options.video){if(this.placeholder){hui.listen(this.placeholder,"click",function(){this.setVideo(this.options.video)}.bind(this))}else{hui.ui.onReady(function(){this.setVideo(this.options.video)}.bind(this))}}};hui.ui.VideoPlayer.prototype={setVideo:function(A){if(this.placeholder){this.placeholder.style.display="none"}this.handler=this.getHandler(A);this.element.appendChild(this.handler.element);if(this.handler.showController()){this.buildController()}},getHandler:function(C){for(var A=0;A<this.handlers.length;A++){var B=this.handlers[A];if(B.isSupported(C)){return new B(C,this)}}},buildController:function(){var A=hui.build("div",{"class":"hui_videoplayer_controller",parent:this.element});this.playButton=hui.build("a",{href:"javascript:void(0);","class":"hui_videoplayer_playpause",text:"wait!",parent:A});hui.listen(this.playButton,"click",this.playPause.bind(this));this.status=hui.build("span",{"class":"hui_videoplayer_status",parent:A})},onCanPlay:function(){this.playButton.update("Play")},onLoad:function(){this.state.loaded=this.state.duration;this.updateStatus()},onDurationChange:function(A){this.state.duration=A;this.updateStatus()},onTimeChange:function(A){this.state.time=A;this.updateStatus()},onLoadProgressChange:function(A){this.state.loaded=A;this.updateStatus()},playPause:function(){if(this.handler.isPlaying()){this.pause()}else{this.play()}},play:function(){this.handler.play()},pause:function(){this.handler.pause()},updateStatus:function(){this.status.innerHTML=this.state.time+" / "+this.state.duration+" / "+this.state.loaded}};hui.ui.VideoPlayer.HTML5=function(B,A){var C=this.element=hui.build("video",{width:B.width,height:B.height,src:B.src});hui.listen(C,"load",A.onLoad.bind(A));hui.listen(C,"canplay",A.onCanPlay.bind(A));hui.listen(C,"durationchange",function(D){A.onDurationChange(C.duration)});hui.listen(C,"timeupdate",function(){A.onTimeChange(this.element.currentTime)}.bind(this))};hui.ui.VideoPlayer.HTML5.isSupported=function(A){if(hui.browser.webkitVersion>528&&(A.type==="video/quicktime"||A.type==="video/mp4")){return true}return false};hui.ui.VideoPlayer.HTML5.prototype={showController:function(){return true},pause:function(){this.element.pause()},play:function(){this.element.play()},getTime:function(){return this.element.currentTime},isPlaying:function(){return !this.element.paused}};hui.ui.VideoPlayer.QuickTime=function(B,A){this.player=A;var C=this.element=hui.build("object",{width:B.width,height:B.height,data:B.src,type:"video/quicktime"});C.innerHTML='<param value="false" name="controller"/><param value="true" name="enablejavascript"/><param value="undefined" name="posterframe"/><param value="false" name="showlogo"/><param value="false" name="autostart"/><param value="true" name="cache"/><param value="white" name="bgcolor"/><param value="false" name="aggressivecleanup"/><param value="true" name="saveembedtags"/><param value="true" name="postdomevents"/>';hui.listen(C,"qt_canplay",A.onCanPlay.bind(A));hui.listen(C,"qt_load",A.onLoad.bind(A));hui.listen(C,"qt_progress",function(){A.onLoadProgressChange(C.GetMaxTimeLoaded()/3000)});hui.listen(C,"qt_durationchange",function(D){A.onDurationChange(C.GetDuration()/3000)});hui.listen(C,"qt_timechanged",function(){A.onTimeChange(C.GetTime())})};hui.ui.VideoPlayer.QuickTime.isSupported=function(A){return A.html==undefined};hui.ui.VideoPlayer.QuickTime.prototype={showController:function(){return true},pause:function(){window.clearInterval(this.observer);this.element.Stop()},play:function(){this.element.Play();this.observer=window.setInterval(this.observeVideo.bind(this),100)},observeVideo:function(){this.player.onTimeChange(this.element.GetTime()/3000)},getTime:function(){return this.element.GetTime()},isPlaying:function(){return this.element.GetRate()!==0}};hui.ui.VideoPlayer.Embedded=function(B,A){this.element=hui.build("div",{width:B.width,height:B.height,html:B.html})};hui.ui.VideoPlayer.Embedded.isSupported=function(A){return A.html!==undefined};hui.ui.VideoPlayer.Embedded.prototype={showController:function(){return false},pause:function(){},play:function(){},getTime:function(){},isPlaying:function(){}};hui.ui.Segmented=function(A){this.options=hui.override({value:null,allowNull:false},A);this.element=hui.get(A.element);this.name=A.name;this.value=this.options.value;hui.ui.extend(this);hui.listen(this.element,"mousedown",this.onClick.bind(this))};hui.ui.Segmented.prototype={onClick:function(E){E=new hui.Event(E);var B=E.findByTag("a");if(B){var F=false;var D=B.getAttribute("rel");var A=hui.get.byClass(this.element,"hui_segmented_selected");for(var C=0;C<A.length;C++){hui.cls.remove(A[C],"hui_segmented_selected")}if(D===this.value&&this.options.allowNull){F=true;this.value=null}else{hui.cls.add(B,"hui_segmented_selected");F=this.value!==D;this.value=D}if(F){this.fire("valueChanged",this.value);hui.ui.firePropertyChange(this,"value",this.value)}}},setValue:function(C){if(C===undefined){C=null}var A=this.element.getElementsByTagName("a");this.value=null;for(var B=0;B<A.length;B++){if(A[B].getAttribute("rel")===C){hui.cls.add(A[B],"hui_segmented_selected");this.value=C}else{hui.cls.remove(A[B],"hui_segmented_selected")}}},getValue:function(){return this.value}};hui.ui.Flash={fullVersion:undefined,getMajorVersion:function(){var B=this.getFullVersion();if(B===null||B===undefined){return null}var A=(B+"").match(/[0-9]+/gi);return A.length>0?parseInt(A[0]):null},getFullVersion:function(){if(this.fullVersion!==undefined){return this.fullVersion}var G=null;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];var D=E[3];if(D==""){D=E[4]}if(D[0]=="d"){D=D.substring(1)}else{if(D[0]=="r"){D=D.substring(1);if(D.indexOf("d")>0){D=D.substring(0,D.indexOf("d"))}}}G=H+"."+B+"."+D}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2}else{if(hui.browser.msie){G=this.getActiveXVersion()}}}}}this.fullVersion=G;return G},getActiveXVersion:function(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version")}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version")}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version")}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0"}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11"}catch(C){A=-1}}return A}};hui.ui.Link=function(A){this.options=A;this.name=A.name;this.element=hui.get(A.element);hui.ui.extend(this);this.addBehavior()};hui.ui.Link.prototype={addBehavior:function(){var A=this;hui.listen(this.element,"click",function(B){hui.stop(B);window.setTimeout(function(){A.fire("click")})})}};hui.ui.Links=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this);this.items=[];this.addBehavior();this.selectedIndex=null;this.inputs={}};hui.ui.Links.prototype={addBehavior:function(){hui.listen(this.element,"click",this.onClick.bind(this));hui.listen(this.element,"dblclick",this.onDblClick.bind(this))},reset:function(){this.setValue([])},setValue:function(A){this.items=A;this.selectedIndex=null;this.build()},getValue:function(){return this.items},onDblClick:function(D){D=new hui.Event(D);hui.selection.clear();D.stop(D);var B=this.selectAndGetRow(D);var A={text:B.text};A[B.kind]=B.value;this.editedLink=B;var C=this.getEditWindow();this.editForm.reset();this.editForm.setValues(A);C.show()},onClick:function(B){B=new hui.Event(B);B.stop();var A=B.getElement();if(hui.cls.has(A,"hui_links_remove")){var C=B.findByClass("hui_links_row");hui.ui.confirmOverlay({element:A,text:"Vil du fjerne linket?",okText:"Ja, fjern",cancelText:"Annuller",onOk:function(){this.items.splice(C.hui_index,1);if(this.selectedIndex===C.hui_index){this.selectedIndex=null}this.build()}.bind(this)})}else{this.selectAndGetRow(B)}},selectAndGetRow:function(C){var D=C.findByClass("hui_links_row");if(D){var B=D.hui_index;if(this.selectedIndex!==null){var A=hui.get.byClass(this.element,"hui_links_row")[this.selectedIndex];hui.cls.remove(A,"hui_links_row_selected")}this.selectedIndex=B;hui.cls.add(D,"hui_links_row_selected");return this.items[B]}},build:function(){var E=this.list||hui.get.firstByClass(this.element,"hui_links_list"),B,D,G,C,F,A;E.innerHTML="";for(B=0;B<this.items.length;B++){D=this.items[B];G=hui.build("div",{"class":"hui_links_row"});G.hui_index=B;G.appendChild(hui.ui.createIcon(D.icon,16));F=hui.build("div",{"class":"hui_links_text",text:D.text});G.appendChild(F);C=hui.build("div",{"class":"hui_links_info",text:hui.string.wrap(D.info)});G.appendChild(C);A=hui.ui.createIcon("monochrome/delete",16);hui.cls.add(A,"hui_links_remove");G.appendChild(A);E.appendChild(G)}},addLink:function(){this.editedLink=null;this.getEditWindow().show();this.editForm.reset();this.editForm.focus()},getEditWindow:function(){if(!this.editWindow){var F=this.editWindow=hui.ui.Window.create({title:"Link",width:300,padding:5});var E=this.editForm=hui.ui.Formula.create();var D=E.buildGroup({above:false},[{label:"Tekst",type:"TextField",options:{key:"text"}}]);var C=hui.ui.TextField.create({key:"url"});D.add(C,"URL");this.inputs["url"]=C;var B=hui.ui.TextField.create({key:"email"});D.add(B,"E-mail");this.inputs["email"]=B;page=hui.ui.DropDown.create({key:"page",source:this.options.pageSource});D.add(page,"Side");this.inputs["page"]=page;file=hui.ui.DropDown.create({key:"file",source:this.options.fileSource});D.add(file,"Fil");this.inputs["file"]=file;var A=this;hui.each(this.inputs,function(G,H){H.listen({$valueChanged:function(){A.changeType(G)}})});D.createButtons().add(hui.ui.Button.create({text:"Gem",submit:true,highlighted:true}));this.editForm.listen({$submit:this.saveLink.bind(this)});F.add(E);if(this.options.pageSource){this.options.pageSource.refresh()}if(this.options.fileSource){this.options.fileSource.refresh()}}return this.editWindow},saveLink:function(){var A=this.editForm.getValues();var B=this.valuesToLink(A);var C=this.editedLink;if(C){hui.override(C,B)}else{this.items.push(B)}this.build();this.editForm.reset();this.editWindow.hide();this.editedLink=null},valuesToLink:function(A){var B={};B.text=A.text;if(A.email!=""){B.kind="email";B.value=A.email;B.info=A.email;B.icon="monochrome/email"}else{if(A.url!=""){B.kind="url";B.value=A.url;B.info=A.url;B.icon="monochrome/globe"}else{if(hui.isDefined(A.page)){B.kind="page";B.value=A.page;B.info=this.inputs["page"].getItem().title;B.icon="common/page"}else{if(hui.isDefined(A.file)){B.kind="file";B.value=A.file;B.info=this.inputs["file"].getItem().title;B.icon="monochrome/file"}}}}return B},changeType:function(A){hui.each(this.inputs,function(B,C){if(B!=A){C.setValue()}})}};hui.ui.MarkupEditor=function(A){this.name=A.name;this.options=hui.override({debug:false,value:"",autoHideToolbar:true,style:"font-family: sans-serif; font-size: 11px;"},A);if(this.options.replace){this.options.replace=hui.get(A.replace);this.options.element=hui.build("div",{className:"hui_markupeditor "+this.options.replace.className});this.options.replace.parentNode.insertBefore(this.options.element,this.options.replace);this.options.replace.style.display="none";this.options.value=this.options.replace.innerHTML}this.ready=false;this.pending=[];this.element=hui.get(this.options.element);if(hui.browser.msie){this.impl=hui.ui.MarkupEditor.MSIE}else{this.impl=hui.ui.MarkupEditor.webkit}this.impl.initialize({element:this.element,controller:this});if(this.options.value){this.setValue(this.options.value)}hui.ui.extend(this)};hui.ui.MarkupEditor.create=function(A){A=A||{};A.element=hui.build("div",{className:"hui_markupeditor"});return new hui.ui.MarkupEditor(A)};hui.ui.MarkupEditor.prototype={implIsReady:function(){this.ready=true;for(var A=0;A<this.pending.length;A++){this.pending[A]()}},implFocused:function(){this._showBar()},implBlurred:function(){this.bar.hide();this.fire("blur")},implValueChanged:function(){this._valueChanged()},destroy:function(){hui.dom.remove(this.element);hui.ui.destroy(this)},getValue:function(){return this.impl.getHTML()},setValue:function(A){this._whenReady(function(){this.impl.setHTML(A)}.bind(this))},focus:function(){this._whenReady(this.impl.focus.bind(this.impl))},_whenReady:function(A){if(this.ready){A()}else{this.pending.push(A)}},_showBar:function(){if(!this.bar){var A=[{key:"bold",icon:"edit/text_bold"},{key:"italic",icon:"edit/text_italic"},{divider:true},{key:"color",icon:"common/color"},{key:"addLink",icon:"monochrome/link"},{divider:true},{key:"align",value:"left",icon:"edit/text_align_left"},{key:"align",value:"center",icon:"edit/text_align_center"},{key:"align",value:"right",icon:"edit/text_align_right"},{key:"align",value:"justify",icon:"edit/text_align_justify"},{divider:true},{key:"clear",icon:"edit/clear"}];this.bar=hui.ui.Bar.create({absolute:true,variant:"mini",small:true});hui.each(A,function(C){if(C.divider){this.bar.addDivider();return }var B=new hui.ui.Bar.Button.create({icon:C.icon,stopEvents:true});B.listen({$mousedown:function(){this._buttonClicked(C)}.bind(this)});this.bar.add(B)}.bind(this));this.bar.addToDocument()}hui.log("Showing bar");this.bar.placeAbove(this);this.bar.show()},_buttonClicked:function(A){this.impl.saveSelection();if(A.key=="color"){this._showColorPicker()}else{if(A.key=="addLink"){this._showLinkEditor()}else{if(A.key=="align"){this.impl.align(A.value)}else{if(A.key=="clear"){this.impl.removeFormat()}else{this.impl.format(A)}}}}this._valueChanged();this.impl.restoreSelection()},_showColorPicker:function(){if(!this.colorPicker){this.colorPicker=hui.ui.Window.create();var A=hui.ui.ColorPicker.create();A.listen(this);this.colorPicker.add(A);this.colorPicker.listen({$userClosedWindow:function(){this.impl.restoreSelection()}.bind(this)})}this.colorPicker.show({avoid:this.element})},_highlightNode:function(A){if(this._highlightedNode){hui.cls.remove(this._highlightedNode,"hui_markupeditor_highlighted")}this._highlightedNode=A;if(A){hui.cls.add(A,"hui_markupeditor_highlighted")}},_showLinkEditor:function(){this.temporaryLink=this.impl.getOrCreateLink();this._highlightNode(this.temporaryLink);if(this.options.linkDelegate){var B=this.options.linkDelegate;B.editLink({node:this.temporaryLink,onSuccess:function(){this._highlightNode(null);this.temporaryLink=null;hui.log("success");this._valueChanged()}.bind(this),onCancel:function(){this._highlightNode(null);hui.log("cancelled");this.temporaryLink=null;this._valueChanged()}.bind(this)})}else{if(!this.linkEditor){this.linkEditor=hui.ui.Window.create({padding:5,width:300});this.linkForm=hui.ui.Formula.create();this.linkEditor.add(this.linkForm);var D=this.linkForm.buildGroup({},[{type:"TextField",options:{key:"url",label:"Address:"}}]);var C=D.createButtons();var A=hui.ui.Button.create({text:"OK",submit:true});this.linkForm.listen({$submit:this._updateLink.bind(this)});C.add(A)}}if(this.linkEditor){this.linkForm.setValues({url:this.temporaryLink.href});this.linkEditor.show({avoid:this.element});this.linkForm.focus()}},_updateLink:function(){var A=this.linkForm.getValues();this.temporaryLink.href=A.url;this.linkForm.reset();this.temporaryLink=null;this.linkEditor.hide();this._valueChanged()},_valueChanged:function(){this.fire("valueChanged",this.impl.getHTML())},$colorWasSelected:function(A){this.impl.restoreSelection(function(){this.impl.colorize(A);this._valueChanged()}.bind(this))}};hui.ui.MarkupEditor.webkit={initialize:function(A){this.element=A.element;this.element.style.overflow="auto";this.element.contentEditable=true;var B=this.controller=A.controller;hui.listen(this.element,"focus",function(){hui.log("Webkit focus");B.implFocused()});hui.listen(this.element,"blur",function(){B.implBlurred()});hui.listen(this.element,"keyup",this._keyUp.bind(this));B.implIsReady()},saveSelection:function(){},restoreSelection:function(A){if(A){A()}},focus:function(){this.element.focus()},format:function(A){if(A.key=="strong"||A.key=="em"){this._wrapInTag(A.key)}else{if(A.key=="insert-table"){this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>")}else{document.execCommand(A.key,null,A.value)}}},getOrCreateLink:function(){var A=this._getSelectedNode();if(A&&A.tagName.toLowerCase()=="a"){return A}document.execCommand("createLink",null,"#");return this._getSelectedNode()},_getSelectedNode:function(){var C=window.getSelection();var A=C.getRangeAt(0);var B=A.commonAncestorContainer;if(!hui.dom.isElement(B)){B=B.parentNode}return B},colorize:function(A){document.execCommand("forecolor",null,A)},align:function(B){var A={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};document.execCommand(A[B],null,null)},_keyUp:function(){this.controller.implValueChanged();this._selectionChanged()},_wrapInTag:function(A){var D=window.getSelection();if(D.rangeCount<1){return }var B=D.getRangeAt(0);var C=B.commonAncestorContainer;if(!hui.dom.isElement(C)){C=C.parentNode}if(C.tagName.toLowerCase()==A){this._unWrap(C)}else{var E=document.createElement(A);B.surroundContents(E);D.selectAllChildren(E)}},_getInlineTag:function(){var A=window.getSelection();if(A.rangeCount<1){return }},_unWrap:function(B){var C=B.childNodes;for(var A=0;A<C.length;A++){B.parentNode.insertBefore(C[A],B)}B.parentNode.removeChild(B)},_insertHTML:function(A){document.execCommand("inserthtml",null,A)},_selectionChanged:function(){hui.log({bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic")})},removeFormat:function(){document.execCommand("removeFormat",null,null)},setHTML:function(A){hui.log("Setting html");this.element.innerHTML=A},getHTML:function(){var A=hui.ui.MarkupEditor.util.clean(this.element);return A.innerHTML}};hui.ui.MarkupEditor.MSIE={initialize:function(A){this.element=A.element;this.iframe=hui.build("iframe",{style:"display:block; width: 100%; border: 0;",parent:this.element});hui.listen(this.iframe,"load",this._load.bind(this));this.controller=A.controller},saveSelection:function(){this.savedRange=this.document.selection.createRange()},restoreSelection:function(A){window.setTimeout(function(){this.body.focus();this.savedRange.select();if(A){A()}}.bind(this))},_load:function(){this.document=hui.frame.getDocument(this.iframe);this.body=this.document.body;this.body.contentEditable=true;hui.listen(this.body,"keyup",this._keyUp.bind(this));hui.listen(this.body,"mouseup",this._mouseUp.bind(this));this.controller.implIsReady()},_keyUp:function(){this.controller.implValueChanged();this.saveSelection()},_mouseUp:function(){this.saveSelection()},focus:function(){this.body.focus();this.controller.implFocused()},align:function(B){var A={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};this.document.execCommand(A[B],null,null)},format:function(A){if(A.key=="strong"||A.key=="em"){this._wrapInTag(A.key)}else{if(A.key=="insert-table"){this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>")}else{this.document.execCommand(A.key,null,null)}}},removeFormat:function(){this.document.execCommand("removeFormat",null,null)},colorize:function(A){this.document.execCommand("forecolor",null,A);this.restoreSelection()},_wrapInTag:function(A){document.execCommand("inserthtml",null,"<"+A+">"+hui.string.escape(hui.selection.getText())+"</"+A+">")},_insertHTML:function(A){document.execCommand("inserthtml",null,A)},setHTML:function(A){this.body.innerHTML=A},getHTML:function(){var A=hui.ui.MarkupEditor.util.clean(this.body);return A.innerHTML}};hui.ui.MarkupEditor.util={clean:function(C){var D=C.cloneNode(true);this.replaceNodes(D,{b:"strong",i:"em",font:"span"});var B=hui.get.byClass(D,"Apple-style-span");for(var A=B.length-1;A>=0;A--){B[A].removeAttribute("class")}this.convertAttributesToStyle(D);return D},replaceNodes:function(C,I){for(var J in I){var K=C.getElementsByTagName(J);for(var F=K.length-1;F>=0;F--){var H=K[F];var B=document.createElement(I[J]);var D=K[F].getAttribute("color");if(D){B.style.color=D}hui.dom.replaceNode(H,B);var A=H.childNodes;for(var E=0;E<A.length;E++){var G=H.removeChild(A[E]);B.appendChild(G)}}}},convertAttributesToStyle:function(C){var B=C.getElementsByTagName("*");for(var A=0;A<B.length;A++){var E=B[A];var D=E.getAttribute("align");if(D){E.style.textAlign=D;E.removeAttribute("align")}}}};hui.ui.ColorPicker=function(A){this.options=A||{};this.name=A.name;this.element=hui.get(A.element);this.color=null;this.buttons=[];this.preview=hui.get.firstByClass(this.element,"hui_colorpicker_preview");this.pages=hui.get.byClass(this.element,"hui_colorpicker_page");this.input=hui.get.firstByTag(this.element,"input");this.wheel1=this.pages[0];this.wheel2=this.pages[1];this.wheel3=this.pages[2];this.swatches=this.pages[3];hui.ui.extend(this);if(A.listener){this.listen(A.listener)}this.addBehavior();this.buildData()};hui.ui.ColorPicker.create=function(C){var A="",F,E,B;for(var D=0;D<360;D+=30){for(B=0.05;B<=1;B+=0.15){F=hui.Color.hsv2rgb(D,B,1);E=hui.Color.rgb2hex(F);A+='<a style="background: rgb('+F[0]+","+F[1]+","+F[2]+')" rel="'+E+'"></a>'}for(B=1;B>=0.2;B-=0.15){F=hui.Color.hsv2rgb(D,1,B);E=hui.Color.rgb2hex(F);A+='<a style="background: rgb('+F[0]+","+F[1]+","+F[2]+')" rel="'+E+'"></a>'}}for(B=255;B>=0;B-=255/12){E=hui.Color.rgb2hex([B,B,B]);A+='<a style="background: rgb('+Math.round(B)+","+Math.round(B)+","+Math.round(B)+')" rel="'+E+'"></a>'}C=C||{};C.element=hui.build("div",{"class":"hui_colorpicker",html:'<div class="hui_bar hui_bar_window_mini"><div class="hui_bar_body"><a class="hui_bar_button hui_bar_button_selected" href="javascript:void(0)" rel="0"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_pastels",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="1"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_brightness",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="2"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_saturated",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="3"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/swatches",16)+')"></span></a><input class="hui_colorpicker"/></div></div><div class="hui_colorpicker_pages"><div class="hui_colorpicker_page hui_colorpicker_wheel1"></div><div class="hui_colorpicker_page hui_colorpicker_wheel2"></div><div class="hui_colorpicker_page hui_colorpicker_wheel3"></div><div class="hui_colorpicker_page hui_colorpicker_swatches">'+A+'</div></div><div class="hui_colorpicker_preview"></div>'});return new hui.ui.ColorPicker(C)};hui.ui.ColorPicker.prototype={addBehavior:function(){var A=hui.get.byClass(this.element,"hui_bar_button");for(var C=0;C<A.length;C++){var B=new hui.ui.Bar.Button({element:A[C]});B.listen(this);this.buttons.push(B)}hui.listen(this.element,"click",this._click.bind(this));hui.listen(this.wheel1,"mousemove",this._hoverWheel1.bind(this));hui.listen(this.wheel1,"click",this._pickColor.bind(this));hui.listen(this.wheel2,"mousemove",this._hoverWheel2.bind(this));hui.listen(this.wheel2,"click",this._pickColor.bind(this));hui.listen(this.wheel3,"mousemove",this._hoverWheel3.bind(this));hui.listen(this.wheel3,"click",this._pickColor.bind(this));hui.listen(this.element,"mousedown",function(D){hui.stop(D)});hui.listen(this.swatches,"mousemove",function(D){D=hui.event(D);this._hoverColor(D.element.getAttribute("rel"))}.bind(this));hui.listen(this.swatches,"click",this._pickColor.bind(this))},$click:function(B){var C=parseInt(B.element.getAttribute("rel")),A;for(A=this.pages.length-1;A>=0;A--){this.pages[A].style.display=A==C?"block":"none"}for(A=0;A<this.buttons.length;A++){this.buttons[A].setSelected(this.buttons[A]==B)}},_click:function(B){B=hui.event(B);B.stop();var A=B.findByTag("input");if(A){A.focus()}},_pickColor:function(A){hui.stop(A);this.fire("colorWasSelected",this.color)},_hoverColor:function(A){this.preview.style.background=A;this.color=A;this.fire("colorWasHovered",this.color);this.input.value=A},buildData:function(){var A=new Array();A[0]=new Array(0,1,0);A[1]=new Array(-1,0,0);A[2]=new Array(0,0,1);A[3]=new Array(0,-1,0);A[4]=new Array(1,0,0);A[5]=new Array(0,0,-1);A[6]=new Array(255,1,1);var E=new Array(360);for(var D=0;D<6;D++){for(var C=0;C<60;C++){E[60*D+C]=new Array(3);for(var B=0;B<3;B++){E[60*D+C][B]=A[6][B];A[6][B]+=(A[D][B]*4)}}}this.colorArray=E},_hoverWheel1:function(O){O=hui.event(O);var B=hui.position.get(this.wheel1);var E=4*(O.getLeft()-B.left);var C=4*(O.getTop()-B.top);var I=E-512;var G=C-512;var S=(I<0)?0:1;var R=(G<0)?0:1;var J=2*R+S;var D=new Array(-180,360,180,0);var N=Math.abs(I);var A=Math.abs(G);var P=A*45/N;if(A>N){P=90-(N*45/A)}var F=Math.floor(Math.abs(D[J]-P));I=Math.abs(E-512);G=Math.abs(C-512);var H=Math.sqrt((I*I)+(G*G));if(E==512&C==512){var Q="000000"}else{var K=0;for(var M=0;M<3;M++){var L=this.colorArray[F][M]*H/256;if(H>256){L+=Math.floor(H-256)}if(L>255){L=255}K=256*K+Math.floor(L)}Q=K.toString(16)}while(Q.length<6){Q="0"+Q}this._hoverColor("#"+Q)},_hoverWheel2:function(J){var K,E,D;J=hui.event(J);var L=hui.position.get(this.wheel2);var N=(J.getLeft()-L.left);var M=(J.getTop()-L.top);if(M>256){return }var G=N-128;var F=128-M;var I=G*G;var C=F*F;var B=Math.sqrt(I+C);var A=B/128;if(B==0){E=0;D=0;K=new Array(0,0,0)}else{var H=Math.acos(G/B);var P=(F>=0)?H:2*Math.PI-H;var O=360*P/(2*Math.PI);if(A>1){K=new Array(255,255,255);E=1;D=1}else{if(A>=0.5){E=1-((A-0.5)*2);D=1;K=hui.Color.hsv2rgb(O,E,D)}else{E=1;D=A*2;K=hui.Color.hsv2rgb(O,E,D)}}}this._hoverColor(hui.Color.rgb2hex(K))},_hoverWheel3:function(J){var K,E,D;J=hui.event(J);var L=hui.position.get(this.wheel3);var N=(J.getLeft()-L.left);var M=(J.getTop()-L.top);if(M>256){return }var G=N-128;var F=128-M;var I=G*G;var C=F*F;var B=Math.sqrt(I+C);var A=B/128;if(B==0){E=0;D=0;K=new Array(0,0,0)}else{var H=Math.acos(G/B);var P=(F>=0)?H:2*Math.PI-H;var O=360*P/(2*Math.PI);if(A>1){K=new Array(255,255,255);E=1;D=1}else{E=A;D=1;K=hui.Color.hsv2rgb(O,E,D)}}this._hoverColor(hui.Color.rgb2hex(K))}};hui.ui.LocationField=function(A){this.options=hui.override({value:null},A);this.name=A.name;this.element=hui.get(A.element);this.chooser=hui.get.firstByTag(this.element,"a");this.latField=new hui.ui.Input({element:hui.get.firstByTag(this.element,"input"),validator:new hui.ui.NumberValidator({min:-90,max:90,allowNull:true})});this.latField.listen(this);this.lngField=new hui.ui.Input({element:this.element.getElementsByTagName("input")[1],validator:new hui.ui.NumberValidator({min:-180,max:180,allowNull:true})});this.lngField.listen(this);this.value=this.options.value;hui.ui.extend(this);this.setValue(this.value);this._addBehavior()};hui.ui.LocationField.create=function(B){B=B||{};var C=B.element=hui.build("span",{"class":"hui_locationfield"});var A=hui.build("span",{html:'<span class="hui_locationfield_latitude"><span><input/></span></span><span class="hui_locationfield_longitude"><span><input/></span></span>'});C.appendChild(hui.ui.wrapInField(A));C.appendChild(hui.build("a",{"class":"hui_locationfield_picker",href:"javascript:void(0);"}));return new hui.ui.LocationField(B)};hui.ui.LocationField.prototype={_addBehavior:function(){hui.listen(this.chooser,"click",this._showPicker.bind(this));hui.ui.addFocusClass({element:this.latField.element,classElement:this.element,"class":"hui_field_focused"});hui.ui.addFocusClass({element:this.lngField.element,classElement:this.element,"class":"hui_field_focused"})},getLabel:function(){return this.options.label},reset:function(){this.setValue()},getValue:function(){return this.value},setValue:function(A){if(A){this.latField.setValue(A.latitude);this.lngField.setValue(A.longitude);this.value=A}else{this.latField.setValue();this.lngField.setValue();this.value=null}this._updatePicker()},_updatePicker:function(){if(this.picker){this.picker.setLocation(this.value)}},_showPicker:function(){if(!this.picker){this.picker=new hui.ui.LocationPicker();this.picker.listen(this)}this.picker.show({node:this.chooser,location:this.value})},$locationChanged:function(A){this.setValue(A);this.fire("valueChanged",this.value);hui.ui.callAncestors(this,"childValueChanged",this.value)},$valueChanged:function(){var B=this.latField.getValue();var A=this.lngField.getValue();if(B===null||A===null){this.value=null}else{this.value={latitude:B,longitude:A}}this._updatePicker();this.fire("valueChanged",this.value);hui.ui.callAncestors(this,"childValueChanged",this.value)}};hui.ui.StyleLength=function(C){this.options=hui.override({value:null,min:0,max:1000,units:["px","pt","em","%"],initialValue:null,defaultUnit:"px",allowNull:false},C);this.name=C.name;var B=this.element=hui.get(C.element);this.input=hui.get.firstByTag(B,"input");var A=B.getElementsByTagName("a");this.up=A[0];this.down=A[1];this.value=this.parseValue(this.options.value);hui.ui.extend(this);this._addBehavior()};hui.ui.StyleLength.prototype={_addBehavior:function(){var A=this.element;hui.listen(this.input,"focus",function(){hui.cls.add(A,"hui_numberfield_focused")});hui.listen(this.input,"blur",this._onBlur.bind(this));hui.listen(this.input,"keyup",this.keyEvent.bind(this));hui.listen(this.up,"mousedown",this._upEvent.bind(this));hui.listen(this.down,"mousedown",this._downEvent.bind(this))},parseValue:function(E){if(E===null||E===undefined){return null}var B=parseFloat(E,10);if(isNaN(B)){return null}var A={number:B,unit:this.options.defaultUnit};for(var C=0;C<this.options.units.length;C++){var D=this.options.units[C];if(E.indexOf(D)!=-1){A.unit=D;break}}A.number=Math.max(this.options.min,Math.min(this.options.max,A.number));return A},_onBlur:function(){hui.cls.remove(this.element,"hui_numberfield_focused");this._updateInput()},keyEvent:function(A){A=A||window.event;if(A.keyCode==hui.KEY_UP){hui.stop(A);this._upEvent()}else{if(A.keyCode==hui.KEY_DOWN){this._downEvent()}else{this._checkAndSetValue(this.parseValue(this.input.value))}}},_updateInput:function(){this.input.value=this.getValue()},_checkAndSetValue:function(B){var A=this.value;var C=false;if(A===null&&B===null){}else{if(A!=null&&B!=null&&A.number===B.number&&A.unit===B.unit){}else{C=true}}this.value=B;if(C){hui.ui.callAncestors(this,"childValueChanged",this.input.value);this.fire("valueChanged",this.getValue())}},_setInitialValue:function(){if(!this.value&&this.options.initialValue){this.setValue(this.options.initialValue)}},_downEvent:function(){this._setInitialValue();if(this.value){this._checkAndSetValue({number:Math.max(this.options.min,this.value.number-1),unit:this.value.unit})}else{this._checkAndSetValue({number:this.options.min,unit:this.options.defaultUnit})}this._updateInput()},_upEvent:function(){this._setInitialValue();if(this.value){this._checkAndSetValue({number:Math.min(this.options.max,this.value.number+1),unit:this.value.unit})}else{this._checkAndSetValue({number:this.options.min+1,unit:this.options.defaultUnit})}this._updateInput()},setInitialValue:function(A){this.options.initialValue=A},getValue:function(){return this.value?this.value.number+this.value.unit:""},setValue:function(A){this.value=this.parseValue(A);this._updateInput()},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")}};hui.ui.DateTimeField=function(A){this.inputFormats=["d-m-Y","d/m-Y","d/m/Y","d-m-Y H:i:s","d/m-Y H:i:s","d/m/Y H:i:s","d-m-Y H:i","d/m-Y H:i","d/m/Y H:i","d-m-Y H","d/m-Y H","d/m/Y H","d-m","d/m","d","Y","m-d-Y","m-d","m/d"];this.outputFormat="d-m-Y H:i:s";this.name=A.name;this.element=hui.get(A.element);this.input=hui.get.firstByTag(this.element,"input");this.options=hui.override({returnType:null,label:null,allowNull:true,value:null},A);this.value=this.options.value;hui.ui.extend(this);this._addBehavior();this._updateUI()};hui.ui.DateTimeField.create=function(A){var B=hui.build("span",{"class":"hui_field_singleline"});hui.build("input",{"class":"hui_formula_text",parent:B});hui.build("a",{"class":"hui_datetime",href:"javascript://",tabIndex:"-1",html:"<span></span>",parent:B});A.element=hui.ui.wrapInField(B);return new hui.ui.DateTimeField(A)};hui.ui.DateTimeField.prototype={_addBehavior:function(){hui.ui.addFocusClass({element:this.input,classElement:this.element,"class":"hui_field_focused"});hui.listen(this.input,"blur",this._onBlur.bind(this));hui.listen(this.input,"keyup",this._parse.bind(this));hui.listen(this.input,"focus",this._onFocus.bind(this));var A=hui.get.firstByTag(this.element,"a");hui.listen(A,"mousedown",hui.stop);hui.listen(A,"click",this._onClickIcon.bind(this))},_onClickIcon:function(A){hui.stop(A);this.input.focus();this._showPicker()},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")},setValue:function(A){if(!A){this.value=null}else{if(A.constructor==Date){this.value=A}else{this.value=new Date();this.value.setTime(parseInt(A)*1000)}}this._updateUI()},_parse:function(){var D=this.value?this.value.getTime():0;var E=this.input.value;var A=null;for(var B=0;B<this.inputFormats.length&&A==null;B++){A=Date.parseDate(E,this.inputFormats[B])}if(this.options.allowNull||A!=null){this.value=A}if(this.datePicker){this.datePicker.setValue(this.value)}var C=this.value?this.value.getTime():0;if(D!=C){hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)}},_check:function(){this._parse();this._updateUI()},getValue:function(){if(this.value!=null&&this.options.returnType=="seconds"){return Math.round(this.value.getTime()/1000)}return this.value},getElement:function(){return this.element},getLabel:function(){return this.options.label},_updateUI:function(){if(this.value){this.input.value=this.value.dateFormat(this.outputFormat)}else{this.input.value=""}},_onBlur:function(){this._check();if(this.panel){this.panel.hide()}if(this.datePickerPanel){this.datePickerPanel.hide()}},_onFocus:function(){this._showPanel()},_showPanel:function(){if(!this.panel){this.panel=hui.ui.BoundPanel.create({variant:"light"});var A=hui.ui.Buttons.create({align:"center"});A.add(hui.ui.Button.create({text:"Idag",small:true,variant:"paper",listener:{$click:this.goToday.bind(this)}}));A.add(hui.ui.Button.create({text:"+ dag",small:true,variant:"paper",listener:{$click:function(){this.addDays(1)}.bind(this)}}));A.add(hui.ui.Button.create({text:"+ uge",small:true,variant:"paper",listener:{$click:function(){this.addDays(7)}.bind(this)}}));A.add(hui.ui.Button.create({text:"12:00",small:true,variant:"paper",listener:{$click:function(){this.setHour(12)}.bind(this)}}));A.add(hui.ui.Button.create({text:"00:00",small:true,variant:"paper",listener:{$click:function(){this.setHour(0)}.bind(this)}}));this.panel.add(A)}this.panel.position({element:this.element,position:"vertical"});this.panel.show()},goToday:function(){var A=this._getValueOrNowCopy();var B=new Date();A.setDate(B.getDate());A.setMonth(B.getMonth());A.setFullYear(B.getFullYear());this.setValue(A)},addDays:function(B){var A=this._getValueOrNowCopy();A.setDate(A.getDate()+B);this.setValue(A)},setHour:function(B){var A=this._getValueOrNowCopy();A.setMilliseconds(0);A.setSeconds(0);A.setMinutes(0);A.setHours(B);this.setValue(A)},_getValueOrNowCopy:function(){return this.value==null?new Date():new Date(this.value.getTime())},_showPicker:function(){if(this.panel){this.panel.hide()}if(!this.datePickerPanel){this.datePickerPanel=hui.ui.BoundPanel.create({variant:"light"});this.datePicker=hui.ui.DatePicker.create({value:this.value});this.datePicker.listen({$dateChanged:function(A){this.setValue(A)}.bind(this)});this.datePickerPanel.add(this.datePicker)}this.datePicker.setValue(this.value);this.datePickerPanel.position(this.element);this.datePickerPanel.show()},$$parentMoved:function(){if(this.datePickerPanel&&this.datePickerPanel.isVisible()){this.datePickerPanel.position(this.element);this.datePickerPanel.show()}if(this.panel&&this.panel.isVisible()){this.panel.position({element:this.element,position:"vertical"});this.panel.show()}},$visibilityChanged:function(){if(this.datePickerPanel){this.datePickerPanel.hide()}if(this.panel){this.panel.hide()}}};hui.ui.TokenField=function(A){this.options=hui.override({label:null,key:null},A);this.element=hui.get(A.element);this.name=A.name;this.value=[""];hui.ui.extend(this);this.updateUI()};hui.ui.TokenField.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_tokenfield"});return new hui.ui.TokenField(A)};hui.ui.TokenField.prototype={setValue:function(A){this.value=A||[];this.value.push("");this.updateUI()},reset:function(){this.value=[""];this.updateUI()},getValue:function(){var A=[];hui.each(this.value,function(B){B=hui.string.trim(B);if(B.length>0){A.push(B)}});return A},getLabel:function(){return this.options.label},updateUI:function(){this.element.innerHTML="";hui.each(this.value,function(C,B){var A=hui.build("input",{"class":"hui_tokenfield_token",parent:this.element});if(this.options.width){A.style.width=this.options.width+"px"}A.value=C;hui.listen(A,"keyup",function(){this.inputChanged(A,B)}.bind(this))}.bind(this))},inputChanged:function(A,B){if(B==this.value.length-1&&A.value!=this.value[B]){this.addField()}this.value[B]=A.value;hui.animate({node:A,css:{width:Math.min(Math.max(A.value.length*7+3,50),150)+"px"},duration:200})},addField:function(){var B=hui.build("input",{"class":"hui_tokenfield_token"});if(this.options.width){B.style.width=this.options.width+"px"}var C=this.value.length;this.value.push("");this.element.appendChild(B);var A=this;hui.listen(B,"keyup",function(){A.inputChanged(B,C)})}};hui.ui.Checkbox=function(A){this.element=hui.get(A.element);this.control=hui.get.firstByTag(this.element,"span");this.options=A;this.name=A.name;this.value=A.value==="true"||A.value===true;hui.ui.extend(this);this.addBehavior()};hui.ui.Checkbox.create=function(B){var A=B.element=hui.build("a",{"class":"hui_checkbox",href:"javascript://",html:"<span><span></span></span>"});if(B.value){hui.cls.add(A,"hui_checkbox_selected")}return new hui.ui.Checkbox(B)};hui.ui.Checkbox.prototype={addBehavior:function(){hui.ui.addFocusClass({element:this.element,"class":"hui_checkbox_focused"});hui.listen(this.element,"click",this.click.bind(this))},click:function(A){hui.stop(A);this.element.focus();this.value=!this.value;this.updateUI();hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value);hui.ui.firePropertyChange(this,"value",this.value)},updateUI:function(){hui.cls.set(this.element,"hui_checkbox_selected",this.value)},setValue:function(A){this.value=A===true||A==="true";this.updateUI()},getValue:function(){return this.value},reset:function(){this.setValue(false)},getLabel:function(){return this.options.label}};hui.ui.Checkboxes=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.items=A.items||[];this.subItems=[];this.values=A.values||A.value||[];hui.ui.extend(this);this._addBehavior();this._updateUI();if(A.url){new hui.ui.Source({url:A.url,delegate:this})}};hui.ui.Checkboxes.create=function(A){A.element=hui.build("div",{"class":A.vertical?"hui_checkboxes hui_checkboxes_vertical":"hui_checkboxes"});if(A.items){hui.each(A.items,function(C){var B=hui.build("a",{"class":"hui_checkbox",href:"javascript:void(0);",html:"<span><span></span></span>"+C.title});hui.ui.addFocusClass({element:B,"class":"hui_checkbox_focused"});A.element.appendChild(B)})}return new hui.ui.Checkboxes(A)};hui.ui.Checkboxes.prototype={_addBehavior:function(){var A=hui.get.byClass(this.element,"hui_checkbox");hui.each(A,function(B,C){hui.ui.addFocusClass({element:B,"class":"hui_checkbox_focused"});hui.listen(B,"click",function(D){hui.stop(D);this.flipValue(this.items[C].value)}.bind(this))}.bind(this))},getValue:function(){return this.values},_checkValues:function(){var B=[];for(var C=0;C<this.values.length;C++){var E=this.values[C],D=false,A;for(A=0;A<this.items.length;A++){D=D||this.items[A].value===E}for(A=0;A<this.subItems.length;A++){D=D||this.subItems[A]._hasValue(E)}if(D){B.push(E)}}this.values=B},setValue:function(A){this.values=A;this._checkValues();this._updateUI()},flipValue:function(A){hui.array.flip(this.values,A);this._checkValues();this._updateUI();this.fire("valueChanged",this.values);hui.ui.callAncestors(this,"childValueChanged",this.values)},_updateUI:function(){var B,C,D;for(B=0;B<this.subItems.length;B++){this.subItems[B]._updateUI()}var A=hui.get.byClass(this.element,"hui_checkbox");for(B=0;B<this.items.length;B++){C=this.items[B];D=hui.array.contains(this.values,C.value);hui.cls.set(A[B],"hui_checkbox_selected",D)}},refresh:function(){for(var A=0;A<this.subItems.length;A++){this.subItems[A].refresh()}},reset:function(){this.setValues([])},getLabel:function(){return this.options.label},setValues:function(A){this.setValue(A)},getValues:function(){return this.values},registerItem:function(A){if(parseInt(A.value)==A.value){A.value=parseInt(A.value)}this.items.push(A)},registerItems:function(A){A.parent=this;this.subItems.push(A)},$itemsLoaded:function(A){hui.each(A,function(C){var B=hui.build("a",{"class":"hui_checkbox",href:"javascript:void(0);",html:"<span><span></span></span>"+hui.string.escape(C.title)});hui.listen(B,"click",function(D){hui.stop(D);this.flipValue(C.value)}.bind(this));hui.ui.addFocusClass({element:B,"class":"hui_checkbox_focused"});this.element.appendChild(B);this.items.push(C)}.bind(this));this._checkValues();this._updateUI()}};hui.ui.Checkboxes.Items=function(A){this.element=hui.get(A.element);this.name=A.name;this.parent=null;this.options=A;this.checkboxes=[];hui.ui.extend(this);if(this.options.source){this.options.source.listen(this)}};hui.ui.Checkboxes.Items.prototype={refresh:function(){if(this.options.source){this.options.source.refresh()}},$itemsLoaded:function(B){this.checkboxes=[];this.element.innerHTML="";var A=this;hui.each(B,function(D){var C=hui.build("a",{"class":"hui_checkbox",href:"javascript://",html:"<span><span></span></span>"+D.title});hui.listen(C,"click",function(E){hui.stop(E);C.focus();A._onItemClick(D)});hui.ui.addFocusClass({element:C,"class":"hui_checkbox_focused"});A.element.appendChild(C);A.checkboxes.push({title:D.title,element:C,value:D.value})});this.parent._checkValues();this._updateUI()},_onItemClick:function(A){this.parent.flipValue(A.value)},_updateUI:function(){try{for(var B=0;B<this.checkboxes.length;B++){var C=this.checkboxes[B];var A=hui.array.indexOf(this.parent.values,C.value);hui.cls.set(C.element,"hui_checkbox_selected",A!=-1)}}catch(D){alert(typeof (this.parent.values));alert(D)}},_hasValue:function(B){for(var A=0;A<this.checkboxes.length;A++){if(this.checkboxes[A].value==B){return true}}return false}};hui.ui.Radiobuttons=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.radios=[];this.value=A.value;this.defaultValue=this.value;this.enabled=true;hui.ui.extend(this)};hui.ui.Radiobuttons.prototype={updateUI:function(){for(var B=0;B<this.radios.length;B++){var A=this.radios[B];hui.cls.set(hui.get(A.id),"hui_radiobutton_selected",A.value==this.value)}},setValue:function(A){this.value=A;this.updateUI()},getValue:function(){if(!this.enabled){return null}return this.value},reset:function(){this.setValue(this.defaultValue)},setEnabled:function(A){this.enabled=A==true;hui.cls.set(this.element,"hui_radiobuttons_disabled",!this.enabled)},registerRadiobutton:function(B){this.radios.push(B);var C=hui.get(B.id);var A=this;C.onclick=function(){if(!A.enabled){return }A.setValue(B.value);A.fire("valueChanged",B.value);hui.ui.callAncestors(A,"childValueChanged",B.value)}}};hui.ui.NumberField=function(B){this.options=hui.override({min:0,max:undefined,value:null,tickSize:1,decimals:0,allowNull:false},B);this.name=B.name;var A=this.element=hui.get(B.element);this.input=hui.get.firstByTag(A,"input");this.up=hui.get.firstByClass(A,"hui_numberfield_up");this.down=hui.get.firstByClass(A,"hui_numberfield_down");if(hui.isString(this.options.value)){this.value=parseInt(this.options.value,10)}else{this.value=this.options.value}if(isNaN(this.value)){this.value=null}hui.ui.extend(this);this._addBehavior()};hui.ui.NumberField.create=function(A){A.element=hui.build("span",{"class":"hui_numberfield",html:'<span><span><input type="text" value="'+(A.value!==undefined?A.value:"0")+'"/><a class="hui_numberfield_up"></a><a class="hui_numberfield_down"></a></span></span>'});return new hui.ui.NumberField(A)};hui.ui.NumberField.prototype={_addBehavior:function(){var A=this.element;hui.listen(this.input,"focus",this._onFocus.bind(this));hui.listen(this.input,"blur",this._onBlur.bind(this));hui.listen(this.input,"keyup",this._onKey.bind(this));hui.listen(this.up,"mousedown",this.upEvent.bind(this));hui.listen(this.down,"mousedown",this.downEvent.bind(this))},_onBlur:function(){hui.cls.remove(this.element,"hui_numberfield_focused");this._updateField();if(this.sliderPanel){this.sliderPanel.hide()}},_onFocus:function(){hui.cls.add(this.element,"hui_numberfield_focused");this._showSlider();this._updateSlider()},_onKey:function(B){B=B||window.event;if(B.keyCode==hui.KEY_UP){hui.stop(B);this.upEvent()}else{if(B.keyCode==hui.KEY_DOWN){this.downEvent()}else{var A=parseFloat(this.input.value,10);if(!isNaN(A)){this._setLocalValue(A,true)}else{this._setLocalValue(null,true)}}}},downEvent:function(A){hui.stop(A);if(this.value===null){this._setLocalValue(this.options.min,true)}else{this._setLocalValue(this.value-this.options.tickSize,true)}this._updateField()},upEvent:function(A){hui.stop(A);this._setLocalValue(this.value+this.options.tickSize,true);this._updateField()},focus:function(){try{this.input.focus()}catch(A){}},getValue:function(){return this.value},getLabel:function(){return this.options.label},setValue:function(A){if(A===null||A===undefined){this._setLocalValue(null,false)}else{A=parseFloat(A,10);if(!isNaN(A)){this._setLocalValue(A,false)}}this._updateField()},_updateField:function(){this.input.value=this.value===null||this.value===undefined?"":this.value},_setLocalValue:function(B,A){var C=this.value;if(B===null||B===undefined&&this.options.allowNull){this.value=null}else{B=this._getValueWithinRange(B);this.value=this._round(B)}if(A&&C!==this.value){this.fireValueChange()}this._updateSlider()},_round:function(B){if(this.options.decimals!==undefined){var A=Math.pow(10,this.options.decimals);B=Math.round(B*A)/A}return B},reset:function(){if(this.options.allowNull){this.value=null}else{this.value=this._getValueWithinRange(0)}this._updateField()},_getValueWithinRange:function(A){if(hui.isDefined(this.options.min)){A=Math.max(A,this.options.min)}if(hui.isDefined(this.options.max)){A=Math.min(A,this.options.max)}return A},_onSliderChange:function(A){var B=this.options.min+(this.options.max-this.options.min)*A;this._setLocalValue(B,true);this._updateField()},_showSlider:function(){if(this.options.min===undefined||this.options.max===undefined){return }if(!this.sliderPanel){this.sliderPanel=hui.ui.BoundPanel.create({variant:"light"});this.slider=hui.ui.Slider.create({width:200});this.slider.element.style.margin="0 3px";this.slider.listen({$valueChanged:this._onSliderChange.bind(this)});this.sliderPanel.add(this.slider)}this.sliderPanel.position({element:this.element,position:"vertical"});this.sliderPanel.show()},_updateSlider:function(){if(this.slider){this.slider.setValue((this.value-this.options.min)/(this.options.max-this.options.min))}},$$parentMoved:function(){if(this.sliderPanel&&this.sliderPanel.isVisible()){this.sliderPanel.position({element:this.element,position:"vertical"});this.sliderPanel.show()}}};hui.ui.TextField=function(A){this.options=hui.override({label:null,key:null,lines:1,maxHeight:100,animateUserChange:true},A);this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this);this.input=hui.get.firstByClass(this.element,"hui_formula_text");this.multiline=this.input.tagName.toLowerCase()=="textarea";this.placeholder=hui.get.firstByClass(this.element,"hui_field_placeholder");this.value=this.input.value;this._addBehavior()};hui.ui.TextField.create=function(B){B=hui.override({lines:1},B);var C,A;if(B.lines>1||B.multiline){A=hui.build("textarea",{"class":"hui_formula_text","rows":B.lines,style:"height: 32px;"});C=hui.build("span",{"class":"hui_formula_text_multiline"});C.appendChild(A)}else{A=hui.build("input",{"class":"hui_formula_text"});if(B.secret){A.setAttribute("type","password")}C=hui.build("span",{"class":"hui_field_singleline"});C.appendChild(A)}if(B.value!==undefined){A.value=B.value}B.element=hui.ui.wrapInField(C);return new hui.ui.TextField(B)};hui.ui.TextField.prototype={_addBehavior:function(){if(this.placeholder){var A=this;hui.ui.onReady(function(){window.setTimeout(function(){A.value=A.input.value;A._updateClass()},500)})}hui.ui.addFocusClass({element:this.input,classElement:this.element,"class":"hui_field_focused",widget:this});hui.listen(this.input,"keyup",this._onKeyUp.bind(this));hui.listen(this.input,"keydown",this._onKeyDown.bind(this));var B=this.element.getElementsByTagName("em")[0];if(B){this._updateClass();hui.listen(B,"mousedown",function(){window.setTimeout(function(){this.input.focus();this.input.select()}.bind(this))}.bind(this));hui.listen(B,"mouseup",function(){this.input.focus();this.input.select()}.bind(this))}},_updateClass:function(){hui.cls.set(this.element,"hui_field_dirty",this.value.length>0)},_onKeyDown:function(B){if(!this.multiline&&B.keyCode===hui.KEY_RETURN){hui.stop(B);this.fire("submit");var A=hui.ui.getAncestor(this,"hui_formula");if(A){A.submit()}return }},_onKeyUp:function(A){if(this.input.value==this.value){return }this.value=this.input.value;this._updateClass();this._expand(this.options.animateUserChange);hui.ui.callAncestors(this,"childValueChanged",this.input.value);this.fire("valueChanged",this.input.value)},focus:function(){try{this.input.focus()}catch(A){}},select:function(){try{this.input.focus();this.input.select()}catch(A){}},reset:function(){this.setValue("")},stress:function(){hui.ui.stress(this)},setValue:function(A){if(A===undefined||A===null){A=""}this.value=A;this.input.value=A;this._expand(this.options.animateValueChange)},getValue:function(){return this.input.value},getLabel:function(){return this.options.label},isEmpty:function(){return this.input.value==""},isBlank:function(){return hui.isBlank(this.input.value)},setError:function(A){var B=A?true:false;hui.cls.set(this.element,"hui_field_error",B);if(typeof (A)=="string"){hui.ui.showToolTip({text:A,element:this.element,key:this.name})}if(!B){hui.ui.hideToolTip({key:this.name})}},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){window.setTimeout(this._expand.bind(this))}},_expand:function(A){if(!this.multiline||!hui.dom.isVisible(this.element)){return }var B=hui.ui.getTextAreaHeight(this.input);B=Math.max(32,B);B=Math.min(B,this.options.maxHeight);if(A){this._updateOverflow();hui.animate(this.input,"height",B+"px",300,{ease:hui.ease.slowFastSlow,onComplete:function(){this._updateOverflow()}.bind(this)})}else{this.input.style.height=B+"px";this._updateOverflow()}},_updateOverflow:function(){if(!this.multiline){return }this.input.style.overflowY=this.input.clientHeight>=this.options.maxHeight?"auto":"hidden"}};hui.ui.Rendering=function(A){this.options=hui.override({clickObjects:false},A);this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Rendering.prototype={_click:function(A){A=hui.event(A)},setContent:function(A){this.element.innerHTML=A}};hui.ui.Icon=function(A){this.options=A;this.name=A.name;this.icon=this.options.icon;this.size=this.options.size;this.element=hui.get(A.element);hui.ui.extend(this);this._addBehavior()};hui.ui.Icon.prototype={_addBehavior:function(){hui.listen(this.element,"click",function(){this.fire("click")}.bind(this))},setSize:function(B){this.size=B;this.element.className="hui_icon_labeled hui_icon_labeled_"+this.size;var A=hui.get.firstByTag(this.element,"span");A.className="hui_icon_"+this.size;A.style.backgroundImage="url("+hui.ui.getIconUrl(this.options.icon,this.size)+")"}};hui.ui.ColorInput=function(A){this.options=hui.override({value:null},A);this.name=A.name;this.element=hui.get(A.element);this.button=hui.get.firstByTag(this.element,"a");this.input=new hui.ui.Input({element:hui.get.firstByTag(this.element,"input"),validator:{validate:function(C){var B=new hui.Color(C);return{valid:true,value:B.toHex()}}}});this.input.listen({$valueChanged:this._onInputChange.bind(this)});this.value=null;hui.ui.extend(this);this.setValue(this.options.value);this._addBehavior()};hui.ui.ColorInput.create=function(A){A=A||{};var B=A.element=hui.build("span",{"class":"hui_colorinput",html:'<span class="hui_field_top"><span><span></span></span></span><span class="hui_field_middle"><span class="hui_field_middle"><span class="hui_field_content"><span class="hui_field_singleline"><input type="text" value=""/></span></span></span></span><span class="hui_field_bottom"><span><span></span></span></span><a tabindex="-1" class="hui_colorinput" href="javascript://"></a>'});return new hui.ui.ColorInput(A)};hui.ui.ColorInput.prototype={_addBehavior:function(){hui.ui.addFocusClass({element:this.input.element,classElement:this.element,"class":"hui_field_focused"});hui.listen(this.button,"click",this._onButtonClick.bind(this))},_syncInput:function(){this.input.setValue(this.value)},_syncColorButton:function(){this.button.innerHTML=this.value?"":"?";this.button.style.backgroundColor=this.value?this.value:""},_onInputChange:function(A){var B=A!=this.value;this.value=A;this._syncColorButton();if(B){this._fireChange()}},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)},_onBlur:function(){hui.Color.parse(this.value)},_onButtonClick:function(){if(hui.window.getViewHeight()<200){this.fire("clickPicker",this.value);return }if(!this.panel){this.panel=hui.ui.BoundPanel.create({modal:true});this.picker=hui.ui.ColorPicker.create();this.picker.listen(this);this.panel.add(this.picker)}this.panel.position(this.button);this.panel.show()},$colorWasSelected:function(A){this.panel.hide();this.setValue(A);this._fireChange()},getValue:function(){return this.value},setValue:function(A){this.value=new hui.Color(A).toHex();this._syncInput();this._syncColorButton()},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")}};hui.ui.Columns=function(A){this.name=A.name;this.options=A||{};this.element=hui.get(A.element);this.body=hui.get.firstByTag(this.element,"tr");hui.ui.extend(this)};hui.ui.Columns.create=function(A){A=A||{};A.element=hui.build("table",{"class":"hui_columns",html:"<tbody><tr></tr></tbody>"});return new hui.ui.Columns(A)};hui.ui.Columns.prototype={addToColumn:function(A,B){var C=this._ensureColumn(A);C.appendChild(B.getElement())},setColumnStyle:function(A,B){var C=this._ensureColumn(A);hui.style.set(C,B)},setColumnWidth:function(A,B){var C=this._ensureColumn(A);C.style.width=B+"px"},_ensureColumn:function(A){var C=hui.get.children(this.body);for(var B=C.length-1;B<A;B++){this.body.appendChild(hui.build("td",{"class":"hui_columns_column"}))}return hui.get.children(this.body)[A]}};hui.ui.Finder=function(A){this.options=hui.override({title:"Finder",selection:{},list:{}},A);this.name=A.name;hui.ui.extend(this);if(A.listener){this.listen(A.listener)}};hui.ui.Finder.create=function(A){return new hui.ui.Finder(A)};hui.ui.Finder.prototype={show:function(){if(!this.window){this._build()}this.window.show()},hide:function(){if(this.window){this.window.hide()}},clear:function(){this.list.clearSelection()},_build:function(){var F=this.window=hui.ui.Window.create({title:this.options.title,icon:"common/search",width:600});var E=hui.ui.Layout.create();F.add(E);var B=hui.ui.Overflow.create({height:400});E.addToLeft(B);var G=this.list=hui.ui.List.create();this.list.listen({$open:function(L){},$select:this._selectionChanged.bind(this)});if(this.options.search){var H=hui.ui.Bar.create({variant:"layout"});var K=hui.ui.SearchField.create({expandedWidth:200});K.listen({$valueChanged:function(){G.resetState()}});H.addToRight(K);E.addToCenter(H)}var I=hui.ui.Overflow.create({height:400});E.addToCenter(I);I.add(this.list);this.selection=hui.ui.Selection.create({value:this.options.selection.value});this.selection.listen({$select:function(){G.resetState()}});var A=new hui.ui.Source({url:this.options.selection.url});this.selection.addItems({source:A});B.add(this.selection);var J=[];if(this.options.list.url){J=[{key:"windowSize",value:10},{key:"windowPage",value:"@"+G.name+".window.page"},{key:"direction",value:"@"+G.name+".sort.direction"},{key:"sort",value:"@"+G.name+".sort.key"}]}if(this.options.selection.parameter){J.push({key:this.options.selection.parameter||"text",value:"@"+this.selection.name+".value"})}if(this.options.selection.kindParameter){J.push({key:this.options.selection.kindParameter||"text",value:"@"+this.selection.name+".kind"})}if(this.options.search){J.push({key:this.options.search.parameter||"text",value:"@"+K.name+".value"})}if(this.options.list.pageParameter){J.push({key:this.options.list.pageParameter,value:"@"+G.name+".window.page"})}var C=this.options.list.source;if(C){hui.log(J);for(var D=0;D<J.length;D++){C.addParameter(J[D])}}if(this.options.list.url){C=new hui.ui.Source({url:this.options.list.url,parameters:J})}this.list.setSource(C);A.refresh()},_selectionChanged:function(){var A=this.list.getFirstSelection();if(A!=null){this.fire("select",A)}}};hui.ui.Structure=function(A){this.name=A.name;this.options=A||{};this.element=hui.get(A.element);hui.ui.extend(this)};hui.ui.Structure.prototype={$$layout:function(){hui.log("layout structure");var C=hui.get.firstByClass(this.element,"hui_structure_top");var B=hui.get.firstByClass(this.element,"hui_structure_bottom");var A=hui.get.firstByClass(this.element,"hui_structure_middle");if(A){A.style.top=(C?C.clientHeight+2:0)+"px";A.style.bottom=(B?B.clientHeight+2:0)+"px"}}};hui.ui.Slider=function(A){this.options=hui.override({value:0,min:0,max:1},A);this.name=A.name;this.element=hui.get(A.element);this.handler=hui.get.firstByTag(A.element,"a");hui.ui.extend(this);this.position=0;this.value=0;this.setValue(this.options.value);this._addBehavior()};hui.ui.Slider.create=function(A){A=hui.override({},A);var B=A.element=hui.build("span",{"class":"hui_slider",html:'<a href="javascript://"></a><span></span>'});if(A.width){B.style.width=A.width+"px"}return new hui.ui.Slider(A)};hui.ui.Slider.prototype={_addBehavior:function(){hui.drag.register({element:this.handler,onBeforeMove:this._onBeforeMove.bind(this),onMove:this._onMove.bind(this),onAfterMove:this._onAfterMove.bind(this)})},_onBeforeMove:function(A){this.dragging=true;var B=hui.position.get(this.handler);this.dragInfo={left:hui.position.getLeft(this.element),diff:A.getLeft()-B.left,max:this.element.clientWidth-this.handler.clientWidth-5};hui.cls.add(this.element,"hui_slider_active")},_onMove:function(A){var B=A.getLeft()-this.dragInfo.left;B=(B-this.dragInfo.diff);B=Math.max(B,5);B=Math.min(B,this.dragInfo.max);this.handler.style.left=B+"px";this._setPosition((B-5)/(this.dragInfo.max-5))},_onAfterMove:function(){this.dragging=false;hui.cls.remove(this.element,"hui_slider_active");this.fire("valueChangedEnd",this.position)},_setPosition:function(A){this.position=A;this.fire("valueChanged",A)},setValue:function(B){var C=Math.max(0,Math.min(B,1));var A=this.element.clientWidth-10-this.handler.clientWidth;if(!this.dragging){hui.animate({node:this.handler,css:{left:(C*A+5)+"px"},duration:200,ease:hui.ease.fastSlow})}this.position=this.value=C}};hui.ui.CodeInput=function(A){this.options=hui.override({},A);this.name=A.name;var B=this.element=hui.get(A.element);this.textarea=hui.get.firstByTag(B,"textarea");if(A.value){this.textarea.value=A.value}this.value=this.textarea.value;hui.ui.extend(this);this._addBehavior()};hui.ui.CodeInput.create=function(A){A=A||{};A.element=hui.build("div",{className:"hui_codeinput",html:'<textarea spellcheck="false"></textarea>'});return new hui.ui.CodeInput(A)};hui.ui.CodeInput.prototype={_addBehavior:function(){hui.listen(this.textarea,"keydown",this._onKeyDown.bind(this));hui.listen(this.textarea,"keyup",this._onKeyUp.bind(this))},getValue:function(){return this.textarea.value},setValue:function(A){this.textarea.value=A;this.value=A},reset:function(){this.setValue("")},_onKeyUp:function(){if(this.textarea.value!==this.value){this.value=this.textarea.value;this.fireValueChange()}},_onKeyDown:function(I){var C=String.fromCharCode(9);var Q=window.event||I;var G=Q.target?Q.target:Q.srcElement?Q.srcElement:Q.which;var B=G.scrollTop;var O=Q.keyCode?Q.keyCode:Q.charCode?Q.charCode:Q.which;if(O==9&&!Q.ctrlKey&&!Q.altKey){if(G.setSelectionRange){Q.preventDefault();var M=G.selectionStart;var T=G.selectionEnd;if(M!=T&&G.value.slice(M,T).indexOf("\n")!=-1){if(M>0){M=G.value.slice(0,M).lastIndexOf("\n")+1}var L=G.value.slice(0,M);var N=G.value.slice(M,T);var P=G.value.slice(T,G.value.length);if(Q.shiftKey){var S=N.split("\n");for(i=0;i<S.length;i++){if(S[i].slice(0,1)==C||S[i].slice(0,1)==" "){S[i]=S[i].slice(1,S[i].length)}}N=S.join("\n");G.value=L.concat(N,P);G.selectionStart=M;G.selectionEnd=L.length+N.length}else{N=N.replace(/\n/g,"\n"+C);L=L.concat(C);G.value=L.concat(N,P);G.selectionStart=M;G.selectionEnd=T+(C.length*N.split("\n").length)}}else{if(Q.shiftKey){var H=G.value.slice(0,M);var F=H.slice(H.length-1,H.length);if(F==C||F==" "){G.value=H.slice(0,H.length-1).concat(G.value.slice(M,G.value.length));G.selectionStart=M-1;G.selectionEnd=T-1}}else{G.value=G.value.slice(0,M).concat(C).concat(G.value.slice(M,G.value.length));if(M==T){G.selectionStart=G.selectionEnd=M+C.length}else{G.selectionStart=M+C.length;G.selectionEnd=T+C.length}}}}else{Q.returnValue=false;var J=document.selection.createRange();var R=document.body.createTextRange();R.moveToElementText(G);R.setEndPoint("EndToStart",J);if(J.text.length==0||J.text.indexOf("\n")==-1){if(Q.shiftKey){var F=R.text.slice(R.text.length-1,R.text.length);if(F==C||F==" "){R.text=R.text.slice(0,R.text.length-1);J.setEndPoint("StartToEnd",R)}}else{var D=G.value.slice(R.text.length,R.text.length+1);if(D!=J.text.slice(0,1)){R.text=R.text.concat(D)}R.text=R.text.concat(C)}var A=document.body.createTextRange();A.setEndPoint("StartToEnd",R);A.setEndPoint("EndToEnd",J);A.select()}else{if(Q.shiftKey){var S=J.text.split("\r\n");var E=G.value.slice(R.text.length,R.text.length+2);if(E==J.text.slice(0,2)){var K=R.text.lastIndexOf("\r\n".concat(C));if(K!=-1){R.text=R.text.slice(0,K+2).concat(R.text.slice(K+3,R.text.length))}}for(i=0;i<S.length;i++){var F=S[i].length>0&&S[i].slice(0,1);if(F==C||F==" "){S[i]=S[i].slice(1,S[i].length)}}J.text=S.join("\r\n")}else{if(R.text.length>0){var E=G.value.slice(R.text.length,R.text.length+2);if(E!=J.text.slice(0,2)){J.text=C.concat(J.text.split("\r\n").join("\r\n".concat(C)))}else{var K=R.text.slice(0,M).lastIndexOf("\r\n")+2;R.text=R.text.slice(0,K).concat(C,R.text.slice(K,R.text.length));J.text=J.text.split("\r\n").join("\r\n".concat(C))}}else{J.text=C.concat(J.text).split("\r\n").join("\r\n".concat(C))}}var A=document.body.createTextRange();A.setEndPoint("StartToEnd",R);A.setEndPoint("EndToEnd",J);A.select()}}}G.scrollTop=B}};hui.ui.ObjectInput=function(A){var B=this.element=hui.get(A.element);this.options=hui.override({types:[]},A);this.types=this.options.types;this.name=A.name;this.value=A.value;this.input=new hui.ui.Input({element:hui.get.firstByTag(B,"input")});this.input.listen({$valueChanged:this._onInputChange.bind(this)});this.object=hui.get.firstByClass(B,"hui_objectinput_object");this.dropdown=new hui.ui.DropDown({element:hui.get.firstByClass(B,"hui_dropdown"),value:"none",items:this._buildDropDownOptions(),listener:{$valueChanged:this._onDropDownChange.bind(this)}});hui.ui.extend(this);this._addBehavior()};hui.ui.ObjectInput.prototype={_addBehavior:function(){},_buildDropDownOptions:function(){var A=[{value:"none",text:"Intet link"}];for(var B=0;B<this.options.types.length;B++){var C=this.options.types[B];A.push({value:C.key,text:C.label})}return A},_getType:function(B){for(var A=0;A<this.types.length;A++){if(this.types[A].key==B){return this.types[A]}}},_onInputChange:function(A){this.value={type:this.dropdown.getValue(),value:A};this._updateUI();this.fireValueChange()},_onDropDownChange:function(B){this._closeAllFinders();var A=this._getType(B);if(!A){this.input.element.style.display=this.object.style.display="none";return }this.input.element.style.display=!A.finderOptions?"":"none";this.object.style.display=A.finderOptions?"":"none";if(A.finderOptions){if(!A._finder){A._finder=hui.ui.Finder.create(A.finderOptions);A._finder.listen({$select:function(C){this._selectObject(A,C)}.bind(this)})}A._finder.show();this.value={type:B,value:null}}else{this.input.focus();this.input.setValue("");this.value={type:B,value:""}}this._updateUI();this.fireValueChange()},_closeAllFinders:function(){for(var A=0;A<this.types.length;A++){if(this.types[A]._finder){this.types[A]._finder.hide()}}},_selectObject:function(B,A){this.value={type:B.key,value:A};this._updateUI();this._closeAllFinders();this.fireValueChange()},_updateUI:function(){var C=this.value;if(!hui.isDefined(C)){this.dropdown.setValue("none");this.input.element.style.display=this.object.style.display="none"}else{var B=this._getType(C.type);if(B){this.dropdown.setValue(C.type);this.input.element.style.display=!B.finderOptions?"":"none";this.object.style.display=B.finderOptions?"":"none";if(!B.finderOptions){this.input.value=C.value}else{var D=hui.get.firstByClass(this.element,"hui_objectinput_title"),A=hui.get.firstByClass(this.element,"hui_objectinput_icon");if(!C.value){this.object.style.display="none"}else{this.object.style.display="";if(hui.isDefined(C.value.title)){hui.dom.setText(D,hui.string.shorten(C.value.title,40))}else{this._setBusy(true);hui.ui.request({url:B.lookupUrl,parameters:{id:C.value.id},onJSON:function(E){hui.dom.setText(D,hui.string.shorten(E.title,40));this._setBusy(false)}.bind(this),onFailure:function(){hui.dom.setText(D,"!!Error");this._setBusy(false)}.bind(this)})}A.style.backgroundImage="url('"+hui.ui.getIconUrl(B.icon,16)+"')"}}}}},_setBusy:function(A){this.busy=A;hui.cls.set(this.element,"hui_objectinput_busy",A)},getValue:function(){return this.value},setValue:function(A){this.value=A;this._updateUI()},reset:function(){this.setValue(null)}};hui.ui.FontInput=function(A){this.options=hui.override({value:null},A);this.name=A.name;this.element=hui.get(A.element);this.button=hui.get.firstByClass(this.element,"hui_fontinput");this.dropdown=new hui.ui.DropDown({element:hui.get.firstByClass(this.element,"hui_dropdown"),items:[{text:"",value:""}].concat(hui.ui.FontPicker.fonts),listener:this});this.value=null;hui.ui.extend(this);this.setValue(this.options.value);this._addBehavior()};hui.ui.FontInput.create=function(A){A=A||{};var B=A.element=hui.build("span",{"class":"hui_colorinput",html:'<span class="hui_field_top"><span><span></span></span></span><span class="hui_field_middle"><span class="hui_field_middle"><span class="hui_field_content"><span class="hui_field_singleline"><input type="text" value=""/></span></span></span></span><span class="hui_field_bottom"><span><span></span></span></span><a tabindex="-1" class="hui_colorinput" href="javascript://"></a>'});return new hui.ui.ColorInput(A)};hui.ui.FontInput.prototype={_addBehavior:function(){hui.listen(this.button,"click",this._onButtonClick.bind(this))},_syncInput:function(){this.dropdown.setValue(this.value)},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)},_onBlur:function(){hui.Color.parse(this.value)},_onButtonClick:function(){if(hui.window.getViewHeight()<200){this.fire("clickPicker",this.value);return }if(!this.panel){this.panel=hui.ui.BoundPanel.create({modal:true,variant:"light"});this.picker=hui.ui.FontPicker.create();this.picker.listen(this);this.panel.add(this.picker)}this.panel.position(this.button);this.panel.show()},$select:function(A){this.panel.hide();this.setValue(A.value);this._fireChange()},$valueChanged:function(A){this.setValue(A);this._fireChange()},getValue:function(){return this.value},setValue:function(A){this.value=A;this._syncInput();this.button.style.fontFamily=A},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")}};hui.ui.FontPicker=function(A){this.name=A.name;this.element=hui.get(A.element);this.fonts=A.fonts.concat(A.additionalFonts);this.previews={};this.options=A||{};hui.override(this.options,A);hui.ui.extend(this);if(this.options.listener){this.listen(this.options.listener)}this._addBehavior()};hui.ui.FontPicker.fonts=[{text:"Verdana",value:"Verdana,sans-serif"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Trebuchet",value:"Trebuchet MS,Helvetica,sans-serif"},{text:"Geneva",value:"Geneva,Tahoma,sans-serif"},{text:"Helvetica",value:"Helvetica,Arial,sans-serif"},{text:"Helvetica Neue",value:"Helvetica Neue,Helvetica,Arial,sans-serif"},{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Arial Black",value:"Arial Black,Gadget,Arial,sans-serif"},{text:"Impact",value:"Impact,Charcoal,Arial Black,Gadget,Arial,sans-serif"},{text:"Times New Roman",value:"Times New Roman,Times,serif"},{text:"Times",value:"Times,Times New Roman,serif"},{text:"Book Antiqua",value:"Book Antiqua,Palatino,serif"},{text:"Palatino",value:"Palatino,Book Antiqua,serif"},{text:"Georgia",value:"Georgia,Book Antiqua,Palatino,serif"},{text:"Garamond",value:"Garamond,Times New Roman,Times,serif"},{text:"Comic Sans",value:"Comic Sans MS,cursive"},{text:"Courier New",value:"Courier New,Courier,monospace"},{text:"Courier",value:"Courier,Courier New,monospace"},{text:"Lucida Console",value:"Lucida Console,Monaco,monospace"},{text:"Monaco",value:"Monaco,Lucida Console,monospace"}];hui.ui.FontPicker.create=function(B){B=hui.override({fonts:hui.ui.FontPicker.fonts,additionalFonts:[]},B);var G=B.fonts.concat(B.additionalFonts);var D=B.element=hui.build("div",{"class":"hui_fontpicker"});for(var C=0;C<G.length;C++){var A=G[C];var F=hui.build("div",{parent:D,"class":"hui_fontpicker_item",text:A.text,style:"font-family:"+A.value+";"});var E=hui.ui.createIcon("monochrome/info",16,"a");F.appendChild(E);F.huiIndex=C}return new hui.ui.FontPicker(B)};hui.ui.FontPicker.prototype={_addBehavior:function(){hui.listen(this.element,"click",this._onClick.bind(this))},_onClick:function(D){D=hui.event(D);var C=D.findByClass("hui_fontpicker_item");if(C){var A=D.findByClass("hui_icon");var B=this.fonts[C.huiIndex];if(A){this._buildPreview(B)}else{this.fire("select",B)}}},$visibilityChanged:function(){if(!hui.dom.isVisible(this.element)){hui.each(this.previews,function(A,B){B.hide()})}},_buildPreview:function(A){if(this.previews[A.text]){this.previews[A.text].show();return }var H=hui.build("div",{className:"hui_fontpicker_example",style:"font-family:"+A.value+";"});var E=[100,200,300,"normal",500,600,"bold","bolder"];var F=["9pt","10pt","11pt","12pt","13pt","14pt","16px","18pt"];var D="<h1>"+A.text+"</h1>";D+='<p style="font-size: 12px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>';D+="<table>";D+="<thead><tr><th></th>";for(var C=0;C<E.length;C++){D+="<th>"+E[C]+"</th>"}D+="</tr></thead>";D+="<tbody>";for(var C=0;C<F.length;C++){D+="<tr><th>"+F[C]+"</th>";for(var B=0;B<E.length;B++){D+='<td style="font-weight: '+E[B]+"; font-size:"+F[C]+';">Pack my box with five dozen liquor jugs</td>'}}D+="</tbody>";H.innerHTML=D;var G=hui.ui.Window.create({title:A.text,padding:3});G.add(H);this.previews[A.text]=G;G.show()}};hui.ui.Split=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);this.rows=hui.get.children(this.element);this.handles=[];this.sizes=[];for(var B=0;B<this.rows.length;B++){if(B>0){this.handles.push(hui.build("div",{"class":"hui_split_handle",parent:this.element}))}}this._buildSizes();hui.ui.extend(this);this._addBehavior()};hui.ui.Split.prototype={_buildSizes:function(){this.sizes=[];for(var B=0;B<this.rows.length;B++){var F=this.rows[B],E=F.getAttribute("data-height");if(E){this.sizes.push(this._getSize(E))}else{this.sizes.push(0)}}var D=0,A=0;for(var B=0;B<this.sizes.length;B++){D+=this.sizes[B];A+=this.sizes[B]==0?1:0}var C=(1-D)/A;for(var B=0;B<this.sizes.length;B++){if(this.sizes[B]==0){this.sizes[B]=C}}},_getSize:function(A){if(A.indexOf("%")!=-1){return parseInt(A)/100}return parseInt(A)/this.element.clientHeight},_addBehavior:function(){},$$layout:function(){this._layout()},_getSiblingHeight:function(D){var A=D.parentNode.clientHeight;var E=D.parentNode.childNodes;for(var C=0;C<E.length;C++){var B=E[C];if(B!==D&&hui.dom.isElement(E[C])){if(hui.style.get(B,"position")!="absolute"){A-=B.offsetHeight}}}return A},_layout:function(){var D=0,C=hui.position.getRemainingHeight(this.element);for(var B=0;B<this.rows.length;B++){this.rows[B].style.top=(D*C)+"px";var A=(this.sizes[B]*C);if(B<this.rows.length-1){A-=6}this.rows[B].style.height=A+"px";D+=this.sizes[B];if(B<this.rows.length-1){this.handles[B].style.top=(D*C)+"px"}}}}