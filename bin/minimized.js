hui=window.hui||{},function(a,b,c){a.KEY_BACKSPACE=8,a.KEY_TAB=9,a.KEY_RETURN=13,a.KEY_ESC=27,a.KEY_LEFT=37,a.KEY_UP=38,a.KEY_RIGHT=39,a.KEY_DOWN=40,a.KEY_DELETE=46,a.KEY_HOME=36,a.KEY_END=35,a.KEY_PAGEUP=33,a.KEY_PAGEDOWN=34,a.KEY_INSERT=45,a.browser={};var d=a.browser;d.msie=!/opera/i.test(b)&&/MSIE/.test(b)||/Trident/.test(b),d.msie6=b.indexOf("MSIE 6")!==-1,d.msie7=b.indexOf("MSIE 7")!==-1,d.msie8=b.indexOf("MSIE 8")!==-1,d.msie9=b.indexOf("MSIE 9")!==-1,d.msie9compat=d.msie7&&b.indexOf("Trident/5.0")!==-1,d.msie10=b.indexOf("MSIE 10")!==-1,d.msie11=b.indexOf("Trident/7.0")!==-1,d.webkit=b.indexOf("WebKit")!==-1,d.safari=b.indexOf("Safari")!==-1,d.webkitVersion=null,d.gecko=!d.webkit&&!d.msie&&b.indexOf("Gecko")!==-1,d.ipad=d.webkit&&b.indexOf("iPad")!==-1,d.windows=b.indexOf("Windows")!==-1,d.opacity=!d.msie6&&!d.msie7&&!d.msie8,d.mediaQueries=d.opacity,d.animation=!(d.msie6||d.msie7||d.msie8||d.msie9),d.wordbreak=!d.msie6&&!d.msie7&&!d.msie8,d.touch=!!("ontouchstart"in c||"onmsgesturechange"in c&&c.navigator.maxTouchPoints);var e=/Safari\/([\d.]+)/.exec(b);e&&(d.webkitVersion=parseFloat(e[1]))}(hui,navigator.userAgent,window),hui.log=function(a){window.console&&window.console.log&&(1==arguments.length?console.log(a):2==arguments.length?console.log(arguments[0],arguments[1]):console.log(arguments))},hui._demanded=[],hui.define=function(a,b){for(var c=hui._demanded,d=c.length-1;d>=0;d--){var e=c[d];hui.array.remove(e.requirements,a),0==e.requirements.length&&(e.callback(),c.splice(d,1))}},hui.demand=function(){for(var a=arguments[0],b=arguments[1],c=[],d=0;d<a.length;d++){var e=hui.evaluate(a[d]);if(!e){c=!1;break}c[d]=e}c?b(c):(hui.log("deferring: "+a),hui._demanded.push({requirements:a,callback:b}))},hui.evaluate=function(a){for(var b=a.split("."),c=window,d=0;d<b.length&&void 0!==c;d++)c=c[b[d]];return c},hui.defer=function(a,b){b&&(a=a.bind(b)),window.setTimeout(a)},hui.extend=function(a,b){function c(){this.constructor=a}var d=a.prototype;for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);if(c.prototype=b.prototype,a.prototype=new c,d)for(var e in d)a.prototype[e]=d[e]},hui.override=function(a,b){if(b)for(var c in b)a[c]=b[c];return a},hui.each=function(a,b){var c;if(hui.isArray(a))for(c=0;c<a.length;c++)b(a[c],c);else if(a instanceof NodeList)for(c=0;c<a.length;c++)b(a.item(c),c);else for(var d in a)b(d,a[d])},hui.when=function(a,b){return a?b:""},hui.intOrString=function(a){if(hui.isDefined(a)){var b=/[0-9]+/.exec(a);if(null!==b&&b[0]==a&&parseInt(a,10)==a)return parseInt(a,10)}return a},hui.between=function(a,b,c){var d=Math.min(c,Math.max(a,b));return isNaN(d)?a:d},hui.fit=function(a,b,c){c=c||{};var d,e,f=a.width/a.height,g=b.width/b.height;return c.upscale===!1&&a.width<=b.width&&a.height<=b.height?(d=a.width,e=a.height):f>g?(d=b.width,e=Math.round(b.width/a.width*a.height)):(d=Math.round(b.height/a.height*a.width),e=b.height),{width:d,height:e}},hui.isBlank=function(a){return null===a||"undefined"==typeof a||""===a||"string"==typeof a&&0===hui.string.trim(a).length},hui.isDefined=function(a){return null!==a&&"undefined"!=typeof a},hui.isString=function(a){return"string"==typeof a},hui.isNumber=function(a){return"number"==typeof a},hui.isArray=function(a){return null!==a&&void 0!==a&&(a.constructor==Array||"[object Array]"===Object.prototype.toString.call(a))},hui.string={startsWith:function(a,b){return"string"==typeof a&&"string"==typeof b&&a.match("^"+b)==b},endsWith:function(a,b){return"string"==typeof a&&"string"==typeof b&&a.match(b+"$")==b},camelize:function(a){if(a.indexOf("-")==-1)return a;for(var b=a.split("-"),c=0===a.indexOf("-")?b[0].charAt(0).toUpperCase()+b[0].substring(1):b[0],d=1,e=b.length;d<e;d++){var f=b[d];c+=f.charAt(0).toUpperCase()+f.substring(1)}return c},trim:function(a){return null===a||void 0===a?"":("string"!=typeof a&&(a=String(a)),a.replace(/^[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+|[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+$/g,""))},wrap:function(a){return null===a||void 0===a?"":a.split("").join("â€‹")},shorten:function(a,b){if(hui.isNumber(a))a+="";else if(!hui.isString(a))return"";return a.length>b?a.substring(0,b-3)+"...":a},escapeHTML:function(a){return null===a||void 0===a?"":hui.build("div",{text:a}).innerHTML},escape:function(a){if(!hui.isString(a))return a;var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return a.replace(/[&<>'`"]/g,function(a){return b[a]||a})},fromJSON:function(a){try{return JSON.parse(a)}catch(a){return hui.log(a),null}},toJSON:function(a){return JSON.stringify(a)}},hui.array={add:function(a,b){if(b.constructor==Array)for(var c=0;c<b.length;c++)hui.array.contains(a,b[c])||a.push(b);else hui.array.contains(a,b)||a.push(b)},contains:function(a,b){return hui.array.indexOf(a,b)!==-1},flip:function(a,b){hui.array.contains(a,b)?hui.array.remove(a,b):a.push(b)},remove:function(a,b){for(var c=a.length-1;c>=0;c--)a[c]==b&&a.splice(c,1)},indexOf:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},toIntegers:function(a){for(var b=a.split(","),c=b.length-1;c>=0;c--)b[c]=parseInt(b[c],10);return b}},hui.dom={isElement:function(a,b){return 1==a.nodeType&&(void 0===b||a.nodeName.toLowerCase()==b)},isDefinedText:function(a){return 3==a.nodeType&&a.nodeValue.length>0},addText:function(a,b){a.appendChild(document.createTextNode(b))},firstChild:function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(1==b[c].nodeType)return b[c];return null},parse:function(a){var b=hui.build("div",{html:a});return hui.get.firstChild(b)},clear:function(a){for(var b=a.childNodes,c=b.length-1;c>=0;c--)b[c].parentNode.removeChild(b[c])},remove:function(a){a.parentNode&&a.parentNode.removeChild(a)},replaceNode:function(a,b){b.parentNode&&b.parentNode.removeChild(b),a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a)},changeTag:function(a,b){for(var c=hui.build(b);a.firstChild;)c.appendChild(a.firstChild);for(var d=a.attributes.length-1;d>=0;--d)c.attributes.setNamedItem(a.attributes[d].cloneNode());return a.parentNode.insertBefore(c,a),a.parentNode.removeChild(a),c},insertBefore:function(a,b){a.parentNode.insertBefore(b,a)},insertAfter:function(a,b){var c=a.nextSibling;c?c.parentNode.insertBefore(b,c):a.parentNode.appendChild(b)},replaceHTML:function(a,b){a=hui.get(a),a.innerHTML=b},runScripts:function(node){if(hui.dom.isElement(node))if(hui.dom.isElement(node,"script"))eval(node.innerHTML);else for(var scripts=node.getElementsByTagName("script"),i=0;i<scripts.length;i++)eval(scripts[i].innerHTML)},setText:function(a,b){void 0!==b&&null!==b||(b="");for(var c=a.childNodes,d=!1,e=c.length-1;e>=0;e--)d||3!==c[e].nodeType?a.removeChild(c[e]):(c[e].nodeValue=b,d=!0);d||hui.dom.addText(a,b)},getText:function(a){for(var b="",c=a.childNodes,d=0;d<c.length;d++)3===c[d].nodeType&&null!==c[d].nodeValue?b+=c[d].nodeValue:1==c[d].nodeType&&(b+=hui.dom.getText(c[d]));return b},isVisible:function(a){for(;a;){if(a.style&&("none"===hui.style.get(a,"display")||"hidden"===hui.style.get(a,"visibility")))return!1;a=a.parentNode}return!0},isDescendantOrSelf:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}},hui.form={getValues:function(a){for(var b={},c=a.getElementsByTagName("input"),d=0;d<c.length;d++)hui.isDefined(c[d].name)&&(b[c[d].name]=c[d].value);return b}},hui.get=function(a){return"string"==typeof a?document.getElementById(a):a},hui.get.children=function(a){for(var b=[],c=a.childNodes,d=0;d<c.length;d++)hui.dom.isElement(c[d])&&b.push(c[d]);return b},hui.get.ancestors=function(a){for(var b=[],c=a.parentNode;c;)b[b.length]=c,c=c.parentNode;return b},hui.get.firstAncestorByClass=function(a,b){for(;a;){if(hui.cls.has(a,b))return a;a=a.parentNode}return null},hui.get.next=function(a){if(!a)return null;if(a.nextElementSibling)return a.nextElementSibling;if(!a.nextSibling)return null;for(var b=a.nextSibling;b&&1!=b.nodeType;)b=b.nextSibling;return b&&1==b.nodeType?b:null},hui.get.previous=function(a){if(!a)return null;if(a.previousElementSibling)return a.previousElementSibling;if(!a.previousSibling)return null;for(var b=a.previousSibling;b&&1!=b.nodeType;)b=b.previousSibling;return b&&1==b.nodeType?b:null},hui.get.before=function(a){var b=[];if(a)for(var c=a.parentNode.childNodes,d=0;d<c.length&&c[d]!=a;d++)1===c[d].nodeType&&b.push(c[d]);return b},hui.get.after=function(a){for(var b=[],c=hui.get.next(a);c;)b.push(c),c=hui.get.next(c);return b},hui.get.firstByClass=function(a,b,c){if(a=hui.get(a)||document.body,a.querySelector)return a.querySelector((c?c+".":".")+b);for(var d=a.getElementsByTagName(c||"*"),e=0;e<d.length;e++)if(hui.cls.has(d[e],b))return d[e];return null},hui.get.byClass=function(a,b,c){a=hui.get(a)||document.body;var d;if(a.querySelectorAll){var e=a.querySelectorAll((c?c+".":".")+b),f=[];for(d=0,ll=e.length;d!=ll;f.push(e[d++]));return f}var g=a.getElementsByTagName(c||"*"),h=[];for(d=0;d<g.length;d++)hui.cls.has(g[d],b)&&(h[h.length]=g[d]);return h},hui.get.byTag=function(a,b){for(var c=a.getElementsByTagName(b),d=[],e=0,f=c.length;e!=f;d.push(c[e++]));return d},hui.get.byId=function(a,b){for(var c=a.childNodes,d=c.length-1;d>=0;d--){if(1===c[d].nodeType&&c[d].getAttribute("id")===b)return c[d];var e=hui.find("#"+b,c[d]);if(e)return e}return null},hui.get.firstParentByTag=function(a,b){for(var c=a;c;){if(c.tagName&&c.tagName.toLowerCase()==b)return c;c=c.parentNode}return null},hui.get.firstParentByClass=function(a,b){for(var c=a;c;){if(hui.cls.has(c))return c;c=c.parentNode}return null},hui.get.firstByTag=function(a,b){if(a=hui.get(a)||document.body,a.querySelector&&"*"!==b)return a.querySelector(b);var c=a.getElementsByTagName(b);return c[0]},hui.get.firstChild=hui.dom.firstChild,hui.find=function(a,b){return(b||document).querySelector(a)},hui.findAll=function(a,b){var c=(b||document).querySelectorAll(a);return Array.prototype.slice.call(c)},hui.closest=function(a,b){for(var c=b;c;){if(c.matches&&c.matches(a))return c;c=c.parentNode}},document.querySelector||(hui.find=function(a,b){return b=b||document.documentElement,"."==a[0]?hui.get.firstByClass(b,a.substr(1)):hui.get.firstByTag(b,a)}),hui.collect=function(a,b){var c={};for(key in a)c[key]=hui.find(a[key],b);return c},hui.build=function(a,b,c){c=c||document;var d="";if(a.indexOf(".")!==-1){var e=a.split(".");a=e[0];for(var f=1;f<e.length;f++)f>1&&(d+=" "),d+=e[f]}var g=c.createElement(a);if(d&&(g.className=d),b)for(var h in b)"text"==h?g.appendChild(c.createTextNode(b.text)):"html"==h?g.innerHTML=b.html:"parent"==h&&hui.isDefined(b.parent)?b.parent.appendChild(g):"parentFirst"==h?0===b.parentFirst.childNodes.length?b.parentFirst.appendChild(g):b.parentFirst.insertBefore(g,b.parentFirst.childNodes[0]):"before"==h?b.before.parentNode.insertBefore(g,b.before):"className"==h?hui.cls.add(g,b.className):"class"==h?hui.cls.add(g,b.class):"style"==h&&"object"==typeof b[h]?hui.style.set(g,b[h]):"style"==h&&(hui.browser.msie7||hui.browser.msie6)?g.style.setAttribute("cssText",b[h]):hui.isDefined(b[h])&&g.setAttribute(h,b[h]);return g},hui.position={getTop:function(a){if(a=hui.get(a)){for(var b=a.offsetTop,c=a.offsetParent;null!==c;)b+=c.offsetTop,c=c.offsetParent;return b}return 0},getLeft:function(a){if(a=hui.get(a)){for(var b=a.offsetLeft,c=a.offsetParent;null!==c;)b+=c.offsetLeft,c=c.offsetParent;return b}return 0},get:function(a){return{left:hui.position.getLeft(a),top:hui.position.getTop(a)}},getScrollOffset:function(a){a=hui.get(a);var b=0,c=0;do if(b+=a.scrollTop||0,c+=a.scrollLeft||0,a=a.parentNode,a&&"HTML"===a.tagName)break;while(a);return{top:b,left:c}},place:function(a){var b=0,c=0,d=hui.get(a.source.element),e=hui.get(a.target.element),f={left:hui.position.getLeft(e),top:hui.position.getTop(e)};if(b=f.left+e.clientWidth*(a.target.horizontal||0),c=f.top+e.clientHeight*(a.target.vertical||0),b-=d.clientWidth*(a.source.horizontal||0),c-=d.clientHeight*(a.source.vertical||0),a.top&&(c+=a.top),a.left&&(b+=a.left),a.insideViewPort){var g=hui.window.getViewWidth();b+d.clientWidth>g&&(b=g-d.clientWidth-(a.viewPortMargin||0)),b<0&&(b=0),c<0&&(c=0);var h=(hui.window.getViewHeight(),hui.window.getScrollTop()+hui.window.getViewHeight()-d.clientHeight),i=hui.window.getScrollTop();c=Math.max(Math.min(c,h),i)}d.style.top=Math.round(c)+"px",d.style.left=Math.round(b)+"px"},getRemainingHeight:function(a){for(var b=a.parentNode.clientHeight,c=a.parentNode.childNodes,d=0;d<c.length;d++){var e=c[d];e!==a&&hui.dom.isElement(c[d])&&"absolute"!=hui.style.get(e,"position")&&(b-=e.offsetHeight)}return b}},hui.window={getScrollTop:function(){return window.pageYOffset?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body?document.body.scrollTop:0},getScrollLeft:function(){return window.pageYOffset?window.pageXOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollLeft:document.body?document.body.scrollLeft:0},scrollTo:function(a){a=hui.override({duration:0,top:0},a);var b=a.element,c=hui.position.get(b),d=hui.window.getScrollTop(),e=hui.window.getViewHeight(),f=d+e;if(d<c.top+b.clientHeight||c.top<f){var g=c.top-Math.round((e-b.clientHeight)/2);g-=a.top/2,g=Math.max(0,g);var h,i=(new Date).getTime();h=function(){var b=((new Date).getTime()-i)/a.duration;b>1&&(b=1),window.scrollTo(0,d+Math.round((g-d)*hui.ease.fastSlow(b))),b<1&&window.setTimeout(h)},h()}},getViewHeight:function(){return window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body?document.body.clientHeight:void 0},getViewWidth:function(){return window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0}},hui.cls={has:function(a,b){if(a=hui.get(a),!a||!a.className)return!1;if(a.hasClassName)return a.hasClassName(b);if(a.className==b)return!0;if(void 0!==a.className.animVal)return!1;for(var c=a.className.split(/\s+/),d=0;d<c.length;d++)if(c[d]==b)return!0;return!1},add:function(a,b){a=hui.get(a),a&&(a.addClassName&&a.addClassName(b),hui.cls.remove(a,b),a.className+=" "+b)},remove:function(a,b){if(a=hui.get(a),a&&a.className){if(a.removeClassName&&a.removeClassName(b),a.className==b)return void(a.className="");for(var c="",d=a.className.split(/\s+/),e=0;e<d.length;e++)d[e]!=b&&(e>0&&(c+=" "),c+=d[e]);a.className=c}},toggle:function(a,b){hui.cls.has(a,b)?hui.cls.remove(a,b):hui.cls.add(a,b)},set:function(a,b,c){c?hui.cls.add(a,b):hui.cls.remove(a,b)}},hui.on=function(a,b,c,d){if("tap"==b){d&&(c=c.bind(d));var e=!1,f=!1;hui.listen(a,"touchstart",function(){f=!0,e=!1},d),hui.listen(a,"touchmove",function(){e=!0},d),hui.listen(a,"touchend",function(a){f=!1,e||(f=!0,c(a))},d),hui.listen(a,"click",function(a){e||f||c(a)},d)}else hui.listen(a,b,c,d)},hui.listen=function(a,b,c,d){a=hui.get(a),a&&(d&&(c=c.bind(d)),document.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,c))},hui.listenOnce=function(a,b,c){var d=null;d=function(e){hui.unListen(a,b,d),c(e)},hui.listen(a,b,d)},hui.unListen=function(a,b,c,d){a=hui.get(a),document.removeEventListener?a.removeEventListener(b,c,!!d):a.detachEvent("on"+b,c)},hui.event=function(a){return void 0!==a&&a.huiEvent===!0?a:new hui.Event(a)},hui.Event=function(a){this.huiEvent=!0,this.event=a=a||window.event,a||hui.log("No event"),this.element=a.target?a.target:a.srcElement,this.shiftKey=a.shiftKey,this.altKey=a.altKey,this.metaKey=a.metaKey,this.returnKey=13==a.keyCode,this.escapeKey=27==a.keyCode,this.spaceKey=32==a.keyCode,this.backspaceKey=8==a.keyCode,this.upKey=38==a.keyCode,this.downKey=40==a.keyCode,this.leftKey=37==a.keyCode,this.rightKey=39==a.keyCode,this.keyCode=a.keyCode},hui.Event.prototype={getLeft:function(){var a=0;return this.event&&(this.event.pageX?a=this.event.pageX:this.event.clientX&&(a=this.event.clientX+hui.window.getScrollLeft())),a},getTop:function(){var a=0;return this.event&&(this.event.pageY?a=this.event.pageY:this.event.clientY&&(a=this.event.clientY+hui.window.getScrollTop())),a},getElement:function(){return this.element},findByClass:function(a){return hui.get.firstAncestorByClass(this.element,a)},findByTag:function(a){return hui.closest(a,this.element)},find:function(a){for(var b=this.element;b;){if(a(b))return b;b=b.parentNode}return null},isDescendantOf:function(a){for(var b=this.element;b;){if(b===a)return!0;b=b.parentNode}return!1},stop:function(){hui.stop(this.event)}},hui.stop=function(a){a||(a=window.event),a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.stopped=!0},hui._=hui._||[],hui._ready="complete"==document.readyState,hui.onReady=function(){hui._ready?hui._handle(arguments):hui._.push(arguments)},hui.onDraw=function(a){window.setTimeout(a,13)},hui.onDraw=function(a,b){for(var c=b.requestAnimationFrame,d=0;d<a.length&&!c;++d)c=b[a[d]+"RequestAnimationFrame"];return c?c.bind(b):hui.onDraw}(["ms","moz","webkit","o"],window),hui._onReady=function(a){if("interactive"==document.readyState)window.setTimeout(a);else if(window.addEventListener)window.addEventListener("DOMContentLoaded",a,!1);else if("undefined"!=typeof document.addEventListener)document.addEventListener("load",a,!1);else if("undefined"!=typeof window.attachEvent)document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),a())});else if("function"==typeof window.onload){var b=window.onload;window.onload=function(){b(),a()}}else window.onload=a},hui.request=function(a){a=hui.override({method:"POST",async:!0,headers:{Ajax:!0}},a);var b=new XMLHttpRequest;if(b){b.onreadystatechange=function(){4==b.readyState&&(200==b.status&&a.$success?a.$success(b):403==b.status&&a.$forbidden?a.$forbidden(b):0!==b.status&&a.$failure?a.$failure(b):0===b.status&&a.$abort&&a.$abort(b),a.$finally&&a.$finally())};var c=a.method.toUpperCase();b.open(c,a.url,a.async);var d=null;if("POST"==c&&a.file){if(d=new FormData,d.append("file",a.file),a.parameters)for(var e in a.parameters){var f=a.parameters[e];if(hui.isArray(f))for(var g=0;g<f.length;g++)d.append(e,f[g]);else d.append(e,f)}a.$progress&&b.upload.addEventListener("progress",function(b){a.$progress(b.loaded,b.total)},!1),a.$load&&b.upload.addEventListener("load",function(b){a.$load()},!1)}else if("POST"==c&&a.files){d=new FormData;for(var g=0;g<a.files.length;g++)d.append("file"+g,a.files[g])}else"POST"==c&&a.parameters?(d=hui.request._buildPostBody(a.parameters),b.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8")):d="";if(a.headers)for(var h in a.headers)b.setRequestHeader(h,a.headers[h]);return b.send(d),b}},hui.request.isXMLResponse=function(a){return a.responseXML&&a.responseXML.documentElement&&"parsererror"!=a.responseXML.documentElement.nodeName},hui.request._buildPostBody=function(a){if(!a)return null;var b,c="";if(hui.isArray(a))for(var d=0;d<a.length;d++)b=a[d],d>0&&(c+="&"),c+=encodeURIComponent(b.name)+"=",void 0!==b.value&&null!==b.value&&(c+=encodeURIComponent(b.value));else for(b in a){var e=a[b];if(hui.isArray(e))for(var d=0;d<e.length;d++)c.length>0&&(c+="&"),c+=encodeURIComponent(b)+"=",void 0!==e[d]&&null!==e[d]&&(c+=encodeURIComponent(e[d]));else c.length>0&&(c+="&"),c+=encodeURIComponent(b)+"=",void 0!==e&&null!==e&&(c+=encodeURIComponent(e))}return c},hui.style={copy:function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d],f=hui.style.get(a,e);f&&(b.style[hui.string.camelize(e)]=f)}},set:function(a,b){for(var c in b)"transform"===c?a.style.webkitTransform=b[c]:"opacity"===c?hui.style.setOpacity(a,b[c]):a.style[c]=b[c]},get:function(a,b){a=hui.get(a);var c=hui.string.camelize(b),d=a.style[c];if(!d)if(document.defaultView&&document.defaultView.getComputedStyle){var e=document.defaultView.getComputedStyle(a,null);d=e?e.getPropertyValue(b):null}else a.currentStyle&&(d=a.currentStyle[c]);return window.opera&&hui.array.contains(["left","top","right","bottom"],b)&&"static"==hui.style.get(a,"position")&&(d="auto"),"auto"==d?"":d},setOpacity:function(a,b){hui.browser.opacity?a.style.opacity=b:1==b?a.style.filter=null:a.style.filter="alpha(opacity="+100*b+")"},length:function(a){return"number"==typeof a?a+"px":a}},hui.frame={getDocument:function(a){return a.contentDocument?a.contentDocument:a.contentWindow?a.contentWindow.document:a.document?a.document:void 0},getWindow:function(a){return a.defaultView?a.defaultView:a.contentWindow?a.contentWindow:void 0}},hui.selection={clear:function(){var a;document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(a=window.getSelection(),a&&a.removeAllRanges&&a.removeAllRanges())},getText:function(a){return a=a||document,a.getSelection?a.getSelection()+"":a.selection?a.selection.createRange().text:""},getNode:function(a){if(a=a||document,a.getSelection){var b=a.getSelection().getRangeAt(0);return"function"==typeof b.commonAncestorContainer?b.commonAncestorContainer():b.commonAncestorContainer}return null},get:function(a){return{node:hui.selection.getNode(a),text:hui.selection.getText(a)}},enable:function(a){document.onselectstart=a?null:function(){return!1},document.body.style.webkitUserSelect=a?null:"none"}},hui.effect={makeFlippable:function(a){hui.browser.webkit?(hui.cls.add(a.container,"hui_flip_container"),hui.cls.add(a.front,"hui_flip_front"),hui.cls.add(a.back,"hui_flip_back")):(hui.cls.add(a.front,"hui_flip_front_legacy"),hui.cls.add(a.back,"hui_flip_back_legacy"))},flip:function(a){if(hui.browser.webkit){var b=hui.get(a.element),c=a.duration||"1s",d=hui.get.firstByClass(b,"hui_flip_front"),e=hui.get.firstByClass(b,"hui_flip_back");d.style.webkitTransitionDuration=c,e.style.webkitTransitionDuration=c,hui.cls.toggle(a.element,"hui_flip_flipped")}else hui.cls.toggle(a.element,"hui_flip_flipped_legacy")},bounceIn:function(a){var b=a.element;hui.browser.msie?hui.style.set(b,{display:"block",visibility:"visible"}):(hui.style.set(b,{display:"block",opacity:0,visibility:"visible"}),hui.animate(b,"transform","scale(0.1)",0),window.setTimeout(function(){hui.animate(b,"opacity",1,300),hui.animate(b,"transform","scale(1)",400,{ease:hui.ease.backOut})}))},fadeIn:function(a){var b=a.element;"none"==hui.style.get(b,"display")&&hui.style.set(b,{opacity:0,display:"inherit"}),hui.animate({node:b,css:{opacity:1},delay:a.delay||null,duration:a.duration||500,$complete:a.onComplete||a.$complete})},fadeOut:function(a){hui.animate({node:a.element,css:{opacity:0},delay:a.delay||null,duration:a.duration||500,hideOnComplete:!0,complete:a.onComplete||a.$complete})},wiggle:function(a){hui.ui.getElement(a.element);hui.cls.add(a.element,"hui_effect_wiggle"),window.setTimeout(function(){hui.cls.remove(a.element,"hui_effect_wiggle")},a.duration||1e3)},shake:function(a){this._do(a.element,"hui_effect_shake",a.duration||1e3)},tada:function(a){this._do(a.element,"hui_effect_tada",1e3)},_do:function(a,b,c){a=hui.ui.getElement(a),hui.cls.add(a,b),window.setTimeout(function(){hui.cls.remove(a,b)},c)}},hui.document={getWidth:function(){return Math.max(document.body.clientWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth)},getHeight:function(){if(hui.browser.msie6){for(var a=Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight),b=document.body.childNodes,c=0;c<b.length;c++)hui.dom.isElement(b[c])&&(a=Math.max(a,b[c].clientHeight));return a}return window.scrollMaxY&&window.innerHeight?window.scrollMaxY+window.innerHeight:Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight)}},hui.drag={attach:function(a){var b=a.touch&&hui.browser.touch;hui.listen(a.element,b?"touchstart":"mousedown",function(b){b=hui.event(b),a.$check&&a.$check(b)===!1||(b.stop(),hui.drag.start(a,b))})},register:function(a){this.attach(a)},start:function(a,b){var c=a.window||window,d=window.document.body.parentNode,e=hui.browser.msie?c.document:c,f=a.touch&&hui.browser.touch;a.$before&&a.$before(),a.onStart&&a.onStart();var g,h,i=({x:b.getLeft(),y:b.getTop(),time:Date.now()},!1);g=function(b){b=hui.event(b),b.stop(b),i||(a.onBeforeMove&&a.onBeforeMove(b),a.$startMove&&a.$startMove(b)),i=!0,a.onMove&&a.onMove(b),a.$move&&a.$move(b)}.bind(this),hui.listen(d,f?"touchmove":"mousemove",g),h=function(b){hui.unListen(d,f?"touchmove":"mousemove",g),hui.unListen(e,f?"touchend":"mouseup",h),a.onEnd&&a.onEnd(),i?(a.onAfterMove&&a.onAfterMove(b),a.$endMove&&a.$endMove(b)):(a.onNotMoved&&a.onNotMoved(b),a.$notMoved&&a.$notMoved(b)),a.$finally&&a.$finally(),hui.selection.enable(!0)}.bind(this),hui.listen(e,f?"touchend":"mouseup",h),hui.selection.enable(!1)},_nativeListeners:[],_activeDrop:null,listen:function(a){hui.browser.msie||(hui.drag._nativeListeners.push(a),hui.drag._nativeListeners.length>1||(hui.listen(document.body,"dragenter",function(a){for(var b=hui.drag._nativeListeners,c=null,d=0;d<b.length;d++){var e=b[d].element;if(hui.dom.isDescendantOrSelf(a.target,e)){c=b[d],null!==hui.drag._activeDrop&&hui.drag._activeDrop==c||hui.cls.add(e,c.hoverClass);break}}hui.drag._activeDrop&&(hui.drag._activeDrop!=c?(hui.cls.remove(hui.drag._activeDrop.element,hui.drag._activeDrop.hoverClass),hui.drag._activeDrop.$leave&&hui.drag._activeDrop.$leave(a)):hui.drag._activeDrop.$hover&&hui.drag._activeDrop.$hover(a)),hui.drag._activeDrop=c}),hui.listen(document.body,"dragover",function(a){hui.stop(a),hui.drag._activeDrop&&hui.drag._activeDrop.$hover&&hui.drag._activeDrop.$hover(a)}),hui.listen(document.body,"dragend",function(a){hui.log("drag end")}),hui.listen(document.body,"dragstart",function(a){hui.log("drag start")}),hui.listen(document.body,"drop",function(a){var b=hui.event(a);b.stop();var c=hui.drag._activeDrop;if(hui.drag._activeDrop=null,c&&(hui.cls.remove(c.element,c.hoverClass),c.$drop&&c.$drop(a,{event:b}),a.dataTransfer))if(hui.log(a.dataTransfer.types),c.$dropFiles&&a.dataTransfer.files&&a.dataTransfer.files.length>0)c.$dropFiles(a.dataTransfer.files,{event:b});else if(c.$dropURL&&null!==a.dataTransfer.types&&(hui.array.contains(a.dataTransfer.types,"public.url")||hui.array.contains(a.dataTransfer.types,"text/uri-list"))){var d=a.dataTransfer.getData("public.url"),e=a.dataTransfer.getData("text/uri-list");d&&!hui.string.startsWith(d,"data:")?c.$dropURL(d,{event:b}):e&&!hui.string.startsWith(d,"data:")&&c.$dropURL(e,{event:b})}else c.$dropText&&null!==a.dataTransfer.types&&hui.array.contains(a.dataTransfer.types,"text/plain")&&c.$dropText(a.dataTransfer.getData("text/plain"),{event:b})})))}},hui.cookie={set:function(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";document.cookie=a+"="+b+d+"; path=/"},get:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},clear:function(a){this.set(a,"",-1)}},hui.location={getParameter:function(a){for(var b=hui.location.getParameters(),c=0;c<b.length;c++)if(b[c].name==a)return b[c].value;return null},setParameter:function(a,b){for(var c=hui.location.getParameters(),d=!1,e=0;e<c.length;e++)if(c[e].name==a){c[e].value=b,d=!0;break}d||c.push({name:a,value:b}),hui.location.setParameters(c)},hasHash:function(a){var b=document.location.hash;return""!==b&&b=="#"+a},getHash:function(){var a=document.location.hash;return""!==a?a.substring(1):null},getHashParameter:function(a){var b=document.location.hash;if(""!==b){var c=b.indexOf(a+"=");if(c!==-1){var d=b.substring(c+a.length+1);return d.indexOf("&")!==-1?d.substring(0,d.indexOf("&")):d}}return null},clearHash:function(){document.location.hash="#"},setParameters:function(a){for(var b="",c=0;c<a.length;c++)b+=0===c?"?":"&",b+=a[c].name+"="+a[c].value;document.location.search=b},getBoolean:function(a){var b=hui.location.getParameter(a);return"true"==b||"1"==b},getInt:function(a){var b=parseInt(hui.location.getParameter(a));return isNaN(b)?null:b},getParameters:function(){for(var a=document.location.search.substring(1).split("&"),b=[],c=0;c<a.length;c++){var d=a[c].split("="),e=unescape(d[0]).replace(/^\s*|\s*$/g,""),f=unescape(d[1]).replace(/^\s*|\s*$/g,"");e&&b.push({name:e,value:f})}return b}},window.define&&define("hui",hui),hui._onReady(function(){hui._ready=!0;for(var a=0;a<hui._.length;a++){var b=hui._[a];hui._handle(b)}delete hui._}),hui._handle=function(a){if("function"==typeof a)a();else{for(var b=null,c=null,d=0;d<a.length;d++)"function"==typeof a[d]?b=a[d]:hui.isArray(a[d])&&(c=a[d]);c&&b?hui.demand(c,b):b&&b()}},hui=window.hui||{},hui.animate=function(a,b,c,d,e){if("string"==typeof a||hui.dom.isElement(a))hui.animation.get(a).animate(null,c,b,d,e);else{var f=hui.animation.get(a.node);if(a.property)f.animate(null,a.value,a.property,a.duration,a);else if(a.css){var g=a;for(var h in a.css)f.animate(null,a.css[h],h,a.duration,g),g=hui.override({},a),g.$complete=void 0}else f.animate(null,"","",a.duration,a)}},hui.animation={objects:{},running:!1,latestId:0,get:function(a){return a=hui.get(a),a.huiAnimationId||(a.huiAnimationId=this.latestId++),this.objects[a.huiAnimationId]||(this.objects[a.huiAnimationId]=new hui.animation.Item(a)),this.objects[a.huiAnimationId]},start:function(){this.running||hui.animation._render()}},hui.animation._lengthUpater=function(a,b,c){a.style[c.property]=c.from+(c.to-c.from)*b+(null!=c.unit?c.unit:"")},hui.animation._transformUpater=function(a,b,c){var d=c.transform,e="";d.rotate&&(e+=" rotate("+(d.rotate.from+(d.rotate.to-d.rotate.from)*b)+d.rotate.unit+")"),d.scale&&(e+=" scale("+(d.scale.from+(d.scale.to-d.scale.from)*b)+")"),a.style[hui.animation.TRANSFORM]=e},hui.animation._colorUpater=function(a,b,c){var d=Math.round(c.from.red+(c.to.red-c.from.red)*b),e=Math.round(c.from.green+(c.to.green-c.from.green)*b),f=Math.round(c.from.blue+(c.to.blue-c.from.blue)*b);if(c.to.alpha<255||c.from.alpha<255){var g=Math.max(0,Math.min(1,c.from.alpha+(c.to.alpha-c.from.alpha)*b));a.style[c.property]="rgba("+d+","+e+","+f+","+g+")",hui.log("rgba("+d+","+e+","+f+","+g+")")}else a.style[c.property]="rgb("+d+","+e+","+f+")"},hui.animation._propertyUpater=function(a,b,c){a[c.property]=Math.round(c.from+(c.to-c.from)*b)},hui.animation._ieOpacityUpdater=function(a,b,c){var d=c.from+(c.to-c.from)*b;1==d?a.style.removeAttribute("filter"):a.style.filter="alpha(opacity="+100*d+")"},hui.animation._render=function(){hui.animation.running=!0;var a=!1,b=Date.now();for(var c in hui.animation.objects){var d=hui.animation.objects[c];if(d.work)for(var e=d.element,f=0;f<d.work.length;f++){var g=d.work[f];if(!g.finished){var h=(b-g.start)/(g.end-g.start);if(h<0)a=!0;else{isNaN(h)||h>1?h=1:h<1&&(a=!0);var i=h;g.delegate&&g.delegate.ease&&(i=g.delegate.ease(i)),g.delegate&&g.delegate.$render?g.delegate.$render(e,i):g.delegate&&g.delegate.callback?g.delegate.callback(e,i):g.updater&&g.updater(e,i,g),1==h&&(g.finished=!0,g.delegate&&g.delegate.$complete?window.setTimeout(g.delegate.$complete):g.delegate&&g.delegate.onComplete?window.setTimeout(g.delegate.onComplete):g.delegate&&g.delegate.hideOnComplete&&(e.style.display="none"))}}}}a?hui.onDraw(hui.animation._render):hui.animation.running=!1},hui.animation._parseStyle=function(a){var b,c={type:null,value:null,unit:null};if(!hui.isDefined(a))return c;if(isNaN(a))if(b=a.match(/([\-]?[0-9\.]+)(px|pt|%)/))c.type="length",c.value=parseFloat(b[1]),c.unit=b[2];else if(b=a.match(/rgb\(([0-9]+),[ ]?([0-9]+),[ ]?([0-9]+)\)/))c.type="color",c.value={red:parseInt(b[1]),green:parseInt(b[2]),blue:parseInt(b[3]),alpha:1};else if(b=a.match(/rgba\(([0-9]+),[ ]?([0-9]+),[ ]?([0-9]+),[ ]?([\.0-9]+)\)/))c.type="color",c.value={red:parseInt(b[1]),green:parseInt(b[2]),blue:parseInt(b[3]),alpha:parseFloat(b[4])};else{var d=new hui.Color(a);
d.ok&&(c.type="color",c.value={red:d.r,green:d.g,blue:d.b,alpha:1})}else c.value=parseFloat(a);return c},hui.animation.Item=function(a){this.element=a,this.work=[]},hui.animation.Item.prototype.animate=function(a,b,c,d,e){var f=this.getWork(hui.string.camelize(c));f.delegate=e,f.finished=!1;var g=!("scrollLeft"==c||"scrollTop"==c||""==c);if(null!==a)f.from=a;else if("transform"==c)f.transform=hui.animation.Item.parseTransform(b,this.element);else if(hui.browser.opacity||"opacity"!=c)if(g){var h=hui.style.get(this.element,c),i=hui.animation._parseStyle(h);f.from=i.value}else f.from=this.element[c];else f.from=this._getIEOpacity(this.element);if(g){var j=hui.animation._parseStyle(b);f.to=j.value,f.unit=j.unit,hui.browser.opacity||"opacity"!=c?"transform"==c?f.updater=hui.browser.msie?function(){}:hui.animation._transformUpater:"color"==j.type?f.updater=hui.animation._colorUpater:f.updater=hui.animation._lengthUpater:f.updater=hui.animation._ieOpacityUpdater}else f.to=b,f.unit=null,f.updater=hui.animation._propertyUpater;f.start=Date.now(),e&&e.delay&&(f.start+=e.delay),f.end=f.start+d,hui.animation.start()},hui.animation.TRANSFORM=function(){var a=navigator.userAgent,b=a.indexOf("Gecko")!==-1&&a.indexOf("WebKit")===-1;return b?"MozTransform":"WebkitTransform"}(),hui.animation.Item.parseTransform=function(a,b){var c,d,e={},f=/rotate\(([0-9\.]+)([a-z]+)\)/i,g=a.match(f);g&&(c=0,b.style[hui.animation.TRANSFORM]&&(d=b.style[hui.animation.TRANSFORM].match(f),d&&(c=parseFloat(d[1]))),e.rotate={from:c,to:parseFloat(g[1]),unit:g[2]});var h=/scale\(([0-9\.]+)\)/i,i=a.match(h);return i&&(c=1,b.style[hui.animation.TRANSFORM]&&(d=b.style[hui.animation.TRANSFORM].match(h),d&&(c=parseFloat(d[1]))),e.scale={from:c,to:parseFloat(i[1])}),e},hui.animation.Item.prototype._getIEOpacity=function(a){var b,c=hui.style.get(a,"filter").toLowerCase();return(b=c.match(/opacity=([0-9]+)/))?parseFloat(b[1])/100:1},hui.animation.Item.prototype.getWork=function(a){for(var b=this.work.length-1;b>=0;b--)if(this.work[b].property===a)return this.work[b];var c={property:a};return this.work[this.work.length]=c,c},hui.animation.Loop=function(a){this.recipe=a,this.position=-1,this.running=!1},hui.animation.Loop.prototype.next=function(){this.position++,this.position>=this.recipe.length&&(this.position=0);var a=this.recipe[this.position];"function"==typeof a?a():a.element&&hui.animate(a.element,a.property,a.value,a.duration,{ease:a.ease});var b=this,c=a.duration||0;void 0!==a.wait&&(c=a.wait),window.setTimeout(function(){b.next()},c)},hui.animation.Loop.prototype.start=function(){this.running=!0,this.next()},hui.ease={slowFastSlow:function(a){var b=1.6,c=1.4;return-1*Math.pow(Math.cos(Math.PI/2*Math.pow(a,b)),Math.pow(Math.PI,c))+1},fastSlow:function(a){var b=.5,c=.7;return-1*Math.pow(Math.cos(Math.PI/2*Math.pow(a,b)),Math.pow(Math.PI,c))+1},elastic:function(a){return 1-hui.ease.elastic2(1-a)},elastic2:function(a,b,c){if(a<=0||a>=1)return a;c||(c=.45);var d;return!b||b<1?(b=1,d=c/4):d=c/(2*Math.PI)*Math.asin(1/b),-(b*Math.pow(2,10*(a-=1))*Math.sin((a-d)*(2*Math.PI)/c))},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},flicker:function(a){return 1==a?1:Math.random()*a},quadIn:function(a){return Math.pow(a,2)},quadOut:function(a){return a*(a-2)*-1},quadInOut:function(a){return a*=2,a<1?Math.pow(a,2)/2:-1*(--a*(a-2)-1)/2},cubicIn:function(a){return Math.pow(a,3)},cubicOut:function(a){return Math.pow(a-1,3)+1},cubicInOut:function(a){return a*=2,a<1?Math.pow(a,3)/2:(a-=2,(Math.pow(a,3)+2)/2)},quartIn:function(a){return Math.pow(a,4)},quartOut:function(a){return-1*(Math.pow(a-1,4)-1)},quartInOut:function(a){return a*=2,a<1?Math.pow(a,4)/2:(a-=2,-.5*(Math.pow(a,4)-2))},quintIn:function(a){return Math.pow(a,5)},quintOut:function(a){return Math.pow(a-1,5)+1},quintInOut:function(a){return a*=2,a<1?Math.pow(a,5)/2:(a-=2,(Math.pow(a,5)+2)/2)},sineIn:function(a){return-1*Math.cos(a*(Math.PI/2))+1},sineOut:function(a){return Math.sin(a*(Math.PI/2))},sineInOut:function(a){return-1*(Math.cos(Math.PI*a)-1)/2},expoIn:function(a){return 0==a?0:Math.pow(2,10*(a-1))},expoOut:function(a){return 1==a?1:-1*Math.pow(2,-10*a)+1},expoInOut:function(a){return 0==a?0:1==a?1:(a*=2,a<1?Math.pow(2,10*(a-1))/2:(--a,(-1*Math.pow(2,-10*a)+2)/2))},circIn:function(a){return-1*(Math.sqrt(1-Math.pow(a,2))-1)},circOut:function(a){return a-=1,Math.sqrt(1-Math.pow(a,2))},circInOut:function(a){return a*=2,a<1?-.5*(Math.sqrt(1-Math.pow(a,2))-1):(a-=2,.5*(Math.sqrt(1-Math.pow(a,2))+1))},backIn:function(a){var b=1.70158;return Math.pow(a,2)*((b+1)*a-b)},backOut:function(a){a-=1;var b=1.70158;return Math.pow(a,2)*((b+1)*a+b)+1},backInOut:function(a){var b=2.5949095;return a*=2,a<1?Math.pow(a,2)*((b+1)*a-b)/2:(a-=2,(Math.pow(a,2)*((b+1)*a+b)+2)/2)},elasticIn:function(a){if(0==a)return 0;if(1==a)return 1;var b=.3,c=b/4;return a-=1,-1*Math.pow(2,10*a)*Math.sin((a-c)*(2*Math.PI)/b)},elasticOut:function(a){if(0==a)return 0;if(1==a)return 1;var b=.3,c=b/4;return Math.pow(2,-10*a)*Math.sin((a-c)*(2*Math.PI)/b)+1},elasticInOut:function(a){if(0==a)return 0;if(a*=2,2==a)return 1;var b=.3*1.5,c=b/4;return a<1?(a-=1,-.5*(Math.pow(2,10*a)*Math.sin((a-c)*(2*Math.PI)/b))):(a-=1,.5*(Math.pow(2,-10*a)*Math.sin((a-c)*(2*Math.PI)/b))+1)},bounceIn:function(a){return 1-hui.ease.bounceOut(1-a)},bounceOut:function(a){var b,c=7.5625,d=2.75;return a<1/d?b=c*Math.pow(a,2):a<2/d?(a-=1.5/d,b=c*Math.pow(a,2)+.75):a<2.5/d?(a-=2.25/d,b=c*Math.pow(a,2)+.9375):(a-=2.625/d,b=c*Math.pow(a,2)+.984375),b},bounceInOut:function(a){return a<.5?hui.ease.bounceIn(2*a)/2:hui.ease.bounceOut(2*a-1)/2+.5}},Date.now||(Date.now=function(){return(new Date).getTime()}),hui.onReady(function(){hui.define("hui.animation",hui.animation)}),hui=window.hui||{},hui.Color=function(a){if(this.ok=!1,hui.isArray(a)&&3==a.length&&(this.r=a[0],this.g=a[1],this.b=a[2]),!hui.isBlank(a)&&hui.isString(a)){"#"==a.charAt(0)&&(a=a.substr(1,6)),a=a.replace(/ /g,""),a=a.toLowerCase();for(var b in hui.Color.table)a==b&&(a=hui.Color.table[b]);for(var c=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^rgb\((\d{1,3})%,\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,process:function(a){return[Math.round(parseInt(a[1])/100*255),Math.round(parseInt(a[2])/100*255),Math.round(parseInt(a[3])/100*255)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],d=0;d<c.length;d++){var e=c[d].re,f=c[d].process,g=e.exec(a);if(g){var h=f(g);this.r=h[0],this.g=h[1],this.b=h[2],this.ok=!0;break}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b}},hui.Color.prototype={r:0,g:0,b:0,toRGB:function(){return"rgb("+this.r+","+this.g+","+this.b+")"},isDefined:function(){return!(void 0===this.r||void 0===this.g||void 0===this.b)},toHex:function(){if(!this.isDefined())return null;var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c}},hui.Color.table={white:"ffffff",black:"000000",red:"ff0000",green:"00ff00",blue:"0000ff"},hui.Color.hex2rgb=function(a){if(hui.isBlank(a))return null;if("#"==a[0]&&(a=a.substr(1)),3==a.length){var b=a;a="",b=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(b).slice(1);for(var c=0;c<3;c++)a+=b[c]+b[c]}var d=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(a).slice(1);return{r:parseInt(d[0],16),g:parseInt(d[1],16),b:parseInt(d[2],16)}},hui.Color.hsv2rgb=function(a,b,c){var d,e,f,g=a/360;if(0===b)d=255*c,e=255*c,f=255*c;else{var h,i,j,k=6*g,l=Math.floor(k),m=c*(1-b),n=c*(1-b*(k-l)),o=c*(1-b*(1-(k-l)));0===l?(h=c,i=o,j=m):1===l?(h=n,i=c,j=m):2==l?(h=m,i=c,j=o):3==l?(h=m,i=n,j=c):4==l?(h=o,i=m,j=c):(h=c,i=m,j=n),d=Math.round(255*h),e=Math.round(255*i),f=Math.round(255*j)}return new Array(d,e,f)},hui.Color.rgb2hsv=function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.min(Math.min(a,b),c),g=Math.max(Math.max(a,b),c),h=g;return g==f?e=0:g==a?e=60*((b-c)/(g-f))%360:g==b?e=60*((c-a)/(g-f))+120:g==c&&(e=60*((a-b)/(g-f))+240),e<0&&(e+=360),d=0===g?0:1-f/g,[Math.round(e),Math.round(100*d),Math.round(100*h)]},hui.Color.rgb2hex=function(a){for(var b="#",c=0;c<3;c++){var d=parseInt(a[c]).toString(16);d.length<2&&(d="0"+d),b+=d}return b},hui.onReady(function(){hui.define("hui.Color",hui.Color)}),!function(a,b,c){function d(a,b){q(a,function(a){return!b(a)})}function e(a,c){var d=b.createElement("script"),e=k;d.onload=d.onerror=d[p]=function(){d[n]&&!/^c|loade/.test(d[n])||e||(d.onload=d[p]=null,e=1,c())},d.async=1,d.src=a,f.insertBefore(d,f.firstChild)}var f=b.getElementsByTagName("head")[0],g={},h={},i={},j={},k=!1,l="push",m="DOMContentLoaded",n="readyState",o="addEventListener",p="onreadystatechange",q=function(a,b){for(var c=0,d=a.length;c<d;++c)if(!b(a[c]))return k;return 1};!b[n]&&b[o]&&(b[o](m,function a(){b.removeEventListener(m,a,k),b[n]="complete"},k),b[n]="loading");var r=function(a,b,f){function k(a){return a.call?a():g[a]}function m(){if(!--s){g[p]=1,o&&o();for(var a in i)q(a.split("|"),k)&&!d(i[a],k)&&(i[a]=[])}}a=a[l]?a:[a];var n=b&&b.call,o=n?b:f,p=n?a.join(""):b,s=a.length;return c(function(){d(a,function(a){return j[a]?(p&&(h[p]=1),void m()):(j[a]=1,p&&(h[p]=1),void e(r.path?r.path+a+".js":a,m))})},0),r};r.get=e,r.ready=function(a,b,c){a=a[l]?a:[a];var e=[];return!d(a,function(a){g[a]||e[l](a)})&&q(a,function(a){return g[a]})?b():!function(a){i[a]=i[a]||[],i[a][l](b),c&&c(e)}(a.join("|")),r};var s=a.$script;r.noConflict=function(){return a.$script=s,this},"undefined"!=typeof module&&module.exports?module.exports=r:a.hui.require=r}(this,document,setTimeout),hui.parallax={_listeners:[],_init:function(){this._listening||(this._listening=!0,hui.listen(window,"scroll",this._scroll.bind(this)),hui.listen(window,"resize",this._resize.bind(this)),hui.onReady(this._resize.bind(this)))},_resize:function(){for(var a=this._listeners.length-1;a>=0;a--){var b=this._listeners[a];b.$resize&&b.$resize(hui.window.getViewWidth(),hui.window.getViewHeight())}this._scroll()},_scroll:function(){for(var a=hui.window.getScrollTop(),b=hui.window.getViewHeight(),c=this._listeners.length-1;c>=0;c--){var d=this._listeners[c];if(d.$scroll)if(d.debug&&!d.debugElement&&(d.debugElement=hui.build("div",{style:"position: absolute; border-top: 1px solid red; left: 0; right: 0;",parent:document.body})),d.element){var e=hui.position.getTop(d.element);e+=d.element.clientHeight/2;var f=e-a,g=f/b;d.debugElement&&(d.debugElement.style.top=e+"px",d.debugElement.innerHTML="<span>"+g+"</span>"),d.$scroll(g)}else{var h=(a-d.min)/(d.max-d.min),i=hui.between(0,h,1);d._latest!==i&&(d.$scroll(i),d._latest=i)}}},listen:function(a){this._listeners.push(a),this._init()}},window.define&&define("hui.parallax",hui.parallax),hui.store={isSupported:function(){try{return hui.isDefined(window.localStorage)}catch(a){return!1}},set:function(a,b){this.isSupported()&&localStorage.setItem(a,b)},get:function(a){return this.isSupported()?localStorage.getItem(a):null},setObject:function(a,b){this.set(a,hui.string.toJSON(b))},getObject:function(a){return hui.string.fromJSON(this.get(a))}},hui.xml={parse:function(a){var b;try{if(window.DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml");var d=b.getElementsByTagName("parsererror");if(d.length>0&&d[0].textContent)return hui.log(d[0].textContent),null}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(a){return null}return b},serialize:function(a){try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(a){}}return null}},hui.Preloader=function(a){this.options=a||{},this.delegate={},this.images=[],this.loaded=0},hui.Preloader.prototype={addImages:function(a){if("object"==typeof a)for(var b=0;b<a.length;b++)this.images.push(a[b]);else this.images.push(a)},setDelegate:function(a){this.delegate=a},load:function(a){a=a||0;var b=this;this.obs=[];for(var c=function(){b._imageChanged(this.huiPreloaderIndex,"imageDidLoad")},d=function(){b._imageChanged(this.huiPreloaderIndex,"imageDidGiveError")},e=function(){b._imageChanged(this.huiPreloaderIndex,"imageDidAbort")},f=a;f<this.images.length+a;f++){var g=f;g>=this.images.length&&(g-=this.images.length);var h=new Image;h.huiPreloaderIndex=g,h.onload=c,h.onerror=d,h.onabort=e,h.src=(this.options.context?this.options.context:"")+this.images[g],this.obs.push(h)}},_imageChanged:function(a,b){this.loaded++,this.delegate[b]&&this.delegate[b](this.loaded,this.images.length,a),this.loaded==this.images.length&&this.delegate.allImagesDidLoad&&this.delegate.allImagesDidLoad()}},Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(a){null==Date.formatFunctions[a]&&Date.createNewFormat(a);var b=Date.formatFunctions[a];return this[b]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;for(var code="Date.prototype."+funcName+" = function(){return ",special=!1,ch="",i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,code+="'"+Date.escape(ch)+"' + "):code+=Date.getFormatCode(ch):special=!0;eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(a){switch(a){case"d":return"Date.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"Date.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"Date.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"Date.leftPad(this.getHours(), 2, '0') + ";case"i":return"Date.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"Date.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+Date.escape(a)+"' + "}},Date.parseDate=function(a,b){null==Date.parseFunctions[b]&&Date.createParser(b);var c=Date.parseFunctions[b];return Date[c](a)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;for(var code="Date."+funcName+" = function(input){\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="",i=0;i<format.length;++i)if(ch=format.charAt(i),special||"\\"!=ch)if(special)special=!1,regex+=Date.escape(ch);else{var obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c)}else special=!0;code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(a,b){switch(a){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+b+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:0,c:null,s:"(?:\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+b+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+b+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+b+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+b+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+b+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+b+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+b+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+b+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+b+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+b+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:Date.escape(a)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+Date.leftPad(Math.floor(this.getTimezoneOffset()/60),2,"0")+Date.leftPad(this.getTimezoneOffset()%60,2,"0")},Date.prototype.getDayOfYear=function(){var a=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var b=0;b<this.getMonth();++b)a+=Date.daysInMonth[b];return a+this.getDate()-1},Date.prototype.getWeekOfYear=function(){var a=this.getDayOfYear()+(5-this.getDay()),b=new Date(this.getFullYear(),0,1),c=5-b.getDay();return parseInt(Date.leftPad((a-c)/7+1,2,"0"))},Date.prototype.isLeapYear=function(){var a=this.getFullYear();return 0==(3&a)&&(a%100||a%400==0&&a)},Date.prototype.getFirstDayOfMonth=function(){var a=(this.getDay()-(this.getDate()-1))%7;return a<0?a+7:a},Date.prototype.getLastDayOfMonth=function(){var a=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return a<0?a+7:a},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},Date.escape=function(a){return a.replace(/('|\\)/g,"\\$1")},Date.leftPad=function(a,b,c){var d=new String(a);for(null==c&&(c=" ");d.length<b;)d=c+d;return d},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"},hui=window.hui||{},hui.ui=hui.ui||{},hui.ui.domReady=!1,hui.ui.context=void 0,hui.ui.language="en",hui.ui.objects={},hui.ui.delegates=[],hui.ui.state="default",hui.ui.latestObjectIndex=0,hui.ui.latestIndex=500,hui.ui.latestPanelIndex=1e3,hui.ui.latestAlertIndex=1500,hui.ui.latestTopIndex=2e3,hui.ui.toolTips={},hui.ui.confirmOverlays={},hui.ui.delayedUntilReady=[],hui.ui.texts={request_error:{en:"An error occurred on the server",da:"Der skete en fejl pÃ¥ serveren"},continue:{en:"Continue",da:"FortsÃ¦t"},reload_page:{en:"Reload page",da:"IndÃ¦s siden igen"},access_denied:{en:"Access denied, maybe you are nolonger logged in",da:"Adgang nÃ¦gtet, du er mÃ¥ske ikke lÃ¦ngere logget ind"}},hui.ui.getContext=function(){if(void 0===this.context){var a=hui.find("*[data-hui-context]");a?this.context=a.getAttribute("data-hui-context"):this.context="/"}return this.context},hui.ui.getURL=function(a){var b=hui.ui.getContext();return"/"===a.substring(0,1)&&(a=a.substring(1)),"/"===b.substring(b.length-1)&&(b=b.substring(0,b.length-1)),b+"/hui/"+a},hui.ui.get=function(a){if(a)return a.element?a:hui.ui.objects[a]},hui.ui.is=function(a,b){return a.__proto__==b.prototype},hui.ui.onReady=function(a){return hui.ui.domReady?a():hui.browser.gecko&&hui.string.endsWith(document.baseURI,"xml")?void window.setTimeout(a,1e3):void hui.ui.delayedUntilReady.push(a)},hui.ui._frameLoaded=function(a){hui.ui.callSuperDelegates(this,"frameLoaded",a)},hui.ui._resize=function(){hui.ui.reLayout(),window.clearTimeout(this._delayedResize),hui.ui._resizeFirst||(this._delayedResize=window.setTimeout(hui.ui._afterResize,500))},hui.ui._afterResize=function(){hui.onDraw(function(){hui.ui.callSuperDelegates(hui.ui,"$afterResize");for(var a in hui.ui.objects){var b=hui.ui.objects[a];b.$$draw&&b.$$draw()}})},hui.ui.confirmOverlay=function(a){var b,c=a.element;c||(c=document.body),a.widget&&(c=a.widget.getElement()),hui.ui.confirmOverlays[c]?(b=hui.ui.confirmOverlays[c],b.clear()):(b=hui.ui.Overlay.create({modal:!0}),hui.ui.confirmOverlays[c]=b),a.text&&b.addText(hui.ui.getTranslated(a.text));var d=hui.ui.Button.create({text:hui.ui.getTranslated(a.okText)||"OK",highlighted:"true"});d.click(function(){a.onOk?a.onOk():a.$ok&&a.$ok(),b.hide()}),b.add(d);var e=hui.ui.Button.create({text:hui.ui.getTranslated(a.cancelText)||"Cancel"});e.onClick(function(){a.onCancel?a.onCancel():a.$cancel&&a.$cancel(),b.hide()}),b.add(e),b.show({element:c})},hui.ui.destroy=function(a){"function"==typeof a.destroy&&a.destroy(),delete hui.ui.objects[a.name]},hui.ui.destroyDescendants=function(a){for(var b=hui.ui.getDescendants(a),c=(hui.ui.objects,0);c<b.length;c++)hui.ui.destroy(b[c])},hui.ui.remove=function(a){hui.ui.destroy(a),hui.ui.destroyDescendants(a),a.element&&hui.dom.remove(a.element)},hui.ui.getAncestors=function(a){var b=[],c=a.element;if(c){var d=hui.get.ancestors(c),e=[];for(var f in hui.ui.objects)e.push(hui.ui.objects[f]);for(var g=0;g<d.length;g++)for(var h=0;h<e.length;h++)e[h].element==d[g]&&b.push(e[h])}return b},hui.ui.getDescendants=function(a){var b=[];if(a){var c=a.getElement?a.getElement():a;if(c){var d=c.getElementsByTagName("*"),e=[];for(var f in hui.ui.objects)e.push(hui.ui.objects[f]);for(var g=0;g<d.length;g++)for(var h=0;h<e.length;h++)d[g]==e[h].element&&b.push(e[h])}}return b},hui.ui.getAncestor=function(a,b){for(var c=hui.ui.getAncestors(a),d=0;d<c.length;d++)if(hui.cls.has(c[d].getElement(),b))return c[d];return null},hui.ui.getComponents=function(a){var b=[],c=hui.ui.objects;for(var d in c)a(c[d])&&b.push(c[d]);return b},hui.ui.changeState=function(a){if(hui.ui.state!==a){var b,c,d=hui.ui.objects;for(b in d)c=d[b],c.options&&c.options.state&&(c.options.state==a?c.show():c.hide());hui.ui.state=a,this.reLayout()}},hui.ui.reLayout=function(){for(var a=hui.ui.getDescendants(document.body),b=0;b<a.length;b++){var c=a[b];c.$$layout&&c.$$layout()}},hui.ui.nextIndex=function(){return hui.ui.latestIndex++,hui.ui.latestIndex},hui.ui.nextPanelIndex=function(){return hui.ui.latestPanelIndex++,hui.ui.latestPanelIndex},hui.ui.nextAlertIndex=function(){return hui.ui.latestAlertIndex++,hui.ui.latestAlertIndex},hui.ui.nextTopIndex=function(){return hui.ui.latestTopIndex++,hui.ui.latestTopIndex},hui.ui.showCurtain=function(a){var b=a.widget;if(!b.curtain){b.curtain=hui.build("div",{class:"hui_curtain",style:"z-index:none"});var c=hui.get.firstByClass(document.body,"hui_body");c||(c=document.body),c.appendChild(b.curtain),hui.listen(b.curtain,"click",function(){b.$curtainWasClicked&&b.$curtainWasClicked()})}var d=b.curtain;if(a.transparent)d.style.background="none";else if(a.color)if("auto"==a.color){var e=hui.style.get(document.body,"background-color");"transparent"!=e&&"rgba(0, 0, 0, 0)"!=e||(e="#fff"),d.style.backgroundColor=e}else d.style.backgroundColor=a.color;hui.browser.msie?d.style.height=hui.document.getHeight()+"px":(d.style.position="fixed",d.style.top="0",d.style.left="0",d.style.bottom="0",d.style.right="0"),d.style.zIndex=a.zIndex,a.transparent?d.style.display="block":(hui.style.setOpacity(d,0),d.style.display="block",hui.animate(d,"opacity",.7,1e3,{ease:hui.ease.slowFastSlow}))},hui.ui.hideCurtain=function(a){a.curtain&&hui.animate(a.curtain,"opacity",0,200,{hideOnComplete:!0})},hui.ui.getText=function(a){var b=this.texts[a];return b?b[this.language]?b[this.language]:b.en:a},hui.ui.getTranslated=function(a){if(!hui.isDefined(a)||hui.isString(a)||"number"==typeof a)return a;if(a[hui.ui.language])return a[hui.ui.language];if(a[null])return a[null];for(var b in a)return a[b]},hui.ui.confirm=function(a){a.name||(a.name="huiConfirm");var b,c=hui.ui.get(a.name);if(c)c.update(a),b=hui.ui.get(name+"_ok"),b.setText(a.ok||"OK"),b.setHighlighted("ok"==a.highlighted),b.clearListeners(),hui.ui.get(name+"_cancel").setText(a.ok||"Cancel"),hui.ui.get(name+"_cancel").setHighlighted("cancel"==a.highlighted),a.cancel&&hui.ui.get(name+"_cancel").setText(a.cancel);else{c=hui.ui.Alert.create(a);var d=hui.ui.Button.create({name:name+"_cancel",text:a.cancel||"Cancel",highlighted:"cancel"===a.highlighted});d.listen({$click:function(){c.hide(),a.onCancel&&a.onCancel(),hui.ui.callDelegates(c,"cancel")}}),c.addButton(d),b=hui.ui.Button.create({name:name+"_ok",text:a.ok||"OK",highlighted:"ok"===a.highlighted}),c.addButton(b)}b.listen({$click:function(){c.hide(),a.onOK&&a.onOK(),hui.ui.callDelegates(c,"ok")}}),c.show()},hui.ui.alert=function(a){this.alertBox?this.alertBox.update(a):(this.alertBox=hui.ui.Alert.create(a),this.alertBoxButton=hui.ui.Button.create({name:"huiAlertBoxButton",text:"OK"}),this.alertBoxButton.listen({$click$huiAlertBoxButton:function(){hui.ui.alertBox.hide(),hui.ui.alertBoxCallBack&&(hui.ui.alertBoxCallBack(),hui.ui.alertBoxCallBack=null)}}),this.alertBox.addButton(this.alertBoxButton)),this.alertBoxCallBack=a.onOK,this.alertBoxButton.setText(a.button?a.button:"OK"),this.alertBox.show()},hui.ui.showMessage=function(a){if("string"==typeof a&&(a={text:a}),a.delay)return void(hui.ui.messageDelayTimer=window.setTimeout(function(){a.delay=null,hui.ui.showMessage(a)},a.delay));window.clearTimeout(hui.ui.messageDelayTimer),hui.ui.message||(hui.ui.message=hui.build("div",{class:"hui_message",html:"<div><div></div></div>"}),hui.browser.msie||hui.style.setOpacity(hui.ui.message,0),document.body.appendChild(hui.ui.message));var b=hui.ui.getTranslated(a.text)||"",c=hui.ui.message.getElementsByTagName("div")[1];a.icon?(hui.dom.clear(c),c.appendChild(hui.ui.createIcon(a.icon,24)),hui.dom.addText(c,b)):a.busy?(c.innerHTML='<span class="hui_message_busy"></span>',hui.dom.addText(c,b)):hui.dom.setText(c,b),hui.ui.message.style.display="block",hui.ui.message.style.zIndex=hui.ui.nextTopIndex(),hui.ui.message.style.marginLeft=hui.ui.message.clientWidth/-2+"px",hui.ui.message.style.marginTop=hui.window.getScrollTop()+"px",hui.browser.opacity&&hui.animate(hui.ui.message,"opacity",1,300),window.clearTimeout(hui.ui.messageTimer),a.duration&&(hui.ui.messageTimer=window.setTimeout(hui.ui.hideMessage,a.duration))},hui.ui.msg=hui.ui.showMessage,hui.ui.msg.success=function(a){a=hui.override({icon:"common/success",duration:2e3},a),hui.ui.msg(a)},hui.ui.msg.fail=function(a){a=hui.override({icon:"common/warning",duration:3e3},a),hui.ui.msg(a)},hui.ui.hideMessage=function(){window.clearTimeout(hui.ui.messageDelayTimer),hui.ui.message&&(hui.browser.opacity?hui.animate(hui.ui.message,"opacity",0,300,{hideOnComplete:!0}):hui.ui.message.style.display="none")},hui.ui.showToolTip=function(a){var b=a.key||"common",c=hui.ui.toolTips[b];c||(c=hui.build("div",{class:"hui_tooltip",style:"display:none;",html:"<div><div></div></div>",parent:document.body}),hui.ui.toolTips[b]=c),c.onclick=function(){hui.ui.hideToolTip(a)};var d=hui.get(a.element),e=hui.position.get(d);hui.dom.setText(c.getElementsByTagName("div")[1],a.text),"none"==c.style.display&&hui.browser.opacity&&hui.style.setOpacity(c,0),hui.style.set(c,{display:"block",zIndex:hui.ui.nextTopIndex()}),hui.style.set(c,{left:e.left-c.clientWidth+4+"px",top:e.top+2-c.clientHeight/2+d.clientHeight/2+"px"}),hui.browser.opacity&&hui.animate(c,"opacity",1,300)},hui.ui.hideToolTip=function(a){var b=a?a.key||"common":"common",c=hui.ui.toolTips[b];c&&(hui.browser.msie?c.style.display="none":hui.animate(c,"opacity",0,300,{hideOnComplete:!0}))},hui.ui.getElement=function(a){return hui.dom.isElement(a)?a:a.getElement?a.getElement():null},hui.ui.isWithin=function(a,b){a=hui.event(a);var c=hui.position.get(b),d={width:b.offsetWidth,height:b.offsetHeight},e=a.getLeft(),f=a.getTop();return e>c.left&&e<c.left+d.width&&f>c.top&&f<c.top+d.height},hui.ui.getIconUrl=function(a,b){return hui.ui.getURL("icons/"+a+b+".png")},hui.ui.createIcon=function(a,b,c){var d=hui.build(c||"span",{class:"hui_icon hui_icon_"+b,style:"background-image: url("+hui.ui.getIconUrl(a,b)+")"});return hui.ui.setIconImage(d,a,b),d},hui.ui.setIconImage=function(a,b,c){32==c?a.setAttribute("style","background-image: url("+hui.ui.getIconUrl(b,c)+"); background-image: -webkit-image-set(url("+hui.ui.getIconUrl(b,c)+") 1x,url("+hui.ui.getIconUrl(b,c+"x2")+") 2x); background-size: "+c+"px;"):a.setAttribute("style","background-image: url("+hui.ui.getIconUrl(b,c)+");")},hui.ui.addFocusClass=function(a){var b=a.classElement||a.element,c=a.class;hui.listen(a.element,"focus",function(){hui.cls.add(b,c),a.widget&&hui.ui.setKeyboardTarget(a.widget)}),hui.listen(a.element,"blur",function(){hui.cls.remove(b,c),a.widget&&hui.ui.setKeyboardTarget(null)})},hui.ui.keyboardTarget=null,hui.ui.setKeyboardTarget=function(a){hui.ui.keyboardTarget=a},hui.ui.stress=function(a){var b=hui.ui.getElement(a);hui.effect.wiggle({element:b,duration:1e3})},hui.ui.positionAtElement=function(a,b,c){c=c||{},a=hui.get(a),b=hui.get(b);var d=hui.style.get(a,"display");"none"==d&&hui.style.set(a,{visibility:"hidden",display:"block"});var e=hui.position.getLeft(b),f=hui.position.getTop(b),g=c.vertical||null;c.horizontal&&"right"==c.horizontal&&(e=e+b.clientWidth-a.clientWidth),"topOutside"==g?f-=a.clientHeight:"bottomOutside"==g&&(f+=b.clientHeight),e+=c.left||0,f+=c.top||0,hui.style.set(a,{left:e+"px",top:f+"px"}),"none"==d&&hui.style.set(a,{visibility:"visible",display:"none"})},hui.ui.extend=function(a,b){void 0!==b&&(a.options&&(a.options=hui.override(a.options,b)),a.element=hui.get(b.element),a.name=b.name),a.name||(hui.ui.latestObjectIndex++,a.name="unnamed"+hui.ui.latestObjectIndex),hui.ui.registerComponent(a),a.delegates=[],a.listen=function(a){return hui.array.add(this.delegates,a),this},a.unListen=function(a){hui.array.remove(this.delegates,a)},a.clearListeners=function(){this.delegates=[]},a.fire=function(a,b,c){return hui.ui.callDelegates(this,a,b,c)},a.fireValueChange=function(){
a.fire("valueChanged",a.value),hui.ui.firePropertyChange(a,"value",a.value),hui.ui.callAncestors(a,"childValueChanged",a.value)},a.fireProperty=function(a,b){hui.ui.firePropertyChange(this,a,b)},a.fireSizeChange=function(){hui.ui.callAncestors(a,"$$childSizeChanged")},a.getElement||(a.getElement=function(){return this.element}),a.destroy||(a.destroy=function(){this.element&&hui.dom.remove(this.element)}),a.valueForProperty||(a.valueForProperty=function(a){return this[a]}),a.nodes&&a.element&&(a.nodes=hui.collect(a.nodes,a.element))},hui.ui.registerComponent=function(a){hui.ui.objects[a.name]&&hui.log("Widget replaced: "+a.name,hui.ui.objects[a.name]),hui.ui.objects[a.name]=a},hui.ui.callAncestors=function(a,b,c,d){"undefined"==typeof c&&(c=a);for(var e=hui.ui.getAncestors(a),f=0;f<e.length;f++)e[f][b]&&e[f][b](c,d)},hui.ui.callDescendants=function(a,b,c,d){"undefined"==typeof c&&(c=a),"$"!==b[0]&&(b="$"+b);for(var e=hui.ui.getDescendants(a),f=0;f<e.length;f++)e[f][b]&&e[f][b](c,d)},hui.ui.callVisible=function(a){hui.ui.callDescendants(a,"$visibilityChanged")},hui.ui.listen=function(a){hui.ui.domReady&&a.$ready&&a.$ready(),hui.ui.delegates.push(a)},hui.ui.unListen=function(a){hui.array.remove(hui.ui.delegates,a)},hui.ui.callDelegates=function(a,b,c,d){"undefined"==typeof c&&(c=a);var e;if(a.delegates)for(var f=0;f<a.delegates.length;f++){var g,h=a.delegates[f],i="$"+b+"$"+a.name;a.name&&h[i]?g=h[i](c,d):h["$"+b]&&(g=h["$"+b](c,d)),void 0===e&&void 0!==g&&"undefined"!=typeof g&&(e=g)}var j=hui.ui.callSuperDelegates(a,b,c,d);return void 0===e&&void 0!==j&&(e=j),e},hui.ui.tellContainers=function(a,b){if(window.parent!=window)try{return window.parent.hui.ui._tellContainers(a,b)}catch(a){window.console&&console.error(a)}},hui.ui._tellContainers=function(a,b){var c=hui.ui.callSuperDelegates({},a,b);if(window.parent!=window)try{c=window.parent.hui.ui._tellContainers(a,b)||c}catch(a){window.console&&console.error(a)}return c},hui.ui.callSuperDelegates=function(a,b,c,d){"undefined"==typeof c&&(c=a);for(var e,f=0;f<hui.ui.delegates.length;f++){var g,h=hui.ui.delegates[f];a.name&&h["$"+b+"$"+a.name]?g=h["$"+b+"$"+a.name](c,d):h["$"+b]&&(g=h["$"+b](c,d)),void 0===e&&void 0!==g&&"undefined"!=typeof g&&(e=g)}return e},hui.ui.resolveImageUrl=function(a,b,c,d){for(var e=0;e<a.delegates.length;e++)if(a.delegates[e].$resolveImageUrl)return a.delegates[e].$resolveImageUrl(b,c,d);for(var f=0;f<hui.ui.delegates.length;f++){var g=hui.ui.delegates[f];if(g.$resolveImageUrl)return g.$resolveImageUrl(b,c,d)}return null},hui.ui.include=function(a){hui.ui.request({url:a.url,$text:function(b){var c=hui.build("div",{html:b,parent:document.body});hui.dom.runScripts(c),a.$success()}})},hui.ui.firePropertyChange=function(a,b,c){hui.ui.callDelegates(a,"propertyChanged",{property:b,value:c})},hui.ui.bind=function(a,b){if(hui.isString(a)&&"@"==a.charAt(0)){var c=a.substring(1).split("."),d=hui.ui.get(c[0]);if(!d)return void hui.log("Unable to bind to "+a);var e=c.slice(1).join(".");return d.listen({$propertyChanged:function(a){a.property==e&&b(a.value)}}),d.valueForProperty(e)}return a},hui.ui.handleRequestError=function(a){hui.log("General request error received");var b=hui.ui.callSuperDelegates(a||this,"requestError");b||hui.ui.confirmOverlay({element:document.body,text:hui.ui.getText("request_error"),okText:hui.ui.getText("reload_page"),cancelText:hui.ui.getText("continue"),onOk:function(){document.location.reload()}})},hui.ui.handleForbidden=function(a){hui.log("General access denied received");var b=hui.ui.callSuperDelegates(a||this,"accessDenied");b||hui.ui.confirmOverlay({element:document.body,text:hui.ui.getText("access_denied"),okText:hui.ui.getText("reload_page"),cancelText:hui.ui.getText("continue"),onOk:function(){document.location.reload()}})},hui.ui.request=function(a){if(a=hui.override({method:"post",parameters:{}},a),a.json)for(var b in a.json)a.parameters[b]=hui.string.toJSON(a.json[b]);var c=a.$success,d=a.$object,e=a.$text,f=a.$xml,g=a.$failure,h=a.$forbidden,i=a.message;a.$success=function(a){i&&(i.success?hui.ui.showMessage({text:i.success,icon:"common/success",duration:i.duration||2e3}):i.start&&hui.ui.hideMessage());var b,g;"string"==typeof c?hui.request.isXMLResponse(a)?hui.ui.callDelegates(a,"success$"+c):(b=a.responseText.replace(/^\s+|\s+$/g,""),g=b.length>0?hui.string.fromJSON(a.responseText):"",hui.ui.callDelegates(g,"success$"+c)):f&&hui.request.isXMLResponse(a)?f(a.responseXML):d?(b=a.responseText.replace(/^\s+|\s+$/g,""),g=b.length>0?hui.string.fromJSON(a.responseText):null,d(g)):"function"==typeof c?c(a):e&&e(a.responseText)},a.$failure=function(b){"string"==typeof g?hui.ui.callDelegates(b,"failure$"+g):"function"==typeof g?g(b):(a.message&&a.message.start&&hui.ui.hideMessage(),hui.ui.handleRequestError())},a.$exception=a.$exception||function(a,b){throw hui.log(a),hui.log(b),a},a.$forbidden=function(b){a.message&&a.message.start&&hui.ui.hideMessage(),h?h(b):(a.$failure(b),hui.ui.handleForbidden())},a.message&&a.message.start&&hui.ui.msg({text:a.message.start,busy:!0,delay:a.message.delay}),hui.request(a)},hui.ui.require=function(a,b){for(var c=a.length-1;c>=0;c--)a[c]=hui.ui.getURL("js/"+a[c]+".js");hui.require(a,b)},window.define&&define("hui.ui",hui.ui),hui.onReady(function(){hui.listen(window,"resize",hui.ui._resize),hui.ui.reLayout(),hui.ui.domReady=!0,window.parent&&window.parent.hui&&window.parent.hui.ui&&window.parent.hui.ui._frameLoaded(window);for(var a=0;a<hui.ui.delayedUntilReady.length;a++)hui.ui.delayedUntilReady[a]();hui.ui.callSuperDelegates(this,"ready"),hui.define("hui.ui",hui.ui)}),hui.ui.Component=function(a){this.name=a.name,this.name||(hui.ui.latestObjectIndex++,this.name="unnamed"+hui.ui.latestObjectIndex),this.element=hui.get(a.element),this.delegates=[],this.nodes&&(this.nodes=hui.collect(this.nodes,this.element)),a.listen&&this.listen(a.listen),hui.ui.registerComponent(this)},hui.ui.Component.prototype={listen:function(a){this.delegates.push(a)},fire:function(a,b,c){return hui.ui.callDelegates(this,a,b,c)},getElement:function(){return this.element},destroy:function(){this.element&&hui.dom.remove(this.element)},valueForProperty:function(a){return this[a]},fireValueChange:function(){this.fire("valueChanged",this.value),hui.ui.firePropertyChange(this,"value",this.value),hui.ui.callAncestors(this,"childValueChanged",this.value)},fireSizeChange:function(){hui.ui.callAncestors(this,"$$childSizeChanged")}},hui.ui.Source=function(a){this.options=hui.override({url:null,parameters:[],lazy:!1},a),this.name=a.name,this.data=null,this.parameters=[];for(var b=0;b<this.options.parameters.length;b++){var c=this.options.parameters[b];this.parameters.push({key:c.key,value:c.value,separate:c.separate})}hui.ui.extend(this),a.delegate&&this.listen(a.delegate),this.initial=!0,this.busy=!1,hui.ui.onReady(this._init.bind(this))},hui.ui.Source.prototype={_init:function(){var a=this;hui.each(this.parameters,function(b){var c=hui.ui.bind(b.value,function(c){a.changeParameter(b.key,c)});b.value=a._convertValue(c)}),this.options.lazy||this.refresh()},_convertValue:function(a){return a&&a.getTime?a.getTime():a},refreshFirst:function(){this.initial&&this.refresh()},refreshLater:function(){window.clearTimeout(this.paramDelay),this.paramDelay=window.setTimeout(function(){this.refresh()}.bind(this),100)},refresh:function(){this.options.delay<1?this._refresh():(window.clearTimeout(this._refreshDelay),this._refreshDelay=window.setTimeout(this._refresh.bind(this),this.options.delay))},_refresh:function(){if(0!=this.delegates.length){for(var a=0==this.delegates.length,b=0;b<this.delegates.length;b++){var c=this.delegates[b];a=!c.$sourceShouldRefresh||(a||c.$sourceShouldRefresh())}if(a){if(this.busy)return void(this.pendingRefresh=!0);this.initial=!1,this.pendingRefresh=!1;var d=this;if(this.options.url){for(var e=[],f=0;f<this.parameters.length;f++){var g=this.parameters[f];if(hui.isArray(g.value)&&g.separate)for(var h=0;h<g.value.length;h++)e.push({name:g.key,value:g.value[h]});else e.push({name:g.key,value:g.value})}this.busy=!0,hui.ui.callDelegates(this,"sourceIsBusy"),this.transport=hui.request({method:"post",url:this.options.url,parameters:e,$success:this._parse.bind(this),$exception:function(a,b){hui.log("Exception while loading source..."),hui.log(a),d._end()},$forbidden:function(){hui.ui.handleForbidden(d),hui.ui.callDelegates(d,"sourceFailed"),d._end()},$failure:function(a){hui.log("sourceFailed"),hui.ui.callDelegates(d,"sourceFailed"),d._end()}})}}}},_end:function(){this.busy=!1,hui.ui.callDelegates(this,"sourceIsNotBusy"),this.pendingRefresh&&this.refresh()},_parse:function(a){if(hui.request.isXMLResponse(a))this._parseXML(a.responseXML);else{var b=a.responseText.replace(/^\s+|\s+$/g,""),c=null;b.length>0&&(c=hui.string.fromJSON(a.responseText)),this.fire("objectsLoaded",c)}this._end()},_parseXML:function(a){var b=a.documentElement.tagName;"items"==b||"options"==b?(this.data=this._parseItems(a),this.fire("optionsLoaded",this.data)):"list"==b?this.fire("listLoaded",a):"articles"==b&&this.fire("articlesLoaded",a)},_parseItems:function(a){var b=a.documentElement,c=[];return this._parseSubItems(b,c),c},_parseSubItems:function(a,b){for(var c=a.childNodes,d=0;d<c.length;d++){var e=c[d];if(1==e.nodeType&&"title"==e.nodeName)b.push({title:e.getAttribute("title"),type:"title"});else if(1==e.nodeType&&("item"==e.nodeName||"option"==e.nodeName)){var f=[];this._parseSubItems(e,f),b.push({text:e.getAttribute("text"),title:e.getAttribute("title"),value:e.getAttribute("value"),icon:e.getAttribute("icon"),kind:e.getAttribute("kind"),badge:e.getAttribute("badge"),children:f})}}},addParameter:function(a){this.parameters.push(a);var b=hui.ui.bind(a.value,function(b){this.changeParameter(a.key,b)}.bind(this));a.value=this._convertValue(b)},setParameter:function(a,b){b=this._convertValue(b);for(var c=0;c<this.parameters.length;c++){var d=this.parameters[c];if(d.key==a)return void(d.value=b)}this.parameters.push({key:a,value:b})},changeParameter:function(a,b){b=this._convertValue(b);for(var c=0;c<this.parameters.length;c++){var d=this.parameters[c];d.key==a&&(d.value=b)}this.refreshLater()}},hui.ui.callDelegatesDrop=function(a,b){for(var c=0;c<hui.ui.delegates.length;c++)hui.ui.delegates[c]["$drop$"+a.kind+"$"+b.kind]&&hui.ui.delegates[c]["$drop$"+a.kind+"$"+b.kind](a,b)},hui.ui.getDragProxy=function(){return hui.ui.dragProxy||(hui.ui.dragProxy=hui.build("div",{class:"hui_dragproxy",style:"display:none"}),document.body.appendChild(hui.ui.dragProxy)),hui.ui.dragProxy},hui.ui.startDrag=function(a,b,c){a=new hui.Event(a);var d=b.dragDropInfo;if(hui.ui.dropTypes=hui.ui.findDropTypes(d),hui.ui.dropTypes){var e=hui.ui.getDragProxy();hui.listen(document.body,"mousemove",hui.ui.dragListener),hui.listen(document.body,"mouseup",hui.ui.dragEndListener),hui.ui.dragInfo=d,d.icon&&(e.style.backgroundImage="url("+hui.ui.getIconUrl(d.icon,16)+")"),hui.ui.startDragPos={top:a.getTop(),left:a.getLeft()},e.innerHTML=d.title?"<span>"+hui.string.escape(d.title)+"</span>":"###",hui.ui.dragging=!0,hui.selection.enable(!1)}},hui.ui.findDropTypes=function(a){for(var b=hui.ui,c=null,d=0;d<b.delegates.length;d++)if(b.delegates[d].dragDrop)for(var e=0;e<b.delegates[d].dragDrop.length;e++){var f=b.delegates[d].dragDrop[e];f.drag==a.kind&&(null==c&&(c={}),c[f.drop]={})}return c},hui.ui.dragListener=function(a){a=new hui.Event(a),hui.ui.dragProxy.style.left=a.getLeft()+10+"px",hui.ui.dragProxy.style.top=a.getTop()+"px",hui.ui.dragProxy.style.display="block";var b=hui.ui.findDropTarget(a.getElement());return b&&hui.ui.dropTypes[b.dragDropInfo.kind]?(hui.ui.latestDropTarget&&hui.cls.remove(hui.ui.latestDropTarget,"hui_drop"),hui.cls.add(b,"hui_drop"),hui.ui.latestDropTarget=b):hui.ui.latestDropTarget&&(hui.cls.remove(hui.ui.latestDropTarget,"hui_drop"),hui.ui.latestDropTarget=null),!1},hui.ui.findDropTarget=function(a){for(;a;){if(a.dragDropInfo)return a;a=a.parentNode}return null},hui.ui.dragEndListener=function(a){hui.unListen(document.body,"mousemove",hui.ui.dragListener),hui.unListen(document.body,"mouseup",hui.ui.dragEndListener),hui.ui.dragging=!1,hui.ui.latestDropTarget?(hui.cls.remove(hui.ui.latestDropTarget,"hui_drop"),hui.ui.callDelegatesDrop(hui.ui.dragInfo,hui.ui.latestDropTarget.dragDropInfo),hui.ui.dragProxy.style.display="none"):(hui.animate(hui.ui.dragProxy,"left",hui.ui.startDragPos.left+10+"px",200,{ease:hui.ease.fastSlow}),hui.animate(hui.ui.dragProxy,"top",hui.ui.startDragPos.top-5+"px",200,{ease:hui.ease.fastSlow,hideOnComplete:!0})),hui.ui.latestDropTarget=null,hui.selection.enable(!1)},hui.ui.dropOverListener=function(a){hui.ui.dragging},hui.ui.dropOutListener=function(a){hui.ui.dragging},hui.ui.Window=function(a){this.element=hui.get(a.element),this.name=a.name,this.close=hui.get.firstByClass(this.element,"hui_window_close"),this.titlebar=hui.get.firstByClass(this.element,"hui_window_titlebar"),this.title=hui.get.firstByClass(this.titlebar,"hui_window_title"),this.content=hui.get.firstByClass(this.element,"hui_window_body"),this.front=hui.get.firstByClass(this.element,"hui_window_front"),this.back=hui.get.firstByClass(this.element,"hui_window_back"),this.back&&hui.effect.makeFlippable({container:this.element,front:this.front,back:this.back}),this.visible=!1,hui.ui.extend(this),this._addBehavior(),a.listener&&this.listen(a.listener)},hui.ui.Window.create=function(a){a=hui.override({title:"Window",close:!0},a);var b='<div class="hui_window_front">'+(a.close?'<div class="hui_window_close"></div>':"")+'<div class="hui_window_titlebar"><div><div>';a.icon&&(b+='<span class="hui_window_icon" style="background-image: url('+hui.ui.getIconUrl(a.icon,16)+')"></span>'),b+='<span class="hui_window_title">'+hui.ui.getTranslated(a.title)+'</span></div></div></div><div class="hui_window_content"><div class="hui_window_content"><div class="hui_window_body" style="'+(a.width?"width:"+a.width+"px;":"")+(a.height?"height:"+a.height+"px;":"")+(a.padding?"padding:"+a.padding+"px;":"")+(a.padding?"padding-bottom:"+Math.max(0,a.padding-2)+"px;":"")+'"></div></div></div><div class="hui_window_bottom"><div class="hui_window_bottom"><div class="hui_window_bottom"></div></div></div></div>';var c="hui_window"+(a.variant?" hui_window_"+a.variant:"");return"dark"==a.variant&&(c+=" hui_context_dark"),a.element=hui.build("div",{class:c,html:b,parent:a.parent||document.body}),"dark"==a.variant&&hui.cls.add(a.element,"hui_context_dark"),new hui.ui.Window(a)},hui.ui.Window.prototype={_addBehavior:function(){var a=this;this.close&&(hui.listen(this.close,"click",function(a){this.hide(),this.fire("userClosedWindow"),this.fire("close")}.bind(this)),hui.listen(this.close,"mousedown",function(a){hui.stop(a)})),hui.drag.register({touch:!0,window:this.element.ownerDocument.defaultView,element:this.titlebar,$before:this._onDragStart.bind(this),$startMove:this._onBeforeMove.bind(this),$move:this._onMove.bind(this),$endMove:this._onAfterMove.bind(this)}),hui.listen(this.element,"mousedown",function(){a.element.style.zIndex=hui.ui.nextPanelIndex()})},setTitle:function(a){hui.dom.setText(this.title,hui.ui.getTranslated(a))},_positionInView:function(){var a=hui.window.getScrollTop(),b=hui.position.getTop(this.element);(b<a||b+this.element.clientHeight>hui.window.getViewHeight()+a)&&hui.animate({node:this.element,css:{top:a+40+"px"},duration:500,ease:hui.ease.slowFastSlow})},show:function(a){if(this.visible)return this._positionInView(),void(this.element.style.zIndex=hui.ui.nextPanelIndex());a=a||{},hui.style.set(this.element,{zIndex:hui.ui.nextPanelIndex(),visibility:"hidden",display:"block"});var b=this.element.clientWidth;hui.style.set(this.element,{width:b+"px",visibility:"visible"}),a.avoid?hui.position.place({insideViewPort:!0,target:{element:a.avoid,vertical:.5,horizontal:1},source:{element:this.element,vertical:.5,horizontal:0}}):(this.element.style.top?this._positionInView():this.element.style.top=hui.window.getScrollTop()+40+"px",this.element.style.left||(this.element.style.left=Math.round((hui.window.getViewWidth()-b)/2)+"px")),hui.browser.opacity&&hui.animate(this.element,"opacity",1,0),this.visible=!0,hui.ui.callVisible(this)},toggle:function(a){this.visible?this.hide():this.show(a)},hide:function(){this.visible&&(hui.browser.opacity?hui.animate(this.element,"opacity",0,100,{$complete:function(){this.element.style.display="none",hui.ui.callVisible(this)}.bind(this)}):(this.element.style.display="none",hui.ui.callVisible(this)),this.visible=!1)},add:function(a){a.getElement?this.content.appendChild(a.getElement()):this.content.appendChild(a)},addToBack:function(a){this.back||(this.back=hui.build("div",{className:"hui_window_back"}),this.element.insertBefore(this.back,this.front),hui.effect.makeFlippable({container:this.element,front:this.front,back:this.back})),this.back.appendChild(hui.ui.getElement(a))},setVariant:function(a){hui.cls.remove(this.element,"hui_window_dark"),hui.cls.remove(this.element,"hui_window_light"),hui.cls.remove(this.element,"hui_window_news"),"dark"!=a&&"light"!=a&&"news"!=a||hui.cls.add(this.element,"hui_window_"+a),hui.cls.set(this.element,"hui_context_dark","dark"==a)},flip:function(){this.back&&(this.back.style.minHeight=this.element.clientHeight+"px",hui.effect.flip({element:this.element}))},setBusy:function(a){return window.clearTimeout(this._busyTimer),a===!1?void(this._busyCurtain&&(this._busyCurtain.style.display="none")):void(this._busyTimer=window.setTimeout(function(){var b=this._busyCurtain;b||(b=this._busyCurtain=hui.build("div",{class:"hui_window_busy",parentFirst:hui.get.firstByClass(this.element,"hui_window_content")})),b.innerHTML=hui.isString(a)?"<span>"+a+"</span>":"<span></span>",b.style.display=""}.bind(this),300))},move:function(a){hui.style.set(this.element,{top:a.top+"px",left:a.left+"px"})},_onDragStart:function(a){this.element.style.zIndex=hui.ui.nextPanelIndex()},_onBeforeMove:function(a){a=hui.event(a);var b=hui.position.get(this.element);this.dragState={left:a.getLeft()-b.left,top:a.getTop()-b.top},this.element.style.right="auto",hui.cls.add(this.element,"hui_window_dragging")},_onMove:function(a){var b=a.getTop()-this.dragState.top,c=a.getLeft()-this.dragState.left;this.element.style.top=Math.max(b,0)+"px",this.element.style.left=Math.max(c,0)+"px"},_onAfterMove:function(){hui.ui.callDescendants(this,"$$parentMoved"),hui.cls.remove(this.element,"hui_window_dragging")},destroy:function(){hui.dom.remove(this.element)}},hui.define&&hui.define("hui.Window",hui.Window),hui.ui.Formula=function(a){this.options=a,hui.ui.extend(this,a),this.addBehavior(),a.listener&&this.listen(a.listener),a.listen&&this.listen(a.listen)},hui.ui.Formula.create=function(a){a=a||{};var b={class:"hui_formula hui_formula"};return a.action&&(b.action=a.action),a.method&&(b.method=a.method),a.element=hui.build("form",b),new hui.ui.Formula(a)},hui.ui.Formula.prototype={addBehavior:function(){this.element.onsubmit=function(){return!1}},submit:function(){this.fire("submit")},getValues:function(){for(var a={},b=hui.ui.getDescendants(this),c=0;c<b.length;c++){var d=b[c];d.options&&d.options.key&&d.getValue?a[d.options.key]=d.getValue():d.name&&d.getValue&&(a[d.name]=d.getValue())}return a},setValues:function(a){if(hui.isDefined(a))for(var b=hui.ui.getDescendants(this),c=0;c<b.length;c++)if(b[c].options&&(b[c].options.key||b[c].options.name)){var d=b[c].options.key||b[c].options.name;d&&void 0!==a[d]&&b[c].setValue(a[d])}},focus:function(a){for(var b=hui.ui.getDescendants(this),c=0;c<b.length;c++)if(b[c].focus&&(!a||b[c].options&&b[c].options.key==a||b[c].name==a))return void b[c].focus()},reset:function(){for(var a=hui.ui.getDescendants(this),b=0;b<a.length;b++)a[b].reset&&a[b].reset()},add:function(a){this.element.appendChild(a.getElement())},createGroup:function(a){var b=hui.ui.Formula.Group.create(a);return this.add(b),b},buildGroup:function(a,b){var c=this.createGroup(a);return hui.each(b,function(a){if(hui.ui.Formula[a.type]){var b=hui.ui.Formula[a.type].create(a.options);c.add(b,a.label)}else if(hui.ui[a.type]){var b=hui.ui[a.type].create(a.options);c.add(b,a.label)}else hui.log("buildGroup: Unable to find type: "+a.type)}),c},childValueChanged:function(a){this.fire("valuesChanged",this.getValues())},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}},hui.ui.Formula.Group=function(a){this.name=a.name,this.element=hui.get(a.element),this.body=hui.get.firstByTag(this.element,"tbody"),this.options=hui.override({above:!0},a),hui.ui.extend(this)},hui.ui.Formula.Group.create=function(a){a=hui.override({above:!0},a);var b=a.element=hui.build("table",{class:"hui_formula_fields"});return a.above&&hui.cls.add(b,"hui_formula_fields_above"),b.appendChild(hui.build("tbody")),new hui.ui.Formula.Group(a)},hui.ui.Formula.Group.prototype={add:function(a,b){var c=hui.build("tr");this.body.appendChild(c);var d=hui.build("td",{class:"hui_formula_field"});if(!b&&a.getLabel&&(b=a.getLabel()),b)if(b=hui.ui.getTranslated(b),this.options.above)hui.build("label",{className:"hui_formula_field",text:b,parent:d});else{var e=hui.build("th",{parent:c,className:"hui_formula_middle"});hui.build("label",{className:"hui_formula_field",text:b,parent:e})}var f=hui.build("div",{class:"hui_formula_field_body"});f.appendChild(a.getElement()),d.appendChild(f),c.appendChild(d)},createButtons:function(a){var b=hui.build("tr",{parent:this.body}),c=hui.build("td",{colspan:this.options.above?1:2,parent:b}),d=hui.ui.Buttons.create(a);return c.appendChild(d.getElement()),d}},hui.ui.Formula.Field=function(a){this.name=a.name,this.element=hui.get(a.element),hui.ui.extend(this)},hui.ui.Formula.Field.prototype={setVisible:function(a){this.element.style.display=a?"":"none"}},hui.ui.List=function(a){this.options=hui.override({url:null,source:null,selectable:!0,indent:null,selectMany:!1,rememberSelection:!1},a),this.element=hui.get(a.element),this.name=a.name,this.options.source&&this.options.source.listen(this),this.url=a.url,this.table=hui.get.firstByTag(this.element,"table"),this.head=hui.get.firstByTag(this.element,"thead"),this.body=hui.get.firstByTag(this.element,"tbody"),this.columns=[],this.rows=[],this.selected=[],this.checked=[],this.navigation=hui.get.firstByClass(this.element,"hui_list_navigation"),this.count=hui.get.firstByClass(this.navigation,"hui_list_count"),this.windowPage=hui.get.firstByClass(this.navigation,"window_page"),this.windowPageBody=hui.get.firstByClass(this.navigation,"window_page_body"),this.parameters={},this.sortKey=null,this.sortDirection=null,this.window={size:null,page:0,total:0},""!=a.windowSize&&(this.window.size=parseInt(a.windowSize)),hui.ui.extend(this),a.dropFiles&&this._addDrop(),this.url&&this.refresh()},hui.ui.List.create=function(a){a=a||{};var b="hui_list";return a.variant&&(b+=" hui_list_"+a.variant),a.element=hui.build("div",{class:b,html:'<div class="hui_list_progress"></div><div class="hui_list_navigation"><div class="hui_list_selection window_page"><div><div class="window_page_body"></div></div></div><span class="hui_list_count"></span></div><div class="hui_list_body"'+(a.maxHeight>0?' style="max-height: '+a.maxHeight+'px; overflow: auto;"':"")+'><table class="hui_list_table"><thead><tr></tr></thead><tbody></tbody></table></div>'}),new hui.ui.List(a)},hui.ui.List.prototype={_addDrop:function(){hui.drag.listen({element:this.element,hoverClass:"hui_list_drop",$dropFiles:function(a){this.fire("filesDropped",a)}.bind(this),$dropURL:function(a){this.fire("urlDropped",a)}.bind(this)})},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block",this.refresh()},registerColumn:function(a){this.columns.push(a)},getSelection:function(){return this.selected.length>0?this._getRowsByIndexes(this.selected):this._getRowsByIndexes(this.checked)},getFirstSelection:function(){var a=this.getSelection();return a.length>0?a[0]:null},getSelectionSize:function(){return this.selected.length+this.checked.length},getSelectionIds:function(){for(var a=this.getSelection(),b=[],c=0;c<a.length;c++)b.push(a[c].id);return b},_getRowsByIndexes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(this.rows[a[c]]);return b},getRows:function(){return this.rows},setParameter:function(a,b){this.parameters[a]=b},loadData:function(a){this.setUrl(a)},setSource:function(a){this.options.source!=a&&(this.options.source&&this.options.source.unListen(this),a.listen(this),this.options.source=a,a.refresh())},setUrl:function(a){this.options.source&&(this.options.source.unListen(this),this.options.source=null),this.url=a,this.selected=[],this.checked=[],this.sortKey=null,this.sortDirection=null,this.resetState(),this.refresh()},clear:function(){this._empty(),this.options.source&&this.options.source.unListen(this),this.options.source=null,this.url=null},clearSelection:function(){this._changeSelection([])},_empty:function(){this.selected=[],this.checked=[],this.columns=[],this.rows=[],this.navigation.style.display="none",hui.dom.clear(this.body),hui.dom.clear(this.head)},resetState:function(){this.window={size:null,page:0,total:0},hui.ui.firePropertyChange(this,"window",this.window),hui.ui.firePropertyChange(this,"window.page",this.window.page)},valueForProperty:function(a){if("window.page"==a)return this.window.page;if("sort.key"==a)return this.sortKey;if("sort.direction"==a)return this.sortDirection||"ascending";if("selection.id"==a){var b=this.getFirstSelection();return b?b.id:null}return this[a]},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){this.options.source&&hui.dom.isVisible(this.element)&&this.options.source.refreshFirst()},refresh:function(){if(this.options.source)return void this.options.source.refreshLater();if(this.url){var a=this.url;"number"==typeof this.window.page&&(a+=a.indexOf("?")==-1?"?":"&",a+="windowPage="+this.window.page),this.window.size&&(a+=a.indexOf("?")==-1?"?":"&",a+="windowSize="+this.window.size),this.sortKey&&(a+=a.indexOf("?")==-1?"?":"&",a+="sort="+this.sortKey),this.sortDirection&&(a+=a.indexOf("?")==-1?"?":"&",a+="direction="+this.sortDirection);for(var b in this.parameters)a+=a.indexOf("?")==-1?"?":"&",a+=b+"="+this.parameters[b];this._setBusy(!0),hui.ui.request({url:a,$object:function(a){this._setBusy(!1),this.$objectsLoaded(a)}.bind(this),$xml:function(a){this._setBusy(!1),this.$listLoaded(a)}.bind(this)})}},sort:function(a){var b=this.columns[a].key;b==this.sortKey?(this.sortDirection="ascending"==this.sortDirection?"descending":"ascending",hui.ui.firePropertyChange(this,"sort.direction",this.sortDirection)):hui.ui.firePropertyChange(this,"sort.key",b),this.sortKey=b},_debug:function(a){},$listLoaded:function(a){this._debug("List loaded"),this._setError(!1);var b,c=this.selected.length>0||this.checked.length>0;this.options.rememberSelection&&(b=this.getSelectionIds()),this.selected=[],this.checked=[],this._parseWindow(a),this._buildNavigation(),hui.dom.clear(this.head),hui.dom.clear(this.body),this.rows=[],this.columns=[],this.checkboxMode="true"===a.documentElement.getAttribute("checkboxes");var d="true"===a.documentElement.getAttribute("ordering"),e=document.createElement("tr"),f=a.getElementsByTagName("sort");if(this.sortKey=null,this.sortDirection=null,f.length>0&&(this.sortKey=f[0].getAttribute("key"),this.sortDirection=f[0].getAttribute("direction")),this.checkboxMode){var g=hui.build("th",{className:"list_check",parent:e});hui.build("a",{className:"list_check_all",parent:g});hui.listen(g,"click",this._checkAll.bind(this))}d&&hui.build("th",{class:"hui_list_order_header",parent:e});var h,i=a.getElementsByTagName("header");for(h=0;h<i.length;h++){var j="",g=document.createElement("th"),k=i[h].getAttribute("width"),l=i[h].getAttribute("key"),m="true"==i[h].getAttribute("sortable");if(k&&""!=k&&(g.style.width=k+"%"),i[h].getAttribute("align")&&(g.style.textAlign=i[h].getAttribute("align")),m){var n=this;g.huiIndex=h,g.onclick=function(){n.sort(this.huiIndex)},j+="sortable"}this.sortKey&&l==this.sortKey&&(j+=" sort_"+this.sortDirection),g.className=j;var o=document.createElement("span");g.appendChild(o),o.appendChild(document.createTextNode(i[h].getAttribute("title")||"")),e.appendChild(g),this.columns.push({key:l,sortable:m,width:k})}this.head.appendChild(e);var p=document.createDocumentFragment(),q=a.getElementsByTagName("row");for(h=0;h<q.length;h++){var r=q[h].getElementsByTagName("cell"),s=document.createElement("tr");if(s.setAttribute("data-index",h),this.checkboxMode){var t=hui.build("td",{parent:s,className:"hui_list_checkbox"});hui.build("a",{className:"hui_list_checkbox",parent:t})}if(d){var t=hui.build("td",{parent:s,className:"hui_list_order"});hui.build("a",{className:"hui_list_order_handler",parent:t})}for(var u=q[h].getAttribute("icon"),v=q[h].getAttribute("title"),w=q[h].getAttribute("level"),x=0;x<r.length;x++){var t=document.createElement("td");"false"==r[x].getAttribute("wrap")&&(t.style.whiteSpace="nowrap"),r[x].getAttribute("vertical-align")&&(t.style.verticalAlign=r[x].getAttribute("vertical-align")),r[x].getAttribute("width")&&(t.style.width=r[x].getAttribute("width")+"%"),r[x].getAttribute("align")&&(t.style.textAlign=r[x].getAttribute("align")),r[x].getAttribute("class")&&hui.cls.add(t,r[x].getAttribute("class")),"true"==r[x].getAttribute("dimmed")&&(t.className="hui_list_dimmed"),0==x&&w>1?t.style.paddingLeft=16*(parseInt(w)-1)+5+"px":0==x&&null!=this.options.indent&&(t.style.paddingLeft=this.options.indent+"px"),this._parseCell(r[x],t),s.appendChild(t),v||(v=hui.dom.getText(r[x])),u||(u=r[x].getAttribute("icon"))}var y={id:q[h].getAttribute("id"),kind:q[h].getAttribute("kind"),icon:u,title:v,index:h,data:this._getData(q[h])};s.dragDropInfo=y,this._addRowBehavior(s,h),p.appendChild(s),this.rows.push(y)}if(this.body.appendChild(p),this._setEmpty(0==q.length),this.options.rememberSelection){hui.log("Previous:",b);for(var z=[],h=0;h<b.length;h++)for(var x=0;x<this.rows.length;x++)this.rows[x].id===b[h]&&z.push(x);this._changeSelection(z)}else this.fire("selectionReset"),c&&this.fire("select",null);this.fireSizeChange()},_parseCell:function(a,b){var c=a.getAttribute("variant");null!=c&&""!=c&&(b=hui.build("div",{parent:b,className:"hui_list_cell_"+c}));var d=a.getAttribute("icon");null!=d&&""!=d&&(b.appendChild(hui.ui.createIcon(d,16)),b=hui.build("div",{parent:b,style:"margin-left: 21px; padding-top: 1px;"}));for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(hui.dom.isDefinedText(f))hui.dom.addText(b,f.nodeValue);else if(hui.dom.isElement(f,"break"))b.appendChild(document.createElement("br"));else if(hui.dom.isElement(f,"icon")){var g=f.getAttribute("size")||16,d=hui.ui.createIcon(f.getAttribute("icon"),g);f.getAttribute("hint")&&d.setAttribute("title",f.getAttribute("hint")),"true"==f.getAttribute("action")&&hui.cls.add(d,"hui_list_icon_action");var h=f.getAttribute("data");h&&d.setAttribute("data",h),"true"===f.getAttribute("revealing")&&hui.cls.add(d,"hui_list_revealing"),b.appendChild(d)}else if(hui.dom.isElement(f,"line")){var i=hui.build("p",{class:"hui_list_line"});"true"==f.getAttribute("dimmed")&&hui.cls.add(i,"hui_list_dimmed"),"true"==f.getAttribute("minor")&&hui.cls.add(i,"hui_list_minor"),"true"==f.getAttribute("mini")&&hui.cls.add(i,"hui_list_mini"),f.getAttribute("class")&&hui.cls.add(i,f.getAttribute("class")),f.getAttribute("top")&&(i.style.paddingTop=f.getAttribute("top")+"px"),b.appendChild(i),this._parseCell(f,i)}else if(hui.dom.isElement(f,"object")){var j=hui.build("div",{class:"hui_list_object"});f.getAttribute("icon")&&j.appendChild(hui.ui.createIcon(f.getAttribute("icon"),16)),f.firstChild&&3===f.firstChild.nodeType&&f.firstChild.nodeValue.length>0&&hui.dom.addText(j,f.firstChild.nodeValue),b.appendChild(j)}else if(hui.dom.isElement(f,"icons")){var k=hui.build("span",{class:"hui_list_icons"});f.getAttribute("left")&&(k.style.marginLeft=f.getAttribute("left")+"px"),this._parseCell(f,k),b.appendChild(k)}else if(hui.dom.isElement(f,"button")){
var l=hui.ui.Button.create({text:f.getAttribute("text"),small:!0,rounded:!0,data:this._getData(f)});l.click(this._buttonClick.bind(this)),b.appendChild(l.getElement())}else if(hui.dom.isElement(f,"wrap"))hui.browser.wordbreak?(hui.cls.add(b,"hui_list_wrap"),hui.dom.addText(b,hui.dom.getText(f))):hui.dom.addText(b,this._wrap(hui.dom.getText(f)));else if(hui.dom.isElement(f,"delete"))this._parseCell(f,hui.build("del",{parent:b}));else if(hui.dom.isElement(f,"strong"))this._parseCell(f,hui.build("strong",{parent:b}));else if(hui.dom.isElement(f,"badge"))this._parseCell(f,hui.build("span",{className:"hui_list_badge",parent:b}));else if(hui.dom.isElement(f,"progress")){var m=hui.build("span",{className:"hui_list_progress",parent:b}),n=Math.round(100*parseFloat(f.getAttribute("value")));hui.build("span",{style:{width:n+"%"},parent:m}),this._parseCell(f,m)}else if(hui.dom.isElement(f,"html"))for(var o=0;o<f.childNodes.length;o++){var p=f.childNodes[o].cloneNode(!0);p.namespaceURI=f.namespaceURI,b.appendChild(p)}}},$objectsLoaded:function(a){var b=this.selected.length>0||this.checked.length>0;this._setError(!1),null==a||(a.constructor==Array?this.setObjects(a):this.setData(a)),this.fire("selectionReset"),b&&this.fire("select"),this.fireSizeChange()},$sourceIsBusy:function(){this._debug("$sourceIsBusy"),this._setBusy(!0)},$sourceIsNotBusy:function(){this._debug("$sourceIsNotBusy"),this._setBusy(!1)},$sourceFailed:function(){hui.log("The source failed!"),this._setError(!0)},_setError:function(a){hui.cls.set(this.element,"hui_list_error",a)},_setBusy:function(a){if(this.busy=a,window.clearTimeout(this.busytimer),a){var b=this.element;this.busytimer=window.setTimeout(function(){hui.cls.add(b,"hui_list_busy"),"hui_overflow"==b.parentNode.className&&hui.cls.add(b,"hui_list_busy_large")},300)}else hui.cls.remove(this.element,"hui_list_busy"),"hui_overflow"==this.element.parentNode.className&&hui.cls.remove(this.element,"hui_list_busy_large")},_setEmpty:function(a){var b=hui.get.firstByClass(this.element,"hui_list_empty");b&&(b.style.display=a?"block":"")},_wrap:function(a){for(var b="",c=0,d=0;d<a.length;d++)" "===a[d]||"-"===a[d]?c=0:c++,b+=a[d],c>10&&(b+="â€‹",c=0);return b},_getData:function(a){var b=a.getAttribute("data");return b?hui.string.fromJSON(b):null},_buttonClick:function(a){var b=hui.get.firstParentByTag(a.getElement(),"tr"),c=this.rows[parseInt(b.getAttribute("data-index"),10)];this.fire("clickButton",{row:c,button:a})},_parseWindow:function(a){var b=a.getElementsByTagName("window");if(b.length>0){var c=b[0];this.window.total=parseInt(c.getAttribute("total")),this.window.size=parseInt(c.getAttribute("size")),this.window.page=parseInt(c.getAttribute("page"))}else this.window.total=0,this.window.size=0,this.window.page=0},_buildNavigation:function(){var a=this,b=this.window.size>0?Math.ceil(this.window.total/this.window.size):0;if(b<2)return void(this.navigation.style.display="none");this.navigation.style.display="block";var c=this.window.page*this.window.size+1;hui.dom.setText(this.count,c+"-"+Math.min((this.window.page+1)*this.window.size,this.window.total)+" / "+this.window.total);var d=this.windowPageBody;if(d.innerHTML="",b<2)this.windowPage.style.display="none";else{for(var e=this._buildPages(b,this.window.page),f=0;f<e.length;f++){var g=e[f];if(""===g)d.appendChild(hui.build("span",{text:"Â·"}));else{var h=document.createElement("a");h.appendChild(document.createTextNode(g+1)),h.setAttribute("data-index",g),h.onmousedown=function(){return a._onPageClick(this),!1},g==a.window.page&&(h.className="hui_list_selected"),d.appendChild(h)}}this.windowPage.style.display="block"}},_buildPages:function(a,b){for(var c=[],d=!1,e=0;e<a;e++)e<1||e>a-2||Math.abs(b-e)<5?(c.push(e),d=!1):(d||c.push(""),d=!0);return c},setData:function(a){this.selected=[],this.checked=[];var b=a.window||{};this.window.total=b.total||0,this.window.size=b.size||0,this.window.page=b.page||0,this._buildNavigation(),this._buildHeaders(a.headers),this._buildRows(a.rows),this._setEmpty(!a.rows||0==a.rows.length)},_buildHeaders:function(a){hui.dom.clear(this.head),this.columns=[];var b=hui.build("tr",{parent:this.head});hui.each(a,function(a,c){var d=hui.build("th");a.width&&(d.style.width=a.width+"%"),a.sortable&&(hui.listen(d,"click",function(){this.sort(c)}.bind(this)),hui.cls.add(d,"sortable")),d.appendChild(hui.build("span",{text:a.title})),b.appendChild(d),this.columns.push(a)}.bind(this))},_buildRows:function(a){var b=this;hui.dom.clear(this.body),this.rows=[],a&&hui.each(a,function(a,c){var d=hui.build("tr"),e=a.icon,f=a.title;hui.each(a.cells,function(a){var b=hui.build("td");a.icon&&(b.appendChild(hui.ui.createIcon(a.icon,16)),e=e||a.icon),a.text&&(b.appendChild(document.createTextNode(a.text)),f=f||a.text),d.appendChild(b)}),b.body.appendChild(d);var g={id:a.id,kind:a.kind,icon:e,title:f,index:c};d.dragDropInfo=g,hui.log(this._getData(d)),b.rows.push({id:a.id,kind:a.kind,icon:e,title:f,index:c,data:a.data}),this._addRowBehavior(d,c)}.bind(this))},setObjects:function(a){a=a||[],this.selected=[],this.checked=[],hui.dom.clear(this.body),this.rows=[];for(var b=0;b<a.length;b++){for(var c=hui.build("tr"),d=a[b],e=null,f=0;f<this.columns.length;f++){var g=hui.build("td");if(this.builder)g.appendChild(this.builder.buildColumn(this.columns[f],d));else{var h=d[this.columns[f].key]||"";if(hui.isArray(h))for(var i=0;i<h.length;i++)h[i].constructor==Object?g.appendChild(this._createObject(h[i])):g.appendChild(hui.build("div",{text:h}));else h.constructor==Object?g.appendChild(this._createObject(h[f])):(hui.dom.addText(g,h),e=null==e?h:e)}c.appendChild(g)}var j={id:d.id,kind:d.kind,title:e};c.dragDropInfo=j,this.body.appendChild(c),this._addRowBehavior(c,b),this.rows.push(d)}},_createObject:function(a){var b=hui.build("div",{class:"hui_list_object"});return a.icon&&b.appendChild(hui.ui.createIcon(a.icon,16)),hui.dom.addText(b,a.text||a.name||""),b},_addRowBehavior:function(a,b){var c=this;a.onmousedown=function(d){if(!c.busy){var e=hui.event(d),f=e.findByClass("hui_list_icon_action");if(!f){var g=e.findByClass("hui_list_checkbox");if(!g)return c._onRowDown(b,e),hui.ui.startDrag&&hui.ui.startDrag(d,a),!1;c._toggleChecked(b)}}},a.ondblclick=function(a){if(!c.busy)return c._onRowDoubleClick(b,a),hui.selection.clear(),!1},a.onclick=function(a){if(!c.busy)return c._onRowClick(b,a),!1}},_checkAll:function(){for(var a=0;a<this.rows.length;a++)hui.array.flip(this.checked,a);this._drawChecks(),this._changeSelection([])},_toggleChecked:function(a){hui.array.flip(this.checked,a),this._drawChecks(),this._changeSelection([])},_drawChecks:function(){for(var a=this.body.getElementsByTagName("tr"),b=0;b<a.length;b++)hui.cls.set(a[b],"hui_list_checked",hui.array.contains(this.checked,b))},_clearChecked:function(){this.checked=[],this._drawChecks(),this.fire("checkedReset")},_changeSelection:function(a){var b,c=this.body.getElementsByTagName("tr");for(b=0;b<this.selected.length;b++)hui.cls.remove(c[this.selected[b]],"hui_list_selected");for(b=0;b<a.length;b++)hui.cls.add(c[a[b]],"hui_list_selected");this.selected=a,a.length>0?(this.fire("select",this.rows[a[0]]),hui.ui.firePropertyChange(this,"selection.id",this.rows[a[0]].id),this._clearChecked()):this.fire("select")},_onRowClick:function(a,b){b=hui.event(b);var c=b.findByClass("hui_list_icon_action");if(c){var d=c.getAttribute("data");d&&(d=hui.string.fromJSON(d)),this.fire("clickIcon",{row:this.rows[a],data:d,node:c})}},_onRowDown:function(a,b){if(this.options.selectable)if(this.checked=[],b.metaKey&&this.options.selectMany){var c=this.selected.slice(0);hui.array.flip(c,a),this._changeSelection(c)}else this._changeSelection([a])},_onRowDoubleClick:function(a,b){if(b=hui.event(b),!b.findByClass("hui_list_icon_action")){var c=this.getFirstSelection();c&&this.fire("open",c)}},_onPageClick:function(a){var b=parseInt(a.getAttribute("data-index"));this.window.page=b,hui.ui.firePropertyChange(this,"window",this.window),hui.ui.firePropertyChange(this,"window.page",this.window.page);for(var c=this.windowPageBody.getElementsByTagName("a"),d=c.length-1;d>=0;d--)c[d].className=c[d]==a?"hui_list_selected":""}},hui.ui.Tabs=function(a){a=a||{},this.name=a.name,this.element=hui.get(a.element),this.activeTab=-1;var b=hui.get.firstByClass(this.element,"hui_tabs_bar");this.bar=hui.get.firstByTag(b,"ul"),this.tabs=[];for(var c=this.bar.getElementsByTagName("li"),d=0;d<c.length;d++)hui.browser.msie||hui.get.firstByTag(c[d],"a").removeAttribute("href"),this.tabs.push(c[d]);this.contents=hui.get.byClass(this.element,"hui_tabs_tab"),this.addBehavior(),hui.ui.extend(this)},hui.ui.Tabs.create=function(a){a=a||{};var b=a.element=hui.build("div",{class:"hui_tabs"}),c="hui_tabs_bar";a.small&&(c+=" hui_tabs_bar_small"),a.centered&&(c+=" hui_tabs_bar_centered");var d=hui.build("div",{class:c,parent:b});return hui.build("ul",{parent:d}),new hui.ui.Tabs(a)},hui.ui.Tabs.prototype={addBehavior:function(){for(var a=0;a<this.tabs.length;a++)this.addTabBehavior(this.tabs[a],a)},addTabBehavior:function(a,b){hui.listen(a,"click",function(){this.tabWasClicked(b)}.bind(this))},registerTab:function(a){a.parent=this,this.tabs.push(a)},tabWasClicked:function(a){this.activeTab=a,this.updateGUI(),hui.ui.callVisible(this)},updateGUI:function(){for(var a=0;a<this.tabs.length;a++)hui.cls.set(this.tabs[a],"hui_tabs_selected",a==this.activeTab),this.contents[a].style.display=a==this.activeTab?"block":"none"},createTab:function(a){a=a||{};var b=hui.build("li",{html:"<a><span><span>"+hui.string.escape(a.title)+"</span></span></a>",parent:this.bar});this.addTabBehavior(b,this.tabs.length),this.tabs.push(b);var c=a.element=hui.build("div",{class:"hui_tabs_tab"});return a.padding>0&&(c.style.padding=a.padding+"px"),this.contents.push(c),this.element.appendChild(c),this.activeTab==-1?(this.activeTab=0,hui.cls.add(b,"hui_tabs_selected")):c.style.display="none",new hui.ui.Tab(a)}},hui.ui.Tab=function(a){this.name=a.name,this.element=hui.get(a.element)},hui.ui.Tab.prototype={add:function(a){this.element.appendChild(a.element)}},hui.ui.ObjectList=function(a){this.options=hui.override({key:null},a),this.name=a.name,this.element=hui.get(a.element),this.body=hui.get.firstByTag(this.element,"tbody"),this.template=[],this.objects=[],hui.ui.extend(this)},hui.ui.ObjectList.create=function(a){a=a||{};var b=a.element=hui.build("table",{class:"hui_objectlist",cellpadding:"0",cellspacing:"0"});if(a.template){for(var c="<thead><tr>",d=0;d<a.template.length;d++)c+="<th>"+(a.template[d].label||"")+"</th>";c+="</tr></thead>",b.innerHTML=c}hui.build("tbody",{parent:b});var e=new hui.ui.ObjectList(a);return a.template&&hui.each(a.template,function(a){e.registerTemplateItem(new hui.ui.ObjectList.Text(a.key))}),e},hui.ui.ObjectList.prototype={ignite:function(){this.addObject({})},addObject:function(a,b){var c;if(0==this.objects.length||b)c=new hui.ui.ObjectList.Object(this.objects.length,a,this),this.objects.push(c),this.body.appendChild(c.getElement());else{var d=this.objects[this.objects.length-1];hui.array.remove(this.objects,d),c=new hui.ui.ObjectList.Object(d.index,a,this),d.index++,this.objects.push(c),this.objects.push(d),this.body.insertBefore(c.getElement(),d.getElement())}},reset:function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a].getElement();b.parentNode?b.parentNode.removeChild(b):(hui.log("no parent for..."),hui.log(b))}this.objects=[],this.addObject({})},addObjects:function(a){for(var b=0;b<a.length;b++)this.addObject(a[b])},setObjects:function(a){this.reset(),this.addObjects(a)},getObjects:function(a){for(var b=[],c=0;c<this.objects.length-1;c++)b.push(this.objects[c].getData());return b},getValue:function(){return this.getObjects()},setValue:function(a){this.setObjects(a)},registerTemplateItem:function(a){this.template.push(a)},objectDidChange:function(a){a.index>=this.objects.length-1&&this.addObject({},!0)},getLabel:function(){return this.options.label}},hui.ui.ObjectList.Object=function(a,b,c){this.data=b,this.index=a,this.list=c,this.fields=[]},hui.ui.ObjectList.Object.prototype={getElement:function(){if(!this.element){this.element=document.createElement("tr");for(var a=0;a<this.list.template.length;a++){var b=this.list.template[a],c=b.clone();c.object=this,this.fields.push(c);var d=document.createElement("td");0==a&&(d.className="first"),d.appendChild(c.getElement()),c.setValue(this.data[b.key]),this.element.appendChild(d)}}return this.element},valueDidChange:function(){this.list.objectDidChange(this)},getData:function(){for(var a=this.data,b=0;b<this.fields.length;b++)a[this.fields[b].key]=this.fields[b].getValue();return a}},hui.ui.ObjectList.Text=function(a){this.key=a,this.value=null},hui.ui.ObjectList.Text.prototype={clone:function(){return new hui.ui.ObjectList.Text(this.key)},getElement:function(){var a=hui.build("input",{class:"hui_textinput"});return this.wrapper=new hui.ui.Input({element:a}),this.wrapper.listen(this),a},$valueChanged:function(a){this.value=a,this.object.valueDidChange()},getValue:function(){return this.value},setValue:function(a){this.value=a,this.wrapper.setValue(a)}},hui.ui.ObjectList.Select=function(a){this.key=a,this.value=null,this.options=[]},hui.ui.ObjectList.Select.prototype={clone:function(){var a=new hui.ui.ObjectList.Select(this.key);return a.options=this.options,a},getElement:function(){this.select=hui.build("select");for(var a=0;a<this.options.length;a++)this.select.options[this.select.options.length]=new Option(this.options[a].label,this.options[a].value);var b=this;return this.select.onchange=function(){b.object.valueDidChange()},this.select},getValue:function(){return this.select.value},setValue:function(a){this.select.value=a},addOption:function(a,b){this.options.push({value:a,label:b})}},hui.ui.DropDown=function(a){this.options=hui.override({label:null,placeholder:null,url:null,source:null,focus:!1},a),this.name=a.name;var b=this.element=hui.get(a.element);this.inner=b.getElementsByTagName("strong")[0],this.items=a.items||[],this.index=-1,this.value=hui.isDefined(this.options.value)?this.options.value:null,this.dirty=!0,this.busy=!1,hui.ui.extend(this),a.listener&&this.listen(a.listener),this._attach(),this._updateIndex(),this._updateUI(),this.options.url?this.options.source=new hui.ui.Source({url:this.options.url,delegate:this}):this.options.source&&this.options.source.listen(this)},hui.ui.DropDown.create=function(a){a=a||{};var b="hui_dropdown";a.variant&&(b+=" hui_dropdown_"+a.variant),a.element=hui.build("a",{class:b,href:"javascript://",html:"<strong></strong>"});var c=new hui.ui.DropDown(a);return a.items&&c.setItems(a.items),c},hui.ui.DropDown.prototype={_attach:function(){hui.listen(this.element,"click",this._click.bind(this)),hui.listen(this.element,"blur",this._hideSelector.bind(this)),hui.listen(this.element,"keydown",this._keyDown.bind(this)),this.options.focus||hui.listen(this.element,"mousedown",function(a){hui.stop(a)})},_updateIndex:function(){this.index=-1;for(var a=0;a<this.items.length;a++)this.items[a].value==this.value&&(this.index=a)},_updateUI:function(){var a=this.items[this.index];if(a){var b=a.label||a.title||a.text||"";this.inner.innerHTML="",hui.dom.addText(this.inner,hui.string.wrap(b))}else this.options.placeholder?(this.inner.innerHTML="",this.inner.appendChild(hui.build("span",{class:"hui_dropdown_placeholder",text:hui.string.escape(this.options.placeholder)}))):this.inner.innerHTML="";if(this.selector)for(var c=this.selector.getElementsByTagName("a"),d=0;d<c.length;d++)this.index==d?hui.cls.add(c[d],"hui_selected"):c[d].className=""},_click:function(a){this.busy||(hui.stop(a),this._selectorVisible?this._hideSelector():(this._showSelector(),this._hider=function(a){a=hui.event(a),a.isDescendantOf(this.element)||this._hideSelector()}.bind(this),hui.listen(document.body,"mousedown",this._hider)))},_showSelector:function(){this._buildSelector();var a=this.element,b=this.selector;if(this.options.focus&&a.focus(),this.items){var c=hui.document.getHeight();if(c<200){var d=hui.position.getLeft(this.element);hui.style.set(this.selector,{left:d+"px",top:"5px"})}else{var e=hui.window.getScrollTop(),f=hui.position.getScrollOffset(this.element).top,g=e-f;hui.position.place({target:{element:this.element,vertical:1,horizontal:0},source:{element:this.selector,vertical:0,horizontal:0},top:g})}hui.style.set(b,{visibility:"hidden",display:"block",width:""});var h=Math.min(c-hui.position.getTop(b)-5,200),i=Math.max(a.clientWidth-5,100,b.clientWidth+20),j=hui.window.getViewWidth()-hui.position.getLeft(a)-20;i=Math.min(i,j),hui.style.set(b,{visibility:"visible",width:i+"px",zIndex:hui.ui.nextTopIndex(),maxHeight:h+"px"}),this._selectorVisible=!0}},_hideSelector:function(){hui.unListen(document.body,"mousedown",this._hider),this.selector&&(this.selector.style.display="none",this._selectorVisible=!1)},_keyDown:function(a){this.busy||0!=this.items.length&&(40==a.keyCode?(hui.stop(a),this.index>=this.items.length-1?this.value=this.items[0].value:this.value=this.items[this.index+1].value,this._updateIndex(),this._updateUI(),this._fireChange()):38==a.keyCode&&(hui.stop(a),this.index>0?this.index--:this.index=this.items.length-1,this.value=this.items[this.index].value,this._updateUI(),this._fireChange()))},selectFirst:function(){this.items.length>0&&this.setValue(this.items[0].value)},getValue:function(){return this.value},setValue:function(a){this.value=a,this._updateIndex(),this._updateUI()},reset:function(){this.setValue(null)},getLabel:function(){return this.options.label},refresh:function(){this.options.source&&this.options.source.refresh()},stress:function(){hui.ui.stress(this)},focus:function(){try{this.element.focus()}catch(a){}},getItem:function(){return this.index>=0?this.items[this.index]:0},addItem:function(a){this.items.push(a),this.dirty=!0,this._updateIndex(),this._updateUI()},setItems:function(a){this.items=a,this.dirty=!0,this.index=-1,this._updateIndex(),this._updateUI()},$optionsLoaded:function(a){this.setItems(a)},$sourceIsBusy:function(){this.busy=!0,hui.style.setOpacity(this.element,.5)},$sourceIsNotBusy:function(){this.busy=!1,hui.style.setOpacity(this.element,1)},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){hui.dom.isVisible(this.element)?this.options.source&&this.options.source.refreshFirst():this._hideSelector()},_buildSelector:function(){if(this.dirty&&this.items){this.selector?this.selector.innerHTML="":(this.selector=hui.build("div",{class:"hui_dropdown_selector"}),document.body.appendChild(this.selector),hui.listen(this.selector,"mousedown",function(a){hui.stop(a)}));var a=this;hui.each(this.items,function(b,c){var d=hui.build("a",{href:"javascript://",text:b.label||b.title||b.text||""});hui.listen(d,"mousedown",function(d){hui.stop(d),a._itemClicked(b,c),hui.listenOnce(document.body,"mouseup",function(a){hui.stop(a)})}),c==a.index&&hui.cls.add(d,"hui_selected"),a.selector.appendChild(d)}),this.dirty=!1}},_itemClicked:function(a,b){this.index=b;var c=this.value!=this.items[b].value;this.value=this.items[b].value,this._updateUI(),this._hideSelector(),c&&this._fireChange()},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value),this.fire("valueChanged",this.value),hui.ui.firePropertyChange(this,"value",this.value)},destroy:function(){hui.dom.remove(this.element),this.selector&&hui.dom.remove(this.selector)}},hui.ui.Alert=function(a){this.options=hui.override({modal:!1},a),this.element=hui.get(a.element),this.name=a.name,this.body=hui.get.firstByClass(this.element,"hui_alert_body"),this.content=hui.get.firstByClass(this.element,"hui_alert_content"),this.emotion=this.options.emotion,this.title=hui.get.firstByTag(this.element,"h1"),hui.ui.extend(this)},hui.ui.Alert.create=function(a){a=hui.override({text:"",emotion:null,title:null},a);var b=a.element=hui.build("div",{class:"hui_alert"}),c=hui.build("div",{class:"hui_alert_body",parent:b});hui.build("div",{class:"hui_alert_content",parent:c}),document.body.appendChild(b);var d=new hui.ui.Alert(a);return a.emotion&&d.setEmotion(a.emotion),a.title&&d.setTitle(a.title),a.text&&d.setText(a.text),d},hui.ui.Alert.prototype={show:function(){var a=hui.ui.nextAlertIndex();this.options.modal&&(hui.ui.showCurtain({widget:this,zIndex:a}),a++),this.element.style.zIndex=a,this.element.style.display="block",this.element.style.top=hui.window.getScrollTop()+100+"px",hui.animate(this.element,"opacity",1,200),hui.animate(this.element,"margin-top","40px",600,{ease:hui.ease.elastic})},hide:function(){hui.animate(this.element,"opacity",0,100,{hideOnComplete:!0}),hui.animate(this.element,"margin-top","0px",100),hui.ui.hideCurtain(this)},setTitle:function(a){this.title||(this.title=hui.build("h1",{parent:this.content})),hui.dom.setText(this.title,hui.ui.getTranslated(a))},setText:function(a){this.text||(this.text=hui.build("p",{parent:this.content})),hui.dom.setText(this.text,hui.ui.getTranslated(a))},setEmotion:function(a){this.emotion&&hui.cls.remove(this.body,this.emotion),this.emotion=a,hui.cls.add(this.body,a)},update:function(a){a=a||{},this.setTitle(a.title||null),this.setText(a.text||null),this.setEmotion(a.emotion||null)},addButton:function(a){this.buttons||(this.buttons=hui.ui.Buttons.create({align:"right"}),this.body.appendChild(this.buttons.element)),this.buttons.add(a)}},hui=window.hui||{},hui.ui=hui.ui||{},hui.ui.Button=function(a){this.options=a,this.name=a.name,this.element=hui.get(a.element);for(var b=0;b<this.element.childNodes.length;b++)if(3==this.element.childNodes[b].nodeType){this.textNode=this.element.childNodes[b];break}this.enabled=!hui.cls.has(this.element,"hui_button_disabled"),hui.ui.extend(this),this._attach(),a.listener&&this.listen(a.listener),a.listen&&this.listen(a.listen)},hui.ui.Button.create=function(a){a=hui.override({text:"",highlighted:!1,enabled:!0},a);var b="hui_button"+(a.highlighted?" hui_is_highlighted":"");a.variant&&(b+=" hui_button_"+a.variant),a.small&&a.variant&&(b+=" hui_button_small_"+a.variant),a.small&&(b+=" hui_button_small"),a.enabled||(b+=" hui_is_disabled");var c=a.text?hui.ui.getTranslated(a.text):null;a.title&&(c=hui.ui.getTranslated(a.title));var d=a.element=hui.build("a",{class:b,href:"javascript://"});if(a.icon){var e=hui.build("span",{parent:d,class:"hui_button_icon",style:"background-image:url("+hui.ui.getIconUrl(a.icon,16)+")"});c||hui.cls.add(e,"hui_button_icon_notext")}return c&&hui.dom.addText(d,c),new hui.ui.Button(a)},hui.ui.Button.prototype={_attach:function(){var a=this;hui.listen(this.element,"mousedown",function(a){hui.stop(a)}),hui.listen(this.element,"click",function(b){hui.stop(b),a._onClick(b)})},_onClick:function(a){if(this.enabled){var b=!1;a&&(b=hui.event(a).altKey),this.options.confirm&&!b?hui.ui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this._fireClick.bind(this)}):this._fireClick()}else this.element.blur()},_fireClick:function(){if(this.fire("click",this),this.options.submit){var a=hui.ui.getAncestor(this,"hui_formula");a?a.submit():hui.log("No form found to submit")}},click:function(a){return a?(this.listen({$click:a}),this):void this._onClick()},focus:function(){this.element.focus()},onClick:function(a){this.listen({$click:a})},setEnabled:function(a){this.enabled=a,this._updateUI()},enable:function(){this.setEnabled(!0)},disable:function(){this.setEnabled(!1)},setHighlighted:function(a){hui.cls.set(this.element,"hui_is_highlighted",a)},_updateUI:function(){hui.cls.set(this.element,"hui_is_disabled",!this.enabled)},setText:function(a){return this.textNode?this.textNode.nodeValue=hui.ui.getTranslated(a):void hui.dom.setText(this.element,hui.ui.getTranslated(a))},getData:function(){return this.options.data},getRole:function(){return this.options.role}},hui.ui.Buttons=function(a){this.name=a.name,this.element=hui.get(a.element),this.body=hui.get.firstByClass(this.element,"hui_buttons_body"),hui.ui.extend(this)},hui.ui.Buttons.create=function(a){a=hui.override({top:0},a);var b=a.element=hui.build("div",{class:"hui_buttons"});return"right"===a.align&&hui.cls.add(b,"hui_buttons_right"),"center"===a.align&&hui.cls.add(b,"hui_buttons_center"),a.top>0&&(b.style.paddingTop=a.top+"px"),hui.build("div",{class:"hui_buttons_body",parent:b}),new hui.ui.Buttons(a)},hui.ui.Buttons.prototype={add:function(a){return this.body.appendChild(a.element),this}},hui.onReady(["hui.ui"],function(){hui.define("hui.ui.Button",hui.ui.Button)}),hui.ui.Selection=function(a){if(this.options=hui.override({value:null},a),this.element=hui.get(a.element),this.name=a.name,this.items=[],this.subItems=[],this.busy=0,this.selection=null,a.items&&a.items.length>0){for(var b=0;b<a.items.length;b++){var c=a.items[b];this.items.push(c);var d=hui.get(c.id);c.element=d,this.addItemBehavior(d,c)}this.selection=this._getSelectionWithValue(this.options.value),this._updateUI()}else null!=this.options.value&&(this.selection={value:this.options.value});hui.ui.extend(this)},hui.ui.Selection.create=function(a){a=hui.override({width:0},a);var b=a.element=hui.build("div",{class:"hui_selection"});return a.width>0&&(b.style.width=a.width+"px"),new hui.ui.Selection(a)},hui.ui.Selection.prototype={getValue:function(){return this.selection},valueForProperty:function(a){return"value"===a?this.selection?this.selection.value:null:"kind"===a?this.selection?this.selection.kind:null:void 0},setValue:function(a){var b=this._getSelectionWithValue(a);null===b?this.selection=null:(this.selection=b,this.kind=b.kind),this._updateUI(),this.fireChange()},_getSelectionWithValue:function(a){var b;for(b=0;b<this.items.length;b++)if(this.items[b].value==a)return this.items[b];for(b=0;b<this.subItems.length;b++)for(var c=this.subItems[b].items,d=0;d<c.length;d++)if(c[d].value==a)return c[d];return null},selectFirst:function(){var a;for(a=0;a<this.items.length;a++)return void this.changeSelection(this.items[a]);for(a=0;a<this.subItems.length;a++)for(var b=this.subItems[a].items,c=0;c<b.length;c++)return void this.changeSelection(b[c])},reset:function(){this.setValue(null)},addItems:function(a){a.element=hui.build("div",{parent:this.element});var b=new hui.ui.Selection.Items(a);b.parent=this,this.subItems.push(b)},_updateUI:function(){var a;for(a=0;a<this.items.length;a++)hui.cls.set(this.items[a].element,"hui_selected",this.isSelection(this.items[a]));for(a=0;a<this.subItems.length;a++)this.subItems[a]._updateUI()},changeSelection:function(a){for(var b=0;b<this.subItems.length;b++)this.subItems[b].selectionChanged(this.selection,a);this.selection=a,this._updateUI(),this.fireChange()},fireChange:function(){this.fire("select",this.selection),this.fireProperty("value",this.selection?this.selection.value:null),this.fireProperty("kind",this.selection?this.selection.kind:null);for(var a=0;a<this.subItems.length;a++)this.subItems[a].parentValueChanged()},registerItems:function(a){a.parent=this,this.subItems.push(a)},addItemBehavior:function(a,b){hui.listen(a,"click",function(){this.itemWasClicked(b)}.bind(this)),hui.listen(a,"dblclick",function(a){hui.stop(a),hui.selection.clear(),this._onDoubleClick(b)}.bind(this)),a.dragDropInfo=b},setObjects:function(a){this.items=[],hui.each(a,function(a){this.items.push(a);var b=hui.build("div",{class:"hui_selection_item"});a.element=b,this.element.appendChild(b);var c=hui.build("span",{class:"hui_selection_label",text:a.title||a.text||""});a.icon&&b.appendChild(hui.ui.createIcon(a.icon,16)),b.appendChild(c),hui.listen(b,"click",function(){this.itemWasClicked(a)}.bind(this)),hui.listen(b,"dblclick",function(b){hui.stop(b),this._onDoubleClick(a)}.bind(this))}.bind(this)),this.fireSizeChange()},isSelection:function(a){if(null===this.selection)return!1;var b=a.value==this.selection.value;return this.selection.kind&&(b=b&&a.kind==this.selection.kind),b},itemWasClicked:function(a){this.busy>0||this.changeSelection(a)},_onDoubleClick:function(a){this.busy>0||this.fire("open",a)},_setBusy:function(a){if(this.busy+=a?1:-1,window.clearTimeout(this.busytimer),this.busy>0){var b=this.element;this.busytimer=window.setTimeout(function(){hui.cls.add(b,"hui_selection_busy")},300)}else hui.cls.remove(this.element,"hui_selection_busy"),this.fire("loaded")},_checkValue:function(){if(this.selection){var a=this._getSelectionWithValue(this.selection.value);a||(hui.log("Value not found: "+this.selection.value),this.busy?hui.log("Will not select first since im still busy"):this.selectFirst())}},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}},hui.ui.Selection.Items=function(a){this.options=hui.override({source:null},a),this.element=hui.get(a.element),this.title=hui.get(this.element.id+"_title"),this.name=a.name,this.disclosed={},this.parent=null,this.items=[],hui.ui.extend(this),this.options.source&&this.options.source.listen(this)},hui.ui.Selection.Items.prototype={refresh:function(){this.options.source&&this.options.source.refresh()},$objectsLoaded:function(a){this.$optionsLoaded(a)},$optionsLoaded:function(a){this.items=[],this.element.innerHTML="",this.buildLevel(this.element,a,0,!0),this.title&&(this.title.style.display=this.items.length>0?"block":"none"),this.parent._updateUI(),this.parent._checkValue(),this.fireSizeChange()},$sourceIsBusy:function(){this.parent._setBusy(!0)},$sourceIsNotBusy:function(){this.parent._setBusy(!1)},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){hui.dom.isVisible(this.element)&&this.options.source&&this.options.source.refreshFirst()},buildLevel:function(a,b,c,d){if(b){var e=this.isHierarchy(b),f=hui.build("div",{class:"hui_selection_level",style:d?"display:block":"display:none",parent:a});hui.each(b,function(a){var b=a.text||a.title||"";if("title"==a.type)return void hui.build("div",{class:"hui_selection_title",html:"<span>"+b+"</span>",parent:f});var d=a.children&&a.children.length>0,g=16*c+6;(!e&&c>0||e&&!d)&&(g+=13);var h=hui.build("div",{class:"hui_selection_item"});h.style.paddingLeft=g+"px",a.badge&&h.appendChild(hui.build("strong",{class:"hui_selection_badge",text:a.badge}));var i=!1;if(e&&d){var j=this;i=this.disclosed[a.value];var k=this.disclosed[a.value]?"hui_disclosure hui_disclosure_open":"hui_disclosure",l=hui.build("span",{class:k,parent:h});hui.listen(l,"click",function(b){hui.stop(b),j.toggle(l,a)})}var m=hui.build("span",{class:"hui_selection_label",text:b});a.icon&&h.appendChild(hui.build("span",{class:"hui_icon_1",style:"background-image: url("+hui.ui.getIconUrl(a.icon,16)+")"})),h.appendChild(m),hui.listen(h,"click",function(b){this.parent.itemWasClicked(a)}.bind(this)),hui.listen(h,"dblclick",function(b){hui.stop(b),hui.selection.clear(),this.parent._onDoubleClick(a)}.bind(this)),f.appendChild(h);var n={title:b,icon:a.icon,badge:a.badge,kind:a.kind,element:h,value:a.value};h.dragDropInfo=n,this.items.push(n),this.buildLevel(f,a.children,c+1,i)}.bind(this))}},toggle:function(a,b){hui.cls.has(a,"hui_disclosure_open")?(this.disclosed[b.value]=!1,hui.get.next(a.parentNode).style.display="none",hui.cls.remove(a,"hui_disclosure_open")):(this.disclosed[b.value]=!0,hui.get.next(a.parentNode).style.display="block",hui.cls.add(a,"hui_disclosure_open")),this.parent.fireSizeChange()},isHierarchy:function(a){if(!a)return!1;for(var b=0;b<a.length;b++)if(null!==a[b]&&a[b].children&&a[b].children.length>0)return!0;return!1},getValue:function(){if(null==this.parent.selection)return null;for(var a=0;a<this.items.length;a++)if(this.items[a].value==this.parent.selection.value)return this.items[a];return null},_updateUI:function(){for(var a=0;a<this.items.length;a++)hui.cls.set(this.items[a].element,"hui_selected",this.parent.isSelection(this.items[a]))},selectionChanged:function(a,b){for(var c=0;c<this.items.length;c++){var d=this.items[c].value;if(d==b.value)return void this.fireProperty("value",b.value)}this.fireProperty("value",null)},parentValueChanged:function(){for(var a=0;a<this.items.length;a++)if(this.parent.isSelection(this.items[a]))return void this.fireProperty("value",this.items[a].value);
this.fireProperty("value",null)}},hui.ui.Toolbar=function(a){this.element=hui.get(a.element),this.name=a.name,hui.ui.extend(this)},hui.ui.Toolbar.create=function(a){a=a||{};var b=a.element=hui.build("div.hui_toolbar");return a.labels===!1&&hui.cls.add(b,"hui_toolbar-nolabels"),a.variant&&hui.cls.add(b,"hui_toolbar-"+a.variant),new hui.ui.Toolbar(a)},hui.ui.Toolbar.prototype={add:function(a){this.element.appendChild(a.getElement())},addDivider:function(){this.element.appendChild(hui.build("span.hui_toolbar_divider"))},setSelection:function(a){for(var b=hui.ui.getDescendants(this),c=0;c<b.length;c++){var d=b[c];d.setSelected&&d.setSelected(d.key==a)}},getByKey:function(a){for(var b=hui.ui.getDescendants(this),c=0;c<b.length;c++){var d=b[c];if(d.key==a)return d}}},hui.ui.Toolbar.Icon=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,this.key=a.key,this.enabled=!hui.cls.has(this.element,"hui_toolbar_icon_disabled"),this.element.tabIndex=this.enabled?0:-1,this.icon=hui.get.firstByClass(this.element,"hui_icon"),hui.ui.extend(this),a.listener&&this.listen(a.listener),this._attach()},hui.ui.Toolbar.Icon.create=function(a){var b=a.element=hui.build("a.hui_toolbar_icon"),c=hui.build("span.hui_icon",{style:"background-image: url("+hui.ui.getIconUrl(a.icon,32)+")",parent:b});return a.overlay&&hui.build("span.hui_icon_overlay",{parent:c,style:"background-image: url("+hui.ui.getIconUrl("overlay/"+a.overlay,32)+")"}),hui.build("span.hui_toolbar_icon_text",{text:a.title||a.text,parent:b}),new hui.ui.Toolbar.Icon(a)},hui.ui.Toolbar.Icon.prototype={_attach:function(){var a=this;this.element.onclick=function(){a._click()}},setEnabled:function(a){this.enabled=a,this.element.tabIndex=a?0:-1,hui.cls.set(this.element,"hui_toolbar_icon_disabled",!this.enabled)},disable:function(){this.setEnabled(!1)},enable:function(){this.setEnabled(!0)},setOverlay:function(a){var b=hui.get.firstByClass(this.element,"hui_icon_overlay");if(b&&!a)b.style.backgroundImage="";else if(b&&a)b.style.backgroundImage="url('"+hui.ui.getIconUrl("overlay/"+a,32)+"')";else if(a){var c=hui.get.firstByClass(this.element,"hui_icon");hui.build("span",{class:"hui_icon_overlay",parent:c,style:"background-image: url("+hui.ui.getIconUrl("overlay/"+a,32)+")"})}},setBadge:function(a){var b=hui.get.firstByClass(this.element,"hui_icon_badge");b||hui.isBlank(a)?hui.isBlank(a)&&b?hui.dom.remove(b):b&&hui.dom.setText(b,a):b=hui.build("span",{class:"hui_icon_badge",parent:hui.get.firstByClass(this.element,"hui_icon"),text:a})},setLabel:function(a){var b=hui.get.firstByClass(this.element,"hui_toolbar_icon_text");hui.dom.setText(b,a)},setIcon:function(a){var b=hui.get.firstByClass(this.element,"hui_icon");b.style.backgroundImage="url("+hui.ui.getIconUrl(a,32)+")"},setSelected:function(a){a&&this.element.blur(),hui.cls.set(this.element,"hui_toolbar_icon_selected",a)},_click:function(){this.enabled&&(this.options.confirm?hui.ui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this._fireClick.bind(this)}):this._fireClick())},_fireClick:function(){this.fire("toolbarIconWasClicked"),this.fire("click")}},hui.ui.Toolbar.More=function(a){this.element=hui.get(a.element),this.name=a.name,this.button=hui.get.firstByClass(this.element,"hui_toolbar_more_toggle"),hui.listen(this.button,"click",this.toggle.bind(this)),hui.ui.extend(this)},hui.ui.Toolbar.More.prototype={toggle:function(){hui.cls.toggle(this.element,"hui_is_expanded")}},hui.ui.ImageInput=function(a){this.name=a.name,this.options=hui.override({width:48,height:48},a),this.element=hui.get(a.element),this.images=[],this.value=null,this.thumbnailsLoaded=!1,hui.ui.extend(this),this._attach()},hui.ui.ImageInput.prototype={_attach:function(){hui.listen(this.element,"click",this._showPicker.bind(this)),hui.listen(hui.get.firstByTag(this.element,"a"),"click",this._clear.bind(this))},setObject:function(a){this.value=a,this._updateUI()},getObject:function(){return this.value},getValue:function(){return this.value},setValue:function(a){this.setObject(a)},_clear:function(a){hui.stop(a),this.reset(),this._fireChange()},reset:function(){this.value=null,this._updateUI()},_updateUI:function(){if(hui.cls.set(this.element,"hui_imageinput_full",null!==this.value),null==this.value)this.element.style.backgroundImage="";else{var a=hui.ui.resolveImageUrl(this,this.value,this.options.width,this.options.height);this.element.style.backgroundImage="url("+a+")"}},_showFinder:function(){this.finder||(this.finder=hui.ui.Finder.create(this.options.finder),this.finder.listen({$select:function(a){this.setObject(a),this._fireChange(),this.finder.hide()}.bind(this)})),this.finder.show()},_showPicker:function(){if(this.options.finder)return void this._showFinder();if(!this.picker){var a=this;this.picker=hui.ui.BoundPanel.create({modal:!0}),this.content=hui.build("div",{class:"hui_imageinput_thumbs"});var b=hui.ui.Buttons.create({align:"right"}),c=hui.ui.Button.create({text:"Luk",highlighted:!0,small:!0});c.listen({$click:function(){a._hidePicker()}});var d=hui.ui.Button.create({text:"Fjern",small:!0});d.listen({$click:function(){a.setObject(null),a._hidePicker(),a._fireChange()}}),b.add(d).add(c),this.picker.add(this.content),this.picker.add(b)}this.picker.position(this.element),this.picker.show(),this.thumbnailsLoaded||(this._updateImages(),this.thumbnailsLoaded=!0)},_hidePicker:function(){this.picker.hide()},$visibilityChanged:function(){this.picker&&!hui.dom.isVisible(this.element)&&this.picker.hide(),this.finder&&!hui.dom.isVisible(this.element)&&this.finder.hide()},_fireChange:function(){this.fireValueChange()},_updateImages:function(){var a=this;hui.request({$success:function(b){a._parse(b.responseXML)},url:this.options.url})},_parse:function(a){this.content.innerHTML="";for(var b=a.getElementsByTagName("image"),c=this,d=0;d<b.length;d++){var e=parseInt(b[d].getAttribute("id")),f={id:e},g=hui.ui.resolveImageUrl(this,f,48,48),h=hui.build("div",{class:"hui_imageinput_thumbnail",style:"background-image:url("+g+")"});h.huiObject={id:e},h.onclick=function(){c.setObject(this.huiObject),c._hidePicker(),c._fireChange()},this.content.appendChild(h)}}},hui.ui.BoundPanel=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,this.visible=!1,this.content=hui.get.firstByClass(this.element,"hui_boundpanel_content"),this.arrow=hui.get.firstByClass(this.element,"hui_boundpanel_arrow"),this.arrowWide=37,this.arrowNarrow=18,"light"==a.variant&&(this.arrowWide=23,this.arrowNarrow=12),hui.ui.extend(this)},hui.ui.BoundPanel.create=function(a){a=hui.override({name:null,top:0,left:0,width:null,padding:null,modal:!1,hideOnClick:!1},a);var b='<div class="hui_boundpanel_arrow"></div><div class="hui_boundpanel_top"><div><div></div></div></div><div class="hui_boundpanel_body"><div class="hui_boundpanel_body"><div class="hui_boundpanel_body"><div class="hui_boundpanel_content" style="';return a.width&&(b+="width:"+a.width+"px;"),a.padding&&(b+="padding:"+a.padding+"px;"),b+='"></div></div></div></div><div class="hui_boundpanel_bottom"><div><div></div></div></div>',a.element=hui.build("div",{class:a.variant?"hui_boundpanel hui_boundpanel_"+a.variant:"hui_boundpanel",style:"display:none;zIndex:"+hui.ui.nextPanelIndex()+";top:"+a.top+"px;left:"+a.left+"px",html:b,parent:document.body}),new hui.ui.BoundPanel(a)},hui.ui.BoundPanel.prototype={toggle:function(){this.visible?this.hide():this.show()},show:function(a){a=a||{};var b=a.target||this.options.target;if(b&&(b.nodeName?this.position(b):this.position(hui.ui.get(b))),this.visible)return void(this.element.style.zIndex=hui.ui.nextPanelIndex());hui.browser.opacity&&hui.style.setOpacity(this.element,0);var c;"left"==this.relativePosition?(c=!1,this.element.style.marginLeft="20px"):"right"==this.relativePosition?(c=!1,this.element.style.marginLeft="-20px"):"top"==this.relativePosition?(c=!0,this.element.style.marginTop="20px"):"bottom"==this.relativePosition&&(c=!0,this.element.style.marginTop="-20px"),this.element.style.visibility="visible",this.element.style.display="block";var d=hui.ui.nextPanelIndex();this.element.style.zIndex=d,hui.ui.callVisible(this),hui.browser.opacity&&hui.animate(this.element,"opacity",1,300,{ease:hui.ease.fastSlow}),hui.animate(this.element,c?"margin-top":"margin-left","0px",300,{ease:hui.ease.fastSlow}),this.visible=!0,this.options.modal&&hui.ui.showCurtain({widget:this,zIndex:d-1,transparent:"transparent"==this.options.modal,color:"auto"}),this.options.hideOnClick&&(this.hideListener=hui.listen(document.body,"click",function(a){hui.ui.isWithin(a,this.element)||this.hide()}.bind(this)))},$curtainWasClicked:function(){hui.ui.hideCurtain(this),this.hide()},hide:function(){this.visible&&(hui.browser.opacity?hui.animate(this.element,"opacity",0,100,{ease:hui.ease.slowFast,$complete:function(){this.element.style.display="none",hui.ui.callVisible(this)}.bind(this)}):(this.element.style.display="none",hui.ui.callVisible(this)),this.options.modal&&hui.ui.hideCurtain(this),this.visible=!1,hui.unListen(document.body,"click",this.hideListener))},isVisible:function(){return this.visible},add:function(a){a.getElement?this.content.appendChild(a.getElement()):this.content.appendChild(a)},clear:function(){hui.ui.destroyDescendants(this.content),this.content.innerHTML=""},addSpace:function(a){this.add(hui.build("div",{style:"font-size:0px;height:"+a+"px"}))},_getDimensions:function(){var a,b;return"none"==this.element.style.display?(this.element.style.visibility="hidden",this.element.style.display="block",a=this.element.clientWidth,b=this.element.clientHeight,this.element.style.display="none",this.element.style.visibility=""):(a=this.element.clientWidth,b=this.element.clientHeight),{width:a,height:b}},$$childSizeChanged:function(){this._rePosition()},$$layout:function(){this._rePosition()},_rePosition:function(){this._latest&&this.position(this._latest)},position:function(a){this._latest=a;var b,c,d,e;a.getElement?b=a.getElement():a.element?(b=a.element,c=a.position):a.rect?(c=a.position,b={offsetWidth:a.rect.width,offsetHeight:a.rect.height},d={left:a.rect.left,top:a.rect.top},e={left:0,top:0}):b=hui.get(a),d||(d={left:hui.position.getLeft(b),top:hui.position.getTop(b)}),e||(e=hui.position.getScrollOffset(b));var f,g,h,i,j={left:hui.window.getScrollLeft(),top:hui.window.getScrollTop()},k=d.left-j.left+hui.window.getScrollLeft(),l=b.clientWidth||b.offsetWidth,m=b.clientHeight||b.offsetHeight,n=this._getDimensions(),o=hui.window.getViewWidth(),p=hui.window.getViewHeight(),q={top:d.top-j.top-(e.top-j.top)},r=q.top/p;"vertical"==c&&(r=r>.5?.9:.1);var s,t;r<=.1?(this.relativePosition="top",this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_top",g="light"==this.options.variant?this.arrowNarrow*-1+1:this.arrowNarrow*-1+2,h=Math.min(o-n.width-2,Math.max(3,k+l/2-n.width/2)),f=k+l/2-h-this.arrowNarrow,i=d.top+m+8-(e.top-j.top)):r>=.9?(this.relativePosition="bottom",this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_bottom",g="light"==this.options.variant?n.height-2:n.height-6,h=Math.min(o-n.width-3,Math.max(3,k+l/2-n.width/2)),f=k+l/2-h-this.arrowNarrow,i=d.top-n.height-5-(e.top-j.top)):(k+l/2)/o<.5?(this.relativePosition="left",h=k+l+10,this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_left",i=d.top+(m-n.height)/2,i-=e.top-j.top,s=j.top+3,t=j.top+(p-n.height)-3,i=Math.min(Math.max(i,s),t),g=d.top-i,g-=e.top-j.top,g-=this.arrowWide/2,g+=m/2,"light"==this.options.variant?(f=-11,g+=2):f=-14):(this.relativePosition="right",h=k-n.width-10,this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_right",i=d.top+(m-n.height)/2,i-=e.top-j.top,s=j.top+3,t=j.top+(p-n.height)-3,i=Math.min(Math.max(i,s),t),g=d.top-i,g-=e.top-j.top,g-=this.arrowWide/2,g+=m/2,"light"==this.options.variant?(f=n.width-1,g+=2):f=n.width-4),this.arrow.style.marginTop=g+"px",this.arrow.style.marginLeft=f+"px",this.visible?(hui.animate(this.element,"top",i+"px",500,{ease:hui.ease.fastSlow}),hui.animate(this.element,"left",h+"px",500,{ease:hui.ease.fastSlow})):(this.element.style.top=i+"px",this.element.style.left=h+"px")},destroy:function(){hui.ui.hideCurtain(this),hui.dom.remove(this.element)}},hui.ui.ImageViewer=function(a){this.options=hui.override({maxWidth:800,maxHeight:600,perimeter:100,sizeSnap:100,margin:0,ease:hui.ease.slowFastSlow,easeEnd:hui.ease.bounce,easeAuto:hui.ease.slowFastSlow,easeReturn:hui.ease.cubicInOut,transition:400,transitionEnd:1e3,transitionReturn:300,images:[]},a),this.element=hui.get(a.element),this.box=this.options.box,this.dirty=!1,this.width=600,this.height=460,this.index=0,this.position=0,this.playing=!1,this.name=a.name,this.images=a.images||[],hui.ui.extend(this),this.box.listen(this),this._attach(),this._attachDrag(),a.listener&&this.listen(a.listener)},hui.ui.ImageViewer.create=function(a){a=a||{};var b=a.element=hui.build("div",{class:"hui_imageviewer",html:'<div class="hui_imageviewer_viewer"><div class="hui_imageviewer_inner_viewer"></div></div><div class="hui_imageviewer_text"></div><div class="hui_imageviewer_status"></div><div class="hui_imageviewer_controller"><div><div><a class="hui_imageviewer_previous"></a><a class="hui_imageviewer_play"></a><a class="hui_imageviewer_next"></a><a class="hui_imageviewer_close"></a></div></div></div>'}),c=a.box=hui.ui.Box.create({variant:"plain",absolute:!0,modal:!0,closable:!0});return c.add(b),c.addToDocument(),new hui.ui.ImageViewer(a)},hui.ui.ImageViewer.prototype={nodes:{viewer:".hui_imageviewer_viewer",innerViewer:".hui_imageviewer_inner_viewer",status:".hui_imageviewer_status",text:".hui_imageviewer_text",previous:".hui_imageviewer_previous",controller:".hui_imageviewer_controller",next:".hui_imageviewer_next",play:".hui_imageviewer_play",close:".hui_imageviewer_close"},_attach:function(){var a=this;this.nodes.next.onclick=function(){a.next(!0)},this.nodes.previous.onclick=function(){a.previous(!0)},this.nodes.play.onclick=function(){a.playOrPause()},this.nodes.close.onclick=this.hide.bind(this),this._timer=function(){a.next(!1)},this._keyListener=function(b){b=hui.event(b),b.escapeKey?a.hide():a.zoomed||(b.rightKey?a.next(!0):b.leftKey?a.previous(!0):b.returnKey&&a.playOrPause())},hui.listen(this.nodes.viewer,"mousemove",this._onMouseMove.bind(this)),hui.listen(this.nodes.controller,"mouseover",function(){a.overController=!0}),hui.listen(this.nodes.controller,"mouseout",function(){a.overController=!1}),hui.listen(this.nodes.viewer,"mouseout",function(b){hui.ui.isWithin(b,this.nodes.viewer)||a._hideController()}.bind(this))},_draw:function(a){hui.browser.webkit?this.nodes.innerViewer.style.webkitTransform="translate3d("+this.position+"px,0,0)":this.nodes.innerViewer.style.marginLeft=this.position+"px"},_attachDrag:function(){var a=0,b=0,c=0,d=(this.nodes.viewer,this.nodes.innerViewer,0);hui.drag.register({touch:!0,element:this.nodes.innerViewer,onBeforeMove:function(b){a=b.getLeft(),c=this.position,d=(this.images.length-1)*this.width*-1}.bind(this),onMove:function(e){b=e.getLeft();var f=c-(a-b);f>0&&(f=(Math.exp(f*-.013)-1)*-80),f<d&&(f=80*(Math.exp(.013*(f-d))-1)+d),this.position=f,this._draw()}.bind(this),onAfterMove:function(){var c=a-b<0?Math.floor:Math.ceil;this.index=c(this.position*-1/this.width);var d=this.images.length-1;this.index==this.images.length?this.index=0:this.index<0?this.index=this.images.length-1:d=1,this._goToImage(!0,d,!1,!0)}.bind(this),onNotMoved:this._zoom.bind(this)})},_onMouseMove:function(){window.clearTimeout(this.ctrlHider),this._shouldShowController()&&(this.ctrlHider=window.setTimeout(this._hideController.bind(this),2e3),hui.browser.opacity?hui.effect.fadeIn({element:this.nodes.controller,duration:200}):this.nodes.controller.style.display="block")},_hideController:function(){this.overController||(hui.browser.opacity?hui.effect.fadeOut({element:this.nodes.controller,duration:500}):this.nodes.controller.style.display="none")},_getLargestSize:function(a,b){return hui.fit(b,a,{upscale:!1})},_calculateSize:function(){var a=this.options.sizeSnap,b=hui.window.getViewWidth()-this.options.perimeter;b=Math.floor(b/a)*a,b=Math.min(b,this.options.maxWidth);var c=hui.window.getViewHeight()-this.options.perimeter;c=Math.floor(c/a)*a,c=Math.min(c,this.options.maxHeight);for(var d=0,e=0,f=0;f<this.images.length;f++){var g=this._getLargestSize({width:b,height:c},this.images[f]);d=Math.max(d,g.width),e=Math.max(e,g.height)}c=Math.floor(Math.min(c,e)),b=Math.floor(Math.min(b,d)),b==this.width&&c==this.height||(this.width=b,this.height=c,this.dirty=!0)},_updateUI:function(){if(this.dirty){this.nodes.innerViewer.innerHTML="";for(var a=0;a<this.images.length;a++){var b=hui.build("div",{class:"hui_imageviewer_image"});hui.style.set(b,{width:this.width+this.options.margin+"px",height:this.height-1+"px"}),this.nodes.innerViewer.appendChild(b)}this.nodes.controller.style.display=this._shouldShowController()?"block":"none",this.dirty=!1,this._preload()}},_shouldShowController:function(){return this.images.length>1},_goToImage:function(a,b,c,d){var e=this.position,f=this.position=this.index*(this.width+this.options.margin)*-1;if(a){var g,h;if(d)g=200*b,h=hui.ease.fastSlow,h=hui.ease.quadOut;else if(b>1)g=Math.min(b*this.options.transitionReturn,2e3),h=this.options.easeReturn;else{var i=0==this.index||this.index==this.images.length-1;h=i?this.options.easeEnd:this.options.ease,c||(h=this.options.easeAuto),g=i?this.options.transitionEnd:this.options.transition}hui.animate({node:this.nodes.innerViewer,css:{marginLeft:f+"px"},duration:g,ease:h,$render:function(a,b){this.position=e+(f-e)*b,this._draw()}.bind(this)})}else this._draw();this._drawText()},_drawText:function(){var a=this.images[this.index].text;a?(this.nodes.text.innerHTML=a,this.nodes.text.style.display="block"):(this.nodes.text.innerHTML="",this.nodes.text.style.display="none")},showById:function(a){for(var b=0;b<this.images.length;b++)if(this.images[b].id==a){this.show(b);break}},show:function(a){this.index=a||0,this._calculateSize(),this._updateUI();var b=this.options.margin;hui.style.set(this.element,{width:this.width+b+"px",height:this.height+2*b-1+"px"}),hui.style.set(this.nodes.viewer,{width:this.width+b+"px",height:this.height-1+"px"}),hui.style.set(this.nodes.innerViewer,{width:(this.width+b)*this.images.length+"px",height:this.height-1+"px"}),hui.style.set(this.nodes.controller,{marginLeft:(this.width-160)/2+.5*b+"px",display:"none"}),this.box.show(),this._goToImage(!1,0,!1),hui.listen(document,"keydown",this._keyListener),this.visible=!0,this._setHash(!0)},_setHash:function(a){},_onHashChange:function(){this._changing||(this._changing=!0,hui.location.hasHash("imageviewer")&&!this.visible?this.show():!hui.location.hasHash("imageviewer")&&this.visible&&this.hide(),this._changing=!1)},hide:function(){this._hide()},_hide:function(){this.pause(),this.box.hide(),this._endZoom(),hui.unListen(document,"keydown",this._keyListener),this.visible=!1,this._setHash(!1)},$boxCurtainWasClicked:function(){this.hide()},$boxWasClosed:function(){this.hide()},clearImages:function(){this.images=[],this.dirty=!0},addImages:function(a){for(var b=0;b<a.length;b++)this.addImage(a[b])},addImage:function(a){this.images.push(a),this.dirty=!0},play:function(){this.interval||(this.interval=window.setInterval(this._timer,6e3)),this.next(!1),this.playing=!0,this.nodes.play.className="hui_imageviewer_pause"},pause:function(){window.clearInterval(this.interval),this.interval=null,this.nodes.play.className="hui_imageviewer_play",this.playing=!1},playOrPause:function(){this.playing?this.pause():this.play()},_resetPlay:function(){this.playing&&(window.clearInterval(this.interval),this.interval=window.setInterval(this._timer,6e3))},previous:function(a){var b=1;this.index--,this.index<0&&(this.index=this.images.length-1,b=this.images.length-1),this._goToImage(!0,b,a),this._resetPlay()},next:function(a){var b=1;this.index++,this.index==this.images.length&&(this.index=0,b=this.images.length-1),this._goToImage(!0,b,a),this._resetPlay()},_preload:function(){var a=new hui.Preloader;a.addImages(hui.ui.getURL("gfx/imageviewer_controls.png"));var b=this;a.setDelegate({allImagesDidLoad:function(){b._preloadImages()}}),a.load()},_preloadImages:function(){var a=new hui.Preloader;a.setDelegate(this);for(var b=0;b<this.images.length;b++){var c=hui.ui.resolveImageUrl(this,this.images[b],this.width,this.height);null!==c&&a.addImages(c)}this.nodes.status.innerHTML="0%",this.nodes.status.style.display="",a.load(this.index)},allImagesDidLoad:function(){this.nodes.status.style.display="none"},imageDidLoad:function(a,b,c){this.nodes.status.innerHTML=Math.round(a/b*100)+"%";var d=hui.ui.resolveImageUrl(this,this.images[c],this.width,this.height);d=d.replace(/&amp;/g,"&"),this.nodes.innerViewer.childNodes[c].style.backgroundImage="url('"+d+"')",hui.cls.set(this.nodes.innerViewer.childNodes[c],"hui_imageviewer_image_abort",!1),hui.cls.set(this.nodes.innerViewer.childNodes[c],"hui_imageviewer_image_error",!1)},imageDidGiveError:function(a,b,c){hui.cls.set(this.nodes.innerViewer.childNodes[c],"hui_imageviewer_image_error",!0)},imageDidAbort:function(a,b,c){hui.cls.set(this.nodes.innerViewer.childNodes[c],"hui_imageviewer_image_abort",!0)},zoomed:!1,_zoom:function(a){var b=this.images[this.index];if(!(b.width<=this.width&&b.height<=this.height)){this.zoomer||(this.zoomer=hui.build("div",{class:"hui_imageviewer_zoomer",style:"width:"+this.nodes.viewer.clientWidth+"px;height:"+this.nodes.viewer.clientHeight+"px"}),this.element.insertBefore(this.zoomer,hui.dom.firstChild(this.element)),hui.listen(this.zoomer,"mousemove",this._onZoomMove.bind(this)),hui.listen(this.zoomer,"click",this._endZoom.bind(this))),this._hideController(),this.pause();var c=this._getLargestSize({width:2e3,height:2e3},b),d=hui.ui.resolveImageUrl(this,b,c.width,c.height),e=Math.max(0,Math.round((this.nodes.viewer.clientHeight-c.height)/2));this.zoomer.innerHTML='<div style="width:'+c.width+"px;height:"+c.height+'px; margin: 0 auto;"><img src="'+d+'" style="margin-top: '+e+'px" /></div>',this.zoomer.style.display="block",this.zoomInfo={width:c.width,height:c.height},this._onZoomMove(a),this.zoomed=!0}},_onZoomMove:function(a){if(this.zoomInfo){var b=hui.position.get(this.zoomer);a=new hui.Event(a);var c=(a.getLeft()-b.left)/this.zoomer.clientWidth*(this.zoomInfo.width-this.zoomer.clientWidth),d=(a.getTop()-b.top)/this.zoomer.clientHeight*(this.zoomInfo.height-this.zoomer.clientHeight);this.zoomer.scrollLeft=c,this.zoomer.scrollTop=d}},_endZoom:function(){this.zoomer&&(this.zoomer.style.display="none",this.zoomed=!1)}},window.define&&define("hui.ui.ImageViewer",hui.ui.ImageViewer),hui.ui.Picker=function(a){a=this.options=hui.override({itemWidth:100,itemHeight:150,itemsVisible:null,shadow:!0,valueProperty:"value"},a),this.element=hui.get(a.element),this.name=a.name,this.container=hui.get.firstByClass(this.element,"hui_picker_container"),this.content=hui.get.firstByClass(this.element,"hui_picker_content"),this.title=hui.get.firstByClass(this.element,"hui_picker_title"),this.pages=[],this.objects=[],this.selected=null,this.value=null,this._addBehavior(),hui.ui.extend(this)},hui.ui.Picker.create=function(a){return a=hui.override({shadow:!0},a),a.element=hui.build("div",{class:"hui_picker",html:hui.when(a.title,'<div class="hui_picker_title">'+a.title+"</div>")+'<div class="hui_picker_container"><div class="hui_picker_content"></div></div><div class="hui_picker_pages"></div>'}),1==a.shadow&&hui.cls.add(a.element,"hui_picker_shadow"),new hui.ui.Picker(a)},hui.ui.Picker.prototype={_addBehavior:function(){hui.drag.register({element:this.element,onBeforeMove:this._onBeforeMove.bind(this),onMove:this._onMove.bind(this),onAfterMove:this._onAfterMove.bind(this)}),hui.listen(this.element,"click",this._onClick.bind(this))},_onClick:function(a){if(!this.dragging){a=hui.event(a);var b=a.findByClass("hui_picker_page");b&&this.goToPage(parseInt(b.getAttribute("data-index")))}},goToPage:function(a){var b=Math.round(this.container.clientWidth*a);b=Math.min(b,this.content.clientWidth-this.container.clientWidth),this._scrollTo(b,hui.ease.fastSlow)},setObjects:function(a){this.selected=null,this.objects=a||[],this._updateUI()},setValue:function(a){this.value=a,this._updateSelection()},getValue:function(){return this.value},reset:function(){this.value=null,this._updateSelection()},_updateUI:function(){var a,b=this;this.content.innerHTML="",this.container.scrollLeft=0,a=this.options.itemsVisible?this.options.itemsVisible*(this.options.itemWidth+14):this.container.clientWidth,hui.style.set(this.container,{width:a+"px",height:this.options.itemHeight+14+"px"}),hui.style.set(this.content,{width:this.objects.length*(this.options.itemWidth+14)+"px",height:this.options.itemHeight+14+"px"}),hui.each(this.objects,function(a,c){var d=hui.build("div",{class:"hui_picker_item",title:a.title,html:'<div style="width:'+b.options.itemWidth+"px;height:"+b.options.itemHeight+"px; overflow: hidden; background-image:url('"+a.image+"')\"><strong>"+hui.string.escape(a.title)+"</strong></div>",parent:b.content});null!=b.value&&a[b.options.valueProperty]==b.value&&hui.cls.add(d,"hui_picker_item_selected"),hui.listen(d,"mouseup",function(){b._onItemClick(a[b.options.valueProperty])})}),this._updatePages()},_updatePages:function(){var a=this.container.clientWidth;if(a){var b=Math.ceil(this.content.clientWidth/a),c=hui.get.firstByClass(this.element,"hui_picker_pages");if(hui.dom.clear(c),!(b<2))for(var d=1;d<=b;d++)hui.build("a",{parent:c,text:d,className:"hui_picker_page"+hui.when(1==d," hui_picker_page_selected"),"data-index":d-1})}},_updateSelection:function(){for(var a=this.content.childNodes,b=0;b<a.length;b++)hui.cls.set(a[b],"hui_picker_item_selected",null!=this.value&&this.objects[b][this.options.valueProperty]==this.value)},_onItemClick:function(a){this.dragging||this.value!=a&&(this.value=a,this._updateSelection(),this.fire("select",a))},_onBeforeMove:function(a){this.dragX=a.getLeft(),this.dragScroll=this.container.scrollLeft,this.dragging=!0},_onMove:function(a){this.container.scrollLeft=this.dragX-a.getLeft()+this.dragScroll},_onAfterMove:function(a){var b=this.options.itemWidth+14,c=Math.round(this.container.scrollLeft/b)*b;this._scrollTo(c),this.dragging=!1},_scrollTo:function(a,b){b=b||hui.ease.bounceOut,hui.animate(this.container,"scrollLeft",a,500,{ease:b,onComplete:this._updatePager.bind(this)})},_updatePager:function(){var a=Math.ceil(this.container.scrollLeft/this.container.clientWidth);hui.log(a);for(var b=hui.get.byClass(this.element,"hui_picker_page"),c=0;c<b.length;c++)hui.cls.set(b[c],"hui_picker_page_selected",a==c)},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){this.container.style.display="none";var a;a=this.options.itemsVisible?this.options.itemsVisible*(this.options.itemWidth+14):this.container.parentNode.clientWidth,a=Math.max(a,0),hui.style.set(this.container,{width:a+"px",display:"block"}),this._updatePages()}}},hui.ui.Menu=function(a){this.options=hui.override({autoHide:!1,parentElement:null},a),this.element=hui.get(a.element),this.name=a.name,this.value=null,this.subMenus=[],this.visible=!1,hui.ui.extend(this),this._addBehavior()},hui.ui.Menu.create=function(a){a=a||{},a.element=hui.build("div",{class:"hui_menu"});var b=new hui.ui.Menu(a);return document.body.appendChild(a.element),b},hui.ui.Menu.prototype={_addBehavior:function(){if(this.hider=function(){this.hide(),this.fire("cancel")}.bind(this),this.options.autoHide){var a=function(a){hui.ui.isWithin(a,this.element)||this.options.parentElement&&hui.ui.isWithin(a,this.options.parentElement)||this._isSubMenuVisible()||this.hide()}.bind(this);hui.listen(this.element,"mouseout",a),this.options.parentElement&&hui.listen(this.options.parentElement,"mouseout",a)}},addDivider:function(){hui.build("div",{class:"hui_menu_divider",parent:this.element})},addItem:function(a){var b=this,c=hui.build("div",{class:"hui_menu_item",text:a.title||a.text});if(hui.listen(c,"click",function(c){hui.stop(c),b._onItemClick(a.value)}),a.children&&a.children.length>0){var d=hui.ui.Menu.create({autoHide:!0,parentElement:c});d.addItems(a.children),hui.listen(c,"mouseover",function(a){d.showAtElement(c,a,"horizontal")}),b.subMenus.push(d),hui.cls.add(c,"hui_menu_item_children"),d.listen({$select:function(a){b.hide(),b.fire("select",a)}})}this.element.appendChild(c)},addItems:function(a){for(var b=0;b<a.length;b++)null==a[b]?this.addDivider():this.addItem(a[b])},getValue:function(){return this.value},_onItemClick:function(a){this.value=a,this.fire("itemWasClicked",a),this.fire("select",a),this.hide()},showAtPointer:function(a){a=hui.event(a),a.stop(),this.showAtPoint({top:a.getTop(),left:a.getLeft()})},showAtElement:function(a,b,c){b=hui.event(b),b.stop(),a=hui.get(a);var d=hui.position.get(a);"horizontal"==c?d.left+=a.clientWidth:"vertical"==c&&(d.top+=a.clientHeight),this.showAtPoint(d)},showAtPoint:function(a){var b=hui.window.getViewWidth(),c=hui.window.getViewHeight(),d=hui.window.getScrollTop(),e=hui.window.getScrollLeft();this.visible||hui.style.set(this.element,{display:"block",visibility:"hidden",opacity:0});var f=this.element.clientWidth,g=this.element.clientHeight,h=Math.min(a.left,b-f-26+e),i=Math.max(0,Math.min(a.top,c-g-20+d));hui.style.set(this.element,{top:i+"px",left:h+"px",visibility:"visible",zIndex:hui.ui.nextTopIndex()}),this.element.style.width||(this.element.style.width=f+6+"px"),this.visible||(hui.style.set(this.element,{opacity:1}),this._addHider(),this.visible=!0)},hide:function(a){if(this.visible){this.element.style.display="none",this._removeHider();for(var b=0;b<this.subMenus.length;b++)this.subMenus[b].hide();this.visible=!1,this.fire("hide")}},isVisible:function(){return this.visible},_isSubMenuVisible:function(){for(var a=0;a<this.subMenus.length;a++)if(this.subMenus[a].visible)return!0;return!1},_addHider:function(){hui.listen(document.body,"click",this.hider)},_removeHider:function(){hui.unListen(document.body,"click",this.hider)}},hui.ui.Overlay=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,this.icons={},this.visible=!1,hui.ui.extend(this),this._addBehavior()},hui.ui.Overlay.create=function(a){a=a||{};var b="hui_overlay"+(a.variant?" hui_overlay_"+a.variant:"");a.variant||(b+=" hui_context_dark");var c=a.element=hui.build("div",{className:b,style:"display:none"});return document.body.appendChild(c),new hui.ui.Overlay(a)},hui.ui.Overlay.prototype={_addBehavior:function(){},addIcon:function(a,b){var c=this,d=hui.build("div",{className:"hui_overlay_icon"});hui.ui.setIconImage(d,b,32),hui.listen(d,"click",function(b){c._iconWasClicked(a,b)}),this.icons[a]=d,this.element.appendChild(d)},addText:function(a){this.element.appendChild(hui.build("span",{class:"hui_overlay_text",text:a}))},add:function(a){this.element.appendChild(a.getElement())},hideIcons:function(a){for(var b=0;b<a.length;b++)this.icons[a[b]].style.display="none"},showIcons:function(a){for(var b=0;b<a.length;b++)this.icons[a[b]].style.display=""},_iconWasClicked:function(a,b){hui.ui.callDelegates(this,"iconWasClicked",a,b)},showAtElement:function(a,b){if(b=b||{},hui.ui.positionAtElement(this.element,a,b),b.autoHide&&this._autoHide(a),!this.visible){hui.browser.msie?this.element.style.display="block":(hui.style.set(this.element,{display:"block",opacity:0}),hui.animate(this.element,"opacity",1,150));var c=void 0===b.zIndex?b.zIndex:hui.ui.nextAlertIndex();this.options.modal?(this.element.style.zIndex=hui.ui.nextAlertIndex(),hui.ui.showCurtain({widget:this,zIndex:c})):this.element.style.zIndex=c,this.visible=!0}},_autoHide:function(a){hui.cls.add(a,"hui_overlay_bound"),hui.unListen(document.body,"mousemove",this._hider),this._hider=function(b){if(!hui.ui.isWithin(b,a)&&!hui.ui.isWithin(b,this.element))try{hui.unListen(document.body,"mousemove",this._hider),hui.cls.remove(a,"hui_overlay_bound"),this.hide()}catch(a){hui.log("unable to stop listening: document="+document);
}}.bind(this),hui.listen(document.body,"mousemove",this._hider)},show:function(a){if(a=a||{},this.visible||hui.style.set(this.element,{display:"block",visibility:"hidden"}),a.element&&hui.position.place({source:{element:this.element,vertical:0,horizontal:.5},target:{element:a.element,vertical:.5,horizontal:.5},insideViewPort:!0,viewPortMargin:9}),a.autoHide&&a.element&&this._autoHide(a.element),!this.visible&&(hui.effect.bounceIn({element:this.element}),this.visible=!0,this.options.modal)){var b=hui.ui.nextAlertIndex();this.element.style.zIndex=b+1,hui.ui.showCurtain({widget:this,zIndex:b,color:"auto"})}},$curtainWasClicked:function(){this.hide()},hide:function(){hui.ui.hideCurtain(this),this.element.style.display="none",this.visible=!1},clear:function(){hui.ui.destroyDescendants(this.element),this.element.innerHTML=""}},hui.ui.Upload=function(a){this.options=hui.override({url:"",parameters:{},multiple:!1,maxSize:"20480",types:"*.*",fieldName:"file",chooseButton:"Choose files..."},a),this.element=hui.get(a.element),this.itemContainer=hui.get.firstByClass(this.element,"hui_upload_items"),this.status=hui.get.firstByClass(this.element,"hui_upload_status"),this.placeholder=hui.get.firstByClass(this.element,"hui_upload_placeholder"),this.name=a.name,this.items=[],this.busy=!1,this._chooseImplementation(),hui.ui.extend(this),this._addBehavior()},hui.ui.Upload.implementations=["HTML5","Frame","Flash"],hui.ui.Upload.nameIndex=0,hui.ui.Upload.create=function(a){return a=a||{},a.element=hui.build("div",{class:"hui_upload",html:'<div class="hui_upload_items"></div><div class="hui_upload_status"></div>'+(a.placeholder?'<div class="hui_upload_placeholder"><span class="hui_upload_icon"></span>'+(a.placeholder.title?"<h2>"+hui.string.escape(hui.ui.getTranslated(a.placeholder.title))+"</h2>":"")+(a.placeholder.text?"<p>"+hui.string.escape(hui.ui.getTranslated(a.placeholder.text))+"</p>":"")+"</div>":"")}),new hui.ui.Upload(a)},hui.ui.Upload.prototype={setParameter:function(a,b){this.options.parameters[a]=b,this.impl.setParameter&&this.impl.setParameter(a,b)},clear:function(){for(var a=0;a<this.items.length;a++)this.items[a]&&this.items[a].destroy();this.items=[],this.itemContainer.style.display="none",this.status.style.display="none",this.placeholder&&(this.placeholder.style.display="block")},addDropTarget:function(a){a.element&&hui.drag.listen({element:a.element,hoverClass:a.hoverClass,$dropFiles:function(b){a.$drop&&a.$drop(),this._transferFiles(b)}.bind(this)})},uploadFiles:function(a){this._transferFiles(a)},_chooseImplementation:function(){var a=hui.ui.Upload.implementations;this.options.implementation&&a.splice(0,0,this.options.implementation);for(var b=0;b<a.length;b++){var c=hui.ui.Upload[a[b]],d=c.support();if(d.supported){if(!this.options.multiple){this.impl=new c(this),hui.log("Selected impl (single): "+a[b]);break}if(this.options.multiple&&d.multiple){this.impl=new c(this),hui.log("Selected impl (multiple): "+a[b]);break}}}this.impl||(hui.log("No implementation found, using frame"),this.impl=new hui.ui.Upload.Frame(this))},_addBehavior:function(){return this.impl.initialize?void hui.ui.onReady(function(){this.impl.initialize(),hui.drag.listen({element:this.element,hoverClass:"hui_upload_drop",$dropFiles:this._transferFiles.bind(this)})}.bind(this)):void alert(this.impl)},_transferFiles:function(a){if(a.length>0)if(this.options.multiple)for(var b=0;b<a.length;b++){var c=a[b];this._transferFile(c)}else this._transferFile(a[0])},_transferFile:function(a){hui.log(a);var b=this.$_addItem({name:a.name,size:a.size});hui.request({method:"post",file:a,url:this.options.url,parameters:this.options.parameters,$progress:function(a,c){b.updateProgress(a,c)},$load:function(){hui.log("transferFile: load")},$abort:function(){this.$_itemFail(b),b.setError("Afbrudt")}.bind(this),$success:function(a){hui.log("transferFile: success"),b.data.request=a,this.$_itemSuccess(b)}.bind(this),$failure:function(){hui.log("transferFile: fail"),this.$_itemFail(b)}.bind(this)})},$_addItem:function(a){return this.busy||(this.fire("uploadDidStartQueue"),this.status.style.display="block",this._setWidgetEnabled(!1),this.busy=!0),this._addItem(a)},$_itemSuccess:function(a){var b=hui.get.firstByClass(this.itemContainer,"hui_upload_item_success");a.setProgress(1),a.setSuccess(),this.fire("uploadDidComplete",a.getInfo()),this._checkQueue();var c=null!=b||this.items.length>1;if(c=c&&null!=a.element.nextSibling,c&&(null==b||b!=a.element.nextSibling)){var d=a.element.parentNode,e=a.element.clientHeight;hui.animate({node:a.element,css:{height:"0px"},ease:hui.ease.slowFastSlow,duration:500,onComplete:function(){d.removeChild(a.element),b?d.insertBefore(a.element,b):d.appendChild(a.element),hui.animate({node:a.element,css:{height:e+"px"},ease:hui.ease.slowFastSlow,duration:200})}})}},$_itemFail:function(a){a.setError("Upload af filen fejlede!"),this.fire("uploadDidFail",a.getInfo()),this._checkQueue()},$_getButtonContainer:function(){var a=hui.build("span",{class:"hui_upload_button"});if(this.options.widget){var b=hui.ui.get(this.options.widget);b.element.parentNode.insertBefore(a,b.element),b.element.parentNode.removeChild(b.element),a.appendChild(b.element)}else a.innerHTML='<a href="javascript:void(0);" class="hui_button"><span><span>'+hui.string.escape(hui.ui.getTranslated(this.options.chooseButton))+"</span></span></a>",this.element.appendChild(a);return a},_setWidgetEnabled:function(a){if(this.options.widget){var b=hui.ui.get(this.options.widget);b&&b.setEnabled&&b.setEnabled(a)}},_checkQueue:function(){for(var a=0;a<this.items.length;a++)if(!this.items[a].isFinished())return;this.busy=!1,this._setWidgetEnabled(!0),this.fire("uploadDidCompleteQueue")},_addItem:function(a){var b=a.index;void 0===b&&(b=this.items.length,a.index=b);var c=b>4,d=new hui.ui.Upload.Item(a,c);this.items[b]=d;var e=hui.get.firstByClass(this.itemContainer,"hui_upload_item_success");return e?this.itemContainer.insertBefore(d.element,e):this.itemContainer.appendChild(d.element),this.itemContainer.style.display="block",this.placeholder&&(this.placeholder.style.display="none"),d}},hui.ui.Upload.Item=function(a,b){this.data=a,this.rearrange=b,this.element=hui.build("div",{className:"hui_upload_item"}),this.element.appendChild(hui.ui.createIcon("file/generic",32)),this.content=hui.build("div",{className:"hui_upload_item_content",parent:this.element}),this.progress=hui.ui.ProgressBar.create({small:!0}),this.content.appendChild(this.progress.getElement());var c=hui.build("p",{parent:this.content});this.info=hui.build("strong",{parent:c}),this.status=hui.build("em",{parent:c}),a.name&&hui.dom.setText(this.info,a.name),this.finished=!1,this.error=!1},hui.ui.Upload.Item.prototype={getInfo:function(){return this.data},isFinished:function(){return this.finished},setError:function(a){this._setStatus(a||hui.ui.getTranslated({en:"Error",da:"Fejl"})),hui.cls.add(this.element,"hui_upload_item_error"),this.progress.hide(),this.progress.setValue(0),this.finished=!0},setSuccess:function(a){this._setStatus(hui.ui.getTranslated({en:"Complete",da:"FÃ¦rdig"})),this.progress.setValue(1),this.finished=!0,hui.cls.add(this.element,"hui_upload_item_success")},updateProgress:function(a,b){return this.setProgress(a/b),this},setProgress:function(a){return this._setStatus(hui.ui.getTranslated({en:"Transfering",da:"OverfÃ¸rer"})),this.progress.setValue(Math.min(.9999,a)),this},setWaiting:function(){return this._setStatus("Venter"),this.progress.setWaiting(),this},hide:function(){this.element.hide()},destroy:function(){hui.dom.remove(this.element)},_setStatus:function(a){this._status!==a&&(hui.dom.setText(this.status,a),this._status=a)}},hui.ui.Upload._nameIndex=0,hui.ui.Upload._buildForm=function(a){var b=a.options;hui.ui.Upload._nameIndex++;var c="hui_upload_"+hui.ui.Upload._nameIndex;hui.log("Frame: name="+c);var d=hui.build("form");if(d.setAttribute("action",b.url||""),d.setAttribute("method","post"),d.setAttribute("enctype","multipart/form-data"),d.setAttribute("encoding","multipart/form-data"),d.setAttribute("target",c),b.parameters)for(var e in b.parameters){var f=hui.build("input",{type:"hidden",name:e});f.value=b.parameters[e],d.appendChild(f)}return d},hui.ui.Upload.Frame=function(a){this.parent=a},hui.ui.Upload.Frame.support=function(){return{supported:!0,multiple:!1}},hui.ui.Upload.Frame.prototype={initialize:function(){var a=this.parent.options,b=this.form=hui.ui.Upload._buildForm(this.parent),c=b.getAttribute("target"),d=this.iframe=hui.build("iframe",{name:c,id:c,src:hui.ui.getURL("html/blank.html"),style:"display:none"});this.parent.element.appendChild(d);var e=this;hui.listen(d,"load",function(){e._uploadComplete()}),this.fileInput=hui.build("input",{type:"file",name:a.fieldName}),hui.listen(this.fileInput,"change",this._onSubmit.bind(this)),b.appendChild(this.fileInput);var f=hui.build("span",{class:"hui_upload_button_input"});f.appendChild(b);var g=this.parent.$_getButtonContainer();g.insertBefore(f,g.firstChild)},setParameter:function(a,b){for(var c=this.form.getElementsByTagName("input"),d=0;d<c.length;d++)if(c[d].name==a)return void(c[d].value=b);hui.build("input",{type:"hidden",name:a,value:b,parent:this.form})},_rebuildParameters:function(){hui.browser.msie&&hui.each(this.parent.options.parameters,function(a,b){this.form[a].value=b}.bind(this))},_rebuildFileInput:function(){var a=this.parent.options,b=this.fileInput;this.fileInput=hui.build("input",{type:"file",name:a.fieldName}),hui.listen(this.fileInput,"change",this._onSubmit.bind(this)),hui.dom.replaceNode(b,this.fileInput),hui.log("Frame: input replaced")},_getFileName:function(){return this.fileInput.value.split("\\").pop()},_onSubmit:function(){this.form.style.display="none",this.uploading=!0,this._rebuildParameters(),this.form.submit(),this.item=this.parent.$_addItem({name:this._getFileName()}),this.item.setWaiting(),this._rebuildFileInput(),hui.log("Frame: Upload started:"+this.uploading)},_uploadComplete:function(){if(hui.log("complete:"+this.uploading+" / "+this.parent.name),this.uploading){this.uploading=!1;var a=this._isSuccessResponse();hui.log("Frame: Upload complete: success="+a);var b=this.item;b&&(a?(this.parent.$_itemSuccess(b),hui.log("Frame: Upload succeeded")):(this.parent.$_itemFail(b),hui.log("Frame: Upload failed!"))),this.iframe.src=hui.ui.getURL("html/blank.html"),this.form.style.display="block",this.form.reset()}},_isSuccessResponse:function(){var a=hui.frame.getDocument(this.iframe);return a.body.innerHTML.indexOf("SUCCESS")!==-1}},hui.ui.Upload.HTML5=function(a){this.parent=a},hui.ui.Upload.HTML5.support=function(){var a=void 0!==window.File&&(hui.browser.webkit||hui.browser.gecko||hui.browser.msie10||hui.browser.msie11);return hui.log("HTML5: supported="+a),{supported:a,multiple:!0}},hui.ui.Upload.HTML5.prototype={initialize:function(){var a=this.parent.options,b=hui.build("span",{class:"hui_upload_button_input"});this.form=hui.build("form",{style:"display: inline-block; margin:0;",parent:b});var c={type:"file",name:a.fieldName,parent:this.form};a.multiple&&(c.multiple="multiple"),this.fileInput=hui.build("input",c);var d=this.parent.$_getButtonContainer();d.insertBefore(b,d.firstChild),hui.listen(this.fileInput,"change",this._submit.bind(this))},_submit:function(a){var b=this.fileInput.files;this.parent._transferFiles(b),this._resetInput()},_resetInput:function(){this.form.reset()}},hui.ui.ProgressBar=function(a){this.element=hui.get(a.element),this.name=a.name,this.WAITING=a.small?"hui_progressbar_small_waiting":"hui_progressbar_waiting",this.COMPLETE=a.small?"hui_progressbar_small_complete":"hui_progressbar_complete",this.options=a||{},this.indicator=hui.get.firstByTag(this.element,"div"),hui.ui.extend(this)},hui.ui.ProgressBar.create=function(a){a=a||{};var b=a.element=hui.build("div",{class:a.small?"hui_progressbar hui_progressbar_small":"hui_progressbar"});return b.appendChild(document.createElement("div")),new hui.ui.ProgressBar(a)},hui.ui.ProgressBar.prototype={setValue:function(a){var b=this.element;this.waiting&&hui.cls.remove(b,this.WAITING),hui.cls.set(b,this.COMPLETE,1==a),hui.animate(this.indicator,"width",100*a+"%",200)},setWaiting:function(){this.waiting=!0,this.indicator.style.width=0,hui.cls.add(this.element,this.WAITING)},reset:function(){var a=this.element;this.waiting&&hui.cls.remove(a,this.WAITING),hui.cls.remove(a,this.COMPLETE),this.indicator.style.width="0%"},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block"}},hui.ui.Gallery=function(a){this.options=a||{},this.name=a.name,this.element=hui.get(a.element),this.body=hui.get.firstByClass(this.element,"hui_gallery_body"),this.objects=[],this.nodes=[],this.selected=[],this.width=100,this.height=100,this.revealing=!1,hui.ui.extend(this),a.dropFiles&&this._addDrop(),this.options.source&&this.options.source.listen(this),this.element.parentNode&&hui.cls.has(this.element.parentNode,"hui_overflow")&&(this.revealing=!0,hui.listen(this.element.parentNode,"scroll",this._reveal.bind(this)))},hui.ui.Gallery.create=function(a){return a=a||{},a.element=hui.build("div",{class:"hui_gallery",html:'<div class="hui_gallery_progress"></div><div class="hui_gallery_body"></div>'}),new hui.ui.Gallery(a)},hui.ui.Gallery.prototype={_addDrop:function(){hui.drag.listen({element:this.element,hoverClass:"hui_gallery_drop",$dropFiles:function(a){this.fire("filesDropped",a)}.bind(this),$dropURL:function(a){this.fire("urlDropped",a)}.bind(this)})},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="",this.options.source&&this.options.source.refresh()},setSize:function(a){this.width=a,this.height=a;for(var b=0;b<this.nodes.length;b++){var c=this.nodes[b];c.style.width=a+"px",c.style.height=a+"px"}this.maxRevealed=0,clearTimeout(this._timer),this._timer=setTimeout(function(){for(var a=0;a<this.nodes.length;a++)this.nodes[a].revealed=!1;this._reveal()}.bind(this),500)},reRender:function(){this._render()},setObjects:function(a){this.selected=[],this.objects=a,this._render(),this.fire("selectionReset")},getObjects:function(){return this.objects},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$objectsLoaded:function(a){this.setObjects(a)},$optionsLoaded:function(a){this.setObjects(a)},_render:function(){this.nodes=[],this.maxRevealed=0,this.body.innerHTML="",hui.each(this.objects,function(a,b){var c=0;!this.revealing&&a.height<a.width&&(c=(this.height-this.height*a.height/a.width)/2);var d=(hui.build("img",{style:"margin:"+c+"px auto 0px"}),hui.build("div",{class:"hui_gallery_item",style:"width:"+this.width+"px; height:"+this.height+"px"}));this.revealing||(d.style.backgroundImage="url("+this._resolveImageUrl(a)+")"),hui.listen(d,"click",function(a){this._itemClicked(b,a)}.bind(this)),d.dragDropInfo={kind:"image",icon:"common/image",id:a.id,title:a.name||a.title},d.onmousedown=function(a){return hui.ui.startDrag(a,d),!1},hui.listen(d,"dblclick",function(){this._onItemDoubleClick(b)}.bind(this)),this.body.appendChild(d),this.nodes.push(d)}.bind(this)),this._reveal(),this.fireSizeChange()},_reveal:function(){if(this.revealing){var a=this.element.parentNode,b=a.scrollTop+a.clientHeight;if(!(b<=this.maxRevealed)){this.maxRevealed=b;for(var c=0,d=this.nodes.length;c<d;c++){var e=this.nodes[c];e.revealed||(e.offsetTop<b?(hui.cls.add(e,"hui_is_loading"),function(a,b){var c=new Image,d=this._resolveImageUrl(b);c.onload=function(){a.className="hui_gallery_item",hui.cls.remove(a,"hui_is_pending"),hui.cls.remove(a,"hui_is_loading"),a.style.backgroundImage="url("+d+")"},c.onerror=function(){hui.cls.remove(a,"hui_is_loading"),hui.cls.add(a,"hui_is_error")},c.src=d,a.revealed=!0}.bind(this)(e,this.objects[c])):hui.cls.add(e,"hui_is_pending"))}}}},_updateUI:function(){for(var a=this.selected,b=0;b<this.nodes.length;b++)hui.cls.set(this.nodes[b],"hui_gallery_item_selected",hui.array.contains(a,b))},_resolveImageUrl:function(a){var b=hui.ui.callDelegates(this,"buildImageUrl",{item:a,width:this.width,height:this.height});return b||hui.ui.resolveImageUrl(this,a,this.width,this.height)},_itemClicked:function(a,b){this.busy||(b=hui.event(b),b.metaKey?hui.array.flip(this.selected,a):this.selected=[a],this.fire("select",this.selected),this._updateUI())},isOneSelection:function(){return 1==this.selected.length},getSelectionSize:function(){return this.selected.length},getSelection:function(){for(var a=[],b=0;b<this.selected.length;b++){var c=this.objects[this.selected[b]];c&&a.push(c)}return a},getSelectionIds:function(){for(var a=[],b=0;b<this.selected.length;b++){var c=this.objects[this.selected[b]];c&&a.push(c.id)}return a},getFirstSelection:function(){return this.selected.length>0?this.objects[this.selected[0]]:null},_onItemDoubleClick:function(a){this.busy||(this.fire("itemOpened",this.objects[a]),this.fire("open",this.objects[a]))},setSource:function(a){this.options.source!=a&&(this.options.source&&this.options.source.unListen(this),a.listen(this),this.options.source=a,a.refresh())},$sourceIsBusy:function(){this._setBusy(!0)},$sourceIsNotBusy:function(){this._setBusy(!1)},$visibilityChanged:function(){hui.dom.isVisible(this.element)&&(this.options.source&&this.options.source.refreshFirst(),this._reveal())},$$layout:function(){this.nodes.length>0&&this._reveal()},_setBusy:function(a){if(this.busy=a,window.clearTimeout(this.busytimer),a){var b=this.element;this.busytimer=window.setTimeout(function(){hui.cls.add(b,"hui_gallery_busy")},300)}else hui.cls.remove(this.element,"hui_gallery_busy")}},hui.ui.Calendar=function(a){this.name=a.name,this.options=hui.override({startHour:7,endHour:24},a),this.element=hui.get(a.element),this.head=hui.get.firstByTag(this.element,"thead"),this.body=hui.get.firstByTag(this.element,"tbody"),this.date=new Date,hui.ui.extend(this),this.buildUI(),this.updateUI(),this.options.source&&this.options.source.listen(this)},hui.ui.Calendar.prototype={show:function(){this.element.style.display="block",this.options.source&&this.options.source.refresh()},hide:function(){this.element.style.display="none"},getFirstDay:function(){var a=new Date(this.date.getTime());return a.setDate(a.getDate()-a.getDay()+1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a},getLastDay:function(){var a=new Date(this.date.getTime());return a.setDate(a.getDate()-a.getDay()+7),a.setHours(23),a.setMinutes(59),a.setSeconds(59),a},clearEvents:function(){this.events=[];for(var a=hui.get.byClass(this.element,"hui_calendar_event"),b=0;b<a.length;b++)hui.dom.remove(a[b]);this.hideEventViewer()},$objectsLoaded:function(a){try{this.setEvents(a)}catch(a){hui.log(a)}},$sourceIsBusy:function(){this.setBusy(!0)},$sourceShouldRefresh:function(){return"none"!=this.element.style.display},setEvents:function(a){a=a||[];for(var b=0;b<a.length;b++){var c=a[b];"object"!=typeof c.startTime&&(c.startTime=new Date(1e3*parseInt(c.startTime))),"object"!=typeof c.endTime&&(c.endTime=new Date(1e3*parseInt(c.endTime)))}this.setBusy(!1),this.clearEvents(),this.events=a;var d=this,e=40*(this.options.endHour-this.options.startHour),f=this.getFirstDay().getWeekOfYear(),g=this.getFirstDay().getYear();hui.each(this.events,function(a){var b=hui.get.byClass(d.body,"hui_calendar_day")[a.startTime.getDay()-1];if(b&&a.startTime.getWeekOfYear()==f&&a.startTime.getYear()==g){var c=hui.build("div",{class:"hui_calendar_event",parent:b}),h=40*((60*a.startTime.getHours()+a.startTime.getMinutes())/60-d.options.startHour)-1,i=(a.endTime.getTime()-a.startTime.getTime())/1e3/60/60*40+1;i=Math.min(e-h,i),hui.style.set(c,{marginTop:h+"px",height:i+"px",visibility:"hidden"});var j=hui.build("div",{parent:c});hui.build("p",{class:"hui_calendar_event_time",text:a.startTime.dateFormat("H:i"),parent:j}),hui.build("p",{class:"hui_calendar_event_text",text:a.text,parent:j}),a.location&&hui.build("p",{class:"hui_calendar_event_location",text:a.location,parent:j}),window.setTimeout(function(){hui.effect.bounceIn({element:c})},200*Math.random()),hui.listen(c,"click",function(){d.eventWasClicked(c)})}})},eventWasClicked:function(a){this.showEvent(a)},setBusy:function(a){hui.cls.set(this.element,"hui_calendar_busy",a)},updateUI:function(){for(var a=this.getFirstDay(),b=hui.get.byClass(this.head,"day"),c=0;c<b.length;c++){var d=new Date(a.getTime());d.setDate(d.getDate()+c),hui.dom.setText(b[c],d.dateFormat("l \\d. d M"))}},buildUI:function(){var a=hui.get.firstByClass(this.element,"hui_calendar_bar");this.toolbar=hui.ui.Toolbar.create({labels:!1}),a.appendChild(this.toolbar.getElement());var b=hui.ui.Button.create({name:"huiCalendarPrevious",text:"",icon:"monochrome/previous"});b.listen(this),this.toolbar.add(b);var c=hui.ui.Button.create({name:"huiCalendarToday",text:"Idag"});c.click(function(){this.setDate(new Date)}.bind(this)),this.toolbar.add(c);var d=hui.ui.Button.create({name:"huiCalendarNext",text:"",icon:"monochrome/next"});d.listen(this),this.toolbar.add(d),this.datePickerButton=hui.ui.Button.create({name:"huiCalendarDatePicker",text:"VÃ¦lg dato..."}),this.datePickerButton.listen(this),this.toolbar.add(this.datePickerButton);for(var e=hui.get.firstByClass(this.body,"hui_calendar_day"),f=this.options.startHour;f<=this.options.endHour;f++){var g=hui.build("div",{class:"hui_calendar_time",html:"<span><em>"+f+":00</em></span>"});f==this.options.startHour&&hui.cls.add(g,"hui_calendar_time_first"),f==this.options.endHour&&hui.cls.add(g,"hui_calendar_time_last"),e.appendChild(g)}},$click$huiCalendarPrevious:function(){var a=new Date(this.date.getTime());a.setDate(this.date.getDate()-7),this.setDate(a)},$click$huiCalendarNext:function(){var a=new Date(this.date.getTime());a.setDate(this.date.getDate()+7),this.setDate(a)},setDate:function(a){this.date=new Date(a.getTime()),this.updateUI(),this.refresh(),this.datePicker&&this.datePicker.setValue(this.date)},$click$huiCalendarDatePicker:function(){this.showDatePicker()},refresh:function(){this.clearEvents(),this.setBusy(!0);var a={startTime:this.getFirstDay(),endTime:this.getLastDay()};this.fire("calendarSpanChanged",a),hui.ui.firePropertyChange(this,"startTime",this.getFirstDay()),hui.ui.firePropertyChange(this,"endTime",this.getLastDay())},valueForProperty:function(a){return"startTime"==a?this.getFirstDay():"endTime"==a?this.getLastDay():this[a]},showDatePicker:function(){if(!this.datePickerPanel){this.datePickerPanel=hui.ui.BoundPanel.create(),this.datePicker=hui.ui.DatePicker.create({name:"huiCalendarDatePicker",value:this.date}),this.datePicker.listen(this),this.datePickerPanel.add(this.datePicker),this.datePickerPanel.addSpace(3);var a=hui.ui.Button.create({name:"huiCalendarDatePickerClose",text:"Luk",small:!0,rounded:!0});a.listen(this),this.datePickerPanel.add(a)}this.datePickerPanel.position(this.datePickerButton.getElement()),this.datePickerPanel.show()},$click$huiCalendarDatePickerClose:function(){this.datePickerPanel.hide()},$dateChanged$huiCalendarDatePicker:function(a){this.setDate(a)},showEvent:function(a){if(!this.eventViewerPanel){this.eventViewerPanel=hui.ui.BoundPanel.create({width:270,padding:3}),this.eventInfo=hui.ui.InfoView.create(null,{height:240,clickObjects:!0}),this.eventViewerPanel.add(this.eventInfo),this.eventViewerPanel.addSpace(5);var b=hui.ui.Button.create({name:"huiCalendarEventClose",text:"Luk"});b.listen(this),this.eventViewerPanel.add(b)}this.eventInfo.clear(),this.eventInfo.setBusy(!0),this.eventViewerPanel.position(a),this.eventViewerPanel.show(),hui.ui.callDelegates(this,"requestEventInfo")},updateEventInfo:function(a,b){this.eventInfo.setBusy(!1),this.eventInfo.update(b)},$click$huiCalendarEventClose:function(){this.hideEventViewer()},hideEventViewer:function(){this.eventViewerPanel&&this.eventViewerPanel.hide()}},hui.ui.DatePicker=function(a){this.name=a.name,this.element=hui.get(a.element),this.options={},hui.override(this.options,a),this.cells=[],this.title=hui.get.firstByTag(this.element,"strong"),this.today=new Date,this.value=this.options.value?new Date(this.options.value.getTime()):new Date,this.viewDate=new Date(this.value.getTime()),this.viewDate.setDate(1),hui.ui.extend(this),this._addBehavior(),this._updateUI()},hui.ui.DatePicker.create=function(a){for(var b=a.element=hui.build("div",{class:"hui_datepicker",html:'<div class="hui_datepicker_header"><a class="hui_datepicker_next"></a><a class="hui_datepicker_previous"></a><strong></strong></div>'}),c=hui.build("table",{parent:b}),d=hui.build("thead",{parent:c}),e=hui.build("tr",{parent:d}),f=0;f<7;f++)e.appendChild(hui.build("th",{text:Date.dayNames[f].substring(0,3)}));for(var g=hui.build("tbody",{parent:c}),h=0;h<6;h++)for(var i=hui.build("tr",{parent:g}),j=0;j<7;j++)hui.build("td",{parent:i});return new hui.ui.DatePicker(a)},hui.ui.DatePicker.prototype={_addBehavior:function(){var a=this;this.cells=hui.findAll("td",this.element),hui.each(this.cells,function(b,c){hui.listen(b,"mousedown",function(b){hui.stop(b),a._selectCell(c)})});var b=hui.get.firstByClass(this.element,"hui_datepicker_next"),c=hui.get.firstByClass(this.element,"hui_datepicker_previous");hui.listen(b,"mousedown",function(b){hui.stop(b),a.next()}),hui.listen(c,"mousedown",function(b){hui.stop(b),a.previous()})},setValue:function(a){a||(a=new Date),this.value=new Date(a.getTime()),this.viewDate=new Date(a.getTime()),this.viewDate.setDate(1),this._updateUI()},_updateUI:function(){hui.dom.setText(this.title,this.viewDate.dateFormat("F Y"));for(var a=this.value.getFullYear()==this.viewDate.getFullYear(),b=this.viewDate.getMonth(),c=0;c<this.cells.length;c++){var d=this._indexToDate(c),e=this.cells[c];d.getMonth()<b?e.className="hui_datepicker_dimmed":d.getMonth()>b?e.className="hui_datepicker_dimmed":e.className="",d.getDate()==this.value.getDate()&&d.getMonth()==this.value.getMonth()&&a&&hui.cls.add(e,"hui_datepicker_selected"),d.getDate()==this.today.getDate()&&d.getMonth()==this.today.getMonth()&&d.getFullYear()==this.today.getFullYear()&&hui.cls.add(e,"hui_datepicker_today"),hui.dom.setText(e,d.getDate())}},_getPreviousMonth:function(){var a=new Date(this.viewDate.getTime());return a.setMonth(a.getMonth()-1),a},_getNextMonth:function(){var a=new Date(this.viewDate.getTime());return a.setMonth(a.getMonth()+1),a},previous:function(){this.viewDate=this._getPreviousMonth(),this._updateUI()},next:function(){this.viewDate=this._getNextMonth(),this._updateUI()},_selectCell:function(a){this.value=this._indexToDate(a),this.viewDate=new Date(this.value.getTime()),this.viewDate.setDate(1),this._updateUI(),hui.ui.callDelegates(this,"dateChanged",this.value)},_indexToDate:function(a){var b,c=this.viewDate.getDay(),d=this.viewDate.getDaysInMonth(),e=this._getPreviousMonth().getDaysInMonth();return a<c?(b=this._getPreviousMonth(),b.setDate(e-c+a+1)):a>c+d-1?(b=this._getPreviousMonth(),b.setDate(a-c-d+1)):(b=new Date(this.viewDate.getTime()),b.setDate(a+1-c)),b}},Date.monthNames=["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"],Date.dayNames=["SÃ¸ndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","LÃ¸rdag"],hui.ui.Layout=function(a){this.name=a.name,this.options=a||{},this.element=hui.get(a.element),hui.ui.extend(this)},hui.ui.Layout.create=function(a){return a=hui.override({text:"",highlighted:!1,enabled:!0},a),a.element=hui.dom.parse('<table class="hui_layout"><tbody class="hui_layout"><tr class="hui_layout_middle"><td class="hui_layout_middle"><table class="hui_layout_middle"><tr><td class="hui_layout_left hui_context_sidebar"><div class="hui_layout_left"></div></td><td class="hui_layout_center"></td></tr></table></td></tr></tbody></table>'),new hui.ui.Layout(a)},hui.ui.Layout.prototype={addToLeft:function(a){var b=hui.get.firstByClass(this.element,"hui_layout_left");b.appendChild(a.element)},addToCenter:function(a){var b=hui.get.firstByClass(this.element,"hui_layout_center");b.appendChild(a.element)},$$layout:function(){if(hui.browser.gecko){var a=hui.get.firstByClass(this.element,"hui_layout_center");a&&(a.style.height="100%")}if((window.navigator.userAgent.indexOf("AppleWebKit/536")||hui.browser.msie7||hui.browser.msie8||hui.browser.msie9)&&hui.dom.isVisible(this.element)){if(void 0===this.diff){var b=hui.get.firstByClass(this.element,"hui_layout_top"),c=hui.get.firstByTag(b,"*").clientHeight,d=hui.get.firstByTag(hui.get.firstByTag(this.element,"tfoot"),"td"),e=0;if(d){var f=hui.get.firstByTag(d,"*");f&&(e=f.clientHeight)}c+=hui.position.getTop(this.element),this.diff=e+c,this.element.parentNode!==document.body&&(this.diff+=15)}var g=hui.get.firstByTag(this.element,"tbody"),h=hui.get.firstByTag(g,"td"),i=hui.window.getViewHeight()-this.diff+5;h.style.height=i+"px"}}},hui.ui.Dock=function(a){this.options=a,this.element=hui.get(a.element),this.iframe=hui.get.firstByTag(this.element,"iframe"),this.progress=hui.get.firstByClass(this.element,"hui_dock_progress"),this.resizer=hui.get.firstByClass(this.element,"hui_dock_sidebar_line"),this.bar=hui.get.firstByClass(this.element,"hui_dock_bar"),hui.listen(this.iframe,"load",this._load.bind(this)),this.name=a.name,hui.ui.extend(this),this.busy=!0,hui.ui.listen(this),this._attach()},hui.ui.Dock.prototype={_attach:function(){this.resizer&&(this.sidebar=hui.get.firstByClass(this.element,"hui_dock_sidebar"),this.main=hui.get.firstByClass(this.element,"hui_dock_sidebar_main"),hui.drag.register({element:this.resizer,onStart:function(){this.hasDragged=!1,hui.cls.add(this.element,"hui_dock_sidebar_resizing"),this._setBusy(!0)}.bind(this),onMove:function(a){var b=a.getLeft();b<10&&(b=10),this._updateSidebarWidth(b),this.hasDragged||hui.cls.remove(this.element,"hui_dock_sidebar_collapsed"),this.hasDragged=!0}.bind(this),onEnd:function(){this._setBusy(!1),this.hasDragged?10==this.latestWidth?this.collapse():this.latestExpandedWidth=this.latestWidth:this.toggle(),hui.cls.remove(this.element,"hui_dock_sidebar_resizing"),hui.ui.callVisible(this),hui.ui.reLayout()}.bind(this)}))},_updateSidebarWidth:function(a){this.latestWidth=a,this.sidebar.style.width=a-1+"px",this.main.style.left=a+"px",this.resizer.style.left=a-5+"px"},setUrl:function(a){this._setBusy(!0),hui.frame.getDocument(this.iframe).location.href=a},collapse:function(){hui.cls.add(this.element,"hui_dock_sidebar_collapsed"),this._updateSidebarWidth(10),hui.ui.callVisible(this)},expand:function(){hui.cls.remove(this.element,"hui_dock_sidebar_collapsed"),this._updateSidebarWidth(this.latestExpandedWidth||200),hui.ui.callVisible(this)},toggle:function(){hui.cls.has(this.element,"hui_dock_sidebar_collapsed")?this.expand():this.collapse()},_load:function(){this._setBusy(!1)},_setBusy:function(a){a?hui.style.set(this.progress,{display:"block",height:this.iframe.clientHeight+"px",width:this.iframe.clientWidth+"px"}):this.progress.style.display="none"},$frameLoaded:function(a){a==hui.frame.getWindow(this.iframe)&&this._setBusy(!1)},$$layout:function(){return}},hui.ui.Box=function(a){this.options=hui.override({},a),this.name=a.name,this.element=hui.get(a.element),this.visible=!this.options.absolute,hui.ui.extend(this),this.nodes.close&&hui.listen(this.nodes.close,"click",this._close.bind(this))},hui.ui.Box.create=function(a){a=a||{};var b=a.variant||"standard",c=a.closable?'<a class="hui_box_close hui_box_close_'+b+'" href="#"></a>':"";return a.title&&(c+='<div class="hui_box_header"><strong class="hui_box_title">'+hui.string.escape(hui.ui.getTranslated(a.title))+"</strong></div>"),c+='<div class="hui_box_body" style="'+(a.padding?"padding: "+a.padding+"px;":"")+(a.width?"width: "+a.width+"px;":"")+'"></div>',a.element=hui.build("div",{class:"hui_box hui_box_"+b,html:c,style:a.width?a.width+"px":null}),a.absolute&&hui.cls.add(a.element,"hui_box_absolute"),new hui.ui.Box(a)},hui.ui.Box.prototype={nodes:{body:".hui_box_body",close:".hui_box_close"},_close:function(a){hui.stop(a),this.hide(),this.fire("boxWasClosed"),this.fire("close")},shake:function(){hui.effect.shake({element:this.element})},addToDocument:function(){document.body.appendChild(this.element)},add:function(a){var b=this.nodes.body;
a.getElement?b.appendChild(a.getElement()):b.appendChild(a)},show:function(){var a=this.element;if(this.options.modal){var b=hui.ui.nextPanelIndex();a.style.zIndex=b+1,hui.ui.showCurtain({widget:this,zIndex:b})}if(this.options.absolute){hui.style.set(a,{display:"block",visibility:"hidden"});var c=a.clientWidth,d=(hui.window.getViewHeight()-a.clientHeight)/2+hui.window.getScrollTop();hui.style.set(a,{marginLeft:c/-2+"px",top:d+"px",display:"block",visibility:"visible"})}else a.style.display="block";this.visible=!0,hui.ui.callVisible(this)},isVisible:function(){return this.visible},$$layout:function(){if(this.options.absolute&&this.visible){var a=this.element,b=a.clientWidth,c=(hui.window.getViewHeight()-a.clientHeight)/2+hui.window.getScrollTop();hui.style.set(a,{marginLeft:b/-2+"px",top:c+"px"})}},hide:function(){hui.ui.hideCurtain(this),this.element.style.display="none",this.visible=!1,hui.ui.callVisible(this)},$curtainWasClicked:function(){this.fire("boxCurtainWasClicked"),this.options.curtainCloses&&this._close()}},hui.ui.Wizard=function(a){this.options=a||{},this.element=hui.get(a.element),this.name=a.name,this.container=hui.get.firstByClass(this.element,"hui_wizard_steps"),this.steps=hui.get.byClass(this.element,"hui_wizard_step"),this.anchors=hui.get.byClass(this.element,"hui_wizard_selection"),this.selected=0,hui.ui.extend(this),this._addBehavior()},hui.ui.Wizard.prototype={_addBehavior:function(){var a=this;hui.each(this.anchors,function(b,c){hui.listen(b,"mousedown",function(b){hui.stop(b),a.goToStep(c)}),hui.listen(b,"click",function(a){hui.stop(a)})})},getStep:function(){return this.selected},goToStep:function(a){var b=this.container;b.style.height=b.clientHeight+"px",hui.cls.remove(this.anchors[this.selected],"hui_selected"),this.steps[this.selected].style.display="none",hui.cls.add(this.anchors[a],"hui_selected"),this.steps[a].style.display="block",this.selected=a,hui.animate(b,"height",this.steps[a].clientHeight+"px",500,{ease:hui.ease.slowFastSlow,onComplete:function(){b.style.height=""}}),hui.ui.callVisible(this),this.fire("stepChanged",this.selected)},isFirst:function(){return 0==this.selected},isLast:function(){return this.selected==this.steps.length-1},next:function(){this.selected<this.steps.length-1&&this.goToStep(this.selected+1)},previous:function(){this.selected>0&&this.goToStep(this.selected-1)}},hui.ui.Input=function(a){this.options=hui.override({placeholderElement:null,validator:null},a);var b=this.element=hui.get(a.element);this.element.setAttribute("autocomplete","off"),this.value=this._validate(this.element.value),this.isPassword="password"==this.element.type,this.name=a.name,hui.ui.extend(this),this._addBehavior(),this.options.placeholderElement&&""!=this.value&&hui.style.set(this.options.placeholderElement,{opacity:0,display:"none"}),this._checkPlaceholder();try{b==document.activeElement&&this._onFocus()}catch(a){}},hui.ui.Input.prototype={_addBehavior:function(){var a=this.element,b=this.options.placeholderElement;hui.listen(a,"keyup",this._onKeyUp.bind(this)),hui.listen(a,"blur",this._onBlur.bind(this)),b&&(hui.listen(a,"focus",this._onFocus.bind(this)),hui.listen(a,"blur",this._checkPlaceholder.bind(this)),b&&(b.style.cursor="text",hui.listen(b,"mousedown",this.focus.bind(this)),hui.listen(b,"click",this.focus.bind(this)))),"submit"==a.type&&hui.listen(a,"click",function(a){this.fire("click",a)}.bind(this))},_onFocus:function(){var a=this.element,b=this.options.placeholderElement;b&&""==a.value&&hui.style.set(b,{opacity:0,display:"none"})},_validate:function(a){var b,c=this.options.validator;return c?(b=c.validate(a),hui.cls.set(this.element,"hui_invalid",!b.valid),b.value):a},_checkPlaceholder:function(){this.options.placeholderElement&&""==this.value&&hui.effect.fadeIn({element:this.options.placeholderElement,duration:200}),this.isPassword&&!hui.browser.msie&&(this.element.type="password")},_onKeyUp:function(){if(this.value!==this.element.value){var a=this._validate(this.element.value),b=a!==this.value;this.value=a,b&&this.fire("valueChanged",this.value)}},_onBlur:function(){hui.cls.remove(this.element,"hui_invalid"),this.element.value=this.value||""},getValue:function(){return this.value},setValue:function(a){void 0!==a&&null!==a||(a=""),this.element.value=a,this.value=this._validate(a)},isEmpty:function(){return""==this.value},isBlank:function(){return hui.isBlank(this.value)},focus:function(){this.element.focus()},setError:function(a){var b=!!a;hui.cls.set(this.element,"hui_field_error",b),"string"==typeof a&&hui.ui.showToolTip({text:a,element:this.element,key:this.name}),b||hui.ui.hideToolTip({key:this.name})}},hui.ui.InfoView=function(a){this.options=hui.override({clickObjects:!1},a),this.element=hui.get(a.element),this.body=hui.get.firstByTag(this.element,"tbody"),this.name=a.name,hui.ui.extend(this)},hui.ui.InfoView.create=function(a){a=a||{};var b=a.element=hui.build("div",{class:"hui_infoview",html:"<table><tbody></tbody></table>"});return a.height&&hui.style.set(b,{height:a.height+"px",overflow:"auto",overflowX:"hidden"}),a.margin&&(b.style.margin=a.margin+"px"),new hui.ui.InfoView(a)},hui.ui.InfoView.prototype={addHeader:function(a){var b=hui.build("tr",{parent:this.body});hui.build("th",{class:"hui_infoview_header",colspan:"2",text:a,parent:b})},addProperty:function(a,b){var c=hui.build("tr",{parent:this.body});hui.build("th",{parent:c,text:a}),hui.build("td",{parent:c,text:b})},addObjects:function(a,b){if(b&&0!=b.length){var c=hui.build("tr",{parent:this.body});c.appendChild(hui.build("th",{text:a}));var d=hui.build("td",{parent:c}),e=this.options.clickObjects;hui.each(b,function(a){var b=hui.build("div",{text:a.title,parent:d});e&&(hui.cls.add(b,"hui_infoview_click"),hui.listen(b,"click",function(){hui.ui.callDelegates(this,"objectWasClicked",a)}))})}},setBusy:function(a){hui.cls.set(this,element,"hui_infoview_busy",a)},clear:function(){hui.dom.clear(this.body)},update:function(a){this.clear();for(var b=0;b<a.length;b++)switch(a[b].type){case"header":this.addHeader(a[b].value);break;case"property":this.addProperty(a[b].label,a[b].value);break;case"objects":this.addObjects(a[b].label,a[b].value)}}},hui.ui.Overflow=function(a){this.options=a,this.element=hui.get(a.element),this.topShadow=hui.get.firstByClass(this.element,"hui_overflow_top"),this.bottomShadow=hui.get.firstByClass(this.element,"hui_overflow_bottom"),hui.listen(this.element,"scroll",this._checkShadows.bind(this)),this.name=a.name,hui.ui.extend(this)},hui.ui.Overflow.create=function(a){a=a||{};var b={class:"hui_overflow",html:'<div class="hui_overflow_top"></div><div class="hui_overflow_bottom"></div>'};return a.height&&(b.style={height:a.height+"px"}),a.element=hui.build("div",b),new hui.ui.Overflow(a)},hui.ui.Overflow.prototype={_checkShadows:function(){hui.browser.msie||(this.element.scrollTop>0?(this.topShadow.style.display="block",this.topShadow.style.top=this.element.scrollTop+"px"):this.topShadow.style.display="none",this.element.scrollHeight-this.element.scrollTop-this.element.clientHeight>0?(this.bottomShadow.style.display="block",this.bottomShadow.style.top=this.element.scrollTop+this.element.clientHeight-this.bottomShadow.clientHeight+"px"):this.bottomShadow.style.display="none")},show:function(){this.element.style.display="",hui.ui.callVisible(this)},hide:function(){this.element.style.display="none",hui.ui.callVisible(this)},add:function(a){return a.getElement?this.element.appendChild(a.getElement()):this.element.appendChild(a),this},$$childSizeChanged:function(){this._checkShadows()},$$layout:function(){return this.options.dynamic?(this.element.style.height=hui.position.getRemainingHeight(this.element)+"px",void this._checkShadows()):void this._checkShadows()},$visibilityChanged:function(){hui.dom.isVisible(this.element)&&this.$$layout()}},hui.ui.SearchField=function(a){this.options=hui.override({expandedWidth:null},a),this.element=hui.get(a.element),this.name=a.name,this.field=hui.get.firstByTag(this.element,"input"),this.value=this.field.value,this.adaptive=hui.cls.has(this.element,"hui_searchfield-adaptive"),this.initialWidth=null,hui.ui.extend(this),this._addBehavior(),""!==this.value&&this._updateClass()},hui.ui.SearchField.create=function(a){return a=a||{},a.element=hui.build("span",{class:a.adaptive?"hui_searchfield hui_searchfield-adaptive":"hui_searchfield",html:'<span class="hui_searchfield_placeholder"></span><a href="javascript:void(0);" class="hui_searchfield_reset"></a><input class="hui_searchfield_input" type="text"/>'}),new hui.ui.SearchField(a)},hui.ui.SearchField.prototype={_addBehavior:function(){var a=this;hui.listen(this.field,"keyup",this._onKeyUp.bind(this));var b=hui.get.firstByTag(this.element,"a");if(b.tabIndex=-1,hui.browser.ipad){var c=function(){a.field.focus()};hui.listen(hui.get.firstByTag(this.element,"em"),"click",c)}else{var c=function(){a.field.focus(),a.field.select()};hui.listen(this.element,"mousedown",c),hui.listen(this.element,"mouseup",c),hui.listen(hui.get.firstByTag(this.element,"em"),"mousedown",c)}hui.listen(b,"mousedown",function(b){hui.stop(b),a.reset(),c()}),hui.listen(this.field,"focus",this._onFocus.bind(this)),hui.listen(this.field,"blur",this._onBlur.bind(this))},_onFocus:function(){hui.ui.setKeyboardTarget(this),this.focused=!0,this._updateClass(),this.options.expandedWidth>0&&(null==this.initialWidth&&(this.initialWidth=parseInt(hui.style.get(this.element,"width"))),hui.animate(this.element,"width",this.options.expandedWidth+"px",500,{ease:hui.ease.slowFastSlow}))},_onBlur:function(){hui.ui.setKeyboardTarget(null),this.focused=!1,this._updateClass(),null!==this.initialWidth&&hui.animate(this.element,"width",this.initialWidth+"px",500,{ease:hui.ease.slowFastSlow,delay:100})},_onKeyUp:function(a){this._fieldChanged(),a.keyCode===hui.KEY_RETURN&&this.fire("submit")},focus:function(){this.field.focus()},setValue:function(a){this.field.value=void 0===a||null===a?"":a,this._fieldChanged()},getValue:function(){return this.field.value},isEmpty:function(){return""==this.field.value},isBlank:function(){return hui.isBlank(this.field.value)},reset:function(){this.field.value="",this._fieldChanged()},_updateClass:function(){var a="hui_searchfield";this.adaptive&&(a+=" hui_searchfield-adaptive"),this.focused&&(a+=" hui_searchfield-focus"),""!=this.value&&(a+=" hui_searchfield-dirty"),this.element.className=a},_fieldChanged:function(){this.field.value!=this.value&&(this.value=this.field.value,this._updateClass(),this.fireValueChange())}},window.define&&define("hui.ui.SearchField",hui.ui.SearchField),hui.ui.Fragment=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,hui.ui.extend(this)},hui.ui.Fragment.prototype={show:function(){this.element.style.display="block",hui.ui.callVisible(this)},hide:function(){this.element.style.display="none",hui.ui.callVisible(this)},setHTML:function(a){hui.ui.destroyDescendants(this.element),this.element.innerHTML=a,hui.dom.runScripts(this.element),this.fireSizeChange()},setContent:function(a){this.element.innerHTML="",this.element.appendChild(a),this.fireSizeChange()}},hui.ui.LocationPicker=function(a){a=a||{},this.name=a.name,this.options=a.options||{},this.element=hui.get(a.element),this.backendLoaded=void 0!==window.google&&void 0!==window.google.maps,this.defered=[],hui.ui.extend(this)},hui.ui.LocationPicker.prototype={show:function(a){if(!this.panel){var b=this.panel=hui.ui.BoundPanel.create({width:302,modal:!0}),c=hui.build("div",{style:"width:300px;height:300px;border:1px solid #bbb;"});b.add(c);var d=hui.ui.Buttons.create({align:"right",top:5}),e=hui.ui.Button.create({text:{en:"Close",da:"Luk"},small:!0});e.listen({$click:function(){b.hide()}}),b.add(d.add(e)),hui.style.set(b.element,{left:"-10000px",top:"-10000px",display:""}),this._whenReady(function(){var b={zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN};this.defaultCenter=new google.maps.LatLng(57.0465,9.9185),this.map=new google.maps.Map(c,b),google.maps.event.addListener(this.map,"click",function(a){var b={latitude:a.latLng.lat(),longitude:a.latLng.lng()};this.setLocation(b),this.fire("locationChanged",b)}.bind(this)),this.setLocation(a.location)}.bind(this))}a.node&&this.panel.position(a.node),this.panel.show()},_whenReady:function(a){return this.backendLoaded?void a():(this.defered.push(a),void(this.loadingBackend||(this.loadingBackend=!0,window.huiLocationPickerReady=function(){this.loadingBackend=!1,this.backendLoaded=!0,hui.log("Google maps loaded!");for(var a=0;a<this.defered.length;a++)this.defered[a]();window.huiLocationPickerReady=null}.bind(this),hui.log("Loading google maps..."),hui.require("http://maps.google.com/maps/api/js?callback=huiLocationPickerReady&key=AIzaSyD-kxdnmiDp7Vs9U4oK_iL9UfaRJgbWF8w"))))},setLocation:function(a){this._whenReady(function(){return hui.log("Setting location..."),!a&&this.marker?(this.marker.setMap(null),void this.map.setCenter(this.defaultCenter)):(a=this._buildLatLng(a),this.marker?(this.marker.setPosition(a),this.marker.setMap(this.map)):this.marker=new google.maps.Marker({position:a,map:this.map}),void this.map.setCenter(a))}.bind(this))},_buildLatLng:function(a){return a||(a={latitude:57.0465,longitude:9.9185}),new google.maps.LatLng(a.latitude,a.longitude)}},hui.ui.Bar=function(a){this.options=hui.override({},a),this.name=a.name,this.element=hui.get(a.element),this.visible=!hui.cls.has(this.element,"hui_bar_absolute")&&"none"!=this.element.style.display,this.body=hui.get.firstByClass(this.element,"hui_bar_left"),hui.ui.extend(this)},hui.ui.Bar.create=function(a){a=a||{};var b="hui_bar";a.variant&&(b+=" hui_bar_"+a.variant),a.absolute&&(b+=" hui_bar_absolute"),a.element=hui.build("div",{class:b});var c=hui.build("div",{class:"hui_bar_body",parent:a.element});return hui.build("div",{class:"hui_bar_left",parent:c}),new hui.ui.Bar(a)},hui.ui.Bar.prototype={addToDocument:function(){document.body.appendChild(this.element)},add:function(a){this.body.appendChild(a.getElement())},addDivider:function(){hui.build("span",{class:"hui_bar_divider",parent:this.body})},addToRight:function(a){var b=this._getRight();b.appendChild(a.getElement())},placeAbove:function(a){a.getElement&&(a=a.getElement()),hui.position.place({source:{element:this.element,vertical:1,horizontal:0},target:{element:a,vertical:0,horizontal:0}}),this.element.style.zIndex=hui.ui.nextTopIndex()},setVisible:function(a){this.visible!==a&&(a?this.show():this.hide())},show:function(){this.visible||(this.options.absolute?this.element.style.visibility="visible":(this.element.style.display="",hui.ui.reLayout()),this.visible=!0,hui.ui.callVisible(this))},hide:function(){this.visible&&(this.options.absolute?this.element.style.visibility="hidden":(this.element.style.display="none",hui.ui.reLayout()),this.visible=!1,hui.ui.callVisible(this))},_getRight:function(){if(!this.right&&(this.right=hui.get.firstByClass(this.element,"hui_bar_right"),!this.right)){var a=hui.get.firstByClass(this.element,"hui_bar_body");this.right=hui.build("div",{class:"hui_bar_right",parentFirst:a})}return this.right},select:function(a){var b=hui.ui.getDescendants(this);hui.log(b);for(var c=0;c<b.length;c++){var d=b[c];d.getKey&&d.setSelected&&d.setSelected(d.getKey()==a)}},$clickButton:function(a){this.fire("clickButton",a)}},hui.ui.Bar.Button=function(a){this.options=hui.override({},a),this.name=a.name,this.element=hui.get(a.element),hui.listen(this.element,"click",this._click.bind(this)),hui.listen(this.element,"mousedown",this._mousedown.bind(this)),hui.listen(this.element,"mouseup",hui.stop),hui.ui.extend(this)},hui.ui.Bar.Button.create=function(a){a=a||{};var b=a.element=hui.build("a",{class:"hui_bar_button"});return a.icon&&b.appendChild(hui.ui.createIcon(a.icon,16)),new hui.ui.Bar.Button(a)},hui.ui.Bar.Button.prototype={_mousedown:function(a){this.fire("mousedown"),this.options.stopEvents&&hui.stop(a)},_click:function(a){this.fire("click"),this.options.stopEvents&&hui.stop(a),hui.ui.callAncestors(this,"$clickButton")},setSelected:function(a){hui.cls.set(this.element,"hui_bar_button_selected",a)},getKey:function(){return this.options.key}},hui.ui.Bar.Text=function(a){this.options=hui.override({},a),this.name=a.name,this.element=hui.get(a.element),hui.ui.extend(this)},hui.ui.Bar.Text.prototype={setText:function(a){hui.dom.setText(this.element,hui.ui.getTranslated(a))}},hui.ui.IFrame=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,hui.ui.extend(this)},hui.ui.IFrame.prototype={setUrl:function(a){this.element.setAttribute("src",a)},clear:function(){this.setUrl("about:blank")},getDocument:function(){return hui.frame.getDocument(this.element)},getWindow:function(){return hui.frame.getWindow(this.element)},reload:function(){this.getWindow().location.reload()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}},hui.ui.VideoPlayer=function(a){this.options=a,this.element=hui.get(a.element),this.placeholder=hui.get.firstByTag(this.element,"div"),this.name=a.name,this.state={duration:0,time:0,loaded:0},this.handlers=[hui.ui.VideoPlayer.HTML5,hui.ui.VideoPlayer.QuickTime,hui.ui.VideoPlayer.Embedded],this.handler=null,hui.ui.extend(this),this.options.video&&(this.placeholder?hui.listen(this.placeholder,"click",function(){this.setVideo(this.options.video)}.bind(this)):hui.ui.onReady(function(){this.setVideo(this.options.video)}.bind(this)))},hui.ui.VideoPlayer.prototype={setVideo:function(a){this.placeholder&&(this.placeholder.style.display="none"),this.handler=this.getHandler(a),this.element.appendChild(this.handler.element),this.handler.showController()&&this.buildController()},getHandler:function(a){for(var b=0;b<this.handlers.length;b++){var c=this.handlers[b];if(c.isSupported(a))return new c(a,this)}},buildController:function(){var a=hui.build("div",{class:"hui_videoplayer_controller",parent:this.element});this.playButton=hui.build("a",{href:"javascript:void(0);",class:"hui_videoplayer_playpause",text:"wait!",parent:a}),hui.listen(this.playButton,"click",this.playPause.bind(this)),this.status=hui.build("span",{class:"hui_videoplayer_status",parent:a})},onCanPlay:function(){this.playButton.update("Play")},onLoad:function(){this.state.loaded=this.state.duration,this.updateStatus()},onDurationChange:function(a){this.state.duration=a,this.updateStatus()},onTimeChange:function(a){this.state.time=a,this.updateStatus()},onLoadProgressChange:function(a){this.state.loaded=a,this.updateStatus()},playPause:function(){this.handler.isPlaying()?this.pause():this.play()},play:function(){this.handler.play()},pause:function(){this.handler.pause()},updateStatus:function(){this.status.innerHTML=this.state.time+" / "+this.state.duration+" / "+this.state.loaded}},hui.ui.VideoPlayer.HTML5=function(a,b){var c=this.element=hui.build("video",{width:a.width,height:a.height,src:a.src});hui.listen(c,"load",b.onLoad.bind(b)),hui.listen(c,"canplay",b.onCanPlay.bind(b)),hui.listen(c,"durationchange",function(a){b.onDurationChange(c.duration)}),hui.listen(c,"timeupdate",function(){b.onTimeChange(this.element.currentTime)}.bind(this))},hui.ui.VideoPlayer.HTML5.isSupported=function(a){return hui.browser.webkitVersion>528&&("video/quicktime"===a.type||"video/mp4"===a.type)},hui.ui.VideoPlayer.HTML5.prototype={showController:function(){return!0},pause:function(){this.element.pause()},play:function(){this.element.play()},getTime:function(){return this.element.currentTime},isPlaying:function(){return!this.element.paused}},hui.ui.VideoPlayer.QuickTime=function(a,b){this.player=b;var c=this.element=hui.build("object",{width:a.width,height:a.height,data:a.src,type:"video/quicktime"});c.innerHTML='<param value="false" name="controller"/><param value="true" name="enablejavascript"/><param value="undefined" name="posterframe"/><param value="false" name="showlogo"/><param value="false" name="autostart"/><param value="true" name="cache"/><param value="white" name="bgcolor"/><param value="false" name="aggressivecleanup"/><param value="true" name="saveembedtags"/><param value="true" name="postdomevents"/>',hui.listen(c,"qt_canplay",b.onCanPlay.bind(b)),hui.listen(c,"qt_load",b.onLoad.bind(b)),hui.listen(c,"qt_progress",function(){b.onLoadProgressChange(c.GetMaxTimeLoaded()/3e3)}),hui.listen(c,"qt_durationchange",function(a){b.onDurationChange(c.GetDuration()/3e3)}),hui.listen(c,"qt_timechanged",function(){b.onTimeChange(c.GetTime())})},hui.ui.VideoPlayer.QuickTime.isSupported=function(a){return void 0==a.html},hui.ui.VideoPlayer.QuickTime.prototype={showController:function(){return!0},pause:function(){window.clearInterval(this.observer),this.element.Stop()},play:function(){this.element.Play(),this.observer=window.setInterval(this.observeVideo.bind(this),100)},observeVideo:function(){this.player.onTimeChange(this.element.GetTime()/3e3)},getTime:function(){return this.element.GetTime()},isPlaying:function(){return 0!==this.element.GetRate()}},hui.ui.VideoPlayer.Embedded=function(a,b){this.element=hui.build("div",{width:a.width,height:a.height,html:a.html})},hui.ui.VideoPlayer.Embedded.isSupported=function(a){return void 0!==a.html},hui.ui.VideoPlayer.Embedded.prototype={showController:function(){return!1},pause:function(){},play:function(){},getTime:function(){},isPlaying:function(){}},hui.ui.Segmented=function(a){this.options=hui.override({value:null,allowNull:!1},a),this.element=hui.get(a.element),this.name=a.name,this.value=this.options.value,hui.ui.extend(this),hui.listen(this.element,"mousedown",this._click.bind(this))},hui.ui.Segmented.create=function(a){var b=a.element=hui.build("span",{class:"hui_segmented hui_segmented_standard"});if(a.items)for(var c=0;c<a.items.length;c++){var d=a.items[c],e=hui.build("a",{parent:b,href:"javascript://",rel:d.value});d.icon&&e.appendChild(hui.ui.createIcon(d.icon,16)),d.text&&hui.build("span",{class:"hui_segmented_text",text:d.text,parent:e}),void 0!==a.value&&a.value==d.value&&hui.cls.add(e,"hui_segmented_selected")}return new hui.ui.Segmented(a)},hui.ui.Segmented.prototype={_click:function(a){a=new hui.Event(a);var b=a.findByTag("a");if(b){for(var c=!1,d=b.getAttribute("rel"),e=hui.get.byClass(this.element,"hui_segmented_selected"),f=0;f<e.length;f++)hui.cls.remove(e[f],"hui_segmented_selected");d===this.value&&this.options.allowNull?(c=!0,this.value=null):(hui.cls.add(b,"hui_segmented_selected"),c=this.value!==d,this.value=d),c&&this.fireValueChange()}},setValue:function(a){void 0===a&&(a=null);var b=this.element.getElementsByTagName("a");this.value=null;for(var c=0;c<b.length;c++)b[c].getAttribute("rel")===a?(hui.cls.add(b[c],"hui_segmented_selected"),this.value=a):hui.cls.remove(b[c],"hui_segmented_selected")},getValue:function(){return this.value}},hui.ui.Flash={fullVersion:void 0,getMajorVersion:function(){var a=this.getFullVersion();if(null===a||void 0===a)return null;var b=(a+"").match(/[0-9]+/gi);return b.length>0?parseInt(b[0]):null},getFullVersion:function(){if(void 0!==this.fullVersion)return this.fullVersion;var a=null;if(null!=navigator.plugins&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var b=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",c=navigator.plugins["Shockwave Flash"+b].description,d=c.split(" "),e=d[2].split("."),f=e[0],g=e[1],h=d[3];""==h&&(h=d[4]),"d"==h[0]?h=h.substring(1):"r"==h[0]&&(h=h.substring(1),h.indexOf("d")>0&&(h=h.substring(0,h.indexOf("d")))),a=f+"."+g+"."+h}}else navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1?a=4:navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1?a=3:navigator.userAgent.toLowerCase().indexOf("webtv")!=-1?a=2:hui.browser.msie&&(a=this.getActiveXVersion());return this.fullVersion=a,a},getActiveXVersion:function(){var a,b;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),a=b.GetVariable("$version")}catch(a){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),a="WIN 6,0,21,0",b.AllowScriptAccess="always",a=b.GetVariable("$version")}catch(a){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a=b.GetVariable("$version")}catch(a){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),a="WIN 3,0,18,0"}catch(a){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),a="WIN 2,0,0,11"}catch(b){a=-1}return a}},hui.ui.Link=function(a){this.options=a,this.name=a.name,this.element=hui.get(a.element),hui.ui.extend(this),this.addBehavior()},hui.ui.Link.prototype={addBehavior:function(){var a=this;hui.listen(this.element,"click",function(b){hui.stop(b),window.setTimeout(function(){a.fire("click")})})}},hui.ui.Links=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,hui.ui.extend(this),this.items=[],this.addBehavior(),this.selectedIndex=null,this.inputs={}},hui.ui.Links.prototype={addBehavior:function(){hui.listen(this.element,"click",this.onClick.bind(this)),hui.listen(this.element,"dblclick",this.onDblClick.bind(this))},reset:function(){this.setValue([])},setValue:function(a){this.items=a,this.selectedIndex=null,this.build()},getValue:function(){return this.items},onDblClick:function(a){a=new hui.Event(a),hui.selection.clear(),a.stop(a);var b=this.selectAndGetRow(a),c={text:b.text};c[b.kind]=b.value,this.editedLink=b;var d=this.getEditWindow();this.editForm.reset(),this.editForm.setValues(c),d.show()},onClick:function(a){a=new hui.Event(a),a.stop();var b=a.getElement();if(hui.cls.has(b,"hui_links_remove")){var c=a.findByClass("hui_links_row");hui.ui.confirmOverlay({element:b,text:"Vil du fjerne linket?",okText:"Ja, fjern",cancelText:"Annuller",onOk:function(){this.items.splice(c.hui_index,1),this.selectedIndex===c.hui_index&&(this.selectedIndex=null),this.build()}.bind(this)})}else this.selectAndGetRow(a)},selectAndGetRow:function(a){var b=a.findByClass("hui_links_row");if(b){var c=b.hui_index;if(null!==this.selectedIndex){var d=hui.get.byClass(this.element,"hui_links_row")[this.selectedIndex];hui.cls.remove(d,"hui_links_row_selected")}return this.selectedIndex=c,hui.cls.add(b,"hui_links_row_selected"),this.items[c]}},build:function(){var a,b,c,d,e,f,g=this.list||hui.get.firstByClass(this.element,"hui_links_list");for(g.innerHTML="",a=0;a<this.items.length;a++)b=this.items[a],c=hui.build("div",{class:"hui_links_row"}),c.hui_index=a,c.appendChild(hui.ui.createIcon(b.icon,16)),e=hui.build("div",{class:"hui_links_text",text:b.text}),c.appendChild(e),d=hui.build("div",{class:"hui_links_info",text:hui.string.wrap(b.info)}),c.appendChild(d),f=hui.ui.createIcon("monochrome/delete",16),hui.cls.add(f,"hui_links_remove"),c.appendChild(f),g.appendChild(c)},addLink:function(){this.editedLink=null,this.getEditWindow().show(),this.editForm.reset(),this.editForm.focus()},getEditWindow:function(){if(!this.editWindow){var a=this.editWindow=hui.ui.Window.create({title:"Link",width:300,padding:5}),b=this.editForm=hui.ui.Formula.create(),c=b.buildGroup({above:!1},[{label:"Tekst",type:"TextField",options:{key:"text"}}]),d=hui.ui.TextInput.create({key:"url"});c.add(d,"URL"),this.inputs.url=d;var e=hui.ui.TextInput.create({key:"email"});c.add(e,"E-mail"),this.inputs.email=e,page=hui.ui.DropDown.create({key:"page",source:this.options.pageSource}),c.add(page,"Side"),this.inputs.page=page,file=hui.ui.DropDown.create({key:"file",source:this.options.fileSource}),c.add(file,"Fil"),this.inputs.file=file;var f=this;hui.each(this.inputs,function(a,b){b.listen({$valueChanged:function(){f.changeType(a)}})}),c.createButtons().add(hui.ui.Button.create({text:"Gem",submit:!0,highlighted:!0})),this.editForm.listen({$submit:this.saveLink.bind(this)}),a.add(b),this.options.pageSource&&this.options.pageSource.refresh(),this.options.fileSource&&this.options.fileSource.refresh()}return this.editWindow},saveLink:function(){var a=this.editForm.getValues(),b=this.valuesToLink(a),c=this.editedLink;c?hui.override(c,b):this.items.push(b),this.build(),this.editForm.reset(),this.editWindow.hide(),this.editedLink=null},valuesToLink:function(a){var b={};return b.text=a.text,""!=a.email?(b.kind="email",b.value=a.email,b.info=a.email,b.icon="monochrome/email"):""!=a.url?(b.kind="url",b.value=a.url,b.info=a.url,b.icon="monochrome/globe"):hui.isDefined(a.page)?(b.kind="page",b.value=a.page,b.info=this.inputs.page.getItem().title,b.icon="common/page"):hui.isDefined(a.file)&&(b.kind="file",b.value=a.file,b.info=this.inputs.file.getItem().title,b.icon="monochrome/file"),b},changeType:function(a){hui.each(this.inputs,function(b,c){b!=a&&c.setValue()})}},hui.ui.MarkupEditor=function(a){this.name=a.name,this.options=a=hui.override({debug:!1,value:"",autoHideToolbar:!0},a),a.replace&&(a.replace=hui.get(a.replace),a.element=hui.build("div",{class:"hui_markupeditor "+a.replace.className}),a.replace.parentNode.insertBefore(a.element,a.replace),a.replace.style.display="none",a.value=this.options.replace.innerHTML),this.ready=!1,this.pending=[],this.element=hui.get(a.element),hui.browser.msie?this.impl=hui.ui.MarkupEditor.MSIE:this.impl=hui.ui.MarkupEditor.webkit,this.impl.initialize({element:this.element,controller:this,$ready:this._ready.bind(this)}),a.value&&this.setValue(a.value),hui.ui.extend(this)},hui.ui.MarkupEditor.create=function(a){return a=a||{},a.element=hui.build("div",{className:"hui_markupeditor"}),new hui.ui.MarkupEditor(a)},hui.ui.MarkupEditor.prototype={_ready:function(){this.ready=!0;for(var a=0;a<this.pending.length;a++)this.pending[a]()},implFocused:function(){this._showBar()},implBlurred:function(){this.bar.hide(),this.fire("blur")},implValueChanged:function(){this._valueChanged()},implSelectionChanged:function(){this.options.linkDelegate&&this.options.linkDelegate.$cancel(),this._highlightNode(null),this.temporaryLink=null,this._valueChanged(),this._refreshInfoWindow(),this.bar&&this.bar.setBlock(this._getFirstBlock())},_getFirstBlock:function(){for(var a=this.impl.getPath(),b=["P","DIV","H1","H2","H3","H4","H5","H6","BLOCKQUOTE"],c=a.length-1;c>=0;c--){var d=a[c].tagName;if(b.indexOf(d)!==-1)return a[c]}return null},destroy:function(){hui.dom.remove(this.element),this.options.replace&&(this.options.replace.style.display="");for(var a=["colorPicker","_infoWindow","bar","impl"],b=a.length-1;b>=0;b--)this[a[b]]&&this[a[b]].destroy()},getValue:function(){return this.impl.getHTML()},setValue:function(a){this._whenReady(function(){this.impl.setHTML(a)}.bind(this))},focus:function(){this._whenReady(this.impl.focus.bind(this.impl))},_whenReady:function(a){this.ready?a():this.pending.push(a)},_showBar:function(){this.bar||(this.bar=new hui.ui.MarkupEditor.Bar({$clickButton:this._buttonClicked.bind(this),$changeBlock:this._changeBlock.bind(this)})),this.bar.show(this)},_buttonClicked:function(a){this.impl.saveSelection(),"color"==a.key?this._showColorPicker():"addLink"==a.key?this._showLinkEditor():"align"==a.key?this.impl.align(a.value):"clear"==a.key?this.impl.removeFormat():"info"==a.key?this._toggleInfoWindow():this.impl.format(a),this._valueChanged(),this._refreshInfoWindow(),this.impl.restoreSelection(),this.impl._selectionChanged()},_changeBlock:function(a){var b=this._getFirstBlock();b&&(b=hui.dom.changeTag(b,a),this.impl.selectNode(b))},_showColorPicker:function(){if(!this.colorPicker){this.colorPicker=hui.ui.Window.create({title:{en:"Color",da:"Farve"}});var a=hui.ui.ColorPicker.create();a.listen(this),this.colorPicker.add(a),this.colorPicker.listen({$userClosedWindow:function(){this.impl.restoreSelection()}.bind(this)})}this.colorPicker.show({avoid:this.element})},_highlightNode:function(a){this._highlightedNode&&hui.cls.remove(this._highlightedNode,"hui_markupeditor_highlighted"),this._highlightedNode=a,a&&hui.cls.add(a,"hui_markupeditor_highlighted")},_showLinkEditor:function(){if(this.temporaryLink=this.impl.getOrCreateLink(),this._highlightNode(this.temporaryLink),this.options.linkDelegate){var a=this.options.linkDelegate;a.$editLink({node:this.temporaryLink,$changed:function(){this._highlightNode(null),this.temporaryLink=null,this._valueChanged()}.bind(this),$cancel:function(){this._highlightNode(null),
this.temporaryLink=null,this._valueChanged()}.bind(this),$remove:function(){this.impl._unWrap(this.temporaryLink),this.impl._selectionChanged()}.bind(this)})}else if(!this.linkEditor){this.linkEditor=hui.ui.Window.create({padding:5,width:300}),this.linkForm=hui.ui.Formula.create(),this.linkEditor.add(this.linkForm);var b=this.linkForm.buildGroup({},[{type:"TextField",options:{key:"url",label:"Address:"}}]),c=b.createButtons(),d=hui.ui.Button.create({text:"OK",submit:!0});this.linkForm.listen({$submit:this._updateLink.bind(this)}),c.add(d)}this.linkEditor&&(this.linkForm.setValues({url:this.temporaryLink.href}),this.linkEditor.show({avoid:this.element}),this.linkForm.focus())},_updateLink:function(){var a=this.linkForm.getValues();this.temporaryLink.href=a.url,this.linkForm.reset(),this.temporaryLink=null,this.linkEditor.hide(),this._valueChanged()},_valueChanged:function(){this.fire("valueChanged",this.impl.getHTML()),this._refreshInfoWindow()},_toggleInfoWindow:function(){this._infoWindow||(this._infoWindow=new hui.ui.MarkupEditor.Info({editor:this})),this._infoWindow.toggle(),this._refreshInfoWindow()},_refreshInfoWindow:function(){this._infoWindow&&this._infoWindow.updatePath(this.impl.getPath())},$colorWasSelected:function(a){this.impl.restoreSelection(function(){this.impl.colorize(a),this._valueChanged()}.bind(this))},$$parentMoved:function(){this.bar&&this.bar.place(this)}},hui.ui.MarkupEditor.Bar=function(a){this.options=a,this._initialize(),hui.ui.extend(this)},hui.ui.MarkupEditor.Bar.prototype={_initialize:function(){var a=[{key:"bold",icon:"edit/text_bold"},{key:"italic",icon:"edit/text_italic"},{divider:!0},{key:"color",icon:"common/color"},{key:"addLink",icon:"monochrome/link"},{divider:!0},{key:"align",value:"left",icon:"edit/text_align_left"},{key:"align",value:"center",icon:"edit/text_align_center"},{key:"align",value:"right",icon:"edit/text_align_right"},{key:"align",value:"justify",icon:"edit/text_align_justify"},{divider:!0},{key:"clear",icon:"edit/clear"},{key:"info",icon:"monochrome/info"}];this.bar=hui.ui.Bar.create({absolute:!0,variant:"mini",small:!0});var b=this.blockSelector=hui.ui.DropDown.create({focus:!1,variant:"bar_mini",items:[{value:"h1",text:"Header 1"},{value:"h2",text:"Header 2"},{value:"h3",text:"Header 3"},{value:"h4",text:"Header 4"},{value:"h5",text:"Header 5"},{value:"h6",text:"Header 6"},{value:"p",text:"Paragraph"},{value:"div",text:"Division"},{value:"blockquote",text:"Blockquote"}]});this.bar.add(b),b.listen({$valueChanged:function(a){this.options.$changeBlock(a)}.bind(this)}),hui.each(a,function(a){if(a.divider)return void this.bar.addDivider();var b=new hui.ui.Bar.Button.create({icon:a.icon,stopEvents:!0});b.listen({$mousedown:function(){this.options.$clickButton(a)}.bind(this)}),this.bar.add(b)}.bind(this)),this.bar.addToDocument()},show:function(a){this.bar.placeAbove(a),this.bar.show()},place:function(a){this.bar.placeAbove(a)},hide:function(){this.bar.hide()},setBlock:function(a){a&&this.blockSelector.setValue(a.tagName.toLowerCase())},destroy:function(){this.bar.destroy()}},hui.ui.MarkupEditor.Info=function(a){this.options=a,this._initialize()};hui.ui.MarkupEditor.Info.prototype={_initialize:function(){this._window=hui.ui.Window.create({title:"Info",width:400}),this._css=hui.ui.CodeInput.create(),this._css.listen({$valueChanged:function(a){this.tag&&this.tag.setAttribute("style",a)}.bind(this)}),this._window.add(this._css),this._path=hui.build("div",{class:"hui_markupeditor_path"}),this._window.add(this._path)},toggle:function(){this._window.toggle({avoid:this.options.editor.element})},updatePath:function(a){for(var b="",c=a.length-1;c>=0;c--)b+='<a data-index="'+c+'" href="javascript://">'+a[c].tagName+"</a> ";this._path.innerHTML=b,this.tag=a[0],this._css.setValue(this.tag?this.tag.getAttribute("style"):"")},destroy:function(){this._window.destroy()}},hui.ui.MarkupEditor.webkit={path:[],initialize:function(a){this.element=a.element,hui.style.set(this.element,a.controller.options.style),this.element.style.overflow="auto",this.element.contentEditable=!0;var b=this.controller=a.controller;hui.listen(this.element,"focus",function(){b.implFocused()}),hui.listen(this.element,"blur",function(){b.implBlurred()}),hui.listen(this.element,"keyup",this._change.bind(this)),hui.listen(this.element,"mouseup",this._change.bind(this)),a.$ready()},saveSelection:function(){},restoreSelection:function(a){a&&a()},focus:function(){this.element.focus(),this._selectionChanged(),this.controller.implFocused()},format:function(a){if("strong"==a.key||"em"==a.key)this._wrapInTag(a.key);else if("insert-table"==a.key)this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>");else{document.execCommand(a.key,null,a.value);var b=this._getSelectedNode();"B"==b.tagName?(b=hui.dom.changeTag(b,"strong"),this.selectNode(b)):"I"==b.tagName&&(b=hui.dom.changeTag(b,"em"),this.selectNode(b)),this.controller._valueChanged()}this._selectionChanged()},selectNode:function(a){window.getSelection().selectAllChildren(a),this._selectionChanged()},getOrCreateLink:function(){var a=this._getSelectedNode();return a&&"a"==a.tagName.toLowerCase()?a:(document.execCommand("createLink",null,"#"),this._selectionChanged(),this._getSelectedNode())},_getSelectedNode:function(){var a=window.getSelection(),b=a.getRangeAt(0),c=b.commonAncestorContainer;return hui.dom.isElement(c)||(c=c.parentNode),c},colorize:function(a){document.execCommand("forecolor",null,a);var b=this._getSelectedNode();if("FONT"==b.tagName){b=hui.dom.changeTag(b,"span"),b.style.color=a,b.removeAttribute("color");var c=window.getSelection();c.selectAllChildren(b)}this._selectionChanged()},align:function(a){var b={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};document.execCommand(b[a],null,null),this._updateInlinePanel()},_change:function(){this.controller.implValueChanged(),this._selectionChanged()},_wrapInTag:function(a){var b=window.getSelection();if(!(b.rangeCount<1)){var c=b.getRangeAt(0),d=c.commonAncestorContainer;if(hui.dom.isElement(d)||(d=d.parentNode),d.tagName.toLowerCase()==a)this._unWrap(d);else{var e=document.createElement(a);c.surroundContents(e),b.selectAllChildren(e)}this._selectionChanged()}},_getInlineTag:function(){var a=window.getSelection();a.rangeCount<1},removeLink:function(a){this._unWrap(a),this._selectionChanged()},_unWrap:function(a){for(var b=a.childNodes,c=0;c<b.length;c++)a.parentNode.insertBefore(b[c],a);a.parentNode.removeChild(a)},_insertHTML:function(a){document.execCommand("inserthtml",null,a)},_getAncestor:function(){var a=window.getSelection();if(a.rangeCount<1)return null;var b=a.getRangeAt(0),c=b.commonAncestorContainer;return hui.dom.isElement(c)||(c=c.parentNode),c},_buildInlinePanel:function(){this._inlinePanel=hui.ui.BoundPanel.create({variant:"light"});var a=hui.build("div",{class:"hui_markupeditor_inlinepanel",html:'<a href="javascript://" data="bold"><strong>Bold</strong></a><a href="javascript://" data="italic"><em>Italic</em></a>'});hui.listen(a,"mousedown",function(a){a=hui.event(a),a.stop();var b=a.findByTag("a");b&&(this.saveSelection(),this.format({key:b.getAttribute("data")}),this.restoreSelection(),this._selectionChanged())}.bind(this)),this._inlinePanel.add(a)},_updateInlinePanel:function(){var a=window.getSelection();if(this._inlinePanel||this._buildInlinePanel(),a.rangeCount<1)return void this._inlinePanel.hide();var b=a.getRangeAt(0);if(b.startOffset==b.endOffset)return void this._inlinePanel.hide();var c=b.getClientRects();if(c.length>0){var d=c[0];this._inlinePanel.position({rect:d,position:"vertical"}),this._inlinePanel.show()}},_selectionChanged:function(){var a=window.getSelection(),b=this._hash(a),c=a.anchorNode?a.anchorNode.parentNode:null,d=this._latestSelection;if(!d||c!=d.node||d.hash!=b){this._latestSelection={node:c,hash:b};for(var e=[],f=this._getAncestor();f&&f!==this.element;)e.push(f),f=f.parentNode;this.path=e,this.controller.implSelectionChanged(),this._updateInlinePanel()}},_storeSelection:function(a){},_hash:function(a){return a.anchorOffset+":"+a.baseOffset+":"+a.extentOffset},removeFormat:function(){document.execCommand("removeFormat",null,null),this._selectionChanged()},setHTML:function(a){this.element.innerHTML=a},getHTML:function(){var a=hui.ui.MarkupEditor.util.clean(this.element);return a.innerHTML},getPath:function(){return this.path},destroy:function(){this._inlinePanel&&this._inlinePanel.destroy()}},hui.ui.MarkupEditor.MSIE={initialize:function(a){this.element=a.element,this.iframe=hui.build("iframe",{style:"display:block; width: 100%; border: 0;",parent:this.element}),hui.listen(this.iframe,"load",function(){this._load(),a.$ready()}.bind(this)),this.controller=a.controller},saveSelection:function(){this.savedRange=this.document.selection.createRange()},restoreSelection:function(a){window.setTimeout(function(){this.body.focus(),this.savedRange.select(),a&&a()}.bind(this))},_load:function(){this.document=hui.frame.getDocument(this.iframe),this.body=this.document.body,this.body.contentEditable=!0,hui.listen(this.body,"keyup",this._keyUp.bind(this)),hui.listen(this.body,"mouseup",this._mouseUp.bind(this))},_keyUp:function(){this.controller.implValueChanged(),this.saveSelection()},_mouseUp:function(){this.saveSelection()},focus:function(){this.body.focus(),this.controller.implFocused()},align:function(a){var b={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};this.document.execCommand(b[a],null,null)},format:function(a){"strong"==a.key||"em"==a.key?this._wrapInTag(a.key):"insert-table"==a.key?this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>"):this.document.execCommand(a.key,null,null)},removeFormat:function(){this.document.execCommand("removeFormat",null,null)},colorize:function(a){this.document.execCommand("forecolor",null,a),this.restoreSelection()},_wrapInTag:function(a){document.execCommand("inserthtml",null,"<"+a+">"+hui.string.escape(hui.selection.getText())+"</"+a+">")},_insertHTML:function(a){document.execCommand("inserthtml",null,a)},setHTML:function(a){this.body.innerHTML=a},getHTML:function(){var a=hui.ui.MarkupEditor.util.clean(this.body);return a.innerHTML},getPath:function(){return[]},destroy:function(){}},hui.ui.MarkupEditor.util={clean:function(a){var b=a.cloneNode(!0);this.replaceNodes(b,{b:"strong",i:"em",font:"span"});for(var c=hui.get.byClass(b,"Apple-style-span"),d=c.length-1;d>=0;d--)c[d].removeAttribute("class");return this.convertAttributesToStyle(b),b},replaceNodes:function(a,b){for(var c in b)for(var d=a.getElementsByTagName(c),e=d.length-1;e>=0;e--){var f=d[e],g=document.createElement(b[c]),h=d[e].getAttribute("color");h&&(g.style.color=h),hui.dom.replaceNode(f,g);for(var i=f.childNodes,j=0;j<i.length;j++){var k=f.removeChild(i[j]);g.appendChild(k)}}},convertAttributesToStyle:function(a){for(var b=a.getElementsByTagName("*"),c=0;c<b.length;c++){var d=b[c],e=d.getAttribute("align");e&&(d.style.textAlign=e,d.removeAttribute("align"))}}},hui.ui.ColorPicker=function(a){this.options=a||{},this.name=a.name,this.element=hui.get(a.element),this.color=null,this.buttons=[],this.preview=hui.get.firstByClass(this.element,"hui_colorpicker_preview"),this.pages=hui.get.byClass(this.element,"hui_colorpicker_page"),this.input=hui.get.firstByTag(this.element,"input"),this.wheel1=this.pages[0],this.wheel2=this.pages[1],this.wheel3=this.pages[2],this.swatches=this.pages[3],hui.ui.extend(this),a.listener&&this.listen(a.listener),this.addBehavior(),this.buildData()},hui.ui.ColorPicker.create=function(a){for(var b,c,d,e="",f=0;f<360;f+=30){for(d=.05;d<=1;d+=.15)b=hui.Color.hsv2rgb(f,d,1),c=hui.Color.rgb2hex(b),e+='<a style="background: rgb('+b[0]+","+b[1]+","+b[2]+')" rel="'+c+'"></a>';for(d=1;d>=.2;d-=.15)b=hui.Color.hsv2rgb(f,1,d),c=hui.Color.rgb2hex(b),e+='<a style="background: rgb('+b[0]+","+b[1]+","+b[2]+')" rel="'+c+'"></a>'}for(d=255;d>=0;d-=21.25)c=hui.Color.rgb2hex([d,d,d]),e+='<a style="background: rgb('+Math.round(d)+","+Math.round(d)+","+Math.round(d)+')" rel="'+c+'"></a>';return a=a||{},a.element=hui.build("div",{class:"hui_colorpicker",html:'<div class="hui_bar hui_bar_window_mini"><div class="hui_bar_body"><a class="hui_bar_button hui_bar_button_selected" href="javascript:void(0)" rel="0"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_pastels",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="1"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_brightness",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="2"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_saturated",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="3"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/swatches",16)+')"></span></a><input class="hui_colorpicker"/></div></div><div class="hui_colorpicker_pages"><div class="hui_colorpicker_page hui_colorpicker_wheel1"></div><div class="hui_colorpicker_page hui_colorpicker_wheel2"></div><div class="hui_colorpicker_page hui_colorpicker_wheel3"></div><div class="hui_colorpicker_page hui_colorpicker_swatches">'+e+'</div></div><div class="hui_colorpicker_preview"></div>'}),new hui.ui.ColorPicker(a)},hui.ui.ColorPicker.prototype={addBehavior:function(){for(var a=hui.get.byClass(this.element,"hui_bar_button"),b=0;b<a.length;b++){var c=new hui.ui.Bar.Button({element:a[b]});c.listen(this),this.buttons.push(c)}hui.listen(this.element,"click",this._click.bind(this)),hui.listen(this.wheel1,"mousemove",this._hoverWheel1.bind(this)),hui.listen(this.wheel1,"click",this._pickColor.bind(this)),hui.listen(this.wheel2,"mousemove",this._hoverWheel2.bind(this)),hui.listen(this.wheel2,"click",this._pickColor.bind(this)),hui.listen(this.wheel3,"mousemove",this._hoverWheel3.bind(this)),hui.listen(this.wheel3,"click",this._pickColor.bind(this)),hui.listen(this.element,"mousedown",function(a){hui.stop(a)}),hui.listen(this.swatches,"mousemove",function(a){a=hui.event(a),this._hoverColor(a.element.getAttribute("rel"))}.bind(this)),hui.listen(this.swatches,"click",this._pickColor.bind(this))},$click:function(a){var b,c=parseInt(a.element.getAttribute("rel"));for(b=this.pages.length-1;b>=0;b--)this.pages[b].style.display=b==c?"block":"none";for(b=0;b<this.buttons.length;b++)this.buttons[b].setSelected(this.buttons[b]==a)},_click:function(a){a=hui.event(a),a.stop();var b=a.findByTag("input");b&&b.focus()},_pickColor:function(a){hui.stop(a),this.fire("colorWasSelected",this.color)},_hoverColor:function(a){this.preview.style.background=a,this.color=a,this.fire("colorWasHovered",this.color),this.input.value=a},buildData:function(){var a=new Array;a[0]=new Array(0,1,0),a[1]=new Array(-1,0,0),a[2]=new Array(0,0,1),a[3]=new Array(0,-1,0),a[4]=new Array(1,0,0),a[5]=new Array(0,0,-1),a[6]=new Array(255,1,1);for(var b=new Array(360),c=0;c<6;c++)for(var d=0;d<60;d++){b[60*c+d]=new Array(3);for(var e=0;e<3;e++)b[60*c+d][e]=a[6][e],a[6][e]+=4*a[c][e]}this.colorArray=b},_hoverWheel1:function(a){a=hui.event(a);var b=hui.position.get(this.wheel1),c=4*(a.getLeft()-b.left),d=4*(a.getTop()-b.top),e=c-512,f=d-512,g=e<0?0:1,h=f<0?0:1,i=2*h+g,j=new Array(-180,360,180,0),k=Math.abs(e),l=Math.abs(f),m=45*l/k;l>k&&(m=90-45*k/l);var n=Math.floor(Math.abs(j[i]-m));e=Math.abs(c-512),f=Math.abs(d-512);var o=Math.sqrt(e*e+f*f);if(512==c&512==d)var p="000000";else{for(var q=0,r=0;r<3;r++){var s=this.colorArray[n][r]*o/256;o>256&&(s+=Math.floor(o-256)),s>255&&(s=255),q=256*q+Math.floor(s)}p=q.toString(16)}for(;p.length<6;)p="0"+p;this._hoverColor("#"+p)},_hoverWheel2:function(a){var b,c,d;a=hui.event(a);var e=hui.position.get(this.wheel2),f=a.getLeft()-e.left,g=a.getTop()-e.top;if(!(g>256)){var h=f-128,i=128-g,j=h*h,k=i*i,l=Math.sqrt(j+k),m=l/128;if(0==l)c=0,d=0,b=new Array(0,0,0);else{var n=Math.acos(h/l),o=i>=0?n:2*Math.PI-n,p=360*o/(2*Math.PI);m>1?(b=new Array(255,255,255),c=1,d=1):m>=.5?(c=1-2*(m-.5),d=1,b=hui.Color.hsv2rgb(p,c,d)):(c=1,d=2*m,b=hui.Color.hsv2rgb(p,c,d))}this._hoverColor(hui.Color.rgb2hex(b))}},_hoverWheel3:function(a){var b,c,d;a=hui.event(a);var e=hui.position.get(this.wheel3),f=a.getLeft()-e.left,g=a.getTop()-e.top;if(!(g>256)){var h=f-128,i=128-g,j=h*h,k=i*i,l=Math.sqrt(j+k),m=l/128;if(0==l)c=0,d=0,b=new Array(0,0,0);else{var n=Math.acos(h/l),o=i>=0?n:2*Math.PI-n,p=360*o/(2*Math.PI);m>1?(b=new Array(255,255,255),c=1,d=1):(c=m,d=1,b=hui.Color.hsv2rgb(p,c,d))}this._hoverColor(hui.Color.rgb2hex(b))}}},hui.ui.LocationInput=function(a){this.options=hui.override({value:null},a),this.name=a.name,this.element=hui.get(a.element),this.chooser=hui.get.firstByTag(this.element,"a"),this.latField=new hui.ui.Input({element:hui.get.firstByTag(this.element,"input"),validator:new hui.ui.NumberValidator({min:-90,max:90,allowNull:!0})}),this.latField.listen(this),this.lngField=new hui.ui.Input({element:this.element.getElementsByTagName("input")[1],validator:new hui.ui.NumberValidator({min:-180,max:180,allowNull:!0})}),this.lngField.listen(this),this.value=this.options.value,hui.ui.extend(this),this.setValue(this.value),this._addBehavior()},hui.ui.LocationInput.create=function(a){return a=a||{},a.element=hui.build("span",{class:"hui_locationinput",html:'<span class="hui_locationinput_latitude"><span><input autocomplete="off"></span></span><span class="hui_locationinput_longitude"><span><input autocomplete="off"></span></span><a class="hui_locationinput_picker" href="javascript://"></a>'}),new hui.ui.LocationInput(a)},hui.ui.LocationInput.prototype={_addBehavior:function(){hui.listen(this.chooser,"click",this._showPicker.bind(this)),hui.ui.addFocusClass({element:this.latField.element,classElement:this.element,class:"hui_locationinput-focused"}),hui.ui.addFocusClass({element:this.lngField.element,classElement:this.element,class:"hui_locationinput-focused"})},getLabel:function(){return this.options.label},reset:function(){this.setValue()},getValue:function(){return this.value},setValue:function(a){a?(this.latField.setValue(a.latitude),this.lngField.setValue(a.longitude),this.value=a):(this.latField.setValue(),this.lngField.setValue(),this.value=null),this._updatePicker()},_updatePicker:function(){this.picker&&this.picker.setLocation(this.value)},_showPicker:function(){this.picker||(this.picker=new hui.ui.LocationPicker,this.picker.listen(this)),this.picker.show({node:this.chooser,location:this.value})},$locationChanged:function(a){this.setValue(a),this.fire("valueChanged",this.value),hui.ui.callAncestors(this,"childValueChanged",this.value)},$valueChanged:function(){var a=this.latField.getValue(),b=this.lngField.getValue();null===a||null===b?this.value=null:this.value={latitude:a,longitude:b},this._updatePicker(),this.fire("valueChanged",this.value),hui.ui.callAncestors(this,"childValueChanged",this.value)}},hui.ui.StyleLength=function(a){this.options=hui.override({value:null,min:0,max:1e3,units:["px","pt","em","%"],initialValue:null,defaultUnit:"px",allowNull:!1},a),this.name=a.name;var b=this.element=hui.get(a.element);this.input=hui.get.firstByTag(b,"input");var c=b.getElementsByTagName("a");this.up=c[0],this.down=c[1],this.value=this.parseValue(this.options.value),hui.ui.extend(this),this._addBehavior()},hui.ui.StyleLength.create=function(a){return a.element=hui.build("span",{class:"hui_style_length hui_numberinput",html:'<input class="hui_textinput" type="text"/><a class="hui_numberinput_up"></a><a class="hui_numberinput_down"></a>'}),new hui.ui.StyleLength(a)},hui.ui.StyleLength.prototype={_addBehavior:function(){this.element;hui.listen(this.input,"blur",this._onBlur.bind(this)),hui.listen(this.input,"keyup",this.keyEvent.bind(this)),hui.listen(this.up,"mousedown",this._upEvent.bind(this)),hui.listen(this.down,"mousedown",this._downEvent.bind(this))},parseValue:function(a){if(null===a||void 0===a)return null;var b=parseFloat(a,10);if(isNaN(b))return null;for(var c={number:b,unit:this.options.defaultUnit},d=0;d<this.options.units.length;d++){var e=this.options.units[d];if(a.indexOf(e)!=-1){c.unit=e;break}}return c.number=Math.max(this.options.min,Math.min(this.options.max,c.number)),c},_onBlur:function(){this._updateInput()},keyEvent:function(a){a=a||window.event,a.keyCode==hui.KEY_UP?(hui.stop(a),this._upEvent()):a.keyCode==hui.KEY_DOWN?this._downEvent():this._checkAndSetValue(this.parseValue(this.input.value))},_updateInput:function(){this.input.value=this.getValue()},_checkAndSetValue:function(a){var b=this.value,c=!1;null===b&&null===a||null!=b&&null!=a&&b.number===a.number&&b.unit===a.unit||(c=!0),this.value=a,c&&(hui.ui.callAncestors(this,"childValueChanged",this.input.value),this.fire("valueChanged",this.getValue()))},_setInitialValue:function(){!this.value&&this.options.initialValue&&this.setValue(this.options.initialValue)},_downEvent:function(){this._setInitialValue(),this.value?this._checkAndSetValue({number:Math.max(this.options.min,this.value.number-1),unit:this.value.unit}):this._checkAndSetValue({number:this.options.min,unit:this.options.defaultUnit}),this._updateInput()},_upEvent:function(){this._setInitialValue(),this.value?this._checkAndSetValue({number:Math.min(this.options.max,this.value.number+1),unit:this.value.unit}):this._checkAndSetValue({number:this.options.min+1,unit:this.options.defaultUnit}),this._updateInput()},setInitialValue:function(a){this.options.initialValue=a},getValue:function(){return this.value?this.value.number+this.value.unit:""},setValue:function(a){this.value=this.parseValue(a),this._updateInput()},focus:function(){try{this.input.focus()}catch(a){}},reset:function(){this.setValue("")}},hui.ui.DateTimeField=function(a){this.inputFormats=["d-m-Y","d/m-Y","d/m/Y","d-m-Y H:i:s","d/m-Y H:i:s","d/m/Y H:i:s","d-m-Y H:i","d/m-Y H:i","d/m/Y H:i","d-m-Y H","d/m-Y H","d/m/Y H","d-m","d/m","d","Y","m-d-Y","m-d","m/d"],this.outputFormat="d-m-Y H:i:s",this.name=a.name,this.element=hui.get(a.element),this.input=hui.get.firstByTag(this.element,"input"),this.options=hui.override({returnType:null,label:null,allowNull:!0,value:null},a),this.value=this.options.value,hui.ui.extend(this),this._addBehavior(),this._updateUI()},hui.ui.DateTimeField.create=function(a){a=a||{};var b=hui.build("span",{class:"hui_datetime"});return hui.build("input",{class:"hui_textinput",parent:b}),hui.build("a",{class:"hui_datetime_selector",href:"javascript://",tabIndex:"-1",parent:b}),a.element=b,new hui.ui.DateTimeField(a)},hui.ui.DateTimeField.prototype={_addBehavior:function(){hui.listen(this.input,"blur",this._onBlur.bind(this)),hui.listen(this.input,"keyup",this._parse.bind(this)),hui.listen(this.input,"focus",this._onFocus.bind(this));var a=hui.get.firstByTag(this.element,"a");hui.listen(a,"mousedown",hui.stop),hui.listen(a,"click",this._onClickIcon.bind(this))},_onClickIcon:function(a){hui.stop(a),this.input.focus(),this._showPicker()},focus:function(){try{this.input.focus()}catch(a){}},reset:function(){this.setValue("")},setValue:function(a){a?a.constructor==Date?this.value=a:(this.value=new Date,this.value.setTime(1e3*parseInt(a))):this.value=null,this._updateUI()},_parse:function(){for(var a=this.value?this.value.getTime():0,b=this.input.value,c=null,d=0;d<this.inputFormats.length&&null==c;d++)c=Date.parseDate(b,this.inputFormats[d]);(this.options.allowNull||null!=c)&&(this.value=c),this.datePicker&&this.datePicker.setValue(this.value);var e=this.value?this.value.getTime():0;a!=e&&(hui.ui.callAncestors(this,"childValueChanged",this.value),this.fire("valueChanged",this.value))},_check:function(){this._parse(),this._updateUI()},getValue:function(){return null!=this.value&&"seconds"==this.options.returnType?Math.round(this.value.getTime()/1e3):this.value},getElement:function(){return this.element},getLabel:function(){return this.options.label},_updateUI:function(){this.value?this.input.value=this.value.dateFormat(this.outputFormat):this.input.value=""},_onBlur:function(){this._check(),this.panel&&this.panel.hide(),this.datePickerPanel&&this.datePickerPanel.hide()},_onFocus:function(){this._showPanel()},_showPanel:function(){if(!this.panel){this.panel=hui.ui.BoundPanel.create({variant:"light"});var a=hui.ui.Buttons.create({align:"center"});a.add(hui.ui.Button.create({text:"Idag",small:!0,variant:"light",listener:{$click:this.goToday.bind(this)}})),a.add(hui.ui.Button.create({text:"+ dag",small:!0,variant:"light",listener:{$click:function(){this.addDays(1)}.bind(this)}})),a.add(hui.ui.Button.create({text:"+ uge",small:!0,variant:"light",listener:{$click:function(){this.addDays(7)}.bind(this)}})),a.add(hui.ui.Button.create({text:"12:00",small:!0,variant:"light",listener:{$click:function(){this.setHour(12)}.bind(this)}})),a.add(hui.ui.Button.create({text:"00:00",small:!0,variant:"light",listener:{$click:function(){this.setHour(0)}.bind(this)}})),this.panel.add(a)}this.panel.position({element:this.element,position:"vertical"}),this.panel.show()},goToday:function(){var a=this._getValueOrNowCopy(),b=new Date;a.setDate(b.getDate()),a.setMonth(b.getMonth()),a.setFullYear(b.getFullYear()),this.setValue(a)},addDays:function(a){var b=this._getValueOrNowCopy();b.setDate(b.getDate()+a),this.setValue(b)},setHour:function(a){var b=this._getValueOrNowCopy();b.setMilliseconds(0),b.setSeconds(0),b.setMinutes(0),b.setHours(a),this.setValue(b)},_getValueOrNowCopy:function(){return null==this.value?new Date:new Date(this.value.getTime())},_showPicker:function(){this.panel&&this.panel.hide(),this.datePickerPanel||(this.datePickerPanel=hui.ui.BoundPanel.create({variant:"light"}),this.datePicker=hui.ui.DatePicker.create({value:this.value}),this.datePicker.listen({$dateChanged:function(a){this.setValue(a)}.bind(this)}),this.datePickerPanel.add(this.datePicker)),this.datePicker.setValue(this.value),this.datePickerPanel.position(this.element),this.datePickerPanel.show()},$$parentMoved:function(){this.datePickerPanel&&this.datePickerPanel.isVisible()&&(this.datePickerPanel.position(this.element),this.datePickerPanel.show()),this.panel&&this.panel.isVisible()&&(this.panel.position({element:this.element,position:"vertical"}),this.panel.show())},$visibilityChanged:function(){this.datePickerPanel&&this.datePickerPanel.hide(),this.panel&&this.panel.hide()}},hui.ui.TokenField=function(a){this.options=hui.override({label:null,key:null},a),this.element=hui.get(a.element),this.name=a.name,this.value=[""],hui.ui.extend(this),this._updateUI()},hui.ui.TokenField.create=function(a){return a=a||{},a.element=hui.build("div",{class:"hui_tokenfield"}),new hui.ui.TokenField(a)},hui.ui.TokenField.prototype={setValue:function(a){this.value=a||[],this.value.push(""),this._updateUI()},reset:function(){this.value=[""],this._updateUI()},getValue:function(){var a=[];return hui.each(this.value,function(b){b=hui.string.trim(b),b.length>0&&a.push(b)}),a},getLabel:function(){return this.options.label},_updateUI:function(){this.element.innerHTML="",hui.each(this.value,function(a,b){var c=hui.build("input",{class:"hui_textinput",parent:this.element,style:{width:"50px"}});this.options.width&&(c.style.width=this.options.width+"px"),c.value=a,hui.listen(c,"keyup",function(){this._inputChanged(c,b)}.bind(this))}.bind(this))},_inputChanged:function(a,b){b==this.value.length-1&&a.value!=this.value[b]&&this._addField(),this.value[b]=a.value,hui.animate({node:a,css:{width:Math.min(Math.max(7*a.value.length+3,50),150)+"px"},duration:200})},$visibilityChanged:function(){hui.dom.isVisible(this.element)&&this.$$layout()},$$layout:function(){for(var a=hui.findAll("input",this.element),b=0;b<a.length;b++)a[b].style.width=Math.min(Math.max(7*a[b].value.length+3,50),150)+"px"},_addField:function(){var a=hui.build("input",{class:"hui_textinput",style:{width:"50px"}});this.options.width&&(a.style.width=this.options.width+"px");var b=this.value.length;this.value.push(""),this.element.appendChild(a);var c=this;hui.listen(a,"keyup",function(){c._inputChanged(a,b)})}},hui.ui.Checkbox=function(a){this.element=hui.get(a.element),this.control=hui.get.firstByTag(this.element,"span"),this.options=a,this.name=a.name,this.value="true"===a.value||a.value===!0,hui.ui.extend(this),this.addBehavior()},hui.ui.Checkbox.create=function(a){var b=a.element=hui.build("a",{class:"hui_checkbox",href:"javascript://",html:"<span><span></span></span>"});return a.value&&hui.cls.add(b,"hui_checkbox_selected"),new hui.ui.Checkbox(a)},hui.ui.Checkbox.prototype={addBehavior:function(){hui.ui.addFocusClass({element:this.element,class:"hui_checkbox_focused"}),hui.listen(this.element,"click",this.click.bind(this))},click:function(a){hui.stop(a),this.element.focus(),this.value=!this.value,this.updateUI(),hui.ui.callAncestors(this,"childValueChanged",this.value),this.fire("valueChanged",this.value),hui.ui.firePropertyChange(this,"value",this.value)},updateUI:function(){hui.cls.set(this.element,"hui_checkbox_selected",this.value)},setValue:function(a){this.value=a===!0||"true"===a,this.updateUI()},getValue:function(){return this.value},reset:function(){this.setValue(!1)},getLabel:function(){return this.options.label}},hui.ui.Checkboxes=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,this.items=a.items||[],this.subItems=[],this.values=a.values||a.value||[],hui.ui.extend(this),this._addBehavior(),this._updateUI(),a.url&&new hui.ui.Source({url:a.url,delegate:this})},hui.ui.Checkboxes.create=function(a){return a.element=hui.build("div",{class:a.vertical?"hui_checkboxes hui_checkboxes_vertical":"hui_checkboxes"}),a.items&&hui.each(a.items,function(b){var c=hui.build("a",{class:"hui_checkbox",href:"javascript:void(0);",html:'<span class="hui_checkbox_button"></span><span class="hui_checkbox_label">'+hui.string.escape(b.title)+"</span>"});hui.ui.addFocusClass({element:c,class:"hui_checkbox_focused"}),a.element.appendChild(c)}),new hui.ui.Checkboxes(a)},hui.ui.Checkboxes.prototype={_addBehavior:function(){var a=hui.get.byClass(this.element,"hui_checkbox");hui.each(a,function(a,b){hui.ui.addFocusClass({element:a,class:"hui_checkbox_focused"}),hui.listen(a,"click",function(a){hui.stop(a),this.flipValue(this.items[b].value)}.bind(this))}.bind(this))},getValue:function(){return this.values},_checkValues:function(){for(var a=[],b=0;b<this.values.length;b++){var c,d=this.values[b],e=!1;for(c=0;c<this.items.length;c++)e=e||this.items[c].value===d;for(c=0;c<this.subItems.length;c++)e=e||this.subItems[c]._hasValue(d);e&&a.push(d)}this.values=a},setValue:function(a){this.values=a,this._checkValues(),this._updateUI()},flipValue:function(a){hui.array.flip(this.values,a),this._checkValues(),this._updateUI(),this.fire("valueChanged",this.values),hui.ui.callAncestors(this,"childValueChanged",this.values)},_updateUI:function(){var a,b,c;for(a=0;a<this.subItems.length;a++)this.subItems[a]._updateUI();var d=hui.get.byClass(this.element,"hui_checkbox");for(a=0;a<this.items.length;a++)b=this.items[a],c=hui.array.contains(this.values,b.value),hui.cls.set(d[a],"hui_checkbox_selected",c)},refresh:function(){for(var a=0;a<this.subItems.length;a++)this.subItems[a].refresh()},reset:function(){this.setValues([])},getLabel:function(){return this.options.label},setValues:function(a){this.setValue(a)},getValues:function(){return this.values},registerItem:function(a){parseInt(a.value)==a.value&&(a.value=parseInt(a.value)),this.items.push(a)},registerItems:function(a){a.parent=this,this.subItems.push(a)},$optionsLoaded:function(a){hui.each(a,function(a){var b=hui.build("a",{class:"hui_checkbox",href:"javascript:void(0);",html:'<span class="hui_checkbox_button"></span><span class="hui_checkbox_label">'+hui.string.escape(a.title)+"</span>"});hui.listen(b,"click",function(b){hui.stop(b),this.flipValue(a.value)}.bind(this)),hui.ui.addFocusClass({element:b,class:"hui_checkbox_focused"}),this.element.appendChild(b),this.items.push(a)}.bind(this)),this._checkValues(),this._updateUI();
}},hui.ui.Checkboxes.Items=function(a){this.element=hui.get(a.element),this.name=a.name,this.parent=null,this.options=a,this.checkboxes=[],hui.ui.extend(this),this.options.source&&this.options.source.listen(this)},hui.ui.Checkboxes.Items.prototype={refresh:function(){this.options.source&&this.options.source.refresh()},$optionsLoaded:function(a){this.checkboxes=[],this.element.innerHTML="";var b=this;hui.each(a,function(a){var c={text:a.title||a.text,value:hui.intOrString(a.value)},d=c.element=hui.build("a",{class:"hui_checkbox",href:"javascript://",html:'<span class="hui_checkbox_button"></span><span class="hui_checkbox_label">'+hui.string.escape(c.text)+"</span>"});hui.listen(d,"click",function(a){hui.stop(a),d.focus(),b._onItemClick(c)}),hui.ui.addFocusClass({element:d,class:"hui_checkbox_focused"}),b.element.appendChild(d),b.checkboxes.push(c)}),this.parent._checkValues(),this._updateUI()},_onItemClick:function(a){this.parent.flipValue(a.value)},_updateUI:function(){for(var a=0;a<this.checkboxes.length;a++){var b=this.checkboxes[a],c=hui.array.indexOf(this.parent.values,b.value);hui.cls.set(b.element,"hui_checkbox_selected",c!=-1)}},_hasValue:function(a){for(var b=0;b<this.checkboxes.length;b++)if(this.checkboxes[b].value==a)return!0;return!1}},hui.ui.Radiobuttons=function(a){this.options=a,this.element=hui.get(a.element),this.name=a.name,this.radios=[],this.value=a.value,this.defaultValue=this.value,this.enabled=!0,hui.ui.extend(this)},hui.ui.Radiobuttons.prototype={updateUI:function(){for(var a=0;a<this.radios.length;a++){var b=this.radios[a];hui.cls.set(hui.get(b.id),"hui_radiobutton_selected",b.value==this.value)}},setValue:function(a){this.value=a,this.updateUI()},getValue:function(){return this.enabled?this.value:null},reset:function(){this.setValue(this.defaultValue)},setEnabled:function(a){this.enabled=1==a,hui.cls.set(this.element,"hui_radiobuttons_disabled",!this.enabled)},registerRadiobutton:function(a){this.radios.push(a);var b=hui.get(a.id),c=this;b.onclick=function(){c.enabled&&(c.setValue(a.value),c.fire("valueChanged",a.value),hui.ui.callAncestors(c,"childValueChanged",a.value))}}},hui.ui.NumberField=function(a){this.options=hui.override({min:0,max:void 0,value:null,tickSize:1,decimals:0,allowNull:!1},a),this.name=a.name;var b=this.element=hui.get(a.element);this.input=hui.get.firstByTag(b,"input"),this.up=hui.get.firstByClass(b,"hui_numberinput_up"),this.down=hui.get.firstByClass(b,"hui_numberinput_down"),hui.isString(this.options.value)?this.value=parseInt(this.options.value,10):this.value=this.options.value,isNaN(this.value)&&(this.value=null),hui.ui.extend(this),this._addBehavior()},hui.ui.NumberField.create=function(a){return a.element=hui.build("span",{class:"hui_numberinput",html:'<input class="hui_textinput" type="text" value="'+(void 0!==a.value?a.value:"0")+'"/><a class="hui_numberinput_up"></a><a class="hui_numberinput_down"></a>'}),new hui.ui.NumberField(a)},hui.ui.NumberField.prototype={_addBehavior:function(){this.element;hui.listen(this.input,"focus",this._onFocus.bind(this)),hui.listen(this.input,"blur",this._onBlur.bind(this)),hui.listen(this.input,"keyup",this._onKey.bind(this)),hui.listen(this.up,"mousedown",this.upEvent.bind(this)),hui.listen(this.down,"mousedown",this.downEvent.bind(this))},_onBlur:function(){this._updateField(),this.sliderPanel&&this.sliderPanel.hide()},_onFocus:function(){this._showSlider(),this._updateSlider()},_onKey:function(a){if(a=a||window.event,a.keyCode==hui.KEY_UP)hui.stop(a),this.upEvent();else if(a.keyCode==hui.KEY_DOWN)this.downEvent();else{var b=parseFloat(this.input.value,10);isNaN(b)?this._setLocalValue(null,!0):this._setLocalValue(b,!0)}},downEvent:function(a){hui.stop(a),null===this.value?this._setLocalValue(this.options.min,!0):this._setLocalValue(this.value-this.options.tickSize,!0),this._updateField()},upEvent:function(a){hui.stop(a),this._setLocalValue(this.value+this.options.tickSize,!0),this._updateField()},focus:function(){try{this.input.focus()}catch(a){}},getValue:function(){return this.value},getLabel:function(){return this.options.label},setValue:function(a){null===a||void 0===a?this._setLocalValue(null,!1):(a=parseFloat(a,10),isNaN(a)||this._setLocalValue(a,!1)),this._updateField()},_updateField:function(){this.input.value=null===this.value||void 0===this.value?"":this.value},_setLocalValue:function(a,b){var c=this.value;null===a||void 0===a&&this.options.allowNull?this.value=null:(a=this._getValueWithinRange(a),this.value=this._round(a)),b&&c!==this.value&&this.fireValueChange(),this._updateSlider()},_round:function(a){if(void 0!==this.options.decimals){var b=Math.pow(10,this.options.decimals);a=Math.round(a*b)/b}return a},reset:function(){this.options.allowNull?this.value=null:this.value=this._getValueWithinRange(0),this._updateField()},_getValueWithinRange:function(a){return hui.isDefined(this.options.min)&&(a=Math.max(a,this.options.min)),hui.isDefined(this.options.max)&&(a=Math.min(a,this.options.max)),a},_onSliderChange:function(a){var b=this.options.min+(this.options.max-this.options.min)*a;this._setLocalValue(b,!0),this._updateField()},_showSlider:function(){void 0!==this.options.min&&void 0!==this.options.max&&(this.sliderPanel||(this.sliderPanel=hui.ui.BoundPanel.create({variant:"light"}),this.slider=hui.ui.Slider.create({width:200}),this.slider.element.style.margin="0 3px",this.slider.listen({$valueChanged:this._onSliderChange.bind(this)}),this.sliderPanel.add(this.slider)),this.sliderPanel.position({element:this.element,position:"vertical"}),this.sliderPanel.show())},_updateSlider:function(){this.slider&&this.slider.setValue((this.value-this.options.min)/(this.options.max-this.options.min))},$$parentMoved:function(){this.sliderPanel&&this.sliderPanel.isVisible()&&(this.sliderPanel.position({element:this.element,position:"vertical"}),this.sliderPanel.show())}},hui.ui.TextField=function(a){this.options=hui.override({label:null,key:null,lines:1,maxHeight:100,animateUserChange:!0},a),this.element=hui.get(a.element),this.name=a.name,hui.ui.extend(this),this.input=this.element,this.multiline="textarea"==this.input.tagName.toLowerCase(),this.placeholder=hui.get.firstByClass(this.element,"hui_field_placeholder"),this.value=this.input.value,this.modified=!1,this._attach()},hui.ui.TextInput=hui.ui.TextField,hui.ui.TextField.create=function(a){a=hui.override({lines:1},a);var b;return a.lines>1||a.multiline?b=hui.build("textarea",{class:"hui_textinput",rows:a.lines}):(b=hui.build("input",{class:"hui_textinput"}),a.secret&&b.setAttribute("type","password")),void 0!==a.value&&(b.value=a.value),a.element=b,new hui.ui.TextField(a)},hui.ui.TextField.prototype={_attach:function(){if(this.placeholder||"password"==this.input.type){var a=this;hui.ui.onReady(function(){window.setTimeout(function(){a.value=a.input.value,console.log(a.value),a._updateClass()},500)})}hui.ui.addFocusClass({element:this.input,classElement:this.element,class:"hui_field_focused",widget:this}),hui.listen(this.input,"keyup",this._onKeyUp.bind(this)),hui.listen(this.input,"keydown",this._onKeyDown.bind(this)),hui.listen(this.input,"change",this._onChange.bind(this));var b=this.element.getElementsByTagName("em")[0];b&&(this._updateClass(),hui.listen(b,"mousedown",function(){window.setTimeout(function(){this.input.focus(),this.input.select()}.bind(this))}.bind(this)),hui.listen(b,"mouseup",function(){this.input.focus(),this.input.select()}.bind(this)))},_updateClass:function(){hui.cls.set(this.element,"hui_field_dirty",this.value.length>0)},_onKeyDown:function(a){if(!this.multiline&&a.keyCode===hui.KEY_RETURN){hui.stop(a),this.fire("submit");var b=hui.ui.getAncestor(this,"hui_formula");return void(b&&b.submit())}},_onChange:function(a){this._onKeyUp(a)},_onKeyUp:function(a){this.input.value!=this.value&&(this.value=this.input.value,this._updateClass(),this._expand(this.options.animateUserChange),hui.ui.callAncestors(this,"childValueChanged",this.input.value),this.fire("valueChanged",this.input.value),this.modified=!0)},focus:function(){try{this.input.focus()}catch(a){}},select:function(){try{this.input.focus(),this.input.select()}catch(a){}},reset:function(){this.setValue("")},isModified:function(){return this.modified},stress:function(){hui.ui.stress(this)},setValue:function(a){void 0!==a&&null!==a||(a=""),this.value=a,this.input.value=a,this._expand(this.options.animateValueChange),this.modified=!1},getValue:function(){return this.input.value},getLabel:function(){return this.options.label},isEmpty:function(){return""==this.input.value},isBlank:function(){return hui.isBlank(this.input.value)},setError:function(a){var b=!!a;hui.cls.set(this.element,"hui_field_error",b),"string"==typeof a&&hui.ui.showToolTip({text:a,element:this.element,key:this.name}),b||hui.ui.hideToolTip({key:this.name})},$visibilityChanged:function(){hui.dom.isVisible(this.element)&&window.setTimeout(this._expand.bind(this))},_expand:function(a){if(this.multiline&&hui.dom.isVisible(this.element)){var b=this._getTextAreaHeight(this.input);b=Math.max(38,b),b=Math.min(b,this.options.maxHeight),a?hui.animate({node:this.input,duration:300,css:{height:b+"px"},ease:hui.ease.slowFastSlow}):this.input.style.height=b+"px"}},_getTextAreaHeight:function(a){var b=this.textAreaDummy;b||(b=this.textAreaDummy=document.createElement("div"),b.className="hui_textarea_dummy",document.body.appendChild(b));var c=a.value;return"\n"===c[c.length-1]&&(c+="x"),c=hui.string.escape(c).replace(/\n/g,"<br/>"),b.innerHTML=c,b.style.width=a.clientWidth+"px",b.clientHeight}},hui.ui.Rendering=function(a){this.options=hui.override({clickObjects:!1},a),this.element=hui.get(a.element),this.name=a.name,hui.ui.extend(this)},hui.ui.Rendering.prototype={_click:function(a){a=hui.event(a)},setContent:function(a){this.element.innerHTML=a}},hui.ui.Icon=function(a){this.options=a,this.name=a.name,this.icon=this.options.icon,this.size=this.options.size,this.element=hui.get(a.element),hui.ui.extend(this),this._addBehavior()},hui.ui.Icon.prototype={_addBehavior:function(){hui.listen(this.element,"click",function(){this.fire("click")}.bind(this))},setSize:function(a){this.size=a,this.element.className="hui_icon_labeled hui_icon_labeled_"+this.size;var b=hui.get.firstByTag(this.element,"span");b.className="hui_icon_"+this.size,b.style.backgroundImage="url("+hui.ui.getIconUrl(this.options.icon,this.size)+")"}},hui.ui.ColorInput=function(a){this.options=hui.override({value:null},a),this.name=a.name,this.element=hui.get(a.element),this.button=hui.get.firstByTag(this.element,"a"),this.input=new hui.ui.Input({element:hui.get.firstByTag(this.element,"input"),validator:{validate:function(a){return a=hui.isBlank(a)?"":new hui.Color(a).toHex(),{valid:!0,value:a}}}}),this.input.listen({$valueChanged:this._onInputChange.bind(this)}),this.value=null,hui.ui.extend(this),this.setValue(this.options.value),this._addBehavior()},hui.ui.ColorInput.create=function(a){a=a||{};a.element=hui.build("span",{class:"hui_colorinput",html:'<input class="hui_textinput" type="text" value=""/><a tabindex="-1" class="hui_colorinput_color" href="javascript://"></a>'});return new hui.ui.ColorInput(a)},hui.ui.ColorInput.prototype={_addBehavior:function(){hui.listen(this.button,"click",this._onButtonClick.bind(this))},_syncInput:function(){this.input.setValue(this.value)},_syncColorButton:function(){this.button.innerHTML=this.value?"":"?",this.button.style.backgroundColor=this.value?this.value:""},_onInputChange:function(a){var b=a!=this.value;this.value=a,this._syncColorButton(),b&&this._fireChange()},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value),this.fire("valueChanged",this.value)},_onBlur:function(){hui.Color.parse(this.value)},_onButtonClick:function(){return hui.window.getViewHeight()<200?void this.fire("clickPicker",this.value):(this.panel||(this.panel=hui.ui.BoundPanel.create({modal:!0}),this.picker=hui.ui.ColorPicker.create(),this.picker.listen(this),this.panel.add(this.picker)),this.panel.position(this.button),void this.panel.show())},$colorWasSelected:function(a){this.panel.hide(),this.setValue(a),this._fireChange()},getValue:function(){return this.value},setValue:function(a){this.value=hui.isBlank(a)?a:new hui.Color(a).toHex(),this._syncInput(),this._syncColorButton()},focus:function(){try{this.input.focus()}catch(a){}},reset:function(){this.setValue("")},destroy:function(){hui.dom.remove(this.element),this.panel&&this.panel.destroy()}},hui.ui.Columns=function(a){this.name=a.name,this.options=a||{},this.element=hui.get(a.element),this.body=hui.get.firstByTag(this.element,"tr"),hui.ui.extend(this)},hui.ui.Columns.create=function(a){return a=a||{},a.flexible=!0,a.element=hui.build("table",{class:"hui_columns",html:"<tbody><tr></tr></tbody>"}),new hui.ui.Columns(a)},hui.ui.Columns.prototype={$$layout:function(){if(!this.options.flexible){this.element.style.height=hui.position.getRemainingHeight(this.element)+"px";for(var a=hui.get.children(this.element),b=0,c=0;c<a.length;c++){var d=a[c],e=this.element.clientWidth/a.length;d.style.width=e+"px",d.style.position="absolute",d.style.marginLeft=b+"px",d.style.height=this.element.clientHeight+"px",b+=e}}},addToColumn:function(a,b){var c=this._ensureColumn(a);c.appendChild(b.getElement())},setColumnStyle:function(a,b){var c=this._ensureColumn(a);hui.style.set(c,b)},setColumnWidth:function(a,b){var c=this._ensureColumn(a);c.style.width=b+"px"},_ensureColumn:function(a){for(var b=hui.get.children(this.body),c=b.length-1;c<a;c++)this.body.appendChild(hui.build("td",{class:"hui_columns_column"}));return hui.get.children(this.body)[a]}},hui.ui.Finder=function(a){this.options=hui.override({title:"Finder",selection:{},list:{}},a),this.name=a.name,this.uploader=null,hui.ui.extend(this),a.listener&&this.listen(a.listener)},hui.ui.Finder.create=function(a){return new hui.ui.Finder(a)},hui.ui.Finder.prototype={show:function(){this.window?this.list&&this.list.refresh():this._build(),this.window.show()},hide:function(){this.window&&this.window.hide()},clear:function(){this.list.clearSelection()},_build:function(){var a=this.window=hui.ui.Window.create({title:this.options.title,icon:"common/search",width:600,height:400});return a.listen({$userClosedWindow:function(){this.fire("cancel")}.bind(this)}),this.options.url?(a.setBusy(!0),void hui.ui.request({url:this.options.url,$object:function(b){hui.override(this.options,b),b.title&&a.setTitle(b.title),a.setBusy(!1),this._buildBody()}.bind(this)})):void this._buildBody()},_buildBody:function(){var a=this.options,b=hui.ui.Structure.create();this.window.add(b);var c=hui.ui.Overflow.create({dynamic:!0});b.addLeft(c);var d=this.list=hui.ui.List.create();this.list.listen({$select:this._selectionChanged.bind(this)});var e=a.search||a.gallery;if(e){var f=hui.ui.Bar.create({variant:"layout"});if(b.addCenter(f),a.search){var g=hui.ui.SearchField.create({expandedWidth:200});g.listen({$valueChanged:function(){d.resetState()}}),f.addToRight(g)}}var h=hui.ui.Overflow.create({dynamic:!0});b.addCenter(h),h.add(this.list),this.selection=hui.ui.Selection.create({value:a.selection.value}),this.selection.listen({$select:function(){d.resetState()}});var i=new hui.ui.Source({url:a.selection.url});this.selection.addItems({source:i}),c.add(this.selection);var j=[];a.list.url&&(j=[{key:"windowSize",value:10},{key:"windowPage",value:"@"+d.name+".window.page"},{key:"direction",value:"@"+d.name+".sort.direction"},{key:"sort",value:"@"+d.name+".sort.key"}]),a.selection.parameter&&j.push({key:a.selection.parameter||"text",value:"@"+this.selection.name+".value"}),a.selection.kindParameter&&j.push({key:a.selection.kindParameter||"text",value:"@"+this.selection.name+".kind"}),a.search&&j.push({key:a.search.parameter||"text",value:"@"+g.name+".value"}),a.list.pageParameter&&j.push({key:a.list.pageParameter,value:"@"+d.name+".window.page"});var k=a.list.source;if(k)for(var l=0;l<j.length;l++)k.addParameter(j[l]);if(a.list.url&&(k=new hui.ui.Source({url:a.list.url,parameters:j})),this.list.setSource(k),a.gallery){var m=hui.ui.Segmented.create({value:"gallery",items:[{icon:"view/list",value:"list"},{icon:"view/gallery",value:"gallery"}]});m.listen({$valueChanged:this.changeView.bind(this)}),f.add(m);var n=new hui.ui.Source({url:a.gallery.url,parameters:j}),o=this.gallery=hui.ui.Gallery.create({source:n});this.list.hide(),h.add(o),o.listen({$select:function(a){this.fire("select",o.getFirstSelection())}.bind(this)}),n.refresh()}if(a.upload&&hui.ui.Upload.HTML5.support().supported){var p=hui.ui.Button.create({text:"Add...",small:!0});p.listen({$click:this._showUpload.bind(this)}),f.add(p)}a.creation&&f.add(hui.ui.Button.create({text:a.creation.button||"Add...",small:!0,listen:{$click:this._showCreation.bind(this)}})),i.refresh(),hui.ui.reLayout()},changeView:function(a){"gallery"==a?(this.list.hide(),this.gallery.show()):(this.list.show(),this.gallery.hide())},_selectionChanged:function(){var a=this.list.getFirstSelection();null!=a&&this.fire("select",a)},_showUpload:function(a){if(!this.uploadPanel){var b=this.options.upload,c=this.uploadPanel=hui.ui.BoundPanel.create({padding:5,width:300,modal:!0});this.uploader=hui.ui.Upload.create({url:b.url,placeholder:b.placeholder,chooseButton:{en:"Choose file...",da:"VÃ¦lg fil..."}}),this.uploader.listen({$uploadDidComplete:function(a){this._uploadSuccess(hui.string.fromJSON(a.request.responseText))}.bind(this)}),c.add(this.uploader)}this.uploadPanel.show({target:a})},_uploadSuccess:function(a){this.uploadPanel.hide(),this.fire("select",a)},_showCreation:function(a){if(!this._createPanel){var b=this._createForm=hui.ui.Formula.create({listen:{$submit:this._create.bind(this)}});b.buildGroup({above:!0},this.options.creation.formula);var c=this._createPanel=hui.ui.BoundPanel.create({padding:5,width:300,modal:!0});c.add(b);var d=hui.ui.Buttons.create();d.add(hui.ui.Button.create({text:"Cancel",listen:{$click:function(){b.reset(),c.hide()}}})),d.add(hui.ui.Button.create({text:"Create",highlighted:!0,submit:!0})),b.add(d)}this._createPanel.show({target:a}),this._createForm.focus()},_create:function(a){var b=this._createForm.getValues();this._createForm.reset(),this._createPanel.hide(),this.window.setBusy(!0);var c=this;hui.ui.request({url:this.options.creation.url,parameters:b,$object:function(a){hui.log("Created",a),c.fire("select",a)},$failure:function(){},$finally:function(){c.window.setBusy(!1)}})}},window.define&&define("hui.ui.Finder",hui.ui.Finder),hui.ui.Structure=function(a){this.name=a.name,this.options=a||{},this.element=hui.get(a.element),hui.ui.extend(this)},hui.ui.Structure.create=function(a){return a=hui.override({},a),a.element=hui.dom.parse('<div class="hui_structure"><div class="hui_structure_middle"><div class="hui_structure_left"></div><div class="hui_structure_center"></div></div></div>'),new hui.ui.Structure(a)},hui.ui.Structure.prototype={addLeft:function(a){var b=hui.get.firstByClass(this.element,"hui_structure_left");b.appendChild(a.element)},addCenter:function(a){var b=hui.get.firstByClass(this.element,"hui_structure_center");b.appendChild(a.element)},$$layout:function(){var a=hui.get.firstByClass(this.element,"hui_structure_top"),b=hui.get.firstByClass(this.element,"hui_structure_bottom"),c=hui.get.firstByClass(this.element,"hui_structure_middle");c&&(c.style.top=(a?a.clientHeight+2:0)+"px",c.style.bottom=(b?b.clientHeight+2:0)+"px")}},hui.ui.Slider=function(a){this.options=hui.override({value:0,min:0,max:1},a),this.name=a.name,this.element=hui.get(a.element),this.handler=hui.get.firstByTag(a.element,"a"),hui.ui.extend(this),this.position=0,this.value=0,this.setValue(this.options.value),this._addBehavior()},hui.ui.Slider.create=function(a){a=hui.override({},a);var b=a.element=hui.build("span",{class:"hui_slider",html:'<a href="javascript://" class="hui_slider_knob"></a><span class="hui_slider_bar"></span>'});return a.width&&(b.style.width=a.width+"px"),new hui.ui.Slider(a)},hui.ui.Slider.prototype={_addBehavior:function(){hui.drag.register({element:this.handler,onBeforeMove:this._onBeforeMove.bind(this),onMove:this._onMove.bind(this),onAfterMove:this._onAfterMove.bind(this)})},_onBeforeMove:function(a){this.dragging=!0;var b=hui.position.get(this.handler);this.dragInfo={left:hui.position.getLeft(this.element),diff:a.getLeft()-b.left,max:this.element.clientWidth-this.handler.clientWidth-5},hui.cls.add(document.body,"hui_slider-grabbing"),hui.cls.add(this.handler,"hui_slider-grabbing")},_onMove:function(a){var b=a.getLeft()-this.dragInfo.left;b-=this.dragInfo.diff,b=Math.max(b,5),b=Math.min(b,this.dragInfo.max),this.handler.style.left=b+"px",this._setPosition((b-5)/(this.dragInfo.max-5))},_onAfterMove:function(){this.dragging=!1,hui.cls.remove(document.body,"hui_slider-grabbing"),hui.cls.remove(this.handler,"hui_slider-grabbing"),this.fire("valueChangedEnd",this.position)},_setPosition:function(a){this.position=a,this.fire("valueChanged",a)},setValue:function(a){var b=Math.max(0,Math.min(a,1)),c=this.element.clientWidth-10-this.handler.clientWidth;this.dragging||hui.animate({node:this.handler,css:{left:b*c+5+"px"},duration:200,ease:hui.ease.fastSlow}),this.position=this.value=b}},hui.ui.CodeInput=function(a){this.options=hui.override({},a),this.name=a.name;var b=this.element=hui.get(a.element);this.textarea=hui.get.firstByTag(b,"textarea"),a.value&&(this.textarea.value=a.value),this.value=this.textarea.value,hui.ui.extend(this),this._addBehavior()},hui.ui.CodeInput.create=function(a){return a=a||{},a.element=hui.build("div",{class:"hui_codeinput",html:'<textarea class="hui_codeinput_input" spellcheck="false"></textarea>'}),a.height&&(a.element.style.height=hui.style.length(a.height)),new hui.ui.CodeInput(a)},hui.ui.CodeInput.prototype={_addBehavior:function(){hui.listen(this.textarea,"keydown",this._onKeyDown.bind(this)),hui.listen(this.textarea,"keyup",this._onKeyUp.bind(this))},getValue:function(){return this.textarea.value},setValue:function(a){this.textarea.value=a,this.value=a},addLine:function(a){""===this.value?this.setValue(a):this.setValue(this.value+"\n"+a)},reset:function(){this.setValue("")},_onKeyUp:function(){this.textarea.value!==this.value&&(this.value=this.textarea.value,this.fireValueChange())},_onKeyDown:function(a){var b=String.fromCharCode(9),c=window.event||a,d=c.target?c.target:c.srcElement?c.srcElement:c.which,e=d.scrollTop,f=c.keyCode?c.keyCode:c.charCode?c.charCode:c.which;if(9==f&&!c.ctrlKey&&!c.altKey)if(d.setSelectionRange){c.preventDefault();var g=d.selectionStart,h=d.selectionEnd;if(g!=h&&d.value.slice(g,h).indexOf("\n")!=-1){g>0&&(g=d.value.slice(0,g).lastIndexOf("\n")+1);var i=d.value.slice(0,g),j=d.value.slice(g,h),k=d.value.slice(h,d.value.length);if(c.shiftKey){for(var l=j.split("\n"),m=0;m<l.length;m++)l[m].slice(0,1)!=b&&" "!=l[m].slice(0,1)||(l[m]=l[m].slice(1,l[m].length));j=l.join("\n"),d.value=i.concat(j,k),d.selectionStart=g,d.selectionEnd=i.length+j.length}else j=j.replace(/\n/g,"\n"+b),i=i.concat(b),d.value=i.concat(j,k),d.selectionStart=g,d.selectionEnd=h+b.length*j.split("\n").length}else if(c.shiftKey){var n=d.value.slice(0,g),o=n.slice(n.length-1,n.length);o!=b&&" "!=o||(d.value=n.slice(0,n.length-1).concat(d.value.slice(g,d.value.length)),d.selectionStart=g-1,d.selectionEnd=h-1)}else d.value=d.value.slice(0,g).concat(b).concat(d.value.slice(g,d.value.length)),g==h?d.selectionStart=d.selectionEnd=g+b.length:(d.selectionStart=g+b.length,d.selectionEnd=h+b.length)}else{c.returnValue=!1;var p=document.selection.createRange(),q=document.body.createTextRange();if(q.moveToElementText(d),q.setEndPoint("EndToStart",p),0==p.text.length||p.text.indexOf("\n")==-1){if(c.shiftKey){var o=q.text.slice(q.text.length-1,q.text.length);o!=b&&" "!=o||(q.text=q.text.slice(0,q.text.length-1),p.setEndPoint("StartToEnd",q))}else{var r=d.value.slice(q.text.length,q.text.length+1);r!=p.text.slice(0,1)&&(q.text=q.text.concat(r)),q.text=q.text.concat(b)}var s=document.body.createTextRange();s.setEndPoint("StartToEnd",q),s.setEndPoint("EndToEnd",p),s.select()}else{if(c.shiftKey){var l=p.text.split("\r\n"),t=d.value.slice(q.text.length,q.text.length+2);if(t==p.text.slice(0,2)){var u=q.text.lastIndexOf("\r\n".concat(b));u!=-1&&(q.text=q.text.slice(0,u+2).concat(q.text.slice(u+3,q.text.length)))}for(var m=0;m<l.length;m++){var o=l[m].length>0&&l[m].slice(0,1);o!=b&&" "!=o||(l[m]=l[m].slice(1,l[m].length))}p.text=l.join("\r\n")}else if(q.text.length>0){var t=d.value.slice(q.text.length,q.text.length+2);if(t!=p.text.slice(0,2))p.text=b.concat(p.text.split("\r\n").join("\r\n".concat(b)));else{var u=q.text.slice(0,g).lastIndexOf("\r\n")+2;q.text=q.text.slice(0,u).concat(b,q.text.slice(u,q.text.length)),p.text=p.text.split("\r\n").join("\r\n".concat(b))}}else p.text=b.concat(p.text).split("\r\n").join("\r\n".concat(b));var s=document.body.createTextRange();s.setEndPoint("StartToEnd",q),s.setEndPoint("EndToEnd",p),s.select()}}d.scrollTop=e}},hui.ui.LinkInput=function(a){var b=this.element=hui.get(a.element);this.options=hui.override({types:[]},a),this.types=this.options.types,this.name=a.name,this.value=a.value,this.input=new hui.ui.Input({element:hui.get.firstByTag(b,"input")}),this.input.listen({$valueChanged:this._onInputChange.bind(this)}),this.object=hui.get.firstByClass(b,"hui_linkinput_object"),this.dropdown=new hui.ui.DropDown({element:hui.get.firstByClass(b,"hui_dropdown"),value:"none",items:this._buildDropDownOptions(),listener:{$valueChanged:this._onDropDownChange.bind(this)}}),hui.ui.extend(this),this._addBehavior()},hui.ui.LinkInput.prototype={_addBehavior:function(){},_buildDropDownOptions:function(){for(var a=[{value:"none",text:"Intet link"}],b=0;b<this.options.types.length;b++){var c=this.options.types[b];a.push({value:c.key,text:c.label})}return a},_getType:function(a){for(var b=0;b<this.types.length;b++)if(this.types[b].key==a)return this.types[b]},_onInputChange:function(a){this.value={type:this.dropdown.getValue(),value:a},this._updateUI(),this.fireValueChange()},_onDropDownChange:function(a){this._closeAllFinders();var b=this._getType(a);return b?(this.input.element.style.display=b.finderOptions?"none":"",this.object.style.display=b.finderOptions?"":"none",b.finderOptions?(b._finder||(b._finder=hui.ui.Finder.create(b.finderOptions),b._finder.listen({$select:function(a){this._selectObject(b,a)}.bind(this)})),b._finder.show(),this.value={type:a,value:null}):(this.input.focus(),this.input.setValue(""),this.value={type:a,value:""}),this._updateUI(),void this.fireValueChange()):void(this.input.element.style.display=this.object.style.display="none")},_closeAllFinders:function(){for(var a=0;a<this.types.length;a++)this.types[a]._finder&&this.types[a]._finder.hide()},_selectObject:function(a,b){this.value={type:a.key,value:b},this._updateUI(),this._closeAllFinders(),this.fireValueChange()},_updateUI:function(){var a=this.value;if(hui.isDefined(a)){var b=this._getType(a.type);if(b)if(this.dropdown.setValue(a.type),this.input.element.style.display=b.finderOptions?"none":"",this.object.style.display=b.finderOptions?"":"none",b.finderOptions){var c=hui.get.firstByClass(this.element,"hui_linkinput_title"),d=hui.get.firstByClass(this.element,"hui_linkinput_icon");a.value?(this.object.style.display="",hui.isDefined(a.value.title)?hui.dom.setText(c,hui.string.shorten(a.value.title,40)):(this._setBusy(!0),hui.ui.request({url:b.lookupUrl,parameters:{id:a.value.id},$object:function(a){hui.dom.setText(c,hui.string.shorten(a.title,40)),this._setBusy(!1)}.bind(this),$failure:function(){hui.dom.setText(c,"!!Error"),this._setBusy(!1)}.bind(this)})),d.style.backgroundImage="url('"+hui.ui.getIconUrl(b.icon,16)+"')"):this.object.style.display="none"}else this.input.value=a.value}else this.dropdown.setValue("none"),this.input.element.style.display=this.object.style.display="none"},_setBusy:function(a){this.busy=a,hui.cls.set(this.element,"hui_linkinput_busy",a)},getValue:function(){return this.value},setValue:function(a){this.value=a,this._updateUI()},reset:function(){this.setValue(null)}},hui.ui.FontInput=function(a){this.options=hui.override({value:null},a),this.name=a.name,this.element=hui.get(a.element),this.button=hui.get.firstByClass(this.element,"hui_fontinput"),this.dropdown=new hui.ui.DropDown({element:hui.get.firstByClass(this.element,"hui_dropdown"),items:[{text:"",value:""}].concat(hui.ui.FontPicker.fonts),listener:this}),this.value=null,hui.ui.extend(this),this.setValue(this.options.value),this._addBehavior()},hui.ui.FontInput.create=function(a){a=a||{};a.element=hui.build("span",{class:"hui_colorinput",html:'<span class="hui_field_top"><span><span></span></span></span><span class="hui_field_middle"><span class="hui_field_middle"><span class="hui_field_content"><span class="hui_field_singleline"><input type="text" value=""/></span></span></span></span><span class="hui_field_bottom"><span><span></span></span></span><a tabindex="-1" class="hui_colorinput" href="javascript://"></a>'});return new hui.ui.ColorInput(a)},hui.ui.FontInput.prototype={_addBehavior:function(){hui.listen(this.button,"click",this._onButtonClick.bind(this))},_syncInput:function(){this.dropdown.setValue(this.value)},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value),this.fire("valueChanged",this.value)},_onBlur:function(){hui.Color.parse(this.value)},_onButtonClick:function(){return hui.window.getViewHeight()<200?void this.fire("clickPicker",this.value):(this.panel||(this.panel=hui.ui.BoundPanel.create({modal:!0,variant:"light"}),this.picker=hui.ui.FontPicker.create(),this.picker.listen(this),this.panel.add(this.picker)),this.panel.position(this.button),void this.panel.show())},$select:function(a){this.panel.hide(),this.setValue(a.value),this._fireChange()},$valueChanged:function(a){this.setValue(a),this._fireChange()},getValue:function(){return this.value},setValue:function(a){this.value=a,this._syncInput(),this.button.style.fontFamily=a},focus:function(){try{this.input.focus()}catch(a){}},reset:function(){this.setValue("")},destroy:function(){hui.dom.remove(this.element),this.panel&&(this.panel.destroy(),this.picker.destroy())}},hui.ui.FontPicker=function(a){this.name=a.name,this.element=hui.get(a.element),this.fonts=a.fonts.concat(a.additionalFonts),this.previews={},this.options=a||{},hui.override(this.options,a),hui.ui.extend(this),this.options.listener&&this.listen(this.options.listener),this._addBehavior()},hui.ui.FontPicker.fonts=[{text:"Verdana",value:"Verdana,sans-serif"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Trebuchet",value:"Trebuchet MS,Helvetica,sans-serif"},{text:"Geneva",value:"Geneva,Tahoma,sans-serif"},{text:"Helvetica",value:"Helvetica,Arial,sans-serif"},{text:"Helvetica Neue",value:"Helvetica Neue,Helvetica,Arial,sans-serif"},{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Arial Black",value:"Arial Black,Gadget,Arial,sans-serif"},{text:"Impact",value:"Impact,Charcoal,Arial Black,Gadget,Arial,sans-serif"},{text:"Times New Roman",value:"Times New Roman,Times,serif"},{text:"Times",value:"Times,Times New Roman,serif"},{text:"Book Antiqua",value:"Book Antiqua,Palatino,serif"},{text:"Palatino",value:"Palatino,Book Antiqua,serif"},{text:"Georgia",value:"Georgia,Book Antiqua,Palatino,serif"},{text:"Garamond",value:"Garamond,Times New Roman,Times,serif"},{text:"Comic Sans",value:"Comic Sans MS,cursive"},{text:"Courier New",value:"Courier New,Courier,monospace"},{text:"Courier",value:"Courier,Courier New,monospace"},{text:"Lucida Console",value:"Lucida Console,Monaco,monospace"},{text:"Monaco",value:"Monaco,Lucida Console,monospace"}],hui.ui.FontPicker.create=function(a){a=hui.override({fonts:hui.ui.FontPicker.fonts,additionalFonts:[]},a);for(var b=a.fonts.concat(a.additionalFonts),c=a.element=hui.build("div",{class:"hui_fontpicker"}),d=0;d<b.length;d++){var e=b[d],f=hui.build("div",{parent:c,class:"hui_fontpicker_item",text:e.text,style:"font-family:"+e.value+";"}),g=hui.ui.createIcon("monochrome/info",16,"a");f.appendChild(g),f.huiIndex=d}return new hui.ui.FontPicker(a);
},hui.ui.FontPicker.prototype={_addBehavior:function(){hui.listen(this.element,"click",this._onClick.bind(this))},_onClick:function(a){a=hui.event(a);var b=a.findByClass("hui_fontpicker_item");if(b){var c=a.findByClass("hui_icon"),d=this.fonts[b.huiIndex];c?this._buildPreview(d):this.fire("select",d)}},$visibilityChanged:function(){hui.dom.isVisible(this.element)||hui.each(this.previews,function(a,b){b.hide()})},_buildPreview:function(a){if(this.previews[a.text])return void this.previews[a.text].show();var b=hui.build("div",{className:"hui_fontpicker_example",style:"font-family:"+a.value+";"}),c=[100,200,300,"normal",500,600,"bold","bolder"],d=["9pt","10pt","11pt","12pt","13pt","14pt","16px","18pt"],e="<h1>"+a.text+"</h1>";e+='<p style="font-size: 12px;">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>',e+="<table>",e+="<thead><tr><th></th>";for(var f=0;f<c.length;f++)e+="<th>"+c[f]+"</th>";e+="</tr></thead>",e+="<tbody>";for(var f=0;f<d.length;f++){e+="<tr><th>"+d[f]+"</th>";for(var g=0;g<c.length;g++)e+='<td style="font-weight: '+c[g]+"; font-size:"+d[f]+';">Pack my box with five dozen liquor jugs</td>'}e+="</tbody>",b.innerHTML=e;var h=hui.ui.Window.create({title:a.text,padding:3});h.add(b),this.previews[a.text]=h,h.show()},destroy:function(){hui.each(this.previews,function(a,b){b.destroy()}),hui.dom.remove(this.element)}},hui.ui.Split=function(a){this.options=hui.override({},a),this.name=a.name,this.element=hui.get(a.element),this.rows=hui.get.children(this.element),this.handles=[],this.sizes=[];for(var b=0;b<this.rows.length;b++)b>0&&this.handles.push(hui.build("div",{class:"hui_split_handle",parent:this.element}));this._buildSizes(),hui.ui.extend(this),this._attach()},hui.ui.Split.prototype={_attach:function(){hui.each(this.handles,function(a){hui.drag.register({element:a,onBeforeMove:function(a){hui.log("before")},onMove:function(a){hui.log("moving")}})})},_buildSizes:function(){this.sizes=[];for(var a=0;a<this.rows.length;a++){var b=this.rows[a],c=b.getAttribute("data-height");c?this.sizes.push(this._getSize(c)):this.sizes.push(0)}for(var d=0,e=0,a=0;a<this.sizes.length;a++)d+=this.sizes[a],e+=0==this.sizes[a]?1:0;for(var f=(1-d)/e,a=0;a<this.sizes.length;a++)0==this.sizes[a]&&(this.sizes[a]=f)},_getSize:function(a){return a.indexOf("%")!=-1?parseInt(a)/100:parseInt(a)/this.element.clientHeight},$$layout:function(){this._layout()},_getSiblingHeight:function(a){for(var b=a.parentNode.clientHeight,c=a.parentNode.childNodes,d=0;d<c.length;d++){var e=c[d];e!==a&&hui.dom.isElement(c[d])&&"absolute"!=hui.style.get(e,"position")&&(b-=e.offsetHeight)}return b},_layout:function(){for(var a=0,b=hui.position.getRemainingHeight(this.element),c=0;c<this.rows.length;c++){this.rows[c].style.top=a*b+"px";var d=this.sizes[c]*b;c<this.rows.length-1&&(d-=6),this.rows[c].style.height=d+"px",a+=this.sizes[c],c<this.rows.length-1&&(this.handles[c].style.top=a*b+"px")}}},hui.ui.NumberValidator=function(a){hui.override({allowNull:!1,min:0,max:10},a),this.min=a.min,this.max=a.max,this.allowNull=a.allowNull,this.middle=Math.max(Math.min(this.max,0),this.min)},hui.ui.NumberValidator.prototype={validate:function(a){if(hui.isBlank(a)&&this.allowNull)return{valid:!0,value:null};var b=parseFloat(a);return isNaN(b)?{valid:!1,value:this.middle}:b<this.min?{valid:!1,value:this.min}:b>this.max?{valid:!1,value:this.max}:{valid:!0,value:b}}},function(a){hui.ui.ObjectInput=function(b){this.options=hui.override({},b),this.key=b.key,this.value=[],b.value&&this.value.push(b.value),"string"==typeof b.finder&&(this.finder=hui.ui.get(b.finder),this.finder.listen({$select:this._found.bind(this)})),this.nodes={text:".hui_objectinput_text",list:".hui_objectinput_list"},this.choose=null,this.remove=null,a.call(this,b),this._attach()},hui.ui.ObjectInput.prototype={_attach:function(){this.choose=new hui.ui.Button({element:hui.get.firstByClass(this.element,"hui_objectinput_choose")}),this.choose.listen({$click:this._choose.bind(this)}),this.remove=new hui.ui.Button({element:hui.get.firstByClass(this.element,"hui_objectinput_remove")}),this.remove.listen({$click:this.reset.bind(this)}),hui.listen(this.nodes.list,"click",this._clickList.bind(this))},_choose:function(){this.finder||(this.finder=hui.ui.Finder.create(this.options.finder),this.finder.listen({$select:this._found.bind(this)})),this.finder.show()},_clickList:function(a){a=hui.event(a),a.stop();var b=a.findByClass("hui_objectinput_delete");if(b){var c=a.findByClass("hui_objectinput_object"),d=parseInt(c.getAttribute("data-index"),10);this.value.splice(d,1),this._render()}},_found:function(a){this.finder.hide(),this.value.push(a),this._render(),this.fireValueChange()},_render:function(){this.nodes.list.innerHTML="";for(var a=0;a<this.value.length;a++){var b=this.value[a];b=this.fire("render",b)||b;var c=hui.build("div",{class:"hui_objectinput_object",parent:this.nodes.list,"data-index":a});b.icon&&c.appendChild(hui.ui.createIcon(b.icon,16)),c.appendChild(hui.build("span",{class:"hui_objectinput_title",text:b.text||b.title}));var d=hui.ui.createIcon("monochrome/delete",16,"a");hui.cls.add(d,"hui_objectinput_delete"),d.href="#",c.appendChild(d)}this.remove.setEnabled(!!this.value)},setValue:function(a){this.value=a||[],this._render(),this.fireValueChange()},getValue:function(){return this.value},reset:function(){this.setValue(null)}},hui.extend(hui.ui.ObjectInput,a)}(hui.ui.Component),function(a){hui.ui.Rows=function(b){a.call(this,b),this.rows=[],this._attach()},hui.ui.Rows.prototype={_attach:function(){for(var a=hui.get.children(this.element),b=0;b<a.length;b++){var c=a[b],d=hui.string.fromJSON(c.getAttribute("data"))||{};d.node=c,this.rows.push(d)}},_findSizes:function(a){for(var b=[],c=this.rows.length,d=0,e=0,f=0;f<c;f++){var g=this.rows[f];if("content"==g.height){var h=this._getContentHeight(g.node);e+=h,b.push(h),d++}else b.push(null)}for(var i=a-e,j=c-d,f=0;f<b.length;f++)null===b[f]&&(b[f]=1/j*i);this.sizes=b},_getContentHeight:function(a){for(var b=0,c=hui.get.children(a),d=0;d<c.length;d++)b+=c[d].clientHeight;return b},$$childSizeChanged:function(){this.$$layout()},$$layout:function(){var a=this.element.parentNode.clientHeight;this.element.style.height=a+"px",this._findSizes(a);for(var b=this.rows.length,c=0;c<b;c++){var d=this.rows[c];d.node.style.height=this.sizes[c]+"px"}}},hui.extend(hui.ui.Rows,a)}(hui.ui.Component),hui.ui.Pages=function(a){this.options=a||{},this.element=hui.get(a.element),this.name=a.name,this.pages=hui.get.children(this.element),this.index=0,this.fixedHeight=hui.cls.has(this.element,"hui_pages_full"),this.expanded=!1,hui.ui.extend(this)},hui.ui.Pages.create=function(a){return a=a||{},a.element=hui.build("div",{class:"hui_pages"}),new hui.ui.Pages(a)},hui.ui.Pages.prototype={add:function(a){var b=hui.dom.isElement(a)?b:a.element,c=hui.build("div",{class:"hui_pages_page"});c.appendChild(b),this.element.appendChild(c),this.pages.length>0&&(c.style.display="none"),this.pages=hui.get.children(this.element)},next:function(){if(!this.expanded){var a=this.pages[this.index];this.index=this.pages.length<=this.index+1?0:this.index+1,this._transition({hide:a,show:this.pages[this.index]})}},previous:function(){if(!this.expanded){var a=this.pages[this.index];this.index=0==this.index?this.pages.length-1:this.index-1,this._transition({hide:a,show:this.pages[this.index]})}},goTo:function(a){for(var b=0;b<this.pages.length;b++)if(this.pages[b].getAttribute("data-key")==a&&b!=this.index){var c=this.pages[this.index];return this.index=b,void this._transition({hide:c,show:this.pages[b]})}},getPageKey:function(){return this.pages[this.index].getAttribute("data-key")},expand:function(){for(var a=this.pages.length,b=0;b<a;b++)this.expanded?hui.style.set(this.pages[b],{width:"",display:b==this.index?"block":"none",float:""}):hui.style.set(this.pages[b],{width:100/a+"%",display:"block",float:"left",opacity:1});hui.ui.callVisible(this),this.expanded=!this.expanded},_transition:function(a){var b=a.hide,c=a.show,d=this.element,e=200;this.fixedHeight?(hui.style.set(b,{position:"absolute",width:d.clientWidth+"px",height:this.element.clientHeight+"px"}),hui.style.set(c,{position:"absolute",display:"block",opacity:0,width:d.clientWidth+"px",height:this.element.clientHeight+"px"})):(hui.style.set(b,{position:"absolute",width:d.clientWidth+"px"}),hui.style.set(c,{position:"absolute",width:d.clientWidth+"px",display:"block",opacity:0}),hui.style.set(d,{height:b.offsetHeight+"px",overflow:"hidden",position:"relative"}),hui.animate({node:d,css:{height:c.offsetHeight+"px"},duration:e,ease:hui.ease.slowFastSlow})),hui.ui.reLayout(),hui.effect.fadeOut({element:b,duration:e,$complete:function(){hui.style.set(b,{width:"",position:"",height:""}),window.setTimeout(function(){b.style.display="none"})}}),hui.effect.fadeIn({element:c,duration:e,$complete:function(){hui.style.set(c,{width:"",position:"",height:""}),this.fixedHeight||hui.style.set(d,{height:"",overflow:"",position:""}),hui.ui.reLayout(),hui.ui.callVisible(this),this.fireSizeChange()}.bind(this)})}};